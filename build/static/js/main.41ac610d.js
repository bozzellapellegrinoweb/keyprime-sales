/*! For license information please see main.41ac610d.js.LICENSE.txt */
(()=>{"use strict";var e={403(e,t,n){var a;n.d(t,{E_:()=>l,F3:()=>o,Ii:()=>i}),function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(a||(a={}));class r extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const s=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},s=n.Plugins=n.Plugins||{},i=()=>null!==t?t.name:(e=>{var t,n;return(null===e||void 0===e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null===e||void 0===e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"})(e),o=e=>{var t;return null===(t=n.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)},l=new Map;return n.convertFileSrc||(n.convertFileSrc=e=>e),n.getPlatform=i,n.handleError=t=>e.console.error(t),n.isNativePlatform=()=>"web"!==i(),n.isPluginAvailable=e=>{const t=l.get(e);return!!(null===t||void 0===t?void 0:t.platforms.has(i()))||!!o(e)},n.registerPlugin=function(e){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const d=l.get(e);if(d)return console.warn('Capacitor plugin "'.concat(e,'" already registered. Cannot register plugins twice.')),d.proxy;const u=i(),h=o(e);let p;const m=s=>{let i;const o=function(){for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];const m=(async()=>(!p&&u in c?p=p="function"===typeof c[u]?await c[u]():c[u]:null!==t&&!p&&"web"in c&&(p=p="function"===typeof c.web?await c.web():c.web),p))().then(t=>{const o=((t,s)=>{var i,o;if(!h){if(t)return null===(o=t[s])||void 0===o?void 0:o.bind(t);throw new r('"'.concat(e,'" plugin is not implemented on ').concat(u),a.Unimplemented)}{const a=null===h||void 0===h?void 0:h.methods.find(e=>s===e.name);if(a)return"promise"===a.rtype?t=>n.nativePromise(e,s.toString(),t):(t,a)=>n.nativeCallback(e,s.toString(),t,a);if(t)return null===(i=t[s])||void 0===i?void 0:i.bind(t)}})(t,s);if(o){const e=o(...l);return i=null===e||void 0===e?void 0:e.remove,e}throw new r('"'.concat(e,".").concat(s,'()" is not implemented on ').concat(u),a.Unimplemented)});return"addListener"===s&&(m.remove=async()=>i()),m};return o.toString=()=>"".concat(s.toString(),"() { [capacitor code] }"),Object.defineProperty(o,"name",{value:s,writable:!1,configurable:!1}),o},f=m("addListener"),g=m("removeListener"),x=(e,t)=>{const n=f({eventName:e},t),a=async()=>{const a=await n;g({eventName:e,callbackId:a},t)},r=new Promise(e=>n.then(()=>e({remove:a})));return r.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await a()},r},v=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return h?x:f;case"removeListener":return g;default:return m(t)}}});return s[e]=v,l.set(e,{name:e,proxy:v,platforms:new Set([...Object.keys(c),...h?[u]:[]])}),v},n.Exception=r,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},i=(e=>e.Capacitor=s(e))("undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{}),o=i.registerPlugin;class l{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),n&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const a=this.listeners[e];if(a)a.forEach(e=>e(t));else if(n){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}}hasListeners(e){var t;return!!(null===(t=this.listeners[e])||void 0===t?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not implemented";return new i.Exception(e,a.Unimplemented)}unavailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not available";return new i.Exception(e,a.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const a=n.indexOf(t);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(t=>{this.notifyListeners(e,t)}))}}const c=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),d=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class u extends l{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(e=>{if(e.length<=0)return;let[n,a]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=d(n).trim(),a=d(a).trim(),t[n]=a}),t}async setCookie(e){try{const t=c(e.key),n=c(e.value),a=e.expires?"; expires=".concat(e.expires.replace("expires=","")):"",r=(e.path||"/").replace("path=",""),s=null!=e.url&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(t,"=").concat(n||"").concat(a,"; path=").concat(r,"; ").concat(s,";")}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat((new Date).toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}o("CapacitorCookies",{web:()=>new u});const h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.assign({method:e.method||"GET",headers:e.headers},t),a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Object.keys(e);return Object.keys(e).map(e=>e.toLocaleLowerCase()).reduce((n,a,r)=>(n[a]=e[t[r]],n),{})}(e.headers),r=a["content-type"]||"";if("string"===typeof e.data)n.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[n,a]of Object.entries(e.data||{}))t.set(n,a);n.body=t.toString()}else if(r.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach((e,n)=>{t.append(n,e)});else for(const n of Object.keys(e.data))t.append(n,e.data[n]);n.body=t;const a=new Headers(n.headers);a.delete("content-type"),n.headers=a}else(r.includes("application/json")||"object"===typeof e.data)&&(n.body=JSON.stringify(e.data));return n};class p extends l{async request(e){const t=h(e,e.webFetchExtra),n=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e?Object.entries(e).reduce((e,n)=>{const[a,r]=n;let s,i;return Array.isArray(r)?(i="",r.forEach(e=>{s=t?encodeURIComponent(e):e,i+="".concat(a,"=").concat(s,"&")}),i.slice(0,-1)):(s=t?encodeURIComponent(r):r,i="".concat(a,"=").concat(s)),"".concat(e,"&").concat(i)},"").substr(1):null}(e.params,e.shouldEncodeUrlParams),a=n?"".concat(e.url,"?").concat(n):e.url,r=await fetch(a,t),s=r.headers.get("content-type")||"";let i,o,{responseType:l="text"}=r.ok?e:{};switch(s.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":o=await r.blob(),i=await(async e=>new Promise((t,n)=>{const a=new FileReader;a.onload=()=>{const e=a.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},a.onerror=e=>n(e),a.readAsDataURL(e)}))(o);break;case"json":i=await r.json();break;default:i=await r.text()}const c={};return r.headers.forEach((e,t)=>{c[t]=e}),{data:i,headers:c,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}o("CapacitorHttp",{web:()=>new p});var m,f;!function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(m||(m={})),function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"}(f||(f={}));class g extends l{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}o("SystemBars",{web:()=>new g})},830(e,t,n){var a,r;n.d(t,{_:()=>r,k:()=>a}),function(e){e.Heavy="HEAVY",e.Medium="MEDIUM",e.Light="LIGHT"}(a||(a={})),function(e){e.Success="SUCCESS",e.Warning="WARNING",e.Error="ERROR"}(r||(r={}))},730(e,t,n){var a=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,a,r,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,a){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,a){if(null===t||"undefined"===typeof t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,a)&&(n=null),a||null===r?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,a=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,v);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var y=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),j=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),C=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var I,L=Object.assign;function M(e){if(void 0===I)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);I=t&&t[1]||""}return"\n"+I+e}var U=!1;function F(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=a.stack.split("\n"),i=r.length-1,o=s.length-1;1<=i&&0<=o&&r[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(r[i]!==s[o]){if(1!==i||1!==o)do{if(i--,0>--o||r[i]!==s[o]){var l="\n"+r[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?M(e):""}function B(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case j:return"Portal";case _:return"Profiler";case k:return"StrictMode";case E:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case z:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){a=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=W(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=V(t.value),a=t.type;if(null!=n)"number"===a?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function se(e,t){var n=V(t.value),a=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=a&&(e.defaultValue=""+a)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,a){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var a=0===n.indexOf("--"),r=fe(n,t[n],a);"float"===n&&(n="cssFloat"),a?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var xe=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,Ne=null,ke=null;function _e(e){if(e=br(e)){if("function"!==typeof je)throw Error(s(280));var t=e.stateNode;t&&(t=wr(t),je(e.stateNode,e.type,t))}}function Se(e){Ne?ke?ke.push(e):ke=[e]:Ne=e}function Ce(){if(Ne){var e=Ne,t=ke;if(ke=Ne=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function ze(e,t){return e(t)}function Ee(){}var Ae=!1;function Te(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return ze(e,t,n)}finally{Ae=!1,(null!==Ne||null!==ke)&&(Ee(),Ce())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var a=wr(n);if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Pe=!1;if(d)try{var De={};Object.defineProperty(De,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(de){Pe=!1}function Re(e,t,n,a,r,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Ie=!1,Le=null,Me=!1,Ue=null,Fe={onError:function(e){Ie=!0,Le=e}};function Be(e,t,n,a,r,s,i,o,l){Ie=!1,Le=null,Re.apply(Fe,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(qe(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(a=r.return)){n=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return Ve(r),e;if(i===a)return Ve(r),t;i=i.sibling}throw Error(s(188))}if(n.return!==a.return)n=r,a=i;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,a=i;break}if(l===a){o=!0,a=r,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,a=r;break}if(l===a){o=!0,a=i,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==a)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ge=r.unstable_scheduleCallback,Je=r.unstable_cancelCallback,$e=r.unstable_shouldYield,Qe=r.unstable_requestPaint,Ye=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,at=r.unstable_IdlePriority,rt=null,st=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var a=0,r=e.suspendedLanes,s=e.pingedLanes,i=268435455&n;if(0!==i){var o=i&~r;0!==o?a=ut(o):0!==(s&=i)&&(a=ut(s))}else 0!==(i=n&~r)?a=ut(i):0!==s&&(a=ut(s));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&r)&&((r=a&-a)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&a)&&(a|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)r=1<<(n=31-it(t)),a|=e[n],t&=~r;return a}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-it(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}var bt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,jt,Nt,kt,_t,St=!1,Ct=[],zt=null,Et=null,At=null,Tt=new Map,Ot=new Map,Pt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":zt=null;break;case"dragenter":case"dragleave":Et=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function It(e,t,n,a,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&jt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=vr(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void _t(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Mt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&jt(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);ye=a,n.target.dispatchEvent(a),ye=null,t.shift()}return!0}function Ut(e,t,n){Mt(e)&&n.delete(t)}function Ft(){St=!1,null!==zt&&Mt(zt)&&(zt=null),null!==Et&&Mt(Et)&&(Et=null),null!==At&&Mt(At)&&(At=null),Tt.forEach(Ut),Ot.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ft)))}function qt(e){function t(t){return Bt(t,e)}if(0<Ct.length){Bt(Ct[0],e);for(var n=1;n<Ct.length;n++){var a=Ct[n];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==zt&&Bt(zt,e),null!==Et&&Bt(Et,e),null!==At&&Bt(At,e),Tt.forEach(t),Ot.forEach(t),n=0;n<Pt.length;n++)(a=Pt[n]).blockedOn===e&&(a.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Pt.shift()}var Ht=y.ReactCurrentBatchConfig,Vt=!0;function Wt(e,t,n,a){var r=bt,s=Ht.transition;Ht.transition=null;try{bt=1,Gt(e,t,n,a)}finally{bt=r,Ht.transition=s}}function Kt(e,t,n,a){var r=bt,s=Ht.transition;Ht.transition=null;try{bt=4,Gt(e,t,n,a)}finally{bt=r,Ht.transition=s}}function Gt(e,t,n,a){if(Vt){var r=$t(e,t,n,a);if(null===r)Va(e,t,a,Jt,n),Rt(e,a);else if(function(e,t,n,a,r){switch(t){case"focusin":return zt=It(zt,e,t,n,a,r),!0;case"dragenter":return Et=It(Et,e,t,n,a,r),!0;case"mouseover":return At=It(At,e,t,n,a,r),!0;case"pointerover":var s=r.pointerId;return Tt.set(s,It(Tt.get(s)||null,e,t,n,a,r)),!0;case"gotpointercapture":return s=r.pointerId,Ot.set(s,It(Ot.get(s)||null,e,t,n,a,r)),!0}return!1}(r,e,t,n,a))a.stopPropagation();else if(Rt(e,a),4&t&&-1<Dt.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&wt(s),null===(s=$t(e,t,n,a))&&Va(e,t,a,Jt,n),s===r)break;r=s}null!==r&&a.stopPropagation()}else Va(e,t,a,null,n)}}var Jt=null;function $t(e,t,n,a){if(Jt=null,null!==(e=vr(e=we(a))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case at:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,a=n.length,r="value"in Yt?Yt.value:Yt.textContent,s=r.length;for(e=0;e<a&&n[e]===r[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function an(){return!1}function rn(e){function t(t,n,a,r,s){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:an,this.isPropagationStopped=an,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=rn(cn),un=L({},cn,{view:0,detail:0}),hn=rn(un),pn=L({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=rn(pn),fn=rn(L({},pn,{dataTransfer:0})),gn=rn(L({},un,{relatedTarget:0})),xn=rn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=rn(vn),yn=rn(L({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function _n(){return kn}var Sn=L({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=rn(Sn),zn=rn(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),En=rn(L({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),An=rn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=rn(Tn),Pn=[9,13,27,32],Dn=d&&"CompositionEvent"in window,Rn=null;d&&"documentMode"in document&&(Rn=document.documentMode);var In=d&&"TextEvent"in window&&!Rn,Ln=d&&(!Dn||Rn&&8<Rn&&11>=Rn),Mn=String.fromCharCode(32),Un=!1;function Fn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,a){Se(a),0<(t=Ka(t,"onChange")).length&&(n=new dn("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Kn=null,Gn=null;function Jn(e){Ma(e,0)}function $n(e){if(G(yr(e)))return e}function Qn(e,t){if("change"===e)return t}var Yn=!1;if(d){var Xn;if(d){var Zn="oninput"in document;if(!Zn){var ea=document.createElement("div");ea.setAttribute("oninput","return;"),Zn="function"===typeof ea.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function ta(){Kn&&(Kn.detachEvent("onpropertychange",na),Gn=Kn=null)}function na(e){if("value"===e.propertyName&&$n(Gn)){var t=[];Wn(t,Gn,e,we(e)),Te(Jn,t)}}function aa(e,t,n){"focusin"===e?(ta(),Gn=n,(Kn=t).attachEvent("onpropertychange",na)):"focusout"===e&&ta()}function ra(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Gn)}function sa(e,t){if("click"===e)return $n(t)}function ia(e,t){if("input"===e||"change"===e)return $n(t)}var oa="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function la(e,t){if(oa(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!u.call(t,r)||!oa(e[r],t[r]))return!1}return!0}function ca(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function da(e,t){var n,a=ca(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ca(a)}}function ua(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ua(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ha(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function pa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ma(e){var t=ha(),n=e.focusedElem,a=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ua(n.ownerDocument.documentElement,n)){if(null!==a&&pa(n))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(a.start,r);a=void 0===a.end?s:Math.min(a.end,r),!e.extend&&s>a&&(r=a,a=s,s=r),r=da(n,s);var i=da(n,a);r&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fa=d&&"documentMode"in document&&11>=document.documentMode,ga=null,xa=null,va=null,ba=!1;function ya(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ba||null==ga||ga!==J(a)||("selectionStart"in(a=ga)&&pa(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},va&&la(va,a)||(va=a,0<(a=Ka(xa,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=ga)))}function wa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ja={animationend:wa("Animation","AnimationEnd"),animationiteration:wa("Animation","AnimationIteration"),animationstart:wa("Animation","AnimationStart"),transitionend:wa("Transition","TransitionEnd")},Na={},ka={};function _a(e){if(Na[e])return Na[e];if(!ja[e])return e;var t,n=ja[e];for(t in n)if(n.hasOwnProperty(t)&&t in ka)return Na[e]=n[t];return e}d&&(ka=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);var Sa=_a("animationend"),Ca=_a("animationiteration"),za=_a("animationstart"),Ea=_a("transitionend"),Aa=new Map,Ta="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(e,t){Aa.set(e,t),l(t,[e])}for(var Pa=0;Pa<Ta.length;Pa++){var Da=Ta[Pa];Oa(Da.toLowerCase(),"on"+(Da[0].toUpperCase()+Da.slice(1)))}Oa(Sa,"onAnimationEnd"),Oa(Ca,"onAnimationIteration"),Oa(za,"onAnimationStart"),Oa("dblclick","onDoubleClick"),Oa("focusin","onFocus"),Oa("focusout","onBlur"),Oa(Ea,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ia=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function La(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,a,r,i,o,l,c){if(Be.apply(this,arguments),Ie){if(!Ie)throw Error(s(198));var d=Le;Ie=!1,Le=null,Me||(Me=!0,Ue=d)}}(a,t,void 0,e),e.currentTarget=null}function Ma(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;La(r,o,c),s=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;La(r,o,c),s=l}}}if(Me)throw e=Ue,Me=!1,Ue=null,e}function Ua(e,t){var n=t[fr];void 0===n&&(n=t[fr]=new Set);var a=e+"__bubble";n.has(a)||(Ha(t,e,2,!1),n.add(a))}function Fa(e,t,n){var a=0;t&&(a|=4),Ha(n,e,a,t)}var Ba="_reactListening"+Math.random().toString(36).slice(2);function qa(e){if(!e[Ba]){e[Ba]=!0,i.forEach(function(t){"selectionchange"!==t&&(Ia.has(t)||Fa(t,!1,e),Fa(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ba]||(t[Ba]=!0,Fa("selectionchange",!1,t))}}function Ha(e,t,n,a){switch(Qt(t)){case 1:var r=Wt;break;case 4:r=Kt;break;default:r=Gt}n=r.bind(null,t,n,e),r=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Va(e,t,n,a,r){var s=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===i)for(i=a.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;i=i.return}for(;null!==o;){if(null===(i=vr(o)))return;if(5===(l=i.tag)||6===l){a=s=i;continue e}o=o.parentNode}}a=a.return}Te(function(){var a=s,r=we(n),i=[];e:{var o=Aa.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=En;break;case Sa:case Ca:case za:l=xn;break;case Ea:l=An;break;case"scroll":l=hn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=zn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=a;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Oe(m,h))&&d.push(Wa(m,f,p)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,r),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!vr(c)&&!c[mr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=a,null!==(c=(c=n.relatedTarget||n.toElement)?vr(c):null)&&(c!==(u=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=a),l!==c)){if(d=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=zn,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:yr(l),p=null==c?o:yr(c),(o=new d(f,m+"leave",l,n,r)).target=u,o.relatedTarget=p,f=null,vr(r)===a&&((d=new d(h,m+"enter",c,n,r)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=Ga(p))m++;for(p=0,f=h;f;f=Ga(f))p++;for(;0<m-p;)d=Ga(d),m--;for(;0<p-m;)h=Ga(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Ga(d),h=Ga(h)}d=null}else d=null;null!==l&&Ja(i,o,l,d,!1),null!==c&&null!==u&&Ja(i,u,c,d,!0)}if("select"===(l=(o=a?yr(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Qn;else if(Vn(o))if(Yn)g=ia;else{g=ra;var x=aa}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sa);switch(g&&(g=g(e,a))?Wn(i,g,n,r):(x&&x(e,o,a),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&ee(o,"number",o.value)),x=a?yr(a):window,e){case"focusin":(Vn(x)||"true"===x.contentEditable)&&(ga=x,xa=a,va=null);break;case"focusout":va=xa=ga=null;break;case"mousedown":ba=!0;break;case"contextmenu":case"mouseup":case"dragend":ba=!1,ya(i,n,r);break;case"selectionchange":if(fa)break;case"keydown":case"keyup":ya(i,n,r)}var v;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qn?Fn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(qn||"onCompositionStart"!==b?"onCompositionEnd"===b&&qn&&(v=en()):(Xt="value"in(Yt=r)?Yt.value:Yt.textContent,qn=!0)),0<(x=Ka(a,b)).length&&(b=new yn(b,e,null,n,r),i.push({event:b,listeners:x}),v?b.data=v:null!==(v=Bn(n))&&(b.data=v))),(v=In?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,Mn);case"textInput":return(e=t.data)===Mn&&Un?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Dn&&Fn(e,t)?(e=en(),Zt=Xt=Yt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(a=Ka(a,"onBeforeInput")).length&&(r=new yn("onBeforeInput","beforeinput",null,n,r),i.push({event:r,listeners:a}),r.data=v))}Ma(i,t)})}function Wa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ka(e,t){for(var n=t+"Capture",a=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Oe(e,n))&&a.unshift(Wa(e,s,r)),null!=(s=Oe(e,t))&&a.push(Wa(e,s,r))),e=e.return}return a}function Ga(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ja(e,t,n,a,r){for(var s=t._reactName,i=[];null!==n&&n!==a;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===a)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=Oe(n,s))&&i.unshift(Wa(n,l,o)):r||null!=(l=Oe(n,s))&&i.push(Wa(n,l,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var $a=/\r\n?/g,Qa=/\u0000|\uFFFD/g;function Ya(e){return("string"===typeof e?e:""+e).replace($a,"\n").replace(Qa,"")}function Xa(e,t,n){if(t=Ya(t),Ya(e)!==t&&n)throw Error(s(425))}function Za(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ar="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ir="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(or)}:ar;function or(e){setTimeout(function(){throw e})}function lr(e,t){var n=t,a=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===a)return e.removeChild(r),void qt(t);a--}else"$"!==n&&"$?"!==n&&"$!"!==n||a++;n=r}while(n);qt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ur=Math.random().toString(36).slice(2),hr="__reactFiber$"+ur,pr="__reactProps$"+ur,mr="__reactContainer$"+ur,fr="__reactEvents$"+ur,gr="__reactListeners$"+ur,xr="__reactHandles$"+ur;function vr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=dr(e);null!==e;){if(n=e[hr])return n;e=dr(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[hr]||e[mr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wr(e){return e[pr]||null}var jr=[],Nr=-1;function kr(e){return{current:e}}function _r(e){0>Nr||(e.current=jr[Nr],jr[Nr]=null,Nr--)}function Sr(e,t){Nr++,jr[Nr]=e.current,e.current=t}var Cr={},zr=kr(Cr),Er=kr(!1),Ar=Cr;function Tr(e,t){var n=e.type.contextTypes;if(!n)return Cr;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Or(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pr(){_r(Er),_r(zr)}function Dr(e,t,n){if(zr.current!==Cr)throw Error(s(168));Sr(zr,t),Sr(Er,n)}function Rr(e,t,n){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return n;for(var r in a=a.getChildContext())if(!(r in t))throw Error(s(108,H(e)||"Unknown",r));return L({},n,a)}function Ir(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cr,Ar=zr.current,Sr(zr,e),Sr(Er,Er.current),!0}function Lr(e,t,n){var a=e.stateNode;if(!a)throw Error(s(169));n?(e=Rr(e,t,Ar),a.__reactInternalMemoizedMergedChildContext=e,_r(Er),_r(zr),Sr(zr,e)):_r(Er),Sr(Er,n)}var Mr=null,Ur=!1,Fr=!1;function Br(e){null===Mr?Mr=[e]:Mr.push(e)}function qr(){if(!Fr&&null!==Mr){Fr=!0;var e=0,t=bt;try{var n=Mr;for(bt=1;e<n.length;e++){var a=n[e];do{a=a(!0)}while(null!==a)}Mr=null,Ur=!1}catch(r){throw null!==Mr&&(Mr=Mr.slice(e+1)),Ge(Ze,qr),r}finally{bt=t,Fr=!1}}return null}var Hr=[],Vr=0,Wr=null,Kr=0,Gr=[],Jr=0,$r=null,Qr=1,Yr="";function Xr(e,t){Hr[Vr++]=Kr,Hr[Vr++]=Wr,Wr=e,Kr=t}function Zr(e,t,n){Gr[Jr++]=Qr,Gr[Jr++]=Yr,Gr[Jr++]=$r,$r=e;var a=Qr;e=Yr;var r=32-it(a)-1;a&=~(1<<r),n+=1;var s=32-it(t)+r;if(30<s){var i=r-r%5;s=(a&(1<<i)-1).toString(32),a>>=i,r-=i,Qr=1<<32-it(t)+r|n<<r|a,Yr=s+e}else Qr=1<<s|n<<r|a,Yr=e}function es(e){null!==e.return&&(Xr(e,1),Zr(e,1,0))}function ts(e){for(;e===Wr;)Wr=Hr[--Vr],Hr[Vr]=null,Kr=Hr[--Vr],Hr[Vr]=null;for(;e===$r;)$r=Gr[--Jr],Gr[Jr]=null,Yr=Gr[--Jr],Gr[Jr]=null,Qr=Gr[--Jr],Gr[Jr]=null}var ns=null,as=null,rs=!1,ss=null;function is(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,as=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,as=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$r?{id:Qr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,as=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=as;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var a=ns;t&&os(e,t)?is(a,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function us(e){if(e!==ns)return!1;if(!rs)return ds(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=as)){if(ls(e))throw hs(),Error(s(418));for(;t;)is(e,t),t=cr(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){as=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}as=null}}else as=ns?cr(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=as;e;)e=cr(e.nextSibling)}function ps(){as=ns=null,rs=!1}function ms(e){null===ss?ss=[e]:ss.push(e)}var fs=y.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var a=n.stateNode}if(!a)throw Error(s(147,e));var r=a,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function i(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=2,n):a:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=Ic(n,e.mode,a)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,a){var s=n.type;return s===N?u(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===O&&vs(s)===t.type)?((a=r(t,n.props)).ref=gs(e,t,n),a.return=e,a):((a=Pc(n.type,n.key,n.props,null,e.mode,a)).ref=gs(e,t,n),a.return=e,a)}function d(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,a)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,a,s){return null===t||7!==t.tag?((t=Dc(n,e.mode,a,s)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ic(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case j:return(t=Lc(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Dc(t,e.mode,n,null)).return=e,t;xs(e,t)}return null}function p(e,t,n,a){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?c(e,t,n,a):null;case j:return n.key===r?d(e,t,n,a):null;case O:return p(e,t,(r=n._init)(n._payload),a)}if(te(n)||R(n))return null!==r?null:u(e,t,n,a,null);xs(e,n)}return null}function m(e,t,n,a,r){if("string"===typeof a&&""!==a||"number"===typeof a)return l(t,e=e.get(n)||null,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case w:return c(t,e=e.get(null===a.key?n:a.key)||null,a,r);case j:return d(t,e=e.get(null===a.key?n:a.key)||null,a,r);case O:return m(e,t,n,(0,a._init)(a._payload),r)}if(te(a)||R(a))return u(t,e=e.get(n)||null,a,r,null);xs(t,a)}return null}function f(r,s,o,l){for(var c=null,d=null,u=s,f=s=0,g=null;null!==u&&f<o.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var x=p(r,u,o[f],l);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(r,u),s=i(x,s,f),null===d?c=x:d.sibling=x,d=x,u=g}if(f===o.length)return n(r,u),rs&&Xr(r,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(r,o[f],l))&&(s=i(u,s,f),null===d?c=u:d.sibling=u,d=u);return rs&&Xr(r,f),c}for(u=a(r,u);f<o.length;f++)null!==(g=m(u,r,f,o[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),s=i(g,s,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(r,e)}),rs&&Xr(r,f),c}function g(r,o,l,c){var d=R(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,f=o,g=o=0,x=null,v=l.next();null!==f&&!v.done;g++,v=l.next()){f.index>g?(x=f,f=null):x=f.sibling;var b=p(r,f,v.value,c);if(null===b){null===f&&(f=x);break}e&&f&&null===b.alternate&&t(r,f),o=i(b,o,g),null===u?d=b:u.sibling=b,u=b,f=x}if(v.done)return n(r,f),rs&&Xr(r,g),d;if(null===f){for(;!v.done;g++,v=l.next())null!==(v=h(r,v.value,c))&&(o=i(v,o,g),null===u?d=v:u.sibling=v,u=v);return rs&&Xr(r,g),d}for(f=a(r,f);!v.done;g++,v=l.next())null!==(v=m(f,r,g,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?g:v.key),o=i(v,o,g),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach(function(e){return t(r,e)}),rs&&Xr(r,g),d}return function e(a,s,i,l){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,d=s;null!==d;){if(d.key===c){if((c=i.type)===N){if(7===d.tag){n(a,d.sibling),(s=r(d,i.props.children)).return=a,a=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&vs(c)===d.type){n(a,d.sibling),(s=r(d,i.props)).ref=gs(a,d,i),s.return=a,a=s;break e}n(a,d);break}t(a,d),d=d.sibling}i.type===N?((s=Dc(i.props.children,a.mode,l,i.key)).return=a,a=s):((l=Pc(i.type,i.key,i.props,null,a.mode,l)).ref=gs(a,s,i),l.return=a,a=l)}return o(a);case j:e:{for(d=i.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation){n(a,s.sibling),(s=r(s,i.children||[])).return=a,a=s;break e}n(a,s);break}t(a,s),s=s.sibling}(s=Lc(i,a.mode,l)).return=a,a=s}return o(a);case O:return e(a,s,(d=i._init)(i._payload),l)}if(te(i))return f(a,s,i,l);if(R(i))return g(a,s,i,l);xs(a,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==s&&6===s.tag?(n(a,s.sibling),(s=r(s,i)).return=a,a=s):(n(a,s),(s=Ic(i,a.mode,l)).return=a,a=s),o(a)):n(a,s)}}var ys=bs(!0),ws=bs(!1),js=kr(null),Ns=null,ks=null,_s=null;function Ss(){_s=ks=Ns=null}function Cs(e){var t=js.current;_r(js),e._currentValue=t}function zs(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Es(e,t){Ns=e,_s=ks=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function As(e){var t=e._currentValue;if(_s!==e)if(e={context:e,memoizedValue:t,next:null},null===ks){if(null===Ns)throw Error(s(308));ks=e,Ns.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var Ts=null;function Os(e){null===Ts?Ts=[e]:Ts.push(e)}function Ps(e,t,n,a){var r=t.interleaved;return null===r?(n.next=n,Os(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ds(e,a)}function Ds(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Rs=!1;function Is(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ms(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Cl)){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,Ds(e,n)}return null===(r=a.interleaved)?(t.next=t,Os(a)):(t.next=r.next,r.next=t),a.interleaved=t,Ds(e,n)}function Fs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Bs(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=i:s=s.next=i,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:a.shared,effects:a.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qs(e,t,n,a){var r=e.updateQueue;Rs=!1;var s=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=r.baseState;for(i=0,d=c=l=null,o=s;;){var h=o.lane,p=o.eventTime;if((a&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=L({},u,h);break e;case 2:Rs=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,i|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(h=o).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{i|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Rl|=i,e.lanes=i,e.memoizedState=u}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],r=a.callback;if(null!==r){if(a.callback=null,a=n,"function"!==typeof r)throw Error(s(191,r));r.call(a)}}}var Vs={},Ws=kr(Vs),Ks=kr(Vs),Gs=kr(Vs);function Js(e){if(e===Vs)throw Error(s(174));return e}function $s(e,t){switch(Sr(Gs,t),Sr(Ks,e),Sr(Ws,Vs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}_r(Ws),Sr(Ws,t)}function Qs(){_r(Ws),_r(Ks),_r(Gs)}function Ys(e){Js(Gs.current);var t=Js(Ws.current),n=le(t,e.type);t!==n&&(Sr(Ks,e),Sr(Ws,n))}function Xs(e){Ks.current===e&&(_r(Ws),_r(Ks))}var Zs=kr(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ai=y.ReactCurrentDispatcher,ri=y.ReactCurrentBatchConfig,si=0,ii=null,oi=null,li=null,ci=!1,di=!1,ui=0,hi=0;function pi(){throw Error(s(321))}function mi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oa(e[n],t[n]))return!1;return!0}function fi(e,t,n,a,r,i){if(si=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ai.current=null===e||null===e.memoizedState?Xi:Zi,e=n(a,r),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(s(301));i+=1,li=oi=null,t.updateQueue=null,ai.current=eo,e=n(a,r)}while(di)}if(ai.current=Yi,t=null!==oi&&null!==oi.next,si=0,li=oi=ii=null,ci=!1,t)throw Error(s(300));return e}function gi(){var e=0!==ui;return ui=0,e}function xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function vi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function bi(e,t){return"function"===typeof t?t(e):t}function yi(e){var t=vi(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var a=oi,r=a.baseQueue,i=n.pending;if(null!==i){if(null!==r){var o=r.next;r.next=i.next,i.next=o}a.baseQueue=r=i,n.pending=null}if(null!==r){i=r.next,a=a.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((si&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=a):c=c.next=h,ii.lanes|=u,Rl|=u}d=d.next}while(null!==d&&d!==i);null===c?o=a:c.next=l,oa(a,t.memoizedState)||(bo=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,n.lastRenderedState=a}if(null!==(e=n.interleaved)){r=e;do{i=r.lane,ii.lanes|=i,Rl|=i,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wi(e){var t=vi(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,i=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{i=e(i,o.action),o=o.next}while(o!==r);oa(i,t.memoizedState)||(bo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,a]}function ji(){}function Ni(e,t){var n=ii,a=vi(),r=t(),i=!oa(a.memoizedState,r);if(i&&(a.memoizedState=r,bo=!0),a=a.queue,Ri(Si.bind(null,n,a,e),[e]),a.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,Ai(9,_i.bind(null,n,a,r,t),void 0,null),null===zl)throw Error(s(349));0!==(30&si)||ki(n,t,r)}return r}function ki(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _i(e,t,n,a){t.value=n,t.getSnapshot=a,Ci(t)&&zi(e)}function Si(e,t,n){return n(function(){Ci(t)&&zi(e)})}function Ci(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oa(e,n)}catch(a){return!0}}function zi(e){var t=Ds(e,1);null!==t&&tc(t,e,1,-1)}function Ei(e){var t=xi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=Gi.bind(null,ii,e),[t.memoizedState,e]}function Ai(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Ti(){return vi().memoizedState}function Oi(e,t,n,a){var r=xi();ii.flags|=e,r.memoizedState=Ai(1|t,n,void 0,void 0===a?null:a)}function Pi(e,t,n,a){var r=vi();a=void 0===a?null:a;var s=void 0;if(null!==oi){var i=oi.memoizedState;if(s=i.destroy,null!==a&&mi(a,i.deps))return void(r.memoizedState=Ai(t,n,s,a))}ii.flags|=e,r.memoizedState=Ai(1|t,n,s,a)}function Di(e,t){return Oi(8390656,8,e,t)}function Ri(e,t){return Pi(2048,8,e,t)}function Ii(e,t){return Pi(4,2,e,t)}function Li(e,t){return Pi(4,4,e,t)}function Mi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ui(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pi(4,4,Mi.bind(null,t,e),n)}function Fi(){}function Bi(e,t){var n=vi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&mi(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function qi(e,t){var n=vi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&mi(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Hi(e,t,n){return 0===(21&si)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(oa(n,t)||(n=ft(),ii.lanes|=n,Rl|=n,e.baseState=!0),t)}function Vi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var a=ri.transition;ri.transition={};try{e(!1),t()}finally{bt=n,ri.transition=a}}function Wi(){return vi().memoizedState}function Ki(e,t,n){var a=ec(e);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},Ji(e))$i(t,n);else if(null!==(n=Ps(e,t,n,a))){tc(n,e,a,Zl()),Qi(n,t,a)}}function Gi(e,t,n){var a=ec(e),r={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ji(e))$i(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,n);if(r.hasEagerState=!0,r.eagerState=o,oa(o,i)){var l=t.interleaved;return null===l?(r.next=r,Os(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ps(e,t,r,a))&&(tc(n,e,a,r=Zl()),Qi(n,t,a))}}function Ji(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function $i(e,t){di=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qi(e,t,n){if(0!==(4194240&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Yi={readContext:As,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},Xi={readContext:As,useCallback:function(e,t){return xi().memoizedState=[e,void 0===t?null:t],e},useContext:As,useEffect:Di,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oi(4194308,4,Mi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oi(4,2,e,t)},useMemo:function(e,t){var n=xi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=xi();return t=void 0!==n?n(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},xi().memoizedState=e},useState:Ei,useDebugValue:Fi,useDeferredValue:function(e){return xi().memoizedState=e},useTransition:function(){var e=Ei(!1),t=e[0];return e=Vi.bind(null,e[1]),xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var a=ii,r=xi();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===zl)throw Error(s(349));0!==(30&si)||ki(a,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,Di(Si.bind(null,a,i,e),[e]),a.flags|=2048,Ai(9,_i.bind(null,a,i,n,t),void 0,null),n},useId:function(){var e=xi(),t=zl.identifierPrefix;if(rs){var n=Yr;t=":"+t+"R"+(n=(Qr&~(1<<32-it(Qr)-1)).toString(32)+n),0<(n=ui++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:As,useCallback:Bi,useContext:As,useEffect:Ri,useImperativeHandle:Ui,useInsertionEffect:Ii,useLayoutEffect:Li,useMemo:qi,useReducer:yi,useRef:Ti,useState:function(){return yi(bi)},useDebugValue:Fi,useDeferredValue:function(e){return Hi(vi(),oi.memoizedState,e)},useTransition:function(){return[yi(bi)[0],vi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ni,useId:Wi,unstable_isNewReconciler:!1},eo={readContext:As,useCallback:Bi,useContext:As,useEffect:Ri,useImperativeHandle:Ui,useInsertionEffect:Ii,useLayoutEffect:Li,useMemo:qi,useReducer:wi,useRef:Ti,useState:function(){return wi(bi)},useDebugValue:Fi,useDeferredValue:function(e){var t=vi();return null===oi?t.memoizedState=e:Hi(t,oi.memoizedState,e)},useTransition:function(){return[wi(bi)[0],vi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ni,useId:Wi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ao={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Zl(),r=ec(e),s=Ms(a,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(tc(t,e,r,a),Fs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Zl(),r=ec(e),s=Ms(a,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(tc(t,e,r,a),Fs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Zl(),a=ec(e),r=Ms(n,a);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Us(e,r,a))&&(tc(t,e,a,n),Fs(t,e,a))}};function ro(e,t,n,a,r,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!la(n,a)||!la(r,s))}function so(e,t,n){var a=!1,r=Cr,s=t.contextType;return"object"===typeof s&&null!==s?s=As(s):(r=Or(t)?Ar:zr.current,s=(a=null!==(a=t.contextTypes)&&void 0!==a)?Tr(e,r):Cr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ao,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function io(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&ao.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,a){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Is(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=As(s):(s=Or(t)?Ar:zr.current,r.context=Tr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ao.enqueueReplaceState(r,r.state,null),qs(e,n,r,a),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",a=t;do{n+=B(a),a=a.return}while(a);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Ms(-1,n)).tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Hl||(Hl=!0,Vl=a),uo(0,t)},n}function mo(e,t,n){(n=Ms(-1,n)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var r=t.value;n.payload=function(){return a(r)},n.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof a&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fo(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new ho;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(n)||(r.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,n,a,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ms(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var vo=y.ReactCurrentOwner,bo=!1;function yo(e,t,n,a){t.child=null===e?ws(t,null,n,a):ys(t,e.child,n,a)}function wo(e,t,n,a,r){n=n.render;var s=t.ref;return Es(t,r),a=fi(e,t,n,a,s,r),n=gi(),null===e||bo?(rs&&n&&es(t),t.flags|=1,yo(e,t,a,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ho(e,t,r))}function jo(e,t,n,a,r){if(null===e){var s=n.type;return"function"!==typeof s||Tc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,No(e,t,s,a,r))}if(s=e.child,0===(e.lanes&r)){var i=s.memoizedProps;if((n=null!==(n=n.compare)?n:la)(i,a)&&e.ref===t.ref)return Ho(e,t,r)}return t.flags|=1,(e=Oc(s,a)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,a,r){if(null!==e){var s=e.memoizedProps;if(la(s,a)&&e.ref===t.ref){if(bo=!1,t.pendingProps=a=s,0===(e.lanes&r))return t.lanes=e.lanes,Ho(e,t,r);0!==(131072&e.flags)&&(bo=!0)}}return So(e,t,n,a,r)}function ko(e,t,n){var a=t.pendingProps,r=a.children,s=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr(Ol,Tl),Tl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sr(Ol,Tl),Tl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==s?s.baseLanes:n,Sr(Ol,Tl),Tl|=a}else null!==s?(a=s.baseLanes|n,t.memoizedState=null):a=n,Sr(Ol,Tl),Tl|=a;return yo(e,t,r,n),t.child}function _o(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function So(e,t,n,a,r){var s=Or(n)?Ar:zr.current;return s=Tr(t,s),Es(t,r),n=fi(e,t,n,a,s,r),a=gi(),null===e||bo?(rs&&a&&es(t),t.flags|=1,yo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ho(e,t,r))}function Co(e,t,n,a,r){if(Or(n)){var s=!0;Ir(t)}else s=!1;if(Es(t,r),null===t.stateNode)qo(e,t),so(t,n,a),oo(t,n,a,r),a=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=As(c):c=Tr(t,c=Or(n)?Ar:zr.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==a||l!==c)&&io(t,i,a,c),Rs=!1;var h=t.memoizedState;i.state=h,qs(t,a,i,r),l=t.memoizedState,o!==a||h!==l||Er.current||Rs?("function"===typeof d&&(no(t,n,d,a),l=t.memoizedState),(o=Rs||ro(t,n,o,a,h,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=l),i.props=a,i.state=l,i.context=c,a=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,Ls(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=As(l):l=Tr(t,l=Or(n)?Ar:zr.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||h!==l)&&io(t,i,a,l),Rs=!1,h=t.memoizedState,i.state=h,qs(t,a,i,r);var m=t.memoizedState;o!==u||h!==m||Er.current||Rs?("function"===typeof p&&(no(t,n,p,a),m=t.memoizedState),(c=Rs||ro(t,n,c,a,h,m,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,m,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,m,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=m),i.props=a,i.state=m,i.context=l,a=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return zo(e,t,n,a,s,r)}function zo(e,t,n,a,r,s){_o(e,t);var i=0!==(128&t.flags);if(!a&&!i)return r&&Lr(t,n,!1),Ho(e,t,s);a=t.stateNode,vo.current=t;var o=i&&"function"!==typeof n.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=ys(t,e.child,null,s),t.child=ys(t,null,o,s)):yo(e,t,o,s),t.memoizedState=a.state,r&&Lr(t,n,!0),t.child}function Eo(e){var t=e.stateNode;t.pendingContext?Dr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Dr(0,t.context,!1),$s(e,t.containerInfo)}function Ao(e,t,n,a,r){return ps(),ms(r),t.flags|=256,yo(e,t,n,a),t.child}var To,Oo,Po,Do={dehydrated:null,treeContext:null,retryLane:0};function Ro(e){return{baseLanes:e,cachePool:null,transitions:null}}function Io(e,t,n){var a,r=t.pendingProps,i=Zs.current,o=!1,l=0!==(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&i)),a?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Sr(Zs,1&i),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Rc(l,r,0,null),e=Dc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Ro(n),t.memoizedState=Do,e):Lo(t,l));if(null!==(i=e.memoizedState)&&null!==(a=i.dehydrated))return function(e,t,n,a,r,i,o){if(n)return 256&t.flags?(t.flags&=-257,Mo(e,t,o,a=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=a.fallback,r=t.mode,a=Rc({mode:"visible",children:a.children},r,0,null),(i=Dc(i,r,o,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,0!==(1&t.mode)&&ys(t,e.child,null,o),t.child.memoizedState=Ro(o),t.memoizedState=Do,i);if(0===(1&t.mode))return Mo(e,t,o,null);if("$!"===r.data){if(a=r.nextSibling&&r.nextSibling.dataset)var l=a.dgst;return a=l,Mo(e,t,o,a=co(i=Error(s(419)),a,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(a=zl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(a.suspendedLanes|o))?0:r)&&r!==i.retryLane&&(i.retryLane=r,Ds(e,r),tc(a,e,r,-1))}return mc(),Mo(e,t,o,a=co(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,as=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Gr[Jr++]=Qr,Gr[Jr++]=Yr,Gr[Jr++]=$r,Qr=e.id,Yr=e.overflow,$r=t),t=Lo(t,a.children),t.flags|=4096,t)}(e,t,l,r,a,i,n);if(o){o=r.fallback,l=t.mode,a=(i=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==i?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Oc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==a?o=Oc(a,o):(o=Dc(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Ro(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Do,r}return e=(o=e.child).sibling,r=Oc(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Lo(e,t){return(t=Rc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Mo(e,t,n,a){return null!==a&&ms(a),ys(t,e.child,null,n),(e=Lo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),zs(e.return,t,n)}function Fo(e,t,n,a,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=n,s.tailMode=r)}function Bo(e,t,n){var a=t.pendingProps,r=a.revealOrder,s=a.tail;if(yo(e,t,a.children,n),0!==(2&(a=Zs.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,n,t);else if(19===e.tag)Uo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Sr(Zs,a),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Fo(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ei(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Fo(t,!0,n,null,s);break;case"together":Fo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Rl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vo(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=14680064&r.subtreeFlags,a|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function Ko(e,t,n){var a=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Or(t.type)&&Pr(),Wo(t),null;case 3:return a=t.stateNode,Qs(),_r(Er),_r(zr),ni(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(sc(ss),ss=null))),Wo(t),null;case 5:Xs(t);var r=Js(Gs.current);if(n=t.type,null!==e&&null!=t.stateNode)Oo(e,t,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(s(166));return Wo(t),null}if(e=Js(Ws.current),us(t)){a=t.stateNode,n=t.type;var i=t.memoizedProps;switch(a[hr]=t,a[pr]=i,e=0!==(1&t.mode),n){case"dialog":Ua("cancel",a),Ua("close",a);break;case"iframe":case"object":case"embed":Ua("load",a);break;case"video":case"audio":for(r=0;r<Ra.length;r++)Ua(Ra[r],a);break;case"source":Ua("error",a);break;case"img":case"image":case"link":Ua("error",a),Ua("load",a);break;case"details":Ua("toggle",a);break;case"input":Q(a,i),Ua("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},Ua("invalid",a);break;case"textarea":re(a,i),Ua("invalid",a)}for(var l in ve(n,i),r=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?a.textContent!==c&&(!0!==i.suppressHydrationWarning&&Xa(a.textContent,c,e),r=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Xa(a.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ua("scroll",a)}switch(n){case"input":K(a),Z(a,i,!0);break;case"textarea":K(a),ie(a);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(a.onclick=Za)}a=r,t.updateQueue=a,null!==a&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=l.createElement(n,{is:a.is}):(e=l.createElement(n),"select"===n&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,n),e[hr]=t,e[pr]=a,To(e,t),t.stateNode=e;e:{switch(l=be(n,a),n){case"dialog":Ua("cancel",e),Ua("close",e),r=a;break;case"iframe":case"object":case"embed":Ua("load",e),r=a;break;case"video":case"audio":for(r=0;r<Ra.length;r++)Ua(Ra[r],e);r=a;break;case"source":Ua("error",e),r=a;break;case"img":case"image":case"link":Ua("error",e),Ua("load",e),r=a;break;case"details":Ua("toggle",e),r=a;break;case"input":Q(e,a),r=$(e,a),Ua("invalid",e);break;case"option":default:r=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},r=L({},a,{value:void 0}),Ua("invalid",e);break;case"textarea":re(e,a),r=ae(e,a),Ua("invalid",e)}for(i in ve(n,r),c=r)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?ge(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Ua("scroll",e):null!=d&&b(e,i,d,l))}switch(n){case"input":K(e),Z(e,a,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=a.value&&e.setAttribute("value",""+V(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?ne(e,!!a.multiple,i,!1):null!=a.defaultValue&&ne(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Za)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Po(0,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(s(166));if(n=Js(Gs.current),Js(Ws.current),us(t)){if(a=t.stateNode,n=t.memoizedProps,a[hr]=t,(i=a.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xa(a.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xa(a.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(a=(9===n.nodeType?n:n.ownerDocument).createTextNode(a))[hr]=t,t.stateNode=a}return Wo(t),null;case 13:if(_r(Zs),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==as&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ps(),t.flags|=98560,i=!1;else if(i=us(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[hr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),i=!1}else null!==ss&&(sc(ss),ss=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Pl&&(Pl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return Qs(),null===e&&qa(t.stateNode.containerInfo),Wo(t),null;case 10:return Cs(t.type._context),Wo(t),null;case 19:if(_r(Zs),null===(i=t.memoizedState))return Wo(t),null;if(a=0!==(128&t.flags),null===(l=i.rendering))if(a)Vo(i,!1);else{if(0!==Pl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Vo(i,!1),null!==(a=l.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=n,n=t.child;null!==n;)e=a,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Sr(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==i.tail&&Ye()>Bl&&(t.flags|=128,a=!0,Vo(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=ei(l))){if(t.flags|=128,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vo(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!rs)return Wo(t),null}else 2*Ye()-i.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,a=!0,Vo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,n=Zs.current,Sr(Zs,a?1&n|2:1&n),t):(Wo(t),null);case 22:case 23:return dc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Tl)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Go(e,t){switch(ts(t),t.tag){case 1:return Or(t.type)&&Pr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Qs(),_r(Er),_r(zr),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(_r(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return _r(Zs),null;case 4:return Qs(),null;case 10:return Cs(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}To=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oo=function(e,t,n,a){var r=e.memoizedProps;if(r!==a){e=t.stateNode,Js(Ws.current);var s,i=null;switch(n){case"input":r=$(e,r),a=$(e,a),i=[];break;case"select":r=L({},r,{value:void 0}),a=L({},a,{value:void 0}),i=[];break;case"textarea":r=ae(e,r),a=ae(e,a),i=[];break;default:"function"!==typeof r.onClick&&"function"===typeof a.onClick&&(e.onclick=Za)}for(d in ve(n,a),n=null,r)if(!a.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var l=r[d];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(l=null!=r?r[d]:void 0,a.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(i||(i=[]),i.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ua("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Po=function(e,t,n,a){n!==a&&(t.flags|=4)};var Jo=!1,$o=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Yo=null;function Xo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(a){Nc(e,t,a)}else n.current=null}function Zo(e,t,n){try{n()}catch(a){Nc(e,t,a)}}var el=!1;function tl(e,t,n){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var r=a=a.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&Zo(t,n,s)}r=r.next}while(r!==a)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var a=n.create;n.destroy=a()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function rl(e){var t=e.alternate;null!==t&&(e.alternate=null,rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[pr],delete t[fr],delete t[gr],delete t[xr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ol(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Za));else if(4!==a&&null!==(e=e.child))for(ol(e,t,n),e=e.sibling;null!==e;)ol(e,t,n),e=e.sibling}function ll(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var cl=null,dl=!1;function ul(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(o){}switch(n.tag){case 5:$o||Xo(n,t);case 6:var a=cl,r=dl;cl=null,ul(e,t,n),dl=r,null!==(cl=a)&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),qt(e)):lr(cl,n.stateNode));break;case 4:a=cl,r=dl,cl=n.stateNode.containerInfo,dl=!0,ul(e,t,n),cl=a,dl=r;break;case 0:case 11:case 14:case 15:if(!$o&&(null!==(a=n.updateQueue)&&null!==(a=a.lastEffect))){r=a=a.next;do{var s=r,i=s.destroy;s=s.tag,void 0!==i&&(0!==(2&s)||0!==(4&s))&&Zo(n,t,i),r=r.next}while(r!==a)}ul(e,t,n);break;case 1:if(!$o&&(Xo(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(o){Nc(n,t,o)}ul(e,t,n);break;case 21:ul(e,t,n);break;case 22:1&n.mode?($o=(a=$o)||null!==n.memoizedState,ul(e,t,n),$o=a):ul(e,t,n);break;default:ul(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach(function(t){var a=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var r=n[a];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,dl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===cl)throw Error(s(160));hl(i,o,r),cl=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){Nc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fl(t,e),t=t.sibling}function fl(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),gl(e),4&a){try{tl(3,e,e.return),nl(3,e)}catch(g){Nc(e,e.return,g)}try{tl(5,e,e.return)}catch(g){Nc(e,e.return,g)}}break;case 1:ml(t,e),gl(e),512&a&&null!==n&&Xo(n,n.return);break;case 5:if(ml(t,e),gl(e),512&a&&null!==n&&Xo(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(g){Nc(e,e.return,g)}}if(4&a&&null!=(r=e.stateNode)){var i=e.memoizedProps,o=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&Y(r,i),be(l,o);var d=be(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ge(r,h):"dangerouslySetInnerHTML"===u?ue(r,h):"children"===u?he(r,h):b(r,u,h,d)}switch(l){case"input":X(r,i);break;case"textarea":se(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var m=i.value;null!=m?ne(r,!!i.multiple,m,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(r,!!i.multiple,i.defaultValue,!0):ne(r,!!i.multiple,i.multiple?[]:"",!1))}r[pr]=i}catch(g){Nc(e,e.return,g)}}break;case 6:if(ml(t,e),gl(e),4&a){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(g){Nc(e,e.return,g)}}break;case 3:if(ml(t,e),gl(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(g){Nc(e,e.return,g)}break;case 4:default:ml(t,e),gl(e);break;case 13:ml(t,e),gl(e),8192&(r=e.child).flags&&(i=null!==r.memoizedState,r.stateNode.isHidden=i,!i||null!==r.alternate&&null!==r.alternate.memoizedState||(Fl=Ye())),4&a&&pl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?($o=(d=$o)||u,ml(t,e),$o=d):ml(t,e),gl(e),8192&a){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Yo=e,u=e.child;null!==u;){for(h=Yo=u;null!==Yo;){switch(m=(p=Yo).child,p.tag){case 0:case 11:case 14:case 15:tl(4,p,p.return);break;case 1:Xo(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){a=p,n=p.return;try{t=a,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){Nc(a,n,g)}}break;case 5:Xo(p,p.return);break;case 22:if(null!==p.memoizedState){yl(h);continue}}null!==m?(m.return=p,Yo=m):yl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{r=h.stateNode,d?"function"===typeof(i=r.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(g){Nc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Nc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),gl(e),4&a&&pl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var a=n;break e}n=n.return}throw Error(s(160))}switch(a.tag){case 5:var r=a.stateNode;32&a.flags&&(he(r,""),a.flags&=-33),ll(e,il(e),r);break;case 3:case 4:var i=a.stateNode.containerInfo;ol(e,il(e),i);break;default:throw Error(s(161))}}catch(o){Nc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,n){Yo=e,vl(e,t,n)}function vl(e,t,n){for(var a=0!==(1&e.mode);null!==Yo;){var r=Yo,s=r.child;if(22===r.tag&&a){var i=null!==r.memoizedState||Jo;if(!i){var o=r.alternate,l=null!==o&&null!==o.memoizedState||$o;o=Jo;var c=$o;if(Jo=i,($o=l)&&!c)for(Yo=r;null!==Yo;)l=(i=Yo).child,22===i.tag&&null!==i.memoizedState?wl(r):null!==l?(l.return=i,Yo=l):wl(r);for(;null!==s;)Yo=s,vl(s,t,n),s=s.sibling;Yo=r,Jo=o,$o=c}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Yo=s):bl(e)}}function bl(e){for(;null!==Yo;){var t=Yo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$o||nl(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!$o)if(null===n)a.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);a.componentDidUpdate(r,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Hs(t,i,a);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&qt(h)}}}break;default:throw Error(s(163))}$o||512&t.flags&&al(t)}catch(p){Nc(t,t.return,p)}}if(t===e){Yo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Yo=n;break}Yo=t.return}}function yl(e){for(;null!==Yo;){var t=Yo;if(t===e){Yo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Yo=n;break}Yo=t.return}}function wl(e){for(;null!==Yo;){var t=Yo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){Nc(t,n,l)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var r=t.return;try{a.componentDidMount()}catch(l){Nc(t,r,l)}}var s=t.return;try{al(t)}catch(l){Nc(t,s,l)}break;case 5:var i=t.return;try{al(t)}catch(l){Nc(t,i,l)}}}catch(l){Nc(t,t.return,l)}if(t===e){Yo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Yo=o;break}Yo=t.return}}var jl,Nl=Math.ceil,kl=y.ReactCurrentDispatcher,_l=y.ReactCurrentOwner,Sl=y.ReactCurrentBatchConfig,Cl=0,zl=null,El=null,Al=0,Tl=0,Ol=kr(0),Pl=0,Dl=null,Rl=0,Il=0,Ll=0,Ml=null,Ul=null,Fl=0,Bl=1/0,ql=null,Hl=!1,Vl=null,Wl=null,Kl=!1,Gl=null,Jl=0,$l=0,Ql=null,Yl=-1,Xl=0;function Zl(){return 0!==(6&Cl)?Ye():-1!==Yl?Yl:Yl=Ye()}function ec(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Al?Al&-Al:null!==fs.transition?(0===Xl&&(Xl=ft()),Xl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function tc(e,t,n,a){if(50<$l)throw $l=0,Ql=null,Error(s(185));xt(e,n,a),0!==(2&Cl)&&e===zl||(e===zl&&(0===(2&Cl)&&(Il|=n),4===Pl&&ic(e,Al)),nc(e,a),1===n&&0===Cl&&0===(1&t.mode)&&(Bl=Ye()+500,Ur&&qr()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-it(s),o=1<<i,l=r[i];-1===l?0!==(o&n)&&0===(o&a)||(r[i]=pt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var a=ht(e,e===zl?Al:0);if(0===a)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){Ur=!0,Br(e)}(oc.bind(null,e)):Br(oc.bind(null,e)),ir(function(){0===(6&Cl)&&qr()}),n=null;else{switch(yt(a)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=at}n=zc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Yl=-1,Xl=0,0!==(6&Cl))throw Error(s(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var a=ht(e,e===zl?Al:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=fc(e,a);else{t=a;var r=Cl;Cl|=2;var i=pc();for(zl===e&&Al===t||(ql=null,Bl=Ye()+500,uc(e,t));;)try{xc();break}catch(l){hc(e,l)}Ss(),kl.current=i,Cl=r,null!==El?t=0:(zl=null,Al=0,t=Pl)}if(0!==t){if(2===t&&(0!==(r=mt(e))&&(a=r,t=rc(e,r))),1===t)throw n=Dl,uc(e,0),ic(e,a),nc(e,Ye()),n;if(6===t)ic(e,a);else{if(r=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var a=0;a<n.length;a++){var r=n[a],s=r.getSnapshot;r=r.value;try{if(!oa(s(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=fc(e,a))&&(0!==(i=mt(e))&&(a=i,t=rc(e,i))),1===t))throw n=Dl,uc(e,0),ic(e,a),nc(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=a,t){case 0:case 1:throw Error(s(345));case 2:case 5:yc(e,Ul,ql);break;case 3:if(ic(e,a),(130023424&a)===a&&10<(t=Fl+500-Ye())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&a)!==a){Zl(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ar(yc.bind(null,e,Ul,ql),t);break}yc(e,Ul,ql);break;case 4:if(ic(e,a),(4194240&a)===a)break;for(t=e.eventTimes,r=-1;0<a;){var o=31-it(a);i=1<<o,(o=t[o])>r&&(r=o),a&=~i}if(a=r,10<(a=(120>(a=Ye()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Nl(a/1960))-a)){e.timeoutHandle=ar(yc.bind(null,e,Ul,ql),a);break}yc(e,Ul,ql);break;default:throw Error(s(329))}}}return nc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function rc(e,t){var n=Ml;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),2!==(e=fc(e,t))&&(t=Ul,Ul=n,null!==t&&sc(t)),e}function sc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ic(e,t){for(t&=~Ll,t&=~Il,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),a=1<<n;e[n]=-1,t&=~a}}function oc(e){if(0!==(6&Cl))throw Error(s(327));wc();var t=ht(e,0);if(0===(1&t))return nc(e,Ye()),null;var n=fc(e,t);if(0!==e.tag&&2===n){var a=mt(e);0!==a&&(t=a,n=rc(e,a))}if(1===n)throw n=Dl,uc(e,0),ic(e,t),nc(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yc(e,Ul,ql),nc(e,Ye()),null}function lc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Bl=Ye()+500,Ur&&qr())}}function cc(e){null!==Gl&&0===Gl.tag&&0===(6&Cl)&&wc();var t=Cl;Cl|=1;var n=Sl.transition,a=bt;try{if(Sl.transition=null,bt=1,e)return e()}finally{bt=a,Sl.transition=n,0===(6&(Cl=t))&&qr()}}function dc(){Tl=Ol.current,_r(Ol)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==El)for(n=El.return;null!==n;){var a=n;switch(ts(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Pr();break;case 3:Qs(),_r(Er),_r(zr),ni();break;case 5:Xs(a);break;case 4:Qs();break;case 13:case 19:_r(Zs);break;case 10:Cs(a.type._context);break;case 22:case 23:dc()}n=n.return}if(zl=e,El=e=Oc(e.current,null),Al=Tl=t,Pl=0,Dl=null,Ll=Il=Rl=0,Ul=Ml=null,null!==Ts){for(t=0;t<Ts.length;t++)if(null!==(a=(n=Ts[t]).interleaved)){n.interleaved=null;var r=a.next,s=n.pending;if(null!==s){var i=s.next;s.next=r,a.next=i}n.pending=a}Ts=null}return e}function hc(e,t){for(;;){var n=El;try{if(Ss(),ai.current=Yi,ci){for(var a=ii.memoizedState;null!==a;){var r=a.queue;null!==r&&(r.pending=null),a=a.next}ci=!1}if(si=0,li=oi=ii=null,di=!1,ui=0,_l.current=null,null===n||null===n.return){Pl=1,Dl=t,El=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,xo(m,o,l,0,t),1&m.mode&&fo(i,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fo(i,d,t),mc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var x=go(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xo(x,o,l,0,t),ms(lo(c,l));break e}}i=c=lo(c,l),4!==Pl&&(Pl=2),null===Ml?Ml=[i]:Ml.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Bs(i,po(0,c,t));break e;case 1:l=c;var v=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Bs(i,mo(i,l,t));break e}}i=i.return}while(null!==i)}bc(n)}catch(y){t=y,El===n&&null!==n&&(El=n=n.return);continue}break}}function pc(){var e=kl.current;return kl.current=Yi,null===e?Yi:e}function mc(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===zl||0===(268435455&Rl)&&0===(268435455&Il)||ic(zl,Al)}function fc(e,t){var n=Cl;Cl|=2;var a=pc();for(zl===e&&Al===t||(ql=null,uc(e,t));;)try{gc();break}catch(r){hc(e,r)}if(Ss(),Cl=n,kl.current=a,null!==El)throw Error(s(261));return zl=null,Al=0,Pl}function gc(){for(;null!==El;)vc(El)}function xc(){for(;null!==El&&!$e();)vc(El)}function vc(e){var t=jl(e.alternate,e,Tl);e.memoizedProps=e.pendingProps,null===t?bc(e):El=t,_l.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Tl)))return void(El=n)}else{if(null!==(n=Go(n,t)))return n.flags&=32767,void(El=n);if(null===e)return Pl=6,void(El=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(El=t);El=t=e}while(null!==t);0===Pl&&(Pl=5)}function yc(e,t,n){var a=bt,r=Sl.transition;try{Sl.transition=null,bt=1,function(e,t,n,a){do{wc()}while(null!==Gl);if(0!==(6&Cl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-it(n),s=1<<r;t[r]=0,a[r]=-1,e[r]=-1,n&=~s}}(e,i),e===zl&&(El=zl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,zc(tt,function(){return wc(),null})),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Sl.transition,Sl.transition=null;var o=bt;bt=1;var l=Cl;Cl|=4,_l.current=null,function(e,t){if(er=Vt,pa(e=ha())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==r&&3!==h.nodeType||(l=o+r),h!==i||0!==a&&3!==h.nodeType||(c=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===r&&(l=o),p===i&&++u===a&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Vt=!1,Yo=t;null!==Yo;)if(e=(t=Yo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Yo=e;else for(;null!==Yo;){t=Yo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,x=f.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),x);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(s(163))}}catch(w){Nc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Yo=e;break}Yo=t.return}f=el,el=!1}(e,n),fl(n,e),ma(tr),Vt=!!er,tr=er=null,e.current=n,xl(n,e,r),Qe(),Cl=l,bt=o,Sl.transition=i}else e.current=n;if(Kl&&(Kl=!1,Gl=e,Jl=r),i=e.pendingLanes,0===i&&(Wl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,Ye()),null!==t)for(a=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],a(r.value,{componentStack:r.stack,digest:r.digest});if(Hl)throw Hl=!1,e=Vl,Vl=null,e;0!==(1&Jl)&&0!==e.tag&&wc(),i=e.pendingLanes,0!==(1&i)?e===Ql?$l++:($l=0,Ql=e):$l=0,qr()}(e,t,n,a)}finally{Sl.transition=r,bt=a}return null}function wc(){if(null!==Gl){var e=yt(Jl),t=Sl.transition,n=bt;try{if(Sl.transition=null,bt=16>e?16:e,null===Gl)var a=!1;else{if(e=Gl,Gl=null,Jl=0,0!==(6&Cl))throw Error(s(331));var r=Cl;for(Cl|=4,Yo=e.current;null!==Yo;){var i=Yo,o=i.child;if(0!==(16&Yo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Yo=d;null!==Yo;){var u=Yo;switch(u.tag){case 0:case 11:case 15:tl(8,u,i)}var h=u.child;if(null!==h)h.return=u,Yo=h;else for(;null!==Yo;){var p=(u=Yo).sibling,m=u.return;if(rl(u),u===d){Yo=null;break}if(null!==p){p.return=m,Yo=p;break}Yo=m}}}var f=i.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Yo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Yo=o;else e:for(;null!==Yo;){if(0!==(2048&(i=Yo).flags))switch(i.tag){case 0:case 11:case 15:tl(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,Yo=v;break e}Yo=i.return}}var b=e.current;for(Yo=b;null!==Yo;){var y=(o=Yo).child;if(0!==(2064&o.subtreeFlags)&&null!==y)y.return=o,Yo=y;else e:for(o=b;null!==Yo;){if(0!==(2048&(l=Yo).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(j){Nc(l,l.return,j)}if(l===o){Yo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Yo=w;break e}Yo=l.return}}if(Cl=r,qr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(j){}a=!0}return a}finally{bt=n,Sl.transition=t}}return!1}function jc(e,t,n){e=Us(e,t=po(0,t=lo(n,t),1),1),t=Zl(),null!==e&&(xt(e,1,t),nc(e,t))}function Nc(e,t,n){if(3===e.tag)jc(e,e,n);else for(;null!==t;){if(3===t.tag){jc(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Wl||!Wl.has(a))){t=Us(t,e=mo(t,e=lo(n,e),1),1),e=Zl(),null!==t&&(xt(t,1,e),nc(t,e));break}}t=t.return}}function kc(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),t=Zl(),e.pingedLanes|=e.suspendedLanes&n,zl===e&&(Al&n)===n&&(4===Pl||3===Pl&&(130023424&Al)===Al&&500>Ye()-Fl?uc(e,0):Ll|=n),nc(e,t)}function _c(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=Zl();null!==(e=Ds(e,t))&&(xt(e,t,n),nc(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),_c(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(s(314))}null!==a&&a.delete(t),_c(e,n)}function zc(e,t){return Ge(e,t)}function Ec(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,a){return new Ec(e,t,n,a)}function Tc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,a,r,i){var o=2;if(a=e,"function"===typeof e)Tc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Dc(n.children,r,i,t);case k:o=8,r|=8;break;case _:return(e=Ac(12,n,t,2|r)).elementType=_,e.lanes=i,e;case E:return(e=Ac(13,n,t,r)).elementType=E,e.lanes=i,e;case A:return(e=Ac(19,n,t,r)).elementType=A,e.lanes=i,e;case P:return Rc(n,r,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case C:o=9;break e;case z:o=11;break e;case T:o=14;break e;case O:o=16,a=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ac(o,n,t,r)).elementType=e,t.type=a,t.lanes=i,t}function Dc(e,t,n,a){return(e=Ac(7,e,a,t)).lanes=n,e}function Rc(e,t,n,a){return(e=Ac(22,e,a,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Ic(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mc(e,t,n,a,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=a,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,a,r,s,i,o,l){return e=new Mc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ac(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Is(s),e}function Fc(e){if(!e)return Cr;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Or(n))return Rr(e,n,t)}return t}function Bc(e,t,n,a,r,s,i,o,l){return(e=Uc(n,a,!0,e,0,s,0,o,l)).context=Fc(null),n=e.current,(s=Ms(a=Zl(),r=ec(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,r),e.current.lanes=r,xt(e,r,a),nc(e,a),e}function qc(e,t,n,a){var r=t.current,s=Zl(),i=ec(r);return n=Fc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ms(s,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=Us(r,t,i))&&(tc(e,r,i,s),Fs(e,r,i)),i}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}jl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Er.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Eo(t),ps();break;case 5:Ys(t);break;case 1:Or(t.type)&&Ir(t);break;case 4:$s(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,r=t.memoizedProps.value;Sr(js,a._currentValue),a._currentValue=r;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Sr(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Io(e,t,n):(Sr(Zs,1&Zs.current),null!==(e=Ho(e,t,n))?e.sibling:null);Sr(Zs,1&Zs.current);break;case 19:if(a=0!==(n&t.childLanes),0!==(128&e.flags)){if(a)return Bo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Sr(Zs,Zs.current),a)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,n)}return Ho(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,rs&&0!==(1048576&t.flags)&&Zr(t,Kr,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;qo(e,t),e=t.pendingProps;var r=Tr(t,zr.current);Es(t,n),r=fi(null,t,a,e,r,n);var i=gi();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Or(a)?(i=!0,Ir(t)):i=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Is(t),r.updater=ao,t.stateNode=r,r._reactInternals=t,oo(t,a,e,n),t=zo(null,t,a,!0,i,n)):(t.tag=0,rs&&i&&es(t),yo(null,t,r,n),t=t.child),t;case 16:a=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,a=(r=a._init)(a._payload),t.type=a,r=t.tag=function(e){if("function"===typeof e)return Tc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===z)return 11;if(e===T)return 14}return 2}(a),e=to(a,e),r){case 0:t=So(null,t,a,e,n);break e;case 1:t=Co(null,t,a,e,n);break e;case 11:t=wo(null,t,a,e,n);break e;case 14:t=jo(null,t,a,to(a.type,e),n);break e}throw Error(s(306,a,""))}return t;case 0:return a=t.type,r=t.pendingProps,So(e,t,a,r=t.elementType===a?r:to(a,r),n);case 1:return a=t.type,r=t.pendingProps,Co(e,t,a,r=t.elementType===a?r:to(a,r),n);case 3:e:{if(Eo(t),null===e)throw Error(s(387));a=t.pendingProps,r=(i=t.memoizedState).element,Ls(e,t),qs(t,a,null,n);var o=t.memoizedState;if(a=o.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ao(e,t,a,n,r=lo(Error(s(423)),t));break e}if(a!==r){t=Ao(e,t,a,n,r=lo(Error(s(424)),t));break e}for(as=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=ws(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),a===r){t=Ho(e,t,n);break e}yo(e,t,a,n)}t=t.child}return t;case 5:return Ys(t),null===e&&cs(t),a=t.type,r=t.pendingProps,i=null!==e?e.memoizedProps:null,o=r.children,nr(a,r)?o=null:null!==i&&nr(a,i)&&(t.flags|=32),_o(e,t),yo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Io(e,t,n);case 4:return $s(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=ys(t,null,a,n):yo(e,t,a,n),t.child;case 11:return a=t.type,r=t.pendingProps,wo(e,t,a,r=t.elementType===a?r:to(a,r),n);case 7:return yo(e,t,t.pendingProps,n),t.child;case 8:case 12:return yo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(a=t.type._context,r=t.pendingProps,i=t.memoizedProps,o=r.value,Sr(js,a._currentValue),a._currentValue=o,null!==i)if(oa(i.value,o)){if(i.children===r.children&&!Er.current){t=Ho(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===a){if(1===i.tag){(c=Ms(-1,n&-n)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),zs(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),zs(o,n,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}yo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,a=t.pendingProps.children,Es(t,n),a=a(r=As(r)),t.flags|=1,yo(e,t,a,n),t.child;case 14:return r=to(a=t.type,t.pendingProps),jo(e,t,a,r=to(a.type,r),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:to(a,r),qo(e,t),t.tag=1,Or(a)?(e=!0,Ir(t)):e=!1,Es(t,n),so(t,a,r),oo(t,a,r,n),zo(null,t,a,!0,e,n);case 19:return Bo(e,t,n);case 22:return ko(e,t,n)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yc(){}function Xc(e,t,n,a,r){var s=n._reactRootContainer;if(s){var i=s;if("function"===typeof r){var o=r;r=function(){var e=Hc(i);o.call(e)}}qc(t,i,e,r)}else i=function(e,t,n,a,r){if(r){if("function"===typeof a){var s=a;a=function(){var e=Hc(i);s.call(e)}}var i=Bc(t,a,e,0,null,!1,0,"",Yc);return e._reactRootContainer=i,e[mr]=i.current,qa(8===e.nodeType?e.parentNode:e),cc(),i}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof a){var o=a;a=function(){var e=Hc(l);o.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Yc);return e._reactRootContainer=l,e[mr]=l.current,qa(8===e.nodeType?e.parentNode:e),cc(function(){qc(t,l,n,a)}),l}(n,t,e,r,a);return Hc(i)}Jc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));qc(e,t,null,null)},Jc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc(function(){qc(null,e,null,null)}),t[mr]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(vt(t,1|n),nc(t,Ye()),0===(6&Cl)&&(Bl=Ye()+500,qr()))}break;case 13:cc(function(){var t=Ds(e,1);if(null!==t){var n=Zl();tc(t,e,1,n)}}),Wc(e,1)}},jt=function(e){if(13===e.tag){var t=Ds(e,134217728);if(null!==t)tc(t,e,134217728,Zl());Wc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=ec(e),n=Ds(e,t);if(null!==n)tc(n,e,t,Zl());Wc(e,t)}},kt=function(){return bt},_t=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},je=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=wr(a);if(!r)throw Error(s(90));G(a),X(a,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},ze=lc,Ee=cc;var Zc={usingClientEntryPoint:!1,Events:[br,yr,wr,Se,Ce,lc]},ed={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},td={bundleType:ed.bundleType,version:ed.version,rendererPackageName:ed.rendererPackageName,rendererConfig:ed.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:ed.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{rt=nd.inject(td),st=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(s(200));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(s(299));var n=!1,a="",r=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,a,r),e[mr]=t.current,qa(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(s(200));return Xc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(s(405));var a=null!=n&&n.hydratedSources||null,r=!1,i="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,r,0,i,o),e[mr]=t.current,qa(e),a)for(e=0;e<a.length;e++)r=(r=(n=a[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Jc(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(s(200));return Xc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(s(40));return!!e._reactRootContainer&&(cc(function(){Xc(null,null,e,!1,function(){e._reactRootContainer=null,e[mr]=null})}),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!Qc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Xc(e,t,n,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},391(e,t,n){var a=n(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},950(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153(e,t,n){var a=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,s={},c=null,d=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,a)&&!l.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===s[a]&&(s[a]=t[a]);return{$$typeof:r,type:e,key:c,ref:d,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202(e,t){var n=Symbol.for("react.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=x.prototype;var y=b.prototype=new v;y.constructor=b,f(y,x.prototype),y.isPureReactComponent=!0;var w=Array.isArray,j=Object.prototype.hasOwnProperty,N={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,a){var r,s={},i=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)j.call(t,r)&&!k.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=a;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:i,ref:o,props:s,_owner:N.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function z(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function E(e,t,r,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case a:l=!0}}if(l)return i=i(l=e),e=""===s?"."+z(l,0):s,w(i)?(r="",null!=e&&(r=e.replace(C,"$&/")+"/"),E(i,t,r,"",function(e){return e})):null!=i&&(S(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+e)),t.push(i)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var d=s+z(o=e[c],c);l+=E(o,t,r,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=E(o=o.value,t,r,d=s+z(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var a=[],r=0;return E(e,a,"","",function(e){return t.call(n,e,r++)}),a}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},P={transition:null},D={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:P,ReactCurrentOwner:N};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=r,t.Profiler=i,t.PureComponent=b,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=R,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),s=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=N.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)j.call(t,c)&&!k.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=a;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:i,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.3.1"},43(e,t,n){e.exports=n(202)},579(e,t,n){e.exports=n(153)},234(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,r=e[a];if(!(0<s(r,t)))break e;e[a]=t,e[n]=r,n=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,r=e.length,i=r>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,n))c<r&&0>s(d,l)?(e[a]=d,e[c]=n,a=c):(e[a]=l,e[o]=n,a=o);else{if(!(c<r&&0>s(d,n)))break e;e[a]=d,e[c]=n,a=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=a(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,n(c,t)}t=a(d)}}function w(e){if(g=!1,y(e),!f)if(null!==a(c))f=!0,P(j);else{var t=a(d);null!==t&&D(w,t.startTime-e)}}function j(e,n){f=!1,g&&(g=!1,v(S),S=-1),m=!0;var s=p;try{for(y(n),h=a(c);null!==h&&(!(h.expirationTime>n)||e&&!E());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var o=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===a(c)&&r(c),y(n)}else r(c);h=a(c)}if(null!==h)var l=!0;else{var u=a(d);null!==u&&D(w,u.startTime-n),l=!1}return l}finally{h=null,p=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,k=!1,_=null,S=-1,C=5,z=-1;function E(){return!(t.unstable_now()-z<C)}function A(){if(null!==_){var e=t.unstable_now();z=e;var n=!0;try{n=_(!0,e)}finally{n?N():(k=!1,_=null)}}else k=!1}if("function"===typeof b)N=function(){b(A)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,O=T.port2;T.port1.onmessage=A,N=function(){O.postMessage(null)}}else N=function(){x(A,0)};function P(e){_=e,k||(k=!0,N())}function D(e,n){S=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,P(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,n(d,e),null===a(c)&&e===a(d)&&(g?(v(S),S=-1):g=!0,D(w,s-i))):(e.sortIndex=o,n(c,e),f||m||(f=!0,P(j))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},853(e,t,n){e.exports=n(234)}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.m=e,n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,a)=>(n.f[a](e,t),t),[])),n.u=e=>"static/js/"+e+".f475f9b0.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="keyprime-sales:";n.l=(a,r,s,i)=>{if(e[a])e[a].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=a),e[a]=[r];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var r=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.p="/",(()=>{var e={792:0};n.f.j=(t,a)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var s=new Promise((n,a)=>r=e[t]=[n,a]);a.push(r[2]=s);var i=n.p+n.u(t),o=new Error;n.l(i,a=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,r[1](o)}},"chunk-"+t,t)}};var t=(t,a)=>{var r,s,[i,o,l]=a,c=0;if(i.some(t=>0!==e[t])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(a);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},a=self.webpackChunkkeyprime_sales=self.webpackChunkkeyprime_sales||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=n(43),r=n(391);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function i(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function o(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}function h(e,t,n,a){return new(n||(n=Promise))(function(r,s){function i(e){try{l(a.next(e))}catch(t){s(t)}}function o(e){try{l(a.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;class p extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class m extends p{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class f extends p{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class g extends p{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var x;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(x||(x={}));class v{constructor(e){let{headers:t={},customFetch:n,region:a=x.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(n)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return h(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var a;let r,s;try{const{headers:i,method:o,body:l,signal:c,timeout:d}=n;let u={},{region:h}=n;h||(h=t.region);const p=new URL("".concat(t.url,"/").concat(e));let x;h&&"any"!==h&&(u["x-region"]=h,p.searchParams.set("forceFunctionRegion",h)),l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",x=l):"string"===typeof l?(u["Content-Type"]="text/plain",x=l):"undefined"!==typeof FormData&&l instanceof FormData?x=l:(u["Content-Type"]="application/json",x=JSON.stringify(l)):x=!l||"string"===typeof l||"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer||"undefined"!==typeof FormData&&l instanceof FormData?l:JSON.stringify(l);let v=c;d&&(s=new AbortController,r=setTimeout(()=>s.abort(),d),c?(v=s.signal,c.addEventListener("abort",()=>s.abort())):v=s.signal);const b=yield t.fetch(p.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),t.headers),i),body:x,signal:v}).catch(e=>{throw new m(e)}),y=b.headers.get("x-relay-error");if(y&&"true"===y)throw new f(b);if(!b.ok)throw new g(b);let w,j=(null!==(a=b.headers.get("Content-Type"))&&void 0!==a?a:"text/plain").split(";")[0].trim();return w="application/json"===j?yield b.json():"application/octet-stream"===j||"application/pdf"===j?yield b.blob():"text/event-stream"===j?b:"multipart/form-data"===j?yield b.formData():yield b.text(),{data:w,error:null,response:b}}catch(i){return{data:null,error:i,response:i instanceof g||i instanceof f?i.context:void 0}}finally{r&&clearTimeout(r)}}()})}}var b=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},y=class{constructor(e){var t,n,a;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(n=e.isMaybeSingle)&&void 0!==n&&n,this.urlLengthLimit=null!==(a=e.urlLengthLimit)&&void 0!==a?a:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var n=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let a=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,a=null,r=null,s=e.status,i=e.statusText;if(e.ok){var o,l;if("HEAD"!==n.method){var c;const t=await e.text();""===t||(a="text/csv"===n.headers.get("Accept")||n.headers.get("Accept")&&(null===(c=n.headers.get("Accept"))||void 0===c?void 0:c.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const d=null===(o=n.headers.get("Prefer"))||void 0===o?void 0:o.match(/count=(exact|planned|estimated)/),u=null===(l=e.headers.get("content-range"))||void 0===l?void 0:l.split("/");d&&u&&u.length>1&&(r=parseInt(u[1])),n.isMaybeSingle&&"GET"===n.method&&Array.isArray(a)&&(a.length>1?(t={code:"PGRST116",details:"Results contain ".concat(a.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,r=null,s=406,i="Not Acceptable"):a=1===a.length?a[0]:null)}else{var d;const r=await e.text();try{t=JSON.parse(r),Array.isArray(t)&&404===e.status&&(a=[],t=null,s=200,i="OK")}catch(u){404===e.status&&""===r?(s=204,i="No Content"):t={message:r}}if(t&&n.isMaybeSingle&&(null===t||void 0===t||null===(d=t.details)||void 0===d?void 0:d.includes("0 rows"))&&(t=null,s=200,i="OK"),t&&n.shouldThrowOnError)throw new b(t)}return{error:t,data:a,count:r,status:s,statusText:i}});return this.shouldThrowOnError||(a=a.catch(e=>{var t;let n="",a="",r="";const s=null===e||void 0===e?void 0:e.cause;if(s){var i,o,l,c;const t=null!==(i=null===s||void 0===s?void 0:s.message)&&void 0!==i?i:"",a=null!==(o=null===s||void 0===s?void 0:s.code)&&void 0!==o?o:"";n="".concat(null!==(l=null===e||void 0===e?void 0:e.name)&&void 0!==l?l:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),n+="\n\nCaused by: ".concat(null!==(c=null===s||void 0===s?void 0:s.name)&&void 0!==c?c:"Error",": ").concat(t),a&&(n+=" (".concat(a,")")),(null===s||void 0===s?void 0:s.stack)&&(n+="\n".concat(s.stack))}else{var d;n=null!==(d=null===e||void 0===e?void 0:e.stack)&&void 0!==d?d:""}const u=this.url.toString().length;return"AbortError"===(null===e||void 0===e?void 0:e.name)||"ABORT_ERR"===(null===e||void 0===e?void 0:e.code)?(r="",a="Request was aborted (timeout or manual cancellation)",u>this.urlLengthLimit&&(a+=". Note: Your request URL is ".concat(u," characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side."))):"HeadersOverflowError"!==(null===s||void 0===s?void 0:s.name)&&"UND_ERR_HEADERS_OVERFLOW"!==(null===s||void 0===s?void 0:s.code)||(r="",a="HTTP headers exceeded server limits (typically 16KB)",u>this.urlLengthLimit&&(a+=". Your request URL is ".concat(u," characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead."))),{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:n,hint:a,code:r},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},w=class extends y{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:a,referencedTable:r=a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=r?"".concat(r,".order"):"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===n?"":n?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(a,"".concat(e)),this}range(e,t){let{foreignTable:n,referencedTable:a=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r="undefined"===typeof a?"offset":"".concat(a,".offset"),s="undefined"===typeof a?"limit":"".concat(a,".limit");return this.url.searchParams.set(r,"".concat(e)),this.url.searchParams.set(s,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:a=!1,wal:r=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const o=[e?"analyze":null,t?"verbose":null,n?"settings":null,a?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(s,'; for="').concat(l,'"; options=').concat(o,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}};const j=new RegExp("[,()]");var N=class extends w{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}regexMatch(e,t){return this.url.searchParams.append(e,"match.".concat(t)),this}regexIMatch(e,t){return this.url.searchParams.append(e,"imatch.".concat(t)),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}isDistinct(e,t){return this.url.searchParams.append(e,"isdistinct.".concat(t)),this}in(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&j.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(n,")")),this}notIn(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&j.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"not.in.(".concat(n,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:n,type:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="";"plain"===a?r="pl":"phrase"===a?r="ph":"websearch"===a&&(r="w");const s=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append(e,"".concat(r,"fts").concat(s,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,n]=e;this.url.searchParams.append(t,"eq.".concat(n))}),this}not(e,t,n){return this.url.searchParams.append(e,"not.".concat(t,".").concat(n)),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=n?"".concat(n,".or"):"or";return this.url.searchParams.append(a,"(".concat(e,")")),this}filter(e,t,n){return this.url.searchParams.append(e,"".concat(t,".").concat(n)),this}},k=class{constructor(e,t){let{headers:n={},schema:a,fetch:r,urlLengthLimit:s=8e3}=t;this.url=e,this.headers=new Headers(n),this.schema=a,this.fetch=r,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:n=!1,count:a}=null!==t&&void 0!==t?t:{},r=n?"HEAD":"GET";let s=!1;const i=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",i),a&&l.append("Prefer","count=".concat(a)),new N({method:r,url:o,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a;const{url:r,headers:s}=this.cloneRequestState();if(t&&s.append("Prefer","count=".concat(t)),n||s.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));r.searchParams.set("columns",e.join(","))}}return new N({method:"POST",url:r,headers:s,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:a,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;const{url:i,headers:o}=this.cloneRequestState();if(o.append("Prefer","resolution=".concat(n?"ignore":"merge","-duplicates")),void 0!==t&&i.searchParams.set("on_conflict",t),a&&o.append("Prefer","count=".concat(a)),r||o.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));i.searchParams.set("columns",e.join(","))}}return new N({method:"POST",url:i,headers:o,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch,urlLengthLimit:this.urlLengthLimit})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const{url:a,headers:r}=this.cloneRequestState();return t&&r.append("Prefer","count=".concat(t)),new N({method:"PATCH",url:a,headers:r,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch,urlLengthLimit:this.urlLengthLimit})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const{url:n,headers:a}=this.cloneRequestState();return e&&a.append("Prefer","count=".concat(e)),new N({method:"DELETE",url:n,headers:a,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=_(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}function C(e,t,n){return(t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach(function(t){C(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var A=class e{constructor(e){let{headers:t={},schema:n,fetch:a,timeout:r,urlLengthLimit:s=8e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=n,this.urlLengthLimit=s;const i=null!==a&&void 0!==a?a:globalThis.fetch;this.fetch=void 0!==r&&r>0?(e,t)=>{const n=new AbortController,a=setTimeout(()=>n.abort(),r),s=null===t||void 0===t?void 0:t.signal;if(s){if(s.aborted)return clearTimeout(a),i(e,t);const r=()=>{clearTimeout(a),n.abort()};return s.addEventListener("abort",r,{once:!0}),i(e,E(E({},t),{},{signal:n.signal})).finally(()=>{clearTimeout(a),s.removeEventListener("abort",r)})}return i(e,E(E({},t),{},{signal:n.signal})).finally(()=>clearTimeout(a))}:i}from(e){if(!e||"string"!==typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new k(new URL("".concat(this.url,"/").concat(e)),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,get:a=!1,count:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var s;let i;const o=new URL("".concat(this.url,"/rpc/").concat(e));let l;const c=e=>null!==e&&"object"===typeof e&&(!Array.isArray(e)||e.some(c)),d=n&&Object.values(t).some(c);d?(i="POST",l=t):n||a?(i=n?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,n]=e;return void 0!==n}).map(e=>{let[t,n]=e;return[t,Array.isArray(n)?"{".concat(n.join(","),"}"):"".concat(n)]}).forEach(e=>{let[t,n]=e;o.searchParams.append(t,n)})):(i="POST",l=t);const u=new Headers(this.headers);return d?u.set("Prefer",r?"count=".concat(r,",return=minimal"):"return=minimal"):r&&u.set("Prefer","count=".concat(r)),new N({method:i,url:o,headers:u,schema:this.schemaName,body:l,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch,urlLengthLimit:this.urlLengthLimit})}};const T=class{constructor(){}static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof n.g&&"undefined"!==typeof n.g.WebSocket)return{type:"native",constructor:n.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node){const t=e.node,n=parseInt(t.replace(/^v/,"").split(".")[0]);return n>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(n," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(n," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}};const O="realtime-js/".concat("2.98.0"),P="2.0.0",D=P,R=1e4;var I,L,M,U,F,B;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(I||(I={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(L||(L={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(M||(M={})),function(e){e.websocket="websocket"}(U||(U={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(F||(F={}));class q{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!==e&&void 0!==e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"===typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const a=null!==(n=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==n?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,n;const a=null!==(n=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==n?n:{},r=(new TextEncoder).encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,r)}_encodeUserBroadcastPush(e,t,n){var a,r;const s=e.topic,i=null!==(a=e.ref)&&void 0!==a?a:"",o=null!==(r=e.join_ref)&&void 0!==r?r:"",l=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},d=0===Object.keys(c).length?"":JSON.stringify(c);if(o.length>255)throw new Error("joinRef length ".concat(o.length," exceeds maximum of 255"));if(i.length>255)throw new Error("ref length ".concat(i.length," exceeds maximum of 255"));if(s.length>255)throw new Error("topic length ".concat(s.length," exceeds maximum of 255"));if(l.length>255)throw new Error("userEvent length ".concat(l.length," exceeds maximum of 255"));if(d.length>255)throw new Error("metadata length ".concat(d.length," exceeds maximum of 255"));const u=this.USER_BROADCAST_PUSH_META_LENGTH+o.length+i.length+s.length+l.length+d.length,h=new ArrayBuffer(this.HEADER_LENGTH+u);let p=new DataView(h),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,o.length),p.setUint8(m++,i.length),p.setUint8(m++,s.length),p.setUint8(m++,l.length),p.setUint8(m++,d.length),p.setUint8(m++,t),Array.from(o,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(i,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(s,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(l,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(d,e=>p.setUint8(m++,e.charCodeAt(0)));var f=new Uint8Array(h.byteLength+n.byteLength);return f.set(new Uint8Array(h),0),f.set(new Uint8Array(n),h.byteLength),f.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"===typeof e){const n=JSON.parse(e),[a,r,s,i,o]=n;return t({join_ref:a,ref:r,topic:s,event:i,payload:o})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),a=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,a)}_decodeUserBroadcast(e,t,n){const a=t.getUint8(1),r=t.getUint8(2),s=t.getUint8(3),i=t.getUint8(4);let o=this.HEADER_LENGTH+4;const l=n.decode(e.slice(o,o+a));o+=a;const c=n.decode(e.slice(o,o+r));o+=r;const d=n.decode(e.slice(o,o+s));o+=s;const u=e.slice(o,e.byteLength),h=i===this.JSON_ENCODING?JSON.parse(n.decode(u)):u,p={type:this.BROADCAST_EVENT,event:c,payload:h};return s>0&&(p.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"===typeof e?Object.fromEntries(Object.entries(e).filter(e=>{let[n]=e;return t.includes(n)})):{}}}class H{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(B||(B={}));const V=function(e,t){var n;const a=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return t?Object.keys(t).reduce((n,r)=>(n[r]=W(r,e,t,a),n),{}):{}},W=(e,t,n,a)=>{const r=t.find(t=>t.name===e),s=null===r||void 0===r?void 0:r.type,i=n[e];return s&&!a.includes(s)?K(s,i):G(i)},K=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return Y(t,n)}switch(e){case B.bool:return J(t);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return $(t);case B.json:case B.jsonb:return Q(t);case B.timestamp:return X(t);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:default:return G(t)}},G=e=>e,J=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},$=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Q=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Y=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,a=e[n];if("{"===e[0]&&"}"===a){let a;const s=e.slice(1,n);try{a=JSON.parse("["+s+"]")}catch(r){a=s?s.split(","):[]}return a.map(e=>K(t,e))}return e},X=e=>"string"===typeof e?e.replace(" ","T"):e,Z=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class ee{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R;this.channel=e,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var te,ne,ae,re;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(te||(te={}));class se{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},e=>{const{onJoin:t,onLeave:n,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=se.syncState(this.state,e,t,n),this.pendingDiffs.forEach(e=>{this.state=se.syncDiff(this.state,e,t,n)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},e=>{const{onJoin:t,onLeave:n,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=se.syncDiff(this.state,e,t,n),a())}),this.onJoin((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})}),this.onLeave((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,a){const r=this.cloneDeep(e),s=this.transformState(t),i={},o={};return this.map(r,(e,t)=>{s[e]||(o[e]=t)}),this.map(s,(e,t)=>{const n=r[e];if(n){const a=t.map(e=>e.presence_ref),r=n.map(e=>e.presence_ref),s=t.filter(e=>r.indexOf(e.presence_ref)<0),l=n.filter(e=>a.indexOf(e.presence_ref)<0);s.length>0&&(i[e]=s),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(r,{joins:i,leaves:o},n,a)}static syncDiff(e,t,n,a){const{joins:r,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(r,(t,a)=>{var r;const s=null!==(r=e[t])&&void 0!==r?r:[];if(e[t]=this.cloneDeep(a),s.length>0){const n=e[t].map(e=>e.presence_ref),a=s.filter(e=>n.indexOf(e.presence_ref)<0);e[t].unshift(...a)}n(t,s,a)}),this.map(s,(t,n)=>{let r=e[t];if(!r)return;const s=n.map(e=>e.presence_ref);r=r.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=r,a(t,r,n),0===r.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const a=e[n];return t[n]="metas"in a?a.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(ne||(ne={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(ae||(ae={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(re||(re={}));class ie{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;var a,r;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=L.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ee(this,M.join,this.params,this.timeout),this.rejoinTimer=new H(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=L.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=L.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=L.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=L.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=L.errored,this.rejoinTimer.scheduleTimeout())}),this._on(M.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new se(this),this.broadcastEndpointURL=Z(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(r=null===(a=this.params.config)||void 0===a?void 0:a.broadcast)||void 0===r?void 0:r.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,a,r;if(this.socket.isConnected()||this.socket.connect(),this.state==L.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params,l=null!==(a=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map(e=>e.filter))&&void 0!==a?a:[],c=!!this.bindings[ae.PRESENCE]&&this.bindings[ae.PRESENCE].length>0||!0===(null===(r=this.params.config.presence)||void 0===r?void 0:r.enabled),d={},u={broadcast:s,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(re.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(re.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:n}=t;var a;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,r=null!==(a=null===t||void 0===t?void 0:t.length)&&void 0!==a?a:0,s=[];for(let a=0;a<r;a++){const r=t[a],{filter:{event:i,schema:o,table:l,filter:c}}=r,d=n&&n[a];if(!(d&&d.event===i&&ie.isFilterValueEqual(d.schema,o)&&ie.isFilterValueEqual(d.table,l)&&ie.isFilterValueEqual(d.filter,c)))return this.unsubscribe(),this.state=L.errored,void(null===e||void 0===e||e(re.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},r),{id:d.id}))}return this.bindings.postgres_changes=s,void(e&&e(re.SUBSCRIBED))}null===e||void 0===e||e(re.SUBSCRIBED)}).receive("error",t=>{this.state=L.errored,null===e||void 0===e||e(re.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(re.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===L.joined&&e===ae.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var a;if(void 0===t||null===t)return Promise.reject("Payload is required for httpSend()");const r={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(r.Authorization="Bearer ".concat(this.socket.accessTokenValue));const s={method:"POST",headers:r,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},i=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(a=n.timeout)&&void 0!==a?a:this.timeout);if(202===i.status)return{success:!0};let o=i.statusText;try{const e=await i.json();o=e.error||e.message||o}catch(l){}return Promise.reject(new Error(o))}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,a;if(this._canPush()||"broadcast"!==e.type)return new Promise(n=>{var a,r,s;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(r=null===(a=this.params)||void 0===a?void 0:a.config)||void 0===r?void 0:r.broadcast)||void 0===s?void 0:s.ack)||n("ok"),i.receive("ok",()=>n("ok")),i.receive("error",()=>n("error")),i.receive("timeout",()=>n("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization="Bearer ".concat(this.socket.accessTokenValue));const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(a=e.body)||void 0===a?void 0:a.cancel()),e.ok?"ok":"error"}catch(r){return"AbortError"===r.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=L.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(M.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new ee(this,M.leave,{},e),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{null===n||void 0===n||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=L.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const a=new AbortController,r=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(r),s}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let a=new ee(this,e,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var a,r;const s=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=M;if(n&&[i,o,l,c].indexOf(s)>=0&&n!==this._joinRef())return;let d=this._onMessage(s,t,n);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(a=this.bindings.postgres_changes)||void 0===a||a.filter(e=>{var t,n,a;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(a=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===a?void 0:a.toLocaleLowerCase())===s}).map(e=>e.callback(d,n)):null===(r=this.bindings[s])||void 0===r||r.filter(e=>{var n,a,r,i,o,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,i=null===(n=e.filter)||void 0===n?void 0:n.event;return s&&(null===(a=t.ids)||void 0===a?void 0:a.includes(s))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(r=t.data)||void 0===r?void 0:r.type.toLocaleLowerCase()))}{const n=null===(o=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===n||n===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:n,commit_timestamp:a,type:r,errors:s}=e,i={schema:t,table:n,commit_timestamp:a,eventType:r,new:{},old:{},errors:s};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,n)})}_isClosed(){return this.state===L.closed}_isJoined(){return this.state===L.joined}_isJoining(){return this.state===L.joining}_isLeaving(){return this.state===L.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,n){const a=e.toLocaleLowerCase(),r={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(r):this.bindings[a]=[r],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(e=>{var a;return!((null===(a=e.type)||void 0===a?void 0:a.toLocaleLowerCase())===n&&ie.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(null!==e&&void 0!==e?e:void 0)===(null!==t&&void 0!==t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(M.close,{},e)}_onError(e){this._on(M.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=L.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=V(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=V(e.columns,e.old_record)),t}}const oe=()=>{},le=25e3,ce=10,de=100,ue=[1e3,2e3,5e3,1e4];class he{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=R,this.transport=null,this.heartbeatIntervalMs=le,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=oe,this.ref=0,this.reconnectTimer=null,this.vsn=D,this.logger=oe,this.conn=null,this.sendBuffer=[],this.serializer=new q,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},!(null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(U.websocket),this.httpEndpoint=Z(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=T.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},"function"===typeof this.conn.close&&(e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case I.connecting:return F.Connecting;case I.open:return F.Open;case I.closing:return F.Closing;default:return F.Closed}}isConnected(){return this.connectionState()===F.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const n="realtime:".concat(e),a=this.getChannels().find(e=>e.topic===n);if(a)return a;{const n=new ie("realtime:".concat(e),t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:n,payload:a,ref:r}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(n," (").concat(r,")"),a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},de)}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){const t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(o){this.log("error","error in heartbeat callback",o)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:t,event:n,payload:a,ref:r}=e,s=r?"(".concat(r,")"):"",i=a.status||"";this.log("receive","".concat(i," ").concat(t," ").concat(n," ").concat(s).trim(),a),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(n,a,r)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===I.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===I.open||this.conn.readyState===I.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL()));(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.accessTokenValue&&(this.channels.forEach(e=>{e.updateJoinPayload({access_token:this.accessTokenValue})}),this.sendBuffer=[],this.channels.forEach(e=>{e._isJoining()&&(e.joinPush.sent=!1,e.joinPush.send())})),this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(M.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return"".concat(e).concat(n).concat(a)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=!1;if(t)e=t,n=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),e=this.accessTokenValue}else e=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const n={access_token:e,version:O};e&&t.updateJoinPayload(n),t.joinedOnce&&t._isJoined()&&t._push(M.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this._isManualToken()||this.setAuth().catch(t=>{this.log("error","Error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(a){this.log("error","error in ".concat(e," callback"),a)}})}catch(n){this.log("error","error triggering ".concat(e," callbacks"),n)}}_setupReconnectionTimer(){this.reconnectTimer=new H(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ce)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,a,r,s,i,o,l,c,d,u,h;switch(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(n=null===e||void 0===e?void 0:e.timeout)&&void 0!==n?n:R,this.heartbeatIntervalMs=null!==(a=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==a?a:le,this.worker=null!==(r=null===e||void 0===e?void 0:e.worker)&&void 0!==r&&r,this.accessToken=null!==(s=null===e||void 0===e?void 0:e.accessToken)&&void 0!==s?s:null,this.heartbeatCallback=null!==(i=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==i?i:oe,this.vsn=null!==(o=null===e||void 0===e?void 0:e.vsn)&&void 0!==o?o:D,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>ue[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!==(c=null===e||void 0===e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(d=null===e||void 0===e?void 0:e.decode)&&void 0!==d?d:(e,t)=>t(JSON.parse(e));break;case P:this.encode=null!==(u=null===e||void 0===e?void 0:e.encode)&&void 0!==u?u:this.serializer.encode.bind(this.serializer),this.decode=null!==(h=null===e||void 0===e?void 0:e.decode)&&void 0!==h?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error("Unsupported serializer version: ".concat(this.vsn))}if(this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}var pe=class extends Error{constructor(e,t){var n;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===(null===(n=t.icebergType)||void 0===n?void 0:n.includes("CommitState"))}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function me(e){var t;const n=null!==(t=e.fetchImpl)&&void 0!==t?t:globalThis.fetch;return{async request(t){let{method:a,path:r,query:s,body:i,headers:o}=t;const l=function(e,t,n){const a=new URL(t,e);if(n)for(const[r,s]of Object.entries(n))void 0!==s&&a.searchParams.set(r,s);return a.toString()}(e.baseUrl,r,s),d=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:"Bearer ".concat(e.token)}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),u=await n(l,{method:a,headers:c(c(c({},i?{"Content-Type":"application/json"}:{}),d),o),body:i?JSON.stringify(i):void 0}),h=await u.text(),p=(u.headers.get("content-type")||"").includes("application/json"),m=p&&h?JSON.parse(h):h;if(!u.ok){var f;const e=p?m:void 0,t=null===e||void 0===e?void 0:e.error;throw new pe(null!==(f=null===t||void 0===t?void 0:t.message)&&void 0!==f?f:"Request failed with status ".concat(u.status),{status:u.status,icebergType:null===t||void 0===t?void 0:t.type,icebergCode:null===t||void 0===t?void 0:t.code,details:e})}return{status:u.status,headers:u.headers,data:m}}}}function fe(e){return e.join("\x1f")}var ge=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:fe(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces"),query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const n={namespace:e.namespace,properties:null===t||void 0===t?void 0:t.properties};return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces"),body:n})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(fe(e.namespace))})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(fe(e.namespace))})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(fe(e.namespace))}),!0}catch(t){if(t instanceof pe&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(n){if(n instanceof pe&&409===n.status)return;throw n}}};function xe(e){return e.join("\x1f")}var ve=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;this.client=e,this.prefix=t,this.accessDelegation=n}async listTables(e){return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(xe(e.namespace),"/tables")})).data.identifiers}async createTable(e,t){const n={};this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(xe(e.namespace),"/tables"),body:t,headers:n})).data.metadata}async updateTable(e,t){const n=await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(xe(e.namespace),"/tables/").concat(e.name),body:t});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(e,t){var n;await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(xe(e.namespace),"/tables/").concat(e.name),query:{purgeRequested:String(null!==(n=null===t||void 0===t?void 0:t.purge)&&void 0!==n&&n)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(xe(e.namespace),"/tables/").concat(e.name),headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(xe(e.namespace),"/tables/").concat(e.name),headers:t}),!0}catch(n){if(n instanceof pe&&404===n.status)return!1;throw n}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(n){if(n instanceof pe&&409===n.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw n}}},be=class{constructor(e){var t;let n="v1";e.catalogName&&(n+="/".concat(e.catalogName));const a=e.baseUrl.endsWith("/")?e.baseUrl:"".concat(e.baseUrl,"/");this.client=me({baseUrl:a,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=null===(t=e.accessDelegation)||void 0===t?void 0:t.join(","),this.namespaceOps=new ge(this.client,n),this.tableOps=new ve(this.client,n,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};var ye=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"storage",n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=a}};function we(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}var je=class extends ye{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";super(e,a,t,n),this.name="vectors"===a?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Ne=class extends ye{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"storage";super(e,n),this.name="vectors"===n?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const ke=e=>{if(Array.isArray(e))return e.map(e=>ke(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[n,a]=e;const r=n.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=ke(a)}),t};function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e){var t=function(e,t){if("object"!=_e(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=_e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_e(t)?t:t+""}function Ce(e,t,n){return(t=Se(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach(function(t){Ce(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const Ae=e=>{var t;return e.msg||e.message||e.error_description||("string"===typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},Te=(e,t,n,a)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&a?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(a)?(r.headers=Ee({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(a)):r.body=a,(null===t||void 0===t?void 0:t.duplex)&&(r.duplex=t.duplex),Ee(Ee({},r),n)):Ee(Ee({},r),n)};async function Oe(e,t,n,a,r,s,i){return new Promise((o,l)=>{e(n,Te(t,a,r,s)).then(e=>{if(!e.ok)throw e;if(null===a||void 0===a?void 0:a.noResolveJson)return e;if("vectors"===i){const t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status)return{};if(!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>o(e)).catch(e=>(async(e,t,n,a)=>{if(e&&"object"===typeof e&&"status"in e&&"ok"in e&&"number"===typeof e.status&&!(null===n||void 0===n?void 0:n.noResolveJson)){const n=e,r=n.status||500;if("function"===typeof n.json)n.json().then(e=>{const n=(null===e||void 0===e?void 0:e.statusCode)||(null===e||void 0===e?void 0:e.code)||r+"";t(new je(Ae(e),r,n,a))}).catch(()=>{if("vectors"===a){const e=r+"";t(new je(n.statusText||"HTTP ".concat(r," error"),r,e,a))}else{const e=r+"";t(new je(n.statusText||"HTTP ".concat(r," error"),r,e,a))}});else{const e=r+"";t(new je(n.statusText||"HTTP ".concat(r," error"),r,e,a))}}else t(new Ne(Ae(e),e,a))})(e,l,a,i))})}function Pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"storage";return{get:async(t,n,a,r)=>Oe(t,"GET",n,a,r,void 0,e),post:async(t,n,a,r,s)=>Oe(t,"POST",n,r,s,a,e),put:async(t,n,a,r,s)=>Oe(t,"PUT",n,r,s,a,e),head:async(t,n,a,r)=>Oe(t,"HEAD",n,Ee(Ee({},a),{},{noResolveJson:!0}),r,void 0,e),remove:async(t,n,a,r,s)=>Oe(t,"DELETE",n,r,s,a,e)}}const De=Pe("storage"),{get:Re,post:Ie,put:Le,head:Me,remove:Ue}=De,Fe=Pe("vectors");var Be=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";var r;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=(r=n)?function(){return r(...arguments)}:function(){return fetch(...arguments)},this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Ee(Ee({},this.headers),{},{[e]:t}),this}async handleOperation(e){try{return{data:await e(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(we(t))return{data:null,error:t};throw t}}},qe=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(we(e))return{data:null,error:e};throw e}}};let He;He=Symbol.toStringTag;var Ve=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[He]="BlobDownloadBuilder",this.promise=null}asStream(){return new qe(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(we(e))return{data:null,error:e};throw e}}};const We={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ke={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Ge=class extends Be{constructor(e){let t=arguments.length>2?arguments[2]:void 0;super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>3?arguments[3]:void 0,"storage"),this.bucketId=t}async uploadOrUpdate(e,t,n,a){var r=this;return r.handleOperation(async()=>{let s;const i=Ee(Ee({},Ke),a);let o=Ee(Ee({},r.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const l=i.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",r.encodeMetadata(l)),s.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",i.cacheControl),l&&!s.has("metadata")&&s.append("metadata",r.encodeMetadata(l))):(s=n,o["cache-control"]="max-age=".concat(i.cacheControl),o["content-type"]=i.contentType,l&&(o["x-metadata"]=r.toBase64(r.encodeMetadata(l))),("undefined"!==typeof ReadableStream&&s instanceof ReadableStream||s&&"object"===typeof s&&"pipe"in s&&"function"===typeof s.pipe)&&!i.duplex&&(i.duplex="half")),(null===a||void 0===a?void 0:a.headers)&&(o=Ee(Ee({},o),a.headers));const c=r._removeEmptyFolders(t),d=r._getFinalPath(c),u=await("PUT"==e?Le:Ie)(r.fetch,"".concat(r.url,"/object/").concat(d),s,Ee({headers:o},(null===i||void 0===i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{path:c,id:u.Id,fullPath:u.Key}})}async upload(e,t,n){return this.uploadOrUpdate("POST",e,t,n)}async uploadToSignedUrl(e,t,n,a){var r=this;const s=r._removeEmptyFolders(e),i=r._getFinalPath(s),o=new URL(r.url+"/object/upload/sign/".concat(i));return o.searchParams.set("token",t),r.handleOperation(async()=>{let e;const t=Ee({upsert:Ke.upsert},a),i=Ee(Ee({},r.headers),{"x-upsert":String(t.upsert)});return"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,i["cache-control"]="max-age=".concat(t.cacheControl),i["content-type"]=t.contentType),{path:s,fullPath:(await Le(r.fetch,o.toString(),e,{headers:i})).Key}})}async createSignedUploadUrl(e,t){var n=this;return n.handleOperation(async()=>{let a=n._getFinalPath(e);const r=Ee({},n.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const s=await Ie(n.fetch,"".concat(n.url,"/object/upload/sign/").concat(a),{},{headers:r}),i=new URL(n.url+s.url),o=i.searchParams.get("token");if(!o)throw new ye("No token returned by API");return{signedUrl:i.toString(),path:e,token:o}})}async update(e,t,n){return this.uploadOrUpdate("PUT",e,t,n)}async move(e,t,n){var a=this;return a.handleOperation(async()=>await Ie(a.fetch,"".concat(a.url,"/object/move"),{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:a.headers}))}async copy(e,t,n){var a=this;return a.handleOperation(async()=>({path:(await Ie(a.fetch,"".concat(a.url,"/object/copy"),{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(e,t,n){var a=this;return a.handleOperation(async()=>{let r=a._getFinalPath(e),s=await Ie(a.fetch,"".concat(a.url,"/object/sign/").concat(r),Ee({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:a.headers});const i=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return{signedUrl:encodeURI("".concat(a.url).concat(s.signedURL).concat(i))}})}async createSignedUrls(e,t,n){var a=this;return a.handleOperation(async()=>{const r=await Ie(a.fetch,"".concat(a.url,"/object/sign/").concat(a.bucketId),{expiresIn:t,paths:e},{headers:a.headers}),s=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return r.map(e=>Ee(Ee({},e),{},{signedUrl:e.signedURL?encodeURI("".concat(a.url).concat(e.signedURL).concat(s)):null}))})}download(e,t,n){const a="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),s=r?"?".concat(r):"",i=this._getFinalPath(e);return new Ve(()=>Re(this.fetch,"".concat(this.url,"/").concat(a,"/").concat(i).concat(s),{headers:this.headers,noResolveJson:!0},n),this.shouldThrowOnError)}async info(e){var t=this;const n=t._getFinalPath(e);return t.handleOperation(async()=>ke(await Re(t.fetch,"".concat(t.url,"/object/info/").concat(n),{headers:t.headers})))}async exists(e){var t=this;const n=t._getFinalPath(e);try{return await Me(t.fetch,"".concat(t.url,"/object/").concat(n),{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(we(a)&&a instanceof Ne){const e=a.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const n=this._getFinalPath(e),a=[],r=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==r&&a.push(r);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&a.push(i);let o=a.join("&");return""!==o&&(o="?".concat(o)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(s,"/public/").concat(n).concat(o))}}}async remove(e){var t=this;return t.handleOperation(async()=>await Ue(t.fetch,"".concat(t.url,"/object/").concat(t.bucketId),{prefixes:e},{headers:t.headers}))}async list(e,t,n){var a=this;return a.handleOperation(async()=>{const r=Ee(Ee(Ee({},We),t),{},{prefix:e||""});return await Ie(a.fetch,"".concat(a.url,"/object/list/").concat(a.bucketId),r,{headers:a.headers},n)})}async listV2(e,t){var n=this;return n.handleOperation(async()=>{const a=Ee({},e);return await Ie(n.fetch,"".concat(n.url,"/object/list-v2/").concat(n.bucketId),a,{headers:n.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}};const Je={"X-Client-Info":"storage-js/".concat("2.98.0")};var $e=class extends Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;const r=new URL(e);(null===a||void 0===a?void 0:a.useNewHostname)&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."));super(r.href.replace(/\/$/,""),Ee(Ee({},Je),t),n,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const n=t.listBucketOptionsToQueryString(e);return await Re(t.fetch,"".concat(t.url,"/bucket").concat(n),{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Re(t.fetch,"".concat(t.url,"/bucket/").concat(e),{headers:t.headers}))}async createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};var n=this;return n.handleOperation(async()=>await Ie(n.fetch,"".concat(n.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}))}async updateBucket(e,t){var n=this;return n.handleOperation(async()=>await Le(n.fetch,"".concat(n.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await Ie(t.fetch,"".concat(t.url,"/bucket/").concat(e,"/empty"),{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Ue(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Qe=class extends Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Ee(Ee({},Je),t),n,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Ie(t.fetch,"".concat(t.url,"/bucket"),{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const n=new URLSearchParams;void 0!==(null===e||void 0===e?void 0:e.limit)&&n.set("limit",e.limit.toString()),void 0!==(null===e||void 0===e?void 0:e.offset)&&n.set("offset",e.offset.toString()),(null===e||void 0===e?void 0:e.sortColumn)&&n.set("sortColumn",e.sortColumn),(null===e||void 0===e?void 0:e.sortOrder)&&n.set("sortOrder",e.sortOrder),(null===e||void 0===e?void 0:e.search)&&n.set("search",e.search);const a=n.toString(),r=a?"".concat(t.url,"/bucket?").concat(a):"".concat(t.url,"/bucket");return await Re(t.fetch,r,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Ue(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}from(e){var t=this;if(!(e=>!(!e||"string"!==typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new ye("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new be({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(n,{get(e,t){const n=e[t];return"function"!==typeof n?n:async function(){try{for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return{data:await n.apply(e,r),error:null}}catch(i){if(a)throw i;return{data:null,error:i}}}}})}},Ye=class extends Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Ee(Ee({},Je),{},{"Content-Type":"application/json"},t),n,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/CreateIndex"),e,{headers:t.headers})||{})}async getIndex(e,t){var n=this;return n.handleOperation(async()=>await Fe.post(n.fetch,"".concat(n.url,"/GetIndex"),{vectorBucketName:e,indexName:t},{headers:n.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/ListIndexes"),e,{headers:t.headers}))}async deleteIndex(e,t){var n=this;return n.handleOperation(async()=>await Fe.post(n.fetch,"".concat(n.url,"/DeleteIndex"),{vectorBucketName:e,indexName:t},{headers:n.headers})||{})}},Xe=class extends Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Ee(Ee({},Je),{},{"Content-Type":"application/json"},t),n,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/PutVectors"),e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/GetVectors"),e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and ".concat(e.segmentCount-1))}return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/ListVectors"),e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/QueryVectors"),e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/DeleteVectors"),e,{headers:t.headers})||{})}},Ze=class extends Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),Ee(Ee({},Je),{},{"Content-Type":"application/json"},t),n,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/CreateVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/GetVectorBucket"),{vectorBucketName:e},{headers:t.headers}))}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/ListVectorBuckets"),e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Fe.post(t.fetch,"".concat(t.url,"/DeleteVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}},et=class extends Ze{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t.headers||{},t.fetch)}from(e){return new tt(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},tt=class extends Ye{constructor(e,t,n,a){super(e,t,a),this.vectorBucketName=n}async createIndex(e){return(()=>super.createIndex)().call(this,Ee(Ee({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listIndexes)().call(this,Ee(Ee({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new nt(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},nt=class extends Xe{constructor(e,t,n,a,r){super(e,t,r),this.vectorBucketName=n,this.indexName=a}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,Ee(Ee({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,Ee(Ee({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return(()=>super.listVectors)().call(t,Ee(Ee({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,Ee(Ee({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,Ee(Ee({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},at=class extends $e{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new Ge(this.url,this.headers,e,this.fetch)}get vectors(){return new et(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Qe(this.url+"/iceberg",this.headers,this.fetch)}};const rt="2.98.0",st=3e4,it=9e4,ot={"X-Client-Info":"gotrue-js/".concat(rt)},lt="X-Supabase-Api-Version",ct={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},dt=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class ut extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function ht(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class pt extends ut{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class mt extends ut{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ft extends ut{constructor(e,t,n,a){super(e,n,a),this.name=t,this.status=n}}class gt extends ft{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function xt(e){return ht(e)&&"AuthSessionMissingError"===e.name}class vt extends ft{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bt extends ft{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class yt extends ft{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wt extends ft{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jt extends ft{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Nt extends ft{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function kt(e){return ht(e)&&"AuthRetryableFetchError"===e.name}class _t extends ft{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class St extends ft{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ct="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),zt=" \t\n\r=".split(""),Et=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<zt.length;t+=1)e[zt[t].charCodeAt(0)]=-2;for(let t=0;t<Ct.length;t+=1)e[Ct[t].charCodeAt(0)]=t;return e})();function At(e,t,n){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(Ct[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(Ct[e]),t.queuedBits-=6}}function Tt(e,t,n){const a=Et[e];if(!(a>-1)){if(-2===a)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Ot(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},a={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},s=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(0===(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,a,n)};for(let i=0;i<e.length;i+=1)Tt(e.charCodeAt(i),r,s);return t.join("")}function Pt(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function Dt(e,t){for(let n=0;n<e.length;n+=1){let a=e.charCodeAt(n);if(a>55295&&a<=56319){const t=1024*(a-55296)&65535;a=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}Pt(a,t)}}function Rt(e){const t=[],n={queue:0,queuedBits:0},a=e=>{t.push(e)};for(let r=0;r<e.length;r+=1)Tt(e.charCodeAt(r),n,a);return new Uint8Array(t)}function It(e){const t=[],n={queue:0,queuedBits:0},a=e=>{t.push(e)};return e.forEach(e=>At(e,n,a)),At(null,n,a),t.join("")}const Lt=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Mt={tested:!1,writable:!1},Ut=()=>{if(!Lt())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(Mt.tested)return Mt.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Mt.tested=!0,Mt.writable=!0}catch(t){Mt.tested=!0,Mt.writable=!1}return Mt.writable};const Ft=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},Bt=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},qt=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(a){return n}},Ht=async(e,t)=>{await e.removeItem(t)};class Vt{constructor(){this.promise=new Vt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Wt(e){const t=e.split(".");if(3!==t.length)throw new St("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!dt.test(t[n]))throw new St("JWT not in base64url format");return{header:JSON.parse(Ot(t[0])),payload:JSON.parse(Ot(t[1])),signature:Rt(t[2]),raw:{header:t[0],payload:t[1]}}}function Kt(e){return("0"+e.toString(16)).substr(-2)}async function Gt(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Jt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let a=0;a<56;a++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,Kt).join("")}();let r=a;n&&(r+="/PASSWORD_RECOVERY"),await Bt(e,"".concat(t,"-code-verifier"),r);const s=await Gt(a);return[s,a===s?"plain":"s256"]}Vt.promiseConstructor=Promise;const $t=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Qt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Yt(e){if(!Qt.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xt(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function Zt(e){return JSON.parse(JSON.stringify(e))}const en=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tn=[502,503,504];async function nn(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new Nt(en(e),0);if(tn.includes(e.status))throw new Nt(en(e),e.status);let a,r;try{a=await e.json()}catch(i){throw new mt(en(i),i)}const s=function(e){const t=e.headers.get(lt);if(!t)return null;if(!t.match($t))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(i){return null}}(e);if(s&&s.getTime()>=ct.timestamp&&"object"===typeof a&&a&&"string"===typeof a.code?r=a.code:"object"===typeof a&&a&&"string"===typeof a.error_code&&(r=a.error_code),r){if("weak_password"===r)throw new _t(en(a),e.status,(null===(t=a.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new gt}else if("object"===typeof a&&a&&"object"===typeof a.weak_password&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new _t(en(a),e.status,a.weak_password.reasons);throw new pt(en(a),e.status||500,r)}async function an(e,t,n,a){var r;const s=Object.assign({},null===a||void 0===a?void 0:a.headers);s[lt]||(s[lt]=ct.name),(null===a||void 0===a?void 0:a.jwt)&&(s.Authorization="Bearer ".concat(a.jwt));const i=null!==(r=null===a||void 0===a?void 0:a.query)&&void 0!==r?r:{};(null===a||void 0===a?void 0:a.redirectTo)&&(i.redirect_to=a.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,n,a,r,s){const i=((e,t,n,a)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(a),Object.assign(Object.assign({},r),n))})(t,a,r,s);let o;try{o=await e(n,Object.assign({},i))}catch(l){throw console.error(l),new Nt(en(l),0)}o.ok||await nn(o);if(null===a||void 0===a?void 0:a.noResolveJson)return o;try{return await o.json()}catch(l){await nn(l)}}(e,t,n+o,{headers:s,noResolveJson:null===a||void 0===a?void 0:a.noResolveJson},{},null===a||void 0===a?void 0:a.body);return(null===a||void 0===a?void 0:a.xform)?null===a||void 0===a?void 0:a.xform(l):{data:Object.assign({},l),error:null}}function rn(e){var t;let n=null;var a;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(a=e.expires_in,Math.round(Date.now()/1e3)+a)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function sn(e){const t=rn(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function on(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ln(e){return{data:e,error:null}}function cn(e){const{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:s}=e,i=u(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:s},user:Object.assign({},i)},error:null}}function dn(e){return e}const un=["global","local","others"];class hn{constructor(e){let{url:t="",headers:n={},fetch:a}=e;this.url=t,this.headers=n,this.fetch=Ft(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:un[0];if(un.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(un.join(", ")));try{return await an(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ht(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await an(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:on})}catch(n){if(ht(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=u(e,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=null===n||void 0===n?void 0:n.newEmail,delete a.newEmail),await an(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:a,headers:this.headers,xform:cn,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(ht(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await an(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:on})}catch(t){if(ht(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,a,r,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await an(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(r=null===(a=null===e||void 0===e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==r?r:""},xform:dn});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(ht(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Yt(e);try{return await an(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:on})}catch(t){if(ht(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Yt(e);try{return await an(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:on})}catch(n){if(ht(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Yt(e);try{return await an(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:on})}catch(n){if(ht(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Yt(e.userId);try{const{data:t,error:n}=await an(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(ht(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Yt(e.userId),Yt(e.id);try{return{data:await an(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(ht(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,a,r,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await an(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(r=null===(a=null===e||void 0===e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==r?r:""},xform:dn});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(ht(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await an(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(ht(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await an(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(ht(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await an(this.fetch,"PUT","".concat(this.url,"/admin/oauth/clients/").concat(e),{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(n){if(ht(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await an(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(ht(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await an(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(ht(t))return{data:null,error:t};throw t}}}function pn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const mn=!!(globalThis&&Ut()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class fn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gn extends fn{}async function xn(e,t,n){mn&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;t>0&&setTimeout(()=>{a.abort(),mn&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve();try{return await globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async a=>{if(!a){if(0===t)throw mn&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new gn('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(mn)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}mn&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await n()}finally{mn&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}})}catch(r){if("AbortError"===(null===r||void 0===r?void 0:r.name)&&t>0)return mn&&console.log("@supabase/gotrue-js: navigatorLock: acquire timeout, recovering by stealing lock",e),console.warn('@supabase/gotrue-js: Lock "'.concat(e,'" was not released within ').concat(t,"ms. ")+"This may indicate an orphaned lock from a component unmount (e.g., React Strict Mode). Forcefully acquiring the lock to recover."),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,{mode:"exclusive",steal:!0},async t=>{if(!t)return console.warn("@supabase/gotrue-js: Navigator LockManager returned null lock even with steal: true"),await n();mn&&console.log("@supabase/gotrue-js: navigatorLock: recovered (stolen)",e,t.name);try{return await n()}finally{mn&&console.log("@supabase/gotrue-js: navigatorLock: released (stolen)",e,t.name)}}));throw r}}function vn(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function bn(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class yn extends Error{constructor(e){let{message:t,code:n,cause:a,name:r}=e;var s;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=null!==(s=null!==r&&void 0!==r?r:a instanceof Error?a.name:void 0)&&void 0!==s?s:"Unknown Error",this.code=n}}class wn extends yn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function jn(e){let{error:t,options:n}=e;var a,r,s;const{publicKey:i}=n;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new yn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(a=i.authenticatorSelection)||void 0===a?void 0:a.requireResidentKey))return new yn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===n.mediation&&"required"===(null===(r=i.authenticatorSelection)||void 0===r?void 0:r.userVerification))return new yn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(s=i.authenticatorSelection)||void 0===s?void 0:s.userVerification))return new yn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new yn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new yn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new yn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new yn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!En(e))return new yn({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(i.rp.id!==e)return new yn({message:'The RP ID "'.concat(i.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new yn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new yn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new yn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Nn(e){let{error:t,options:n}=e;const{publicKey:a}=n;if(!a)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(n.signal instanceof AbortSignal)return new yn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new yn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!En(e))return new yn({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(a.rpId!==e)return new yn({message:'The RP ID "'.concat(a.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new yn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new yn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}const kn=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function _n(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:n,excludeCredentials:a}=e,r=u(e,["challenge","user","excludeCredentials"]),s=Rt(t).buffer,i=Object.assign(Object.assign({},n),{id:Rt(n.id).buffer}),o=Object.assign(Object.assign({},r),{challenge:s,user:i});if(a&&a.length>0){o.excludeCredentials=new Array(a.length);for(let e=0;e<a.length;e++){const t=a[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:Rt(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}function Sn(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:n}=e,a=u(e,["challenge","allowCredentials"]),r=Rt(t).buffer,s=Object.assign(Object.assign({},a),{challenge:r});if(n&&n.length>0){s.allowCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];s.allowCredentials[e]=Object.assign(Object.assign({},t),{id:Rt(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return s}function Cn(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e;return{id:e.id,rawId:e.id,response:{attestationObject:It(new Uint8Array(e.response.attestationObject)),clientDataJSON:It(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function zn(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const n=e,a=e.getClientExtensionResults(),r=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:It(new Uint8Array(r.authenticatorData)),clientDataJSON:It(new Uint8Array(r.clientDataJSON)),signature:It(new Uint8Array(r.signature)),userHandle:r.userHandle?It(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:null!==(t=n.authenticatorAttachment)&&void 0!==t?t:void 0}}function En(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function An(){var e,t;return!!(Lt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const Tn={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},On={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Pn(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),n={};for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];for(const i of r)if(i)for(const a in i){const r=i[a];if(void 0!==r)if(Array.isArray(r))n[a]=r;else if(t(r))n[a]=r;else if(e(r)){const t=n[a];e(t)?n[a]=Pn(t,r):n[a]=Pn(r)}else n[a]=r}return n}class Dn{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:n,webauthn:a,friendlyName:r,signal:s}=e;var i;try{const{data:e,error:o}=await this.client.mfa.challenge({factorId:n,webauthn:a});if(!e)return{data:null,error:o};const l=null!==s&&void 0!==s?s:kn.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;if(!t.name){const e=r;if(e)t.name="".concat(t.id,":").concat(e);else{const e=(await this.client.getUser()).data.user,n=(null===(i=null===e||void 0===e?void 0:e.user_metadata)||void 0===i?void 0:i.name)||(null===e||void 0===e?void 0:e.email)||(null===e||void 0===e?void 0:e.id)||"User";t.name="".concat(t.id,":").concat(n)}}t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const a=function(e,t){return Pn(Tn,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new wn("Browser returned unexpected credential type",t)}:{data:null,error:new wn("Empty credential response",t)}}catch(t){return{data:null,error:jn({error:t,options:e})}}}({publicKey:a,signal:l});return r?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}case"request":{const a=function(e,t){return Pn(On,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new wn("Browser returned unexpected credential type",t)}:{data:null,error:new wn("Empty credential response",t)}}catch(t){return{data:null,error:Nn({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:a,signal:l}));return r?{data:{factorId:n,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}}}catch(o){return ht(o)?{data:null,error:o}:{data:null,error:new mt("Unexpected error in challenge",o)}}}async _verify(e){let{challengeId:t,factorId:n,webauthn:a}=e;return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:a})}async _authenticate(e,t){let{factorId:n,webauthn:{rpId:a=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}={}}=e;if(!a)return{data:null,error:new ut("rpId is required for WebAuthn authentication")};try{if(!An())return{data:null,error:new mt("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this.challenge({factorId:n,webauthn:{rpId:a,rpOrigins:r},signal:s},{request:t});if(!e)return{data:null,error:i};const{webauthn:o}=e;return this._verify({factorId:n,challengeId:e.challengeId,webauthn:{type:o.type,rpId:a,rpOrigins:r,credential_response:o.credential_response}})}catch(i){return ht(i)?{data:null,error:i}:{data:null,error:new mt("Unexpected error in authenticate",i)}}}async _register(e,t){let{friendlyName:n,webauthn:{rpId:a=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}={}}=e;if(!a)return{data:null,error:new ut("rpId is required for WebAuthn registration")};try{if(!An())return{data:null,error:new mt("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this._enroll({friendlyName:n});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===n&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:i};const{data:o,error:l}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:a,rpOrigins:r},signal:s},{create:t});return o?this._verify({factorId:e.id,challengeId:o.challengeId,webauthn:{rpId:a,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}}):{data:null,error:l}}catch(i){return ht(i)?{data:null,error:i}:{data:null,error:new mt("Unexpected error in register",i)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Rn={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ot,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:5e3,skipAutoInitialize:!1};async function In(e,t,n){return await n()}const Ln={};class Mn{get jwks(){var e,t;return null!==(t=null===(e=Ln[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Ln[this.storageKey]=Object.assign(Object.assign({},Ln[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Ln[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ln[this.storageKey]=Object.assign(Object.assign({},Ln[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},Rn),e);if(this.storageKey=r.storageKey,this.instanceID=null!==(t=Mn.nextInstanceID[this.storageKey])&&void 0!==t?t:0,Mn.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.instanceID>0&&Lt()){const e="".concat(this._logPrefix()," Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new hn({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Ft(r.fetch),this.lock=r.lock||In,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,this.lockAcquireTimeout=r.lockAcquireTimeout,r.lock?this.lock=r.lock:this.persistSession&&Lt()&&(null===(n=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===n?void 0:n.locks)?this.lock=xn:this.lock=In,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Dn(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:Ut()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pn(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=pn(this.memoryStorage)),Lt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}null===(a=this.broadcastChannel)||void 0===a||a.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(t){this._debug("#broadcastChannel","error",t)}})}r.skipAutoInitialize||this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return"GoTrueClient@"+"".concat(this.storageKey,":").concat(this.instanceID," (").concat(rt,") ").concat((new Date).toISOString())}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger(this._logPrefix(),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},n="none";if(Lt()&&(t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach((e,n)=>{t[n]=e})}catch(a){}return n.searchParams.forEach((e,n)=>{t[n]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),Lt()&&this.detectSessionInUrl&&"none"!==n){const{data:a,error:r}=await this._getSessionFromURL(t,n);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return ht(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return{error:r}}const{session:s,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ht(t)?this._returnResult({error:t}):this._returnResult({error:new mt("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,a;try{const r=await an(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken}},xform:rn}),{data:s,error:i}=r;if(i||!s)return this._returnResult({data:{user:null,session:null},error:i});const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(r){if(ht(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(e){var t,n,a;try{let r;if("email"in e){const{email:n,password:a,options:s}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Jt(this.storage,this.storageKey)),r=await an(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:n,password:a,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:o},xform:rn})}else{if(!("phone"in e))throw new bt("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:i}=e;r=await an(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:s,data:null!==(n=null===i||void 0===i?void 0:i.data)&&void 0!==n?n:{},channel:null!==(a=null===i||void 0===i?void 0:i.channel)&&void 0!==a?a:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:rn})}}const{data:s,error:i}=r;if(i||!s)return await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),this._returnResult({data:{user:null,session:null},error:i});const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(r){if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),ht(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:a,options:r}=e;t=await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:n,password:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:sn})}else{if(!("phone"in e))throw new bt("You must provide either an email or phone number and a password");{const{phone:n,password:a,options:r}=e;t=await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:n,password:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:sn})}}const{data:n,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const e=new vt;return this._returnResult({data:{user:null,session:null},error:e})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(ht(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,a,r;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,n,a,r,s,i,o,l,c,d,u;let h,p;if("message"in e)h=e.message,p=e.signature;else{const{chain:d,wallet:u,statement:m,options:f}=e;let g;if(Lt())if("object"===typeof u)g=u;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!==typeof u||!(null===f||void 0===f?void 0:f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=u}const x=new URL(null!==(t=null===f||void 0===f?void 0:f.url)&&void 0!==t?t:window.location.href),v=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!v||0===v.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const b=vn(v[0]);let y=null===(n=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===n?void 0:n.chainId;if(!y){const e=await g.request({method:"eth_chainId"});y=parseInt(e,16)}h=function(e){var t;const{chainId:n,domain:a,expirationTime:r,issuedAt:s=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:d,uri:u,version:h}=e;if(!Number.isInteger(n))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(n));if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(i));if(!u)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(h));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const p=vn(e.address),m=d?"".concat(d,"://").concat(a):a,f=e.statement?"".concat(e.statement,"\n"):"",g="".concat(m," wants you to sign in with your Ethereum account:\n").concat(p,"\n\n").concat(f);let x="URI: ".concat(u,"\nVersion: ").concat(h,"\nChain ID: ").concat(n).concat(i?"\nNonce: ".concat(i):"","\nIssued At: ").concat(s.toISOString());if(r&&(x+="\nExpiration Time: ".concat(r.toISOString())),o&&(x+="\nNot Before: ".concat(o.toISOString())),l&&(x+="\nRequest ID: ".concat(l)),c){let e="\nResources:";for(const t of c){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}x+=e}return"".concat(g,"\n").concat(x)}({domain:x.host,address:b,statement:m,uri:x.href,version:"1",chainId:y,nonce:null===(a=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===a?void 0:a.nonce,issuedAt:null!==(s=null===(r=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===r?void 0:r.issuedAt)&&void 0!==s?s:new Date,expirationTime:null===(i=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===i?void 0:i.expirationTime,notBefore:null===(o=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===o?void 0:o.notBefore,requestId:null===(l=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===c?void 0:c.resources}),p=await g.request({method:"personal_sign",params:[bn(h),b]})}try{const{data:t,error:n}=await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:p},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(u=e.options)||void 0===u?void 0:u.captchaToken}}:null),xform:rn});if(n)throw n;if(!t||!t.session||!t.user){const e=new vt;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(m){if(ht(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var t,n,a,r,s,i,o,l,c,d,u,h;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:u,wallet:h,statement:f,options:g}=e;let x;if(Lt())if("object"===typeof h)x=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");x=e.solana}else{if("object"!==typeof h||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=h}const v=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in x&&x.signIn){const e=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),f?{statement:f}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");p="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),m=t.signature}else{if(!("signMessage"in x)||"function"!==typeof x.signMessage||!("publicKey"in x)||"object"!==typeof x||!x.publicKey||!("toBase58"in x.publicKey)||"function"!==typeof x.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=["".concat(v.host," wants you to sign in with your Solana account:"),x.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1","URI: ".concat(v.href),"Issued At: ".concat(null!==(a=null===(n=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===n?void 0:n.issuedAt)&&void 0!==a?a:(new Date).toISOString()),...(null===(r=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===r?void 0:r.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(s=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===s?void 0:s.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(i=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(d=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await x.signMessage((new TextEncoder).encode(p),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=e}}try{const{data:t,error:n}=await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:It(m)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:rn});if(n)throw n;if(!t||!t.session||!t.user){const e=new vt;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:n})}catch(f){if(ht(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async _exchangeCodeForSession(e){const t=await qt(this.storage,"".concat(this.storageKey,"-code-verifier")),[n,a]=(null!==t&&void 0!==t?t:"").split("/");try{if(!n&&"pkce"===this.flowType)throw new jt;const{data:t,error:r}=await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:rn});if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),r)throw r;if(!t||!t.session||!t.user){const e=new vt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!==a&&void 0!==a?a:null}),error:r})}catch(r){if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),ht(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(e){try{const{options:t,provider:n,token:a,access_token:r,nonce:s}=e,i=await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:n,id_token:a,access_token:r,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:rn}),{data:o,error:l}=i;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o||!o.session||!o.user){const e=new vt;return this._returnResult({data:{user:null,session:null},error:e})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:o,error:l})}catch(t){if(ht(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,a,r,s;try{if("email"in e){const{email:a,options:r}=e;let s=null,i=null;"pkce"===this.flowType&&([s,i]=await Jt(this.storage,this.storageKey));const{error:o}=await an(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:a,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},create_user:null===(n=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:s,code_challenge_method:i},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){const{phone:t,options:n}=e,{data:i,error:o}=await an(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(a=null===n||void 0===n?void 0:n.data)&&void 0!==a?a:{},create_user:null===(r=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(s=null===n||void 0===n?void 0:n.channel)&&void 0!==s?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:o})}throw new bt("You must provide either an email or phone number.")}catch(i){if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),ht(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async verifyOtp(e){var t,n;try{let a,r;"options"in e&&(a=null===(t=e.options)||void 0===t?void 0:t.redirectTo,r=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:s,error:i}=await an(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:a,xform:rn});if(i)throw i;if(!s){throw new Error("An error occurred on token verification.")}const o=s.session,l=s.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(a){if(ht(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,n,a,r,s;try{let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Jt(this.storage,this.storageKey));const l=await an(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:ln});return(null===(r=l.data)||void 0===r?void 0:r.url)&&Lt()&&!(null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(i){if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),ht(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new gt;const{error:a}=await an(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(ht(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:n,type:a,options:r}=e,{error:s}=await an(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}if("phone"in e){const{phone:n,type:a,options:r}=e,{data:s,error:i}=await an(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:i})}throw new bt("You must provide either an email or phone number and a type")}catch(t){if(ht(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await qt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<it;if(this._debug("#__loadSession()","session has".concat(n?"":" not"," expired"),"expires_at",e.expires_at),!n){if(this.userStorage){const t=await qt(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=Xt()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,n,a)=>{if("__isInsecureUserWarningProxy"===n)return!0;if("symbol"===typeof n){const t=n.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,n,a)}return t.value||"string"!==typeof n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,n,a)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await an(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:on}):await this._useSession(async e=>{var t,n,a;const{data:r,error:s}=e;if(s)throw s;return(null===(t=r.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await an(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(a=null===(n=r.session)||void 0===n?void 0:n.access_token)&&void 0!==a?a:void 0,xform:on}):{data:{user:null},error:new gt}})}catch(t){if(ht(t))return xt(t)&&(await this._removeSession(),await Ht(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async n=>{const{data:a,error:r}=n;if(r)throw r;if(!a.session)throw new gt;const s=a.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await Jt(this.storage,this.storageKey));const{data:l,error:c}=await an(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:s.access_token,xform:on});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(n){if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),ht(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new gt;const t=Date.now()/1e3;let n=t,a=!0,r=null;const{payload:s}=Wt(e.access_token);if(s.exp&&(n=s.exp,a=n<=t),a){const{data:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!t)return{data:{user:null,session:null},error:null};r=t}else{const{data:a,error:s}=await this._getUser(e.access_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});r={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(t){if(ht(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:a,error:r}=t;if(r)throw r;e=null!==(n=a.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new gt;const{data:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(ht(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Lt())throw new yt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new yt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new wt("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new yt("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new wt("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const a=new URL(window.location.href);return a.searchParams.delete("code"),window.history.replaceState(window.history.state,"",a.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:r,refresh_token:s,expires_in:i,expires_at:o,token_type:l}=e;if(!r||!i||!s||!l)throw new yt("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const h=u-c;1e3*h<=st&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(d,"s"));const p=u-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,u,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,u,c);const{data:m,error:f}=await this._getUser(r);if(f)throw f;const g={provider_token:n,provider_refresh_token:a,access_token:r,expires_in:d,expires_at:u,refresh_token:s,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(n){if(ht(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return"function"===typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await qt(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var n;const{data:a,error:r}=t;if(r&&!xt(r))return this._returnResult({error:r});const s=null===(n=a.session)||void 0===n?void 0:n.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return ht(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status)&&!xt(t))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await Ht(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,a;try{const{data:{session:a},error:r}=t;if(r)throw r;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(r){await(null===(a=this.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,a=null;"pkce"===this.flowType&&([n,a]=await Jt(this.storage,this.storageKey,!0));try{return await an(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),ht(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:a}=await this._useSession(async t=>{var n,a,r,s,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(a=e.options)||void 0===a?void 0:a.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:!0});return await an(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==i?i:void 0})});if(a)throw a;return Lt()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),this._returnResult({data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null})}catch(n){if(ht(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:a,data:{session:r}}=t;if(a)throw a;const{options:s,provider:i,token:o,access_token:l,nonce:c}=e,d=await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(n=null===r||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,body:{provider:i,id_token:o,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:rn}),{data:u,error:h}=d;return h?this._returnResult({data:{user:null,session:null},error:h}):u&&u.session&&u.user?(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),this._returnResult({data:u,error:h})):this._returnResult({data:{user:null,session:null},error:new vt})}catch(a){if(await Ht(this.storage,"".concat(this.storageKey,"-code-verifier")),ht(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,a;const{data:r,error:s}=t;if(s)throw s;return await an(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(a=null===(n=r.session)||void 0===n?void 0:n.access_token)&&void 0!==a?a:void 0})})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const r=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await an(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:rn})),a=(e,t)=>{const n=200*Math.pow(2,e);return t&&kt(t)&&Date.now()+n-r<st},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await n(s);if(!a(s,null,t))return void e(t)}catch(r){if(!a(s,r))return void t(r)}})()}))}catch(r){if(this._debug(t,"error",r),ht(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}var n,a}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Lt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await qt(this.storage,this.storageKey);if(r&&this.userStorage){let t=await qt(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:r.user},await Bt(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:Xt()}else if(r&&!r.user&&!r.user){const e=await qt(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await Ht(this.storage,this.storageKey+"-user"),await Bt(this.storage,this.storageKey,r)):r.user=Xt()}if(this._debug(n,"session from storage",r),!this._isValidSession(r))return this._debug(n,"session is not valid"),void(null!==r&&await this._removeSession());const s=1e3*(null!==(t=r.expires_at)&&void 0!==t?t:1/0)-Date.now()<it;if(this._debug(n,"session has".concat(s?"":" not"," expired with margin of ").concat(it,"s")),s){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),kt(e)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(r.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(n,"error",r),void console.error(r)}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new gt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(a,"begin");try{this.refreshingDeferred=new Vt;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new gt;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const a={data:t.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(r){if(this._debug(a,"error",r),ht(r)){const e={data:null,error:r};return kt(r)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(r),r}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a="#_notifyAllSubscribers(".concat(e,")");this._debug(a,"begin",t,"broadcast = ".concat(n));try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],r=Array.from(this.stateChangeEmitters.values()).map(async n=>{try{await n.callback(e,t)}catch(r){a.push(r)}});if(await Promise.all(r),a.length>0){for(let e=0;e<a.length;e+=1)console.error(a[e]);throw a[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ht(this.storage,"".concat(this.storageKey,"-code-verifier"));const t=Object.assign({},e),n=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!n&&t.user&&await Bt(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const a=Zt(e);await Bt(this.storage,this.storageKey,a)}else{const e=Zt(t);await Bt(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ht(this.storage,this.storageKey),await Ht(this.storage,this.storageKey+"-code-verifier"),await Ht(this.storage,this.storageKey+"-user"),this.userStorage&&await Ht(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Lt()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),st);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"===typeof t&&"function"===typeof t.unref?t.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const a=Math.floor((1e3*n.expires_at-t)/st);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(a," ticks, a tick lasts ").concat(st,"ms, refresh threshold is ").concat(3," ticks")),a<=3&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof fn))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Lt()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const a=["provider=".concat(encodeURIComponent(t))];if((null===n||void 0===n?void 0:n.redirectTo)&&a.push("redirect_to=".concat(encodeURIComponent(n.redirectTo))),(null===n||void 0===n?void 0:n.scopes)&&a.push("scopes=".concat(encodeURIComponent(n.scopes))),"pkce"===this.flowType){const[e,t]=await Jt(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});a.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);a.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&a.push("skip_http_redirect=".concat(n.skipBrowserRedirect)),"".concat(e,"?").concat(a.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:a,error:r}=t;return r?this._returnResult({data:null,error:r}):await an(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token})})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,a;const{data:r,error:s}=t;if(s)return this._returnResult({data:null,error:s});const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await an(this.fetch,"POST","".concat(this.url,"/factors"),{body:i,headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null===(a=null===o||void 0===o?void 0:o.totp)||void 0===a?void 0:a.qr_code)&&(o.totp.qr_code="data:image/svg+xml;utf-8,".concat(o.totp.qr_code)),this._returnResult({data:o,error:null}))})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:r}=t;if(r)return this._returnResult({data:null,error:r});const s=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?Cn(e.webauthn.credential_response):zn(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:o}=await an(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:s,headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token});return o?this._returnResult({data:null,error:o}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:o}))})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:r}=t;if(r)return this._returnResult({data:null,error:r});const s=await an(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token});if(s.error)return s;const{data:i}=s;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:_n(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:Sn(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const r of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])a.all.push(r),"verified"===r.status&&a[r.factor_type].push(r);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,n,a,r;if(e)try{const{payload:a}=Wt(e);let r=null;a.aal&&(r=a.aal);let s=r;const{data:{user:i},error:o}=await this.getUser(e);if(o)return this._returnResult({data:null,error:o});(null!==(n=null===(t=null===i||void 0===i?void 0:i.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==n?n:[]).length>0&&(s="aal2");return{data:{currentLevel:r,nextLevel:s,currentAuthenticationMethods:a.amr||[]},error:null}}catch(d){if(ht(d))return this._returnResult({data:null,error:d});throw d}const{data:{session:s},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Wt(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;(null!==(r=null===(a=s.user.factors)||void 0===a?void 0:a.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(c="aal2");return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:o.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?await an(this.fetch,"GET","".concat(this.url,"/oauth/authorizations/").concat(e),{headers:this.headers,jwt:n.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new gt})})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:a},error:r}=n;if(r)return this._returnResult({data:null,error:r});if(!a)return this._returnResult({data:null,error:new gt});const s=await an(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&Lt()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(ht(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:a},error:r}=n;if(r)return this._returnResult({data:null,error:r});if(!a)return this._returnResult({data:null,error:new gt});const s=await an(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&Lt()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(ht(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await an(this.fetch,"GET","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new gt})})}catch(e){if(ht(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?(await an(this.fetch,"DELETE","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new gt})})}catch(t){if(ht(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const n=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>n)return t;const{data:a,error:r}=await an(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(r)throw r;return a.keys&&0!==a.keys.length?(this.jwks=a,this.jwks_cached_at=n,t=a.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});n=e.session.access_token}const{header:a,payload:r,signature:s,raw:{header:i,payload:o}}=Wt(n);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(r.exp);const l=a.alg&&!a.alg.startsWith("HS")&&a.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(a.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:r,header:a,signature:s},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(a.alg),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,s,function(e){const t=[];return Dt(e,e=>t.push(e)),new Uint8Array(t)}("".concat(i,".").concat(o))))throw new St("Invalid JWT signature");return{data:{claims:r,header:a,signature:s},error:null}}catch(n){if(ht(n))return this._returnResult({data:null,error:n});throw n}}}Mn.nextInstanceID={};const Un=Mn;let Fn="";Fn="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Bn={headers:{"X-Client-Info":"supabase-js-".concat(Fn,"/").concat("2.98.0")}},qn={schema:"public"},Hn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Vn={};function Wn(e){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e){var t=function(e,t){if("object"!=Wn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Wn(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wn(t)?t:t+""}function Gn(e,t,n){return(t=Kn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(n),!0).forEach(function(t){Gn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const Qn=(e,t,n)=>{const a=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(n),r=Headers;return async(n,s)=>{var i;const o=null!==(i=await t())&&void 0!==i?i:e;let l=new r(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(o)),a(n,$n($n({},s),{},{headers:l}))}};var Yn=class extends Un{constructor(e){super(e)}},Xn=class{constructor(e,t,n){var a,r;this.supabaseUrl=e,this.supabaseKey=t;const s=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((n=t).endsWith("/")?n:n+"/")}catch(a){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var n}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const i="sb-".concat(s.hostname.split(".")[0],"-auth-token"),o=function(e,t){var n,a;const{db:r,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:$n($n({},l),r),auth:$n($n({},c),s),realtime:$n($n({},d),i),storage:{},global:$n($n($n({},u),o),{},{headers:$n($n({},null!==(n=null===u||void 0===u?void 0:u.headers)&&void 0!==n?n:{}),null!==(a=null===o||void 0===o?void 0:o.headers)&&void 0!==a?a:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==n&&void 0!==n?n:{},{db:qn,realtime:Vn,auth:$n($n({},Hn),{},{storageKey:i}),global:Bn});var l;(this.storageKey=null!==(a=o.auth.storageKey)&&void 0!==a?a:"",this.headers=null!==(r=o.global.headers)&&void 0!==r?r:{},o.accessToken)?(this.accessToken=o.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(l=o.auth)&&void 0!==l?l:{},this.headers,o.global.fetch);this.fetch=Qn(t,this._getAccessToken.bind(this),o.global.fetch),this.realtime=this._initRealtimeClient($n({headers:this.headers,accessToken:this._getAccessToken.bind(this)},o.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new A(new URL("rest/v1",s).href,{headers:this.headers,schema:o.db.schema,fetch:this.fetch,timeout:o.db.timeout,urlLengthLimit:o.db.urlLengthLimit}),this.storage=new at(this.storageUrl.href,this.headers,this.fetch,null===n||void 0===n?void 0:n.storage),o.accessToken||this._listenForAuthEvents()}get functions(){return new v(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{head:!1,get:!1,count:void 0};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,n=this;if(n.accessToken)return await n.accessToken();const{data:a}=await n.auth.getSession();return null!==(e=null===(t=a.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:n.supabaseKey}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:a,persistSession:r,detectSessionInUrl:s,storage:i,userStorage:o,storageKey:l,flowType:c,lock:d,debug:u,throwOnError:h}=e;const p={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Yn({url:this.authUrl.href,headers:$n($n({},p),t),storageKey:l,autoRefreshToken:a,persistSession:r,detectSessionInUrl:s,storage:i,userStorage:o,flowType:c,lock:d,debug:u,throwOnError:h,fetch:n,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new he(this.realtimeUrl.href,$n($n({},e),{},{params:$n($n({},{apikey:this.supabaseKey}),null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=n,this.realtime.setAuth(n))}};(function(){if("undefined"!==typeof window)return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(void 0===t||null===t)return!1;const n=t.match(/^v(\d+)\./);return!!n&&parseInt(n[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var Zn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ea=["color","size","strokeWidth","absoluteStrokeWidth","children"];var ta=(e,t)=>{const n=(0,a.forwardRef)((n,r)=>{let{color:s="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:l,children:u}=n,h=d(n,ea);return(0,a.createElement)("svg",c(c({ref:r},Zn),{},{width:i,height:i,stroke:s,strokeWidth:l?24*Number(o)/Number(i):o,className:"lucide lucide-".concat((p=e,p.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},h),[...t.map(e=>{let[t,n]=e;return(0,a.createElement)(t,n)}),...(Array.isArray(u)?u:[u])||[]]);var p});return n.displayName="".concat(e),n};const na=ta("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),aa=ta("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ra=ta("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),sa=ta("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),ia=ta("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),oa=ta("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),la=ta("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),ca=ta("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),da=ta("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ua=ta("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]),ha=ta("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),pa=ta("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),ma=ta("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),fa=ta("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),ga=ta("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),xa=ta("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),va=ta("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ba=ta("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ya=ta("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),wa=ta("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ja=ta("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Na=ta("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ka=ta("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),_a=ta("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Sa=ta("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),Ca=ta("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),za=ta("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ea=ta("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Aa=ta("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Ta=ta("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Oa=ta("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Pa=ta("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Da=ta("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ra=ta("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Ia=ta("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),La=ta("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ma=ta("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ua=ta("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Fa=ta("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ba=ta("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),qa=ta("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ha=ta("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),Va=ta("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]),Wa=ta("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ka=ta("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Ga=ta("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var Ja,$a,Qa=n(403);!function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(Ja||(Ja={})),function(e){e.None="NONE",e.Slide="SLIDE",e.Fade="FADE"}($a||($a={}));const Ya=(0,Qa.F3)("StatusBar");var Xa,Za;!function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(Xa||(Xa={})),function(e){e.Body="body",e.Ionic="ionic",e.Native="native",e.None="none"}(Za||(Za={}));const er=(0,Qa.F3)("Keyboard");n(830);(0,Qa.F3)("Haptics",{web:()=>n.e(182).then(n.bind(n,182)).then(e=>new e.HapticsWeb)});var tr=n(579);const nr=["label"],ar=["label","children"],rr=["children","variant","size","icon","className"];(async()=>{if(Qa.Ii.isNativePlatform())try{await Ya.setStyle({style:Ja.Dark}),await Ya.setBackgroundColor({color:"#0f172a"}),er.addListener("keyboardWillShow",()=>{document.body.classList.add("keyboard-open")}),er.addListener("keyboardWillHide",()=>{document.body.classList.remove("keyboard-open")})}catch(e){console.log("Native plugin init error:",e)}})();const sr=new Xn("https://wqtylxrrerhbxagdzftn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndxdHlseHJyZXJoYnhhZ2R6ZnRuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2NjkyNjAsImV4cCI6MjA4NzI0NTI2MH0.oXUs9ITNi6lEFat_5FH0x-Exw5MDgRhwx6T0yL3xiWQ",ir);var ir;const or="bozzellapellegrino@gmail.com",lr={"Dubai Marina":{lat:25.0805,lng:55.1403,zoom:14},"Palm Jumeirah":{lat:25.1124,lng:55.139,zoom:13},"Downtown Dubai":{lat:25.1972,lng:55.2744,zoom:14},"Business Bay":{lat:25.1851,lng:55.2628,zoom:14},JBR:{lat:25.078,lng:55.134,zoom:15},"Dubai Hills Estate":{lat:25.1026,lng:55.2427,zoom:13},"Dubai Hills":{lat:25.1026,lng:55.2427,zoom:13},"Mohammed Bin Rashid City":{lat:25.1695,lng:55.3147,zoom:13},"MBR City":{lat:25.1695,lng:55.3147,zoom:13},"Dubai Creek Harbour":{lat:25.2048,lng:55.3461,zoom:14},"Dubai Creek":{lat:25.2048,lng:55.3461,zoom:14},"Jumeirah Village Circle":{lat:25.0655,lng:55.2094,zoom:14},JVC:{lat:25.0655,lng:55.2094,zoom:14},JLT:{lat:25.075,lng:55.155,zoom:14},"Dubai South":{lat:24.8966,lng:55.1581,zoom:12},"DAMAC Hills":{lat:25.0285,lng:55.243,zoom:13},"DAMAC Hills 2":{lat:25.005,lng:55.275,zoom:13},"Arabian Ranches":{lat:25.0597,lng:55.2671,zoom:13},Meydan:{lat:25.1606,lng:55.2958,zoom:13},DIFC:{lat:25.2104,lng:55.2796,zoom:15},"Al Marjan Island":{lat:25.7955,lng:55.7283,zoom:13},"Dubai Islands":{lat:25.275,lng:55.315,zoom:12},"Expo City":{lat:24.96,lng:55.158,zoom:13},"Yas Island":{lat:24.4957,lng:54.603,zoom:13},"Saadiyat Island":{lat:24.5465,lng:54.433,zoom:13},"Al Reem Island":{lat:24.495,lng:54.405,zoom:13},"Sobha Hartland":{lat:25.185,lng:55.325,zoom:14},"Tilal Al Ghaf":{lat:25.035,lng:55.21,zoom:13},"Emaar Beachfront":{lat:25.085,lng:55.135,zoom:14},"Bluewaters Island":{lat:25.08,lng:55.12,zoom:14},"City Walk":{lat:25.205,lng:55.26,zoom:14},"Abu Dhabi":{lat:24.4539,lng:54.3773,zoom:11},Sharjah:{lat:25.3463,lng:55.4209,zoom:11},Ajman:{lat:25.4052,lng:55.5136,zoom:11},"Ras Al Khaimah":{lat:25.7895,lng:55.9432,zoom:11}},cr=25.1972,dr=55.2744,ur=["Palm Jumeirah","Dubai Marina","Downtown","Dubai Creek","JBR","Business Bay","JLT","DIFC","MBR City","Dubai Hills","Altro"],hr=["Emaar","Damac","Sobha","Meraas","Nakheel","Dubai Properties","Azizi","Danube","Binghatti","Altro"],pr=[2,4,5,6],mr=["lead","trattativa","EOI","venduto","incassato"],fr={lead:"Lead",trattativa:"Trattativa",EOI:"EOI",venduto:"Venduto (SPA)",incassato:"Incassato"},gr=["nuovo","contattato","interessato","trattativa","acquistato","perso"],xr=["bassa","normale","alta","urgente"],vr={bg:{primary:"#0f172a",secondary:"#1e293b",tertiary:"#1e293b",elevated:"#1F1F23"},border:{subtle:"#334155",default:"#3F3F46",strong:"#52525B"},text:{primary:"#FAFAFA",secondary:"#A1A1AA",tertiary:"#71717A",muted:"#52525B"},sections:{dashboard:{accent:"#A78BFA",bg:"rgba(167,139,250,0.08)",border:"rgba(167,139,250,0.2)"},vendite:{accent:"#34D399",bg:"rgba(52,211,153,0.08)",border:"rgba(52,211,153,0.2)"},pipeline:{accent:"#60A5FA",bg:"rgba(96,165,250,0.08)",border:"rgba(96,165,250,0.2)"},crm:{accent:"#FBBF24",bg:"rgba(251,191,36,0.08)",border:"rgba(251,191,36,0.2)"},tasks:{accent:"#F472B6",bg:"rgba(244,114,182,0.08)",border:"rgba(244,114,182,0.2)"},utenti:{accent:"#22D3EE",bg:"rgba(34,211,238,0.08)",border:"rgba(34,211,238,0.2)"},offplan:{accent:"#F97316",bg:"rgba(249,115,22,0.08)",border:"rgba(249,115,22,0.2)"},calculator:{accent:"#10B981",bg:"rgba(16,185,129,0.08)",border:"rgba(16,185,129,0.2)"}},status:{lead:{color:"#71717A",bg:"rgba(113,113,122,0.15)"},trattativa:{color:"#60A5FA",bg:"rgba(96,165,250,0.15)"},EOI:{color:"#FBBF24",bg:"rgba(251,191,36,0.15)"},prenotato:{color:"#FBBF24",bg:"rgba(251,191,36,0.15)"},venduto:{color:"#34D399",bg:"rgba(52,211,153,0.15)"},incassato:{color:"#22C55E",bg:"rgba(34,197,94,0.15)"}},priority:{bassa:{color:"#71717A",bg:"rgba(113,113,122,0.15)"},normale:{color:"#60A5FA",bg:"rgba(96,165,250,0.15)"},alta:{color:"#FBBF24",bg:"rgba(251,191,36,0.15)"},urgente:{color:"#EF4444",bg:"rgba(239,68,68,0.15)"}}},br=e=>(e||0).toLocaleString("en-AE",{minimumFractionDigits:0,maximumFractionDigits:0}),yr=e=>e?new Date(e).toLocaleString("it-IT",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"-",wr=e=>e?new Date(e).toLocaleDateString("it-IT",{day:"2-digit",month:"short"}):"-",jr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://wa.me/".concat((e||"").replace(/\D/g,"")).concat(t?"?text=".concat(encodeURIComponent(t)):"")},Nr=e=>e&&new Date(e)<new Date,kr=e=>e&&new Date(e).toDateString()===(new Date).toDateString(),_r=(e,t)=>"".concat((e||"")[0]||"").concat((t||"")[0]||"").toUpperCase()||"?",Sr=async(e,t,n)=>{try{const a=await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,subject:t,html:n})});return(await a.json()).success||!1}catch(a){return console.log("Email error:",a),!1}},Cr=e=>{let{message:t,type:n="success",onClose:r}=e;(0,a.useEffect)(()=>{const e=setTimeout(r,2500);return()=>clearTimeout(e)},[r]);return(0,tr.jsxs)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 ".concat({success:"bg-emerald-500",error:"bg-red-500",info:"bg-blue-500"}[n]," text-white px-5 py-3 rounded-full shadow-2xl flex items-center gap-2 animate-slideUp"),children:[(0,tr.jsx)(na,{className:"w-4 h-4"}),(0,tr.jsx)("span",{className:"text-sm font-medium",children:t})]})},zr=e=>{let{nome:t,cognome:n,size:a="md",color:r}=e;const s=["bg-violet-500","bg-blue-500","bg-emerald-500","bg-amber-500","bg-pink-500","bg-cyan-500"],i=r||s[Math.abs((t||"").charCodeAt(0)||0)%s.length];return(0,tr.jsx)("div",{className:"".concat({sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base",xl:"w-14 h-14 text-lg"}[a]," ").concat(i," rounded-full flex items-center justify-center font-semibold text-white shrink-0"),children:_r(t,n)})},Er=e=>{let{status:t,type:n="pipeline"}=e;const a="pipeline"===n?vr.status[t]:"priority"===n?vr.priority[t]:vr.status[t];if(!a)return null;const r=fr[t]||t;return(0,tr.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{background:a.bg,color:a.color},children:r})},Ar=e=>{let{children:t,className:n="",hover:a=!1,onClick:r,padding:s="p-5"}=e;return(0,tr.jsx)("div",{onClick:r,className:"bg-[#1e293b] border border-[#334155] rounded-2xl ".concat(s," ").concat(a?"hover:border-[#3F3F46] hover:bg-[#1F1F23] cursor-pointer transition-all duration-200":""," ").concat(n),children:t})},Tr=e=>{let{icon:t,title:n,accent:a,action:r,actionLabel:s,onAction:i}=e;return(0,tr.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(".concat(a,", 0.15)")},children:(0,tr.jsx)(t,{className:"w-5 h-5",style:{color:"rgb(".concat(a,")")}})}),(0,tr.jsx)("h2",{className:"text-lg font-semibold text-white",children:n})]}),r&&(0,tr.jsxs)("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all hover:bg-white/5",style:{color:"rgb(".concat(a,")")},children:[s," ",(0,tr.jsx)(aa,{className:"w-4 h-4"})]})]})},Or=e=>{let{label:t,value:n,subValue:a,icon:r,color:s,trend:i,onClick:o}=e;return(0,tr.jsxs)(Ar,{hover:!!o,onClick:o,className:"relative overflow-hidden",children:[(0,tr.jsxs)("div",{className:"flex items-start justify-between",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-sm text-zinc-500 mb-1",children:t}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-white",children:"number"===typeof n?br(n):n}),a&&(0,tr.jsx)("p",{className:"text-sm text-zinc-500 mt-1",children:a})]}),(0,tr.jsx)("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center",style:{background:"".concat(s,"15")},children:(0,tr.jsx)(r,{className:"w-5 h-5",style:{color:s}})})]}),void 0!==i&&(0,tr.jsxs)("div",{className:"flex items-center gap-1 mt-3 text-sm ".concat(i>=0?"text-emerald-400":"text-red-400"),children:[i>=0?(0,tr.jsx)(ra,{className:"w-4 h-4"}):(0,tr.jsx)(sa,{className:"w-4 h-4"}),Math.abs(i),"% vs last month"]}),(0,tr.jsx)("div",{className:"absolute -right-8 -bottom-8 w-32 h-32 rounded-full opacity-5",style:{background:s}})]})},Pr=e=>{let{value:t,max:n,color:a="#A78BFA",height:r="h-2",showLabel:s=!1}=e;const i=n>0?Math.min(t/n*100,100):0;return(0,tr.jsxs)("div",{className:"relative",children:[(0,tr.jsx)("div",{className:"".concat(r," bg-zinc-700/50 rounded-full overflow-hidden"),children:(0,tr.jsx)("div",{className:"h-full rounded-full transition-all duration-700 ease-out",style:{width:"".concat(i,"%"),background:a}})}),s&&(0,tr.jsxs)("span",{className:"absolute right-0 -top-6 text-xs text-zinc-500",children:[i.toFixed(0),"%"]})]})},Dr=e=>{let{icon:t,title:n,description:a,action:r,onAction:s}=e;return(0,tr.jsxs)(Ar,{className:"text-center py-12",children:[(0,tr.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-zinc-700/50 flex items-center justify-center mx-auto mb-4",children:(0,tr.jsx)(t,{className:"w-8 h-8 text-zinc-600"})}),(0,tr.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:n}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm mb-6 max-w-sm mx-auto",children:a}),r&&(0,tr.jsx)("button",{onClick:s,className:"px-5 py-2.5 bg-white text-zinc-900 rounded-xl font-medium text-sm hover:bg-zinc-100 transition-colors",children:r})]})},Rr=e=>{let{label:t}=e,n=d(e,nr);return(0,tr.jsxs)("div",{children:[t&&(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:t}),(0,tr.jsx)("input",c(c({},n),{},{className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] focus:ring-1 focus:ring-[#3F3F46] transition-all"}))]})},Ir=e=>{let{label:t,children:n}=e,a=d(e,ar);return(0,tr.jsxs)("div",{children:[t&&(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:t}),(0,tr.jsx)("select",c(c({},a),{},{className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-[#3F3F46] transition-all appearance-none cursor-pointer",children:n}))]})},Lr=e=>{let{children:t,variant:n="primary",size:a="md",icon:r,className:s=""}=e,i=d(e,rr);return(0,tr.jsxs)("button",c(c({},i),{},{className:"".concat({primary:"bg-white text-zinc-900 hover:bg-zinc-100",secondary:"bg-zinc-700/50 text-white hover:bg-zinc-700",ghost:"bg-transparent text-zinc-400 hover:text-white hover:bg-white/5",danger:"bg-red-500/10 text-red-400 hover:bg-red-500/20"}[n]," ").concat({sm:"px-3 py-1.5 text-xs",md:"px-4 py-2.5 text-sm",lg:"px-6 py-3 text-base"}[a]," rounded-xl font-medium flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed ").concat(s),children:[r&&(0,tr.jsx)(r,{className:"w-4 h-4"}),t]}))},Mr=e=>{let{isOpen:t,onClose:n,title:a,children:r,size:s="md"}=e;if(!t)return null;return(0,tr.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm",onClick:n}),(0,tr.jsxs)("div",{className:"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full ".concat({sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"}[s]," max-h-[85vh] overflow-hidden animate-scaleIn"),children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between p-5 border-b border-[#334155]",children:[(0,tr.jsx)("h3",{className:"text-lg font-semibold text-white",children:a}),(0,tr.jsx)("button",{onClick:n,className:"text-zinc-500 hover:text-white transition-colors",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]}),(0,tr.jsx)("div",{className:"p-5 overflow-y-auto max-h-[calc(85vh-80px)]",children:r})]})]})},Ur=e=>{let{isOpen:t,onClose:n,title:a,children:r}=e;return t?(0,tr.jsxs)("div",{className:"fixed inset-0 z-50 md:flex md:items-center md:justify-center md:p-4",children:[(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm",onClick:n}),(0,tr.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 md:relative md:max-w-lg md:w-full bg-[#1e293b] border-t md:border border-[#334155] rounded-t-3xl md:rounded-2xl max-h-[90vh] overflow-hidden animate-slideUp",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between p-5 border-b border-[#334155]",children:[(0,tr.jsx)("h3",{className:"text-lg font-semibold text-white",children:a}),(0,tr.jsx)("button",{onClick:n,className:"text-zinc-500 hover:text-white transition-colors",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]}),(0,tr.jsx)("div",{className:"p-5 overflow-y-auto max-h-[calc(90vh-80px)]",children:r})]})]}):null},Fr=e=>{let{icon:t,label:n,active:a,onClick:r,accent:s,badge:i,isNew:o}=e;return(0,tr.jsxs)("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all relative ".concat(a?"bg-white/10 text-white":"text-zinc-400 hover:text-white hover:bg-white/5"),children:[(0,tr.jsx)(t,{className:"w-5 h-5",style:a?{color:s}:{}}),(0,tr.jsx)("span",{className:"font-medium flex-1",children:n}),i>0&&(0,tr.jsx)("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:i}),o&&(0,tr.jsx)("span",{className:"px-1.5 py-0.5 bg-emerald-500 text-white text-[10px] font-bold rounded animate-pulse",children:"LIVE"})]})},Br=e=>{let{phone:t,whatsapp:n,email:a,clienteName:r}=e;return(0,tr.jsxs)("div",{className:"flex gap-2",children:[t&&(0,tr.jsxs)("a",{href:"tel:".concat(t),className:"flex-1 bg-zinc-700/50 hover:bg-zinc-700 text-white rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors",children:[(0,tr.jsx)(oa,{className:"w-4 h-4"}),"Chiama"]}),(n||t)&&(0,tr.jsxs)("a",{href:jr(n||t,r?"Ciao ".concat(r,", "):""),target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors",children:[(0,tr.jsx)(la,{className:"w-4 h-4"}),"WhatsApp"]}),a&&(0,tr.jsxs)("a",{href:"mailto:".concat(a),className:"flex-1 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors",children:[(0,tr.jsx)(ca,{className:"w-4 h-4"}),"Email"]})]})},qr=e=>{let{isOpen:t,onClose:n,sales:r,clienti:s,tasks:i,onSelectSale:o,onSelectCliente:l,onSelectTask:c,setActiveTab:d}=e;const[u,h]=(0,a.useState)(""),p=(0,a.useRef)(null);if((0,a.useEffect)(()=>{t&&p.current&&p.current.focus(),t||h("")},[t]),!t)return null;const m=u.toLowerCase(),f=m.length>=2?r.filter(e=>"".concat(e.progetto," ").concat(e.developer," ").concat(e.zona," ").concat(e.cliente_nome," ").concat(e.agente).toLowerCase().includes(m)).slice(0,5):[],g=m.length>=2?s.filter(e=>"".concat(e.nome," ").concat(e.cognome," ").concat(e.telefono," ").concat(e.email).toLowerCase().includes(m)).slice(0,5):[],x=m.length>=2?i.filter(e=>"".concat(e.titolo," ").concat(e.descrizione).toLowerCase().includes(m)).slice(0,3):[],v=f.length>0||g.length>0||x.length>0;return(0,tr.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[15vh]",children:[(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm",onClick:n}),(0,tr.jsxs)("div",{className:"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-xl shadow-2xl overflow-hidden animate-scaleIn",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3 px-4 py-4 border-b border-[#334155]",children:[(0,tr.jsx)(da,{className:"w-5 h-5 text-zinc-500"}),(0,tr.jsx)("input",{ref:p,type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Cerca lead, clienti, task...",className:"flex-1 bg-transparent text-white text-lg placeholder:text-zinc-600 focus:outline-none"}),(0,tr.jsx)("kbd",{className:"hidden sm:flex items-center gap-1 px-2 py-1 bg-zinc-700/50 rounded text-xs text-zinc-500",children:"ESC"})]}),(0,tr.jsx)("div",{className:"max-h-[50vh] overflow-y-auto",children:u.length<2?(0,tr.jsxs)("div",{className:"p-8 text-center",children:[(0,tr.jsx)(ua,{className:"w-12 h-12 text-zinc-700 mx-auto mb-3"}),(0,tr.jsx)("p",{className:"text-zinc-500",children:"Digita almeno 2 caratteri per cercare"}),(0,tr.jsxs)("p",{className:"text-zinc-600 text-sm mt-2",children:["Premi ",(0,tr.jsx)("kbd",{className:"px-1.5 py-0.5 bg-zinc-700/50 rounded text-xs",children:"\u2318K"})," ovunque per aprire"]})]}):v?(0,tr.jsxs)("div",{className:"p-2",children:[f.length>0&&(0,tr.jsxs)("div",{className:"mb-2",children:[(0,tr.jsx)("div",{className:"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Lead / Vendite"}),f.map(e=>{var t;return(0,tr.jsxs)("button",{onClick:()=>{o(e),n()},className:"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors",children:[(0,tr.jsx)("div",{className:"w-2 h-8 rounded-full",style:{background:null===(t=vr.status[e.stato||"lead"])||void 0===t?void 0:t.color}}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium truncate",children:e.progetto||"TBD"}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-xs truncate",children:[e.developer," \u2022 ",e.cliente_nome||"No cliente"]})]}),(0,tr.jsx)(Er,{status:e.stato||"lead"})]},e.id)})]}),g.length>0&&(0,tr.jsxs)("div",{className:"mb-2",children:[(0,tr.jsx)("div",{className:"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Clienti"}),g.map(e=>(0,tr.jsxs)("button",{onClick:()=>{l(e),d("crm"),n()},className:"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors",children:[(0,tr.jsx)(zr,{nome:e.nome,cognome:e.cognome,size:"sm"}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsxs)("p",{className:"text-white text-sm font-medium truncate",children:[e.nome," ",e.cognome]}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs truncate",children:e.telefono||e.email||"No contatto"})]}),(0,tr.jsx)("span",{className:"text-amber-400 text-xs",children:e.stato})]},e.id))]}),x.length>0&&(0,tr.jsxs)("div",{children:[(0,tr.jsx)("div",{className:"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Task"}),x.map(e=>(0,tr.jsxs)("button",{onClick:()=>{d("tasks"),n()},className:"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors",children:[(0,tr.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat("completato"===e.stato?"bg-emerald-500/20":"bg-pink-500/20"),children:(0,tr.jsx)(ha,{className:"w-4 h-4 ".concat("completato"===e.stato?"text-emerald-400":"text-pink-400")})}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium truncate ".concat("completato"===e.stato?"line-through opacity-50":""),children:e.titolo}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs truncate",children:e.assegnato_a||"Non assegnato"})]}),(0,tr.jsx)(Er,{status:e.priorita,type:"priority"})]},e.id))]})]}):(0,tr.jsxs)("div",{className:"p-8 text-center text-zinc-500",children:['Nessun risultato per "',u,'"']})}),(0,tr.jsxs)("div",{className:"px-4 py-3 border-t border-[#334155] flex items-center justify-between text-xs text-zinc-600",children:[(0,tr.jsx)("span",{children:"KeyPrime Search"}),(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("span",{children:"Naviga con"}),(0,tr.jsx)("kbd",{className:"px-1.5 py-0.5 bg-zinc-700/50 rounded",children:"\u2191\u2193"}),(0,tr.jsx)("span",{children:"Seleziona con"}),(0,tr.jsx)("kbd",{className:"px-1.5 py-0.5 bg-zinc-700/50 rounded",children:"\u21b5"})]})]})]})]})};function Hr(){const[e,t]=(0,a.useState)("login"),[n,r]=(0,a.useState)(null),[s,i]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[d,u]=(0,a.useState)([]),[h,p]=(0,a.useState)([]),[m,f]=(0,a.useState)([]),[g,x]=(0,a.useState)([]),[v,b]=(0,a.useState)(!1),[y,w]=(0,a.useState)(null),[j,N]=(0,a.useState)(null),[k,_]=(0,a.useState)("dashboard"),[S,C]=(0,a.useState)(!1),[z,E]=(0,a.useState)(!1),[A,T]=(0,a.useState)(null),[O,P]=(0,a.useState)(null),[D,R]=(0,a.useState)(null),[I,L]=(0,a.useState)(null),[M,U]=(0,a.useState)(null),[F,B]=(0,a.useState)(null),[q,H]=(0,a.useState)(null),[V,W]=(0,a.useState)(!1),[K,G]=(0,a.useState)(!1),[J,$]=(0,a.useState)(null),[Q,Y]=(0,a.useState)({search:"",stato:""}),[X,Z]=(0,a.useState)({search:"",stato:""}),[ee,te]=(0,a.useState)("all"),[ne,ae]=(0,a.useState)(null),[re,se]=(0,a.useState)([]),[ie,oe]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),oe(!0)),"Escape"===e.key&&oe(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);const[le,ce]=(0,a.useState)(()=>{const e=localStorage.getItem("keyprime_read_notifications");return e?JSON.parse(e):[]}),de=function(e){return N({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})};(0,a.useEffect)(()=>{const e=localStorage.getItem("keyprime_user");if(e){const n=JSON.parse(e);r(n),_("admin"===n.ruolo?"dashboard":"home");const a="admin"===n.ruolo?"admin":"agente_admin"===n.ruolo?"agente":n.ruolo;t(a)}},[]);const ue=async()=>{b(!0);const{data:e}=await sr.from("sales_with_commissions").select("*").order("created_at",{ascending:!1});i(e||[]),b(!1)},he=async()=>{const{data:e}=await sr.from("user_credentials").select("*").order("created_at",{ascending:!1});l(e||[])},pe=async()=>{const{data:e}=await sr.from("clienti").select("*").order("created_at",{ascending:!1});u(e||[])},me=async()=>{const{data:e}=await sr.from("tasks").select("*").order("scadenza",{ascending:!0});p(e||[])},fe=async()=>{const{data:e}=await sr.from("lead_activities").select("*").order("created_at",{ascending:!1});f(e||[])},ge=async()=>{const{data:e}=await sr.from("follow_ups").select("*").order("data_reminder",{ascending:!0});x(e||[])},xe=async()=>{const{data:e}=await sr.from("saved_listings").select("*").eq("user_id",null===n||void 0===n?void 0:n.id).order("created_at",{ascending:!1});se(e||[])};(0,a.useEffect)(()=>{n&&(ue(),pe(),me(),fe(),ge(),xe(),"admin"===n.ruolo&&he())},[n]);const ve=async()=>{b(!0),de("Aggiornamento..."),await Promise.all([ue(),pe(),me(),fe(),ge(),xe(),"admin"===(null===n||void 0===n?void 0:n.ruolo)?he():Promise.resolve()]),b(!1),de("Dati aggiornati \u2713")},be=async(e,n)=>{b(!0),w(null);const{data:a}=await sr.from("user_credentials").select("*").eq("username",e).eq("password",n).eq("attivo",!0).single();if(!a)return w("Credenziali non valide"),void b(!1);r(a),localStorage.setItem("keyprime_user",JSON.stringify(a)),_("admin"===a.ruolo?"dashboard":"home");const s="admin"===a.ruolo?"admin":"agente_admin"===a.ruolo?"agente":a.ruolo;t(s),b(!1)},ye=()=>{r(null),localStorage.removeItem("keyprime_user"),t("login"),C(!1)},we=async e=>{await sr.from("user_credentials").update({password:e}).eq("id",n.id);const t=c(c({},n),{},{password:e});r(t),localStorage.setItem("keyprime_user",JSON.stringify(t)),W(!1),de("Password aggiornata")},je=async e=>{var t,a,r,s,i,o,l,c;const{error:d}=await sr.from("saved_listings").insert([{property_id:e.project_id,title:e.title,price:parseFloat(e.price_from)||0,location_full:null===(t=e.location)||void 0===t?void 0:t.full_name,location_path:(null===(a=e.location)||void 0===a?void 0:a.path_name)||(null===(r=e.location)||void 0===r?void 0:r.name),property_type:"off-plan",size:null,bedrooms:(null===(s=e.bedrooms)||void 0===s||null===(i=s.available)||void 0===i?void 0:i.join(","))||null,bathrooms:null,furnished:null,image_url:null===(o=e.images)||void 0===o||null===(l=o[0])||void 0===l?void 0:l.medium_image_url,pf_url:e.url,completion_status:e.construction_phase_key,agent_name:null===(c=e.developer)||void 0===c?void 0:c.name,agent_email:null,description:e.title,created_by:null===n||void 0===n?void 0:n.nome,user_id:null===n||void 0===n?void 0:n.id,property_data:e}]);d?(console.error("Save error:",d),de("Errore nel salvataggio")):(xe(),de("Progetto salvato \u2713"))},Ne=async e=>{await sr.from("saved_listings").delete().eq("property_id",e),xe(),de("Annuncio rimosso")},ke=async e=>{let t=e.cliente_id;if(e.newCliente&&e.newCliente.nome){const{data:a}=await sr.from("clienti").insert([{nome:e.newCliente.nome,cognome:e.newCliente.cognome||"",telefono:e.newCliente.telefono||"",email:e.newCliente.email||"",stato:"nuovo",fonte:"Off-Plan",agente_riferimento:null===n||void 0===n?void 0:n.nome,created_by:null===n||void 0===n?void 0:n.nome,referente:null===n||void 0===n?void 0:n.referente}]).select().single();a&&(t=a.id,e.cliente_nome="".concat(a.nome," ").concat(a.cognome),pe())}await sr.from("sales").insert([{data:(new Date).toISOString().split("T")[0],developer:e.developer,progetto:e.progetto,zona:e.zona,valore:e.valore||0,stato:"lead",agente:null===n||void 0===n?void 0:n.nome,referente:null===n||void 0===n?void 0:n.referente,cliente_id:t,inserted_by:null===n||void 0===n?void 0:n.nome,inserted_as:null===n||void 0===n?void 0:n.ruolo}]),"admin"!==(null===n||void 0===n?void 0:n.ruolo)&&await(async(e,t)=>{await Sr(or,"\ud83c\udfaf Nuovo Lead: ".concat(e.progetto),'<div style="font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px"><h2 style="color:#3b82f6">\ud83c\udfaf Nuovo Lead</h2><p style="font-size:18px;margin:16px 0"><strong>'.concat(e.progetto,'</strong></p><p style="color:#94a3b8">Zona: ').concat(e.zona||"N/A",'</p><p style="color:#94a3b8">Agente: ').concat(t,'</p><a href="https://keyprime-sales-1npw.vercel.app" style="display:inline-block;margin-top:20px;padding:12px 24px;background:#3b82f6;color:white;text-decoration:none;border-radius:8px">Apri KeyPrime</a></div>'))})({progetto:e.progetto,zona:e.zona},null===n||void 0===n?void 0:n.nome),ue(),de("Lead creato da Off-Plan")},_e=async e=>{if(!z){E(!0);try{let t=e.cliente_id;if(!t&&e.cliente_nome){const{data:a,error:r}=await sr.from("clienti").insert([{nome:e.cliente_nome,cognome:e.cliente_cognome,email:e.cliente_email,telefono:e.cliente_telefono,whatsapp:e.cliente_whatsapp,nazionalita:e.cliente_nazionalita,budget_min:e.cliente_budget_min?parseFloat(e.cliente_budget_min):null,budget_max:e.cliente_budget_max?parseFloat(e.cliente_budget_max):null,note:e.cliente_note,stato:"nuovo",fonte:"Agente",agente_riferimento:null===n||void 0===n?void 0:n.nome,created_by:null===n||void 0===n?void 0:n.nome,referente:null===n||void 0===n?void 0:n.referente}]).select().single();r&&console.error("Cliente error:",r),a&&(t=a.id)}const{error:a}=await sr.from("sales").insert([{data:e.data,developer:e.developer,progetto:e.progetto,zona:e.zona,valore:e.valore||0,agente:e.agente,segnalatore:e.segnalatore,referente:null===n||void 0===n?void 0:n.referente,commission_pct:5,inserted_by:null===n||void 0===n?void 0:n.nome,inserted_as:null===n||void 0===n?void 0:n.ruolo,pagato:!1,stato:e.stato||"lead",cliente_id:t}]);if(a)return console.error("Insert error:",a),de("Errore: "+a.message),void E(!1);de("Lead aggiunto"),T(null),ue(),pe()}catch(t){console.error("addLead error:",t),de("Errore salvataggio")}E(!1)}},Se=async e=>{if(!z){E(!0);try{let t=e.cliente_id;if(!t&&e.nuovo_cliente_nome){const{data:a,error:r}=await sr.from("clienti").insert([{nome:e.nuovo_cliente_nome,cognome:e.nuovo_cliente_cognome||"",telefono:e.nuovo_cliente_telefono||"",email:e.nuovo_cliente_email||"",stato:"acquistato",fonte:"Vendita",agente_riferimento:null===n||void 0===n?void 0:n.nome,created_by:null===n||void 0===n?void 0:n.nome,referente:null===n||void 0===n?void 0:n.referente}]).select().single();r&&console.error("Cliente error:",r),a&&(t=a.id)}e.cliente_id&&await sr.from("clienti").update({stato:"acquistato"}).eq("id",e.cliente_id);const{error:a}=await sr.from("sales").insert([{data:e.data,developer:e.developer,progetto:e.progetto,zona:e.zona,valore:e.valore,agente:e.agente,segnalatore:e.segnalatore,cliente_id:t,referente:null===n||void 0===n?void 0:n.referente,commission_pct:5,inserted_by:null===n||void 0===n?void 0:n.nome,inserted_as:null===n||void 0===n?void 0:n.ruolo,pagato:!1,stato:"venduto"}]);if(a)return console.error("Insert error:",a),de("Errore: "+a.message),void E(!1);de("Vendita registrata"),T(null),ue(),pe()}catch(t){console.error("addSale error:",t),de("Errore salvataggio")}E(!1)}},Ce=async(e,t)=>{const n=s.find(t=>t.id===e);null!==n&&void 0!==n&&n.cliente_id&&await sr.from("clienti").update({stato:"acquistato"}).eq("id",n.cliente_id),await sr.from("sales").update({stato:"venduto",valore:t}).eq("id",e),$(null),P(null),de("Vendita confermata!"),ue(),pe()},ze=async(e,t)=>{const n=s.find(t=>t.id===e);if("vinto"===t.stato&&"vinto"!==(null===n||void 0===n?void 0:n.stato)&&await(async(e,t)=>{await Sr(or,"\ud83c\udf89 Nuova Vendita: ".concat(e.progetto),'<div style="font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px"><h2 style="color:#10b981">\ud83c\udf89 Nuova Vendita Chiusa!</h2><p style="font-size:24px;margin:16px 0"><strong>'.concat(e.progetto,'</strong></p><p style="font-size:20px;color:#10b981">').concat(e.valore?e.valore.toLocaleString():0,' AED</p><p style="color:#94a3b8">Agente: ').concat(t,'</p><p style="color:#94a3b8">Developer: ').concat(e.developer||"N/A",'</p><a href="https://keyprime-sales-1npw.vercel.app" style="display:inline-block;margin-top:20px;padding:12px 24px;background:#10b981;color:white;text-decoration:none;border-radius:8px">Apri KeyPrime</a></div>'))})(n,n.agente||n.segnalatore||"N/A"),"incassato"===t.stato&&"incassato"!==(null===n||void 0===n?void 0:n.stato)&&await Sr(or,"\ud83d\udcb0 Incasso: ".concat(n.progetto),'<div style="font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px"><h2 style="color:#10b981">\ud83d\udcb0 Incasso Registrato!</h2><p style="font-size:24px;margin:16px 0"><strong>'.concat(n.progetto,'</strong></p><p style="font-size:20px;color:#10b981">').concat(br(n.valore)," AED</p></div>")),!0===t.pagato&&(null===n||void 0===n||!n.pagato)){const e=n.agente||n.segnalatore;if(e){const{data:t}=await sr.from("user_credentials").select("*").eq("nome",e).single();if(null!==t&&void 0!==t&&t.email){const e=Number(n.valore)*(n.commission_pct||5)/100*(n.agente?.7:.3);await Sr(t.email,"\ud83d\udcb0 Commissione",'<div style="font-family:-apple-system,sans-serif;padding:20px"><h2>Commissione Pagata!</h2><p>'.concat(n.progetto,": ").concat(br(e)," AED</p></div>"))}}}console.log("Updating sale:",e,t);const{error:a}=await sr.from("sales").update(t).eq("id",e);if(a)return console.error("Update error:",a),console.error("Error details:",JSON.stringify(a,null,2)),void de("Errore: "+(a.message||a.details||"Sconosciuto"));console.log("Update success, reloading..."),await ue(),de("Salvato")},Ee=async e=>{window.confirm("Eliminare questo lead?")&&(await sr.from("sales").delete().eq("id",e),de("Eliminato"),ue())},Ae=async e=>{await sr.from("clienti").insert([c(c({},e),{},{created_by:null===n||void 0===n?void 0:n.nome,referente:null===n||void 0===n?void 0:n.referente})]),pe(),L(null),de("Cliente creato")},Te=async(e,t)=>{await sr.from("clienti").update(t).eq("id",e),t.assegnato_a&&(await sr.from("sales").update({assegnato_a:t.assegnato_a}).eq("cliente_id",e),await ue()),await pe(),L(null),(null===D||void 0===D?void 0:D.id)===e&&R(e=>c(c({},e),t)),de("Salvato")},Oe=async function(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||window.confirm("Eliminare?"))&&(await sr.from("clienti").delete().eq("id",e),await pe(),R(null),de("Eliminato"))},Pe=async e=>{if(await sr.from("tasks").insert([c(c({},e),{},{created_by:null===n||void 0===n?void 0:n.nome})]),e.assegnato_a){const{data:t}=await sr.from("user_credentials").select("email").eq("nome",e.assegnato_a).single();null!==t&&void 0!==t&&t.email&&await(async(e,t)=>{t&&await Sr(t,"\ud83d\udccb Nuovo Task: ".concat(e.titolo),'<div style="font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px"><h2 style="color:#a78bfa">\ud83d\udccb Nuovo Task Assegnato</h2><p style="font-size:18px;margin:16px 0"><strong>'.concat(e.titolo,'</strong></p><p style="color:#94a3b8">Priorit\xe0: ').concat(e.priorita||"normale",'</p><p style="color:#94a3b8">Scadenza: ').concat(e.scadenza?new Date(e.scadenza).toLocaleDateString("it-IT"):"Nessuna","</p>").concat(e.descrizione?'<p style="margin-top:16px;padding:12px;background:#1e293b;border-radius:8px">'.concat(e.descrizione,"</p>"):"",'<a href="https://keyprime-sales-1npw.vercel.app" style="display:inline-block;margin-top:20px;padding:12px 24px;background:#8b5cf6;color:white;text-decoration:none;border-radius:8px">Apri KeyPrime</a></div>'))})(e,t.email)}me(),U(null),de("Task creato")},De=async e=>{const t=h.find(t=>t.id===e);await sr.from("tasks").update({stato:"completato",completed_at:(new Date).toISOString()}).eq("id",e),t&&"admin"!==(null===n||void 0===n?void 0:n.ruolo)&&await(async(e,t)=>{await Sr(or,"\u2705 Task completato: ".concat(e.titolo),'<div style="font-family:-apple-system,sans-serif;padding:20px"><h2>Task Completato</h2><p><strong>'.concat(e.titolo,"</strong></p><p>Completato da: ").concat(t,"</p></div>"))})(t,null===n||void 0===n?void 0:n.nome),de("Completato!"),me()},Re=async(e,t)=>{const a=h.find(t=>t.id===e);await sr.from("tasks").update({note:t}).eq("id",e),a&&"admin"!==(null===n||void 0===n?void 0:n.ruolo)&&await(async(e,t,n)=>{await Sr(or,"\ud83d\udcac Nota: ".concat(e.titolo),'<div style="font-family:-apple-system,sans-serif;padding:20px"><h2>Nuova Nota</h2><p><strong>'.concat(e.titolo,"</strong></p><p>Da: ").concat(t,"</p><p>Nota: ").concat(n,"</p></div>"))})(a,null===n||void 0===n?void 0:n.nome,t),me(),H(null),de("Nota inviata")},Ie=async e=>{window.confirm("Eliminare?")&&(await sr.from("tasks").delete().eq("id",e),me())},Le=async(e,t,a)=>{await sr.from("lead_activities").insert([{sale_id:e,tipo:t,contenuto:a,created_by:null===n||void 0===n?void 0:n.nome}]),fe(),de("Attivit\xe0 registrata")},Me=async e=>{await sr.from("lead_activities").delete().eq("id",e),fe()},Ue=async e=>{await sr.from("follow_ups").insert([c(c({},e),{},{assegnato_a:e.assegnato_a||(null===n||void 0===n?void 0:n.nome)})]),ge(),de("Follow-up programmato")},Fe=async e=>{await sr.from("follow_ups").update({completato:!0}).eq("id",e),ge(),de("Follow-up completato")},Be=async e=>{await sr.from("follow_ups").delete().eq("id",e),ge()},qe=async e=>{await sr.from("user_credentials").insert([e]),he(),B(null),de("Utente creato")},He=async e=>{window.confirm("Eliminare?")&&(await sr.from("user_credentials").delete().eq("id",e),he())},Ve=s.filter(e=>!(Q.search&&!"".concat(e.progetto," ").concat(e.developer," ").concat(e.agente," ").concat(e.cliente_nome).toLowerCase().includes(Q.search.toLowerCase()))&&(!Q.stato||e.stato===Q.stato)),We=d.filter(e=>!(X.search&&!"".concat(e.nome," ").concat(e.cognome," ").concat(e.email," ").concat(e.telefono).toLowerCase().includes(X.search.toLowerCase()))&&(!X.stato||e.stato===X.stato)),Ke=h.filter(e=>"pending"===e.stato&&("admin"===(null===n||void 0===n?void 0:n.ruolo)||e.assegnato_a===(null===n||void 0===n?void 0:n.nome))),Ge=Ke.filter(e=>Nr(e.scadenza)),Je=Ke.filter(e=>kr(e.scadenza)),$e=g.filter(e=>!e.completato&&("admin"===(null===n||void 0===n?void 0:n.ruolo)||e.assegnato_a===(null===n||void 0===n?void 0:n.nome))),Qe=$e.filter(e=>kr(e.data_reminder)),Ye=$e.filter(e=>Nr(e.data_reminder)),Xe="admin"===(null===n||void 0===n?void 0:n.ruolo)?Ke.filter(e=>Nr(e.scadenza)||kr(e.scadenza)):Ke,Ze="admin"===(null===n||void 0===n?void 0:n.ruolo)?s.filter(e=>{const t=new Date(e.created_at);return(new Date-t)/36e5<=24&&!le.includes("sale_"+e.id)}):[],et=[...Xe.filter(e=>{const t=le.includes("task_".concat(e.id,"_").concat(null===n||void 0===n?void 0:n.id));return"admin"!==(null===n||void 0===n?void 0:n.ruolo)?!t&&(e.created_by!==(null===n||void 0===n?void 0:n.nome)||Nr(e.scadenza)):!t}).map(e=>"task_".concat(e.id,"_").concat(null===n||void 0===n?void 0:n.id)),...Ze.map(e=>"sale_"+e.id)],tt=et.length,nt=e=>{const t=[...new Set([...le,e])];ce(t),localStorage.setItem("keyprime_read_notifications",JSON.stringify(t))};if("login"===e)return(0,tr.jsx)("div",{className:"min-h-screen bg-[#0f172a] flex items-center justify-center p-6",children:(0,tr.jsxs)("div",{className:"w-full max-w-sm",children:[(0,tr.jsxs)("div",{className:"text-center mb-10",children:[(0,tr.jsx)("img",{src:"/logo.png",alt:"KeyPrime",className:"h-20 mx-auto mb-4"}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Real Estate CRM"})]}),y&&(0,tr.jsx)("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 rounded-xl px-4 py-3 mb-6 text-sm",children:y}),(0,tr.jsx)(as,{onLogin:be,loading:v})]})});if("agente"===e||"segnalatore"===e){var at;const t="agente_admin"===(null===n||void 0===n?void 0:n.ruolo)?"agente":e,a="agente_admin"===(null===n||void 0===n?void 0:n.ruolo),r=s.filter(e=>"agente"===t?e.agente===(null===n||void 0===n?void 0:n.nome):e.segnalatore===(null===n||void 0===n?void 0:n.nome)),i=h.filter(e=>e.assegnato_a===(null===n||void 0===n?void 0:n.nome)&&"pending"===e.stato),o=d.filter(e=>e.created_by===(null===n||void 0===n?void 0:n.nome)||e.agente_riferimento===(null===n||void 0===n?void 0:n.nome)),l="agente"===t||a?.7:.3,c=r.filter(e=>"venduto"===e.stato||"incassato"===e.stato),u=c.reduce((e,t)=>e+Number(t.valore)*(t.commission_pct||5)/100*l,0),p=c.filter(e=>e.pagato).reduce((e,t)=>e+Number(t.valore)*(t.commission_pct||5)/100*l,0),f=mr.reduce((e,t)=>(e[t]=r.filter(e=>(e.stato||"lead")===t),e),{}),x=[{id:"home",icon:pa,label:"Home",accent:vr.sections.dashboard.accent},{id:"leads",icon:ma,label:"Lead",accent:vr.sections.pipeline.accent},{id:"pipeline",icon:fa,label:"Pipeline",accent:vr.sections.vendite.accent},{id:"offplan",icon:ga,label:"Off-Plan",accent:vr.sections.offplan.accent,isNew:!0},{id:"calculator",icon:xa,label:"Calcolatore ROI",accent:vr.sections.calculator.accent,isNew:!0},{id:"tasks",icon:ha,label:"Task",accent:vr.sections.tasks.accent,badge:i.length},{id:"settings",icon:va,label:"Account",accent:vr.sections.utenti.accent}];return A?(0,tr.jsxs)("div",{className:"min-h-screen bg-[#0f172a]",children:[(0,tr.jsx)("div",{className:"sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155] px-4 py-4",children:(0,tr.jsxs)("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[(0,tr.jsxs)("button",{onClick:()=>T(null),className:"text-zinc-400 hover:text-white flex items-center gap-2 transition-colors",children:[(0,tr.jsx)(ba,{className:"w-5 h-5"}),"Indietro"]}),(0,tr.jsx)("span",{className:"text-white font-semibold",children:"lead"===A?"Nuovo Lead":"Nuova Vendita"}),(0,tr.jsx)("div",{className:"w-20"})]})}),(0,tr.jsxs)("div",{className:"p-4 pb-32 max-w-lg mx-auto",children:["lead"===A&&(0,tr.jsx)(ms,{type:t,userName:null===n||void 0===n?void 0:n.nome,clienti:o,onSubmit:_e}),"vendita"===A&&(0,tr.jsx)(fs,{type:t,userName:null===n||void 0===n?void 0:n.nome,clienti:o,onSubmit:Se})]}),(0,tr.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-[#0f172a]/95 backdrop-blur-xl border-t border-[#334155]",children:(0,tr.jsx)(Lr,{onClick:()=>{var e;return null===(e=document.getElementById("submitBtn"))||void 0===e?void 0:e.click()},className:"w-full py-4",disabled:z,children:z?(0,tr.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,tr.jsx)(ya,{className:"w-4 h-4 animate-spin"})," Salvataggio..."]}):"lead"===A?"Salva Lead":"Registra Vendita"})})]}):(0,tr.jsxs)("div",{className:"min-h-screen bg-[#0f172a] lg:flex",children:[(0,tr.jsxs)("aside",{className:"hidden lg:flex flex-col w-64 border-r border-[#334155] bg-[#1e293b] p-4 fixed h-full",children:[(0,tr.jsx)("div",{className:"mb-8",children:(0,tr.jsx)("img",{src:"/logo.png",alt:"KeyPrime",className:"h-16"})}),(0,tr.jsx)("nav",{className:"space-y-1 flex-1",children:x.map(e=>(0,tr.jsx)(Fr,{icon:e.icon,label:e.label,active:k===e.id,onClick:()=>_(e.id),accent:e.accent,badge:e.badge,isNew:e.isNew},e.id))}),(0,tr.jsx)("div",{className:"pt-4 border-t border-[#334155]",children:(0,tr.jsxs)("div",{className:"flex items-center gap-3 px-2 py-2",children:[(0,tr.jsx)(zr,{nome:null===n||void 0===n?void 0:n.nome,size:"sm"}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium truncate",children:null===n||void 0===n?void 0:n.nome}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs capitalize",children:t})]}),(0,tr.jsx)("button",{onClick:ye,className:"text-zinc-500 hover:text-white",children:(0,tr.jsx)(wa,{className:"w-4 h-4"})})]})})]}),(0,tr.jsxs)("div",{className:"flex-1 lg:ml-64 pb-24 lg:pb-0",children:[(0,tr.jsx)("div",{className:"lg:hidden sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]",children:(0,tr.jsxs)("div",{className:"flex items-center justify-between px-4 py-4",children:[(0,tr.jsx)("img",{src:"/logo.png",alt:"KeyPrime",className:"h-12"}),(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("button",{onClick:ve,className:"p-2 text-zinc-400 hover:text-white",title:"Aggiorna",children:(0,tr.jsx)(ya,{className:"w-5 h-5 ".concat(v?"animate-spin":"")})}),(0,tr.jsxs)("button",{onClick:()=>G(!0),className:"relative p-2 text-zinc-400 hover:text-white",children:[(0,tr.jsx)(ja,{className:"w-5 h-5"}),tt>0&&(0,tr.jsx)("span",{className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:tt})]}),(0,tr.jsx)(zr,{nome:null===n||void 0===n?void 0:n.nome,size:"sm"})]})]})}),(0,tr.jsx)("div",{className:"hidden lg:block sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]",children:(0,tr.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("h1",{className:"text-xl font-semibold text-white capitalize",children:"home"===k?"Ciao, ".concat(null===n||void 0===n?void 0:n.nome):null===(at=x.find(e=>e.id===k))||void 0===at?void 0:at.label}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm",children:["home"===k&&"Il tuo riepilogo","leads"===k&&"".concat(r.length," lead totali"),"pipeline"===k&&"Stato dei tuoi lead","offplan"===k&&"Progetti Off-Plan","calculator"===k&&"Calcola rendimenti immobiliari UAE","tasks"===k&&"".concat(i.length," task pendenti")]})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsxs)("button",{onClick:()=>G(!0),className:"relative p-2 text-zinc-400 hover:text-white bg-[#334155] rounded-xl",children:[(0,tr.jsx)(ja,{className:"w-5 h-5"}),tt>0&&(0,tr.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:tt})]}),(0,tr.jsx)("button",{onClick:ve,className:"p-2 text-zinc-400 hover:text-white bg-[#334155] rounded-xl",title:"Aggiorna",children:(0,tr.jsx)(ya,{className:"w-5 h-5"})}),(0,tr.jsx)(Lr,{onClick:()=>T("lead"),icon:Na,children:"Nuovo Lead"}),(0,tr.jsx)(Lr,{onClick:()=>T("vendita"),variant:"secondary",icon:ka,children:"Vendita"})]})]})}),(0,tr.jsxs)("div",{className:"p-4 lg:p-6 space-y-6",children:["home"===k&&(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsxs)("div",{className:"lg:hidden grid grid-cols-2 gap-3",children:[(0,tr.jsxs)("button",{onClick:()=>T("lead"),className:"bg-gradient-to-br from-blue-500/20 to-blue-600/10 border border-blue-500/20 rounded-2xl p-5 text-left",children:[(0,tr.jsx)(ma,{className:"w-6 h-6 text-blue-400 mb-3"}),(0,tr.jsx)("span",{className:"text-white font-medium block",children:"Nuovo Lead"})]}),(0,tr.jsxs)("button",{onClick:()=>T("vendita"),className:"bg-gradient-to-br from-emerald-500/20 to-emerald-600/10 border border-emerald-500/20 rounded-2xl p-5 text-left",children:[(0,tr.jsx)(ka,{className:"w-6 h-6 text-emerald-400 mb-3"}),(0,tr.jsx)("span",{className:"text-white font-medium block",children:"Vendita"})]})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,tr.jsx)(Or,{label:"Lead Attivi",value:r.filter(e=>"venduto"!==e.stato&&"incassato"!==e.stato).length,icon:ma,color:"#60A5FA",onClick:()=>_("leads")}),(0,tr.jsx)(Or,{label:"Vendite (SPA)",value:c.length,icon:_a,color:"#34D399"}),(0,tr.jsx)(Or,{label:"Comm. Maturate",value:br(u),icon:ka,color:"#FBBF24"}),(0,tr.jsx)(Or,{label:"Comm. Pagate",value:br(p),icon:na,color:"#34D399"})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("h3",{className:"text-white font-medium mb-4",children:"Pipeline"}),(0,tr.jsx)("div",{className:"grid grid-cols-5 gap-2",children:mr.map(e=>{var t,n,a;return(0,tr.jsxs)("div",{className:"text-center",children:[(0,tr.jsx)("div",{className:"rounded-xl py-3 px-2",style:{background:(null===(t=vr.status[e])||void 0===t?void 0:t.bg)||"#334155"},children:(0,tr.jsx)("p",{className:"text-2xl font-bold",style:{color:(null===(n=vr.status[e])||void 0===n?void 0:n.color)||"#fff"},children:(null===(a=f[e])||void 0===a?void 0:a.length)||0})}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 mt-2",children:fr[e]||e})]},e)})})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,tr.jsx)("span",{className:"text-white font-medium",children:"Commissioni"}),(0,tr.jsxs)("span",{className:"text-zinc-400 text-sm",children:[br(u)," AED maturate"]})]}),(0,tr.jsx)(Pr,{value:p,max:u||1,color:"#34D399"}),(0,tr.jsxs)("div",{className:"flex justify-between mt-3 text-sm",children:[(0,tr.jsxs)("span",{className:"text-emerald-400",children:["\u2713 Pagate: ",br(p)," AED"]}),(0,tr.jsxs)("span",{className:"text-amber-400",children:["\u23f3 Pending: ",br(u-p)," AED"]})]})]}),i.length>0&&(0,tr.jsx)(Ar,{hover:!0,onClick:()=>_("tasks"),className:"border-pink-500/20 bg-pink-500/5",children:(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-pink-500/20 flex items-center justify-center",children:(0,tr.jsx)(ha,{className:"w-6 h-6 text-pink-400"})}),(0,tr.jsx)("div",{className:"flex-1",children:(0,tr.jsxs)("p",{className:"text-white font-medium",children:[i.length," task da completare"]})}),(0,tr.jsx)(aa,{className:"w-5 h-5 text-zinc-500"})]})}),(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,tr.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Lead Aperti"}),(0,tr.jsx)("button",{onClick:()=>_("leads"),className:"text-sm text-violet-400",children:"Tutti \u2192"})]}),0===r.filter(e=>"lead"===e.stato||"trattativa"===e.stato||"EOI"===e.stato).length?(0,tr.jsx)(Ar,{padding:"p-6",className:"text-center",children:(0,tr.jsx)("p",{className:"text-zinc-500",children:"Nessun lead aperto"})}):(0,tr.jsx)("div",{className:"grid gap-3 lg:grid-cols-2",children:r.filter(e=>"lead"===e.stato||"trattativa"===e.stato||"EOI"===e.stato).slice(0,4).map(e=>{var t;return(0,tr.jsx)(Ar,{hover:!0,onClick:()=>P(e),padding:"p-4",children:(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsx)("div",{className:"w-1 h-12 rounded-full",style:{background:null===(t=vr.status[e.stato||"lead"])||void 0===t?void 0:t.color}}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-white font-medium truncate",children:e.progetto}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:e.developer})]}),(0,tr.jsxs)("div",{className:"text-right",children:[(0,tr.jsx)("p",{className:"text-emerald-400 font-medium",children:e.valore>0?br(e.valore):"TBD"}),(0,tr.jsx)(Er,{status:e.stato||"lead"})]})]})},e.id)})})]}),c.length>0&&(0,tr.jsxs)("div",{className:"mt-6",children:[(0,tr.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,tr.jsx)("h2",{className:"text-lg font-semibold text-white",children:"\ud83c\udf89 Vendite Confermate"})}),(0,tr.jsx)("div",{className:"grid gap-3 lg:grid-cols-2",children:c.slice(0,4).map(e=>(0,tr.jsx)(Ar,{hover:!0,onClick:()=>P(e),padding:"p-4",className:"border-emerald-500/20",children:(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsx)("div",{className:"w-1 h-12 rounded-full bg-emerald-500"}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-white font-medium truncate",children:e.progetto}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:e.developer})]}),(0,tr.jsxs)("div",{className:"text-right",children:[(0,tr.jsx)("p",{className:"text-emerald-400 font-medium",children:br(e.valore)}),(0,tr.jsx)(Er,{status:e.stato})]})]})},e.id))})]})]}),"leads"===k&&(0,tr.jsx)(Wr,{leads:r,clienti:d,onSelectLead:P,onUpdateStatus:(e,t)=>ze(e,{stato:t}),onDelete:Ee,theme:vr,users:[],isAdmin:!1}),"pipeline"===k&&(0,tr.jsxs)("div",{className:"space-y-6",children:[(0,tr.jsx)("div",{className:"grid grid-cols-5 gap-3",children:mr.map(e=>{var t,n;return(0,tr.jsxs)(Ar,{padding:"p-4",className:"text-center",children:[(0,tr.jsx)("p",{className:"text-3xl font-bold",style:{color:null===(t=vr.status[e])||void 0===t?void 0:t.color},children:(null===(n=f[e])||void 0===n?void 0:n.length)||0}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:fr[e]||e})]},e)})}),(0,tr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:mr.map(e=>{var t,n;return(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,tr.jsx)("div",{className:"w-3 h-3 rounded-full",style:{background:null===(t=vr.status[e])||void 0===t?void 0:t.color}}),(0,tr.jsx)("span",{className:"text-white font-medium text-sm",children:fr[e]||e}),(0,tr.jsxs)("span",{className:"text-zinc-500 text-xs",children:["(",(null===(n=f[e])||void 0===n?void 0:n.length)||0,")"]})]}),(0,tr.jsxs)("div",{className:"space-y-2",children:[(f[e]||[]).map(t=>{var n;return(0,tr.jsxs)(Ar,{hover:!0,onClick:()=>P(t),padding:"p-3",className:"border-l-2",style:{borderLeftColor:null===(n=vr.status[e])||void 0===n?void 0:n.color},children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium truncate",children:t.progetto}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:t.developer}),t.valore>0&&(0,tr.jsx)("p",{className:"text-emerald-400 text-sm mt-1",children:br(t.valore)})]},t.id)}),(!f[e]||0===f[e].length)&&(0,tr.jsx)("div",{className:"text-center py-4 text-zinc-600 text-xs",children:"Nessun lead"})]})]},e)})})]}),"tasks"===k&&(0,tr.jsx)(Qr,{tasks:i,allTasks:h.filter(e=>e.assegnato_a===(null===n||void 0===n?void 0:n.nome)),clienti:d,onComplete:De,onAddNote:e=>H(e)}),"offplan"===k&&(0,tr.jsx)(es,{clienti:o,onCreateLead:ke,savedListings:re,onSaveListing:je,onRemoveListing:Ne,user:n}),"calculator"===k&&(0,tr.jsx)(bs,{}),"settings"===k&&(0,tr.jsxs)(Ar,{className:"max-w-lg",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,tr.jsx)(zr,{nome:null===n||void 0===n?void 0:n.nome,size:"lg"}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-xl font-semibold text-white",children:null===n||void 0===n?void 0:n.nome}),(0,tr.jsx)("p",{className:"text-zinc-500",children:t})]})]}),(0,tr.jsxs)("div",{className:"space-y-2",children:[(0,tr.jsx)(Lr,{variant:"secondary",icon:Sa,onClick:()=>W(!0),className:"w-full justify-start",children:"Cambia Password"}),(0,tr.jsx)(Lr,{variant:"danger",icon:wa,onClick:ye,className:"w-full justify-start",children:"Esci"})]})]})]}),(0,tr.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-[#0f172a]/95 backdrop-blur-xl border-t border-[#334155] px-4 py-2 z-30",children:(0,tr.jsx)("div",{className:"flex justify-around",children:x.map(e=>(0,tr.jsxs)("button",{onClick:()=>_(e.id),className:"flex flex-col items-center py-2 px-3 ".concat(k===e.id?"text-white":"text-zinc-500"),children:[(0,tr.jsx)(e.icon,{className:"w-6 h-6",style:k===e.id?{color:e.accent}:{}}),(0,tr.jsx)("span",{className:"text-xs mt-1",children:e.label})]},e.id))})})]}),O&&(0,tr.jsx)(rs,{sale:O,cliente:d.find(e=>e.id===(null===O||void 0===O?void 0:O.cliente_id)),rate:l,onClose:()=>P(null),onUpdateSale:ze,onConvert:()=>$(O),activities:m.filter(e=>e.sale_id===(null===O||void 0===O?void 0:O.id)),followUps:g.filter(e=>e.sale_id===(null===O||void 0===O?void 0:O.id)),onAddActivity:Le,onCreateFollowUp:Ue,onCompleteFollowUp:Fe,onDeleteActivity:Me,onDeleteFollowUp:Be,userName:null===n||void 0===n?void 0:n.nome}),J&&(0,tr.jsx)(ss,{sale:J,onConvert:Ce,onCancel:()=>$(null)}),K&&(0,tr.jsx)(is,{tasks:Xe,unreadIds:et,recentSales:Ze,onClose:()=>{G(!1)},onGoToTask:()=>{G(!1),_("tasks")},onMarkAsRead:nt,userId:null===n||void 0===n?void 0:n.id}),V&&(0,tr.jsx)(os,{currentPassword:null===n||void 0===n?void 0:n.password,onSave:we,onClose:()=>W(!1)}),q&&(0,tr.jsx)(ls,{task:q,onSave:Re,onClose:()=>H(null)}),j&&(0,tr.jsx)(Cr,{message:j.message,type:j.type,onClose:()=>N(null)})]})}if("admin"===e){const e=(e=>{if("all"===ee)return e;const t=parseInt(ee),n=new Date;return n.setDate(n.getDate()-t),e.filter(e=>e.data&&new Date(e.data)>=n)})(s),t=e.filter(e=>"venduto"===e.stato||"incassato"===e.stato),a=e.reduce((e,t)=>{const n=Number(t.valore)*(t.commission_pct||5)/100,a=o.find(e=>e.nome===t.agente&&("agente"===e.ruolo||"agente_admin"===e.ruolo)),r="agente_admin"===(null===a||void 0===a?void 0:a.ruolo);let s,i,l,c;if(r)"Giovanni"===t.referente?(s=.7*n,i=0,c=0,l=.3*n):(s=.3*n,i=0,c=0,l=.7*n);else{s=t.agente?.7*n:0,i=t.segnalatore?.3*n:0;const e=n-s-i;l="Pellegrino"===t.referente?.7*e:"Giovanni"===t.referente?.3*e:0,c="Giovanni"===t.referente?.7*e:"Pellegrino"===t.referente?.3*e:0}const d=r?0:n-s-(t.segnalatore?.3*n:0);return{valore:e.valore+Number(t.valore),comm:e.comm+n,ag:e.ag+s,sg:e.sg+(t.segnalatore&&!r?.3*n:0),netto:e.netto+d,pell:e.pell+l,giov:e.giov+c}},{valore:0,comm:0,ag:0,sg:0,netto:0,pell:0,giov:0}),r=mr.reduce((t,n)=>(t[n]=e.filter(e=>(e.stato||"lead")===n),t),{}),i=e.reduce((e,t)=>{var n;const a=(null===(n=t.data)||void 0===n?void 0:n.substring(0,7))||"N/A";return e[a]=(e[a]||0)+Number(t.valore),e},{}),l=e.reduce((e,t)=>(t.agente&&(e[t.agente]=(e[t.agente]||0)+Number(t.valore)),e),{}),c=e.reduce((e,t)=>(t.zona&&(e[t.zona]=(e[t.zona]||0)+Number(t.valore)),e),{}),u=h.filter(e=>"pending"===e.stato),p=[{id:"dashboard",icon:pa,label:"Dashboard",accent:vr.sections.dashboard.accent},{id:"commissioni",icon:Ca,label:"Commissioni",accent:"#10B981"},{id:"vendite",icon:ka,label:"Vendite",accent:vr.sections.vendite.accent},{id:"pipeline",icon:fa,label:"Pipeline",accent:vr.sections.pipeline.accent},{id:"crm",icon:za,label:"CRM",accent:vr.sections.crm.accent},{id:"offplan",icon:ga,label:"Off-Plan",accent:vr.sections.offplan.accent,isNew:!0},{id:"calculator",icon:xa,label:"Calcolatore ROI",accent:vr.sections.calculator.accent,isNew:!0},{id:"tasks",icon:ha,label:"Task",accent:vr.sections.tasks.accent,badge:u.length},{id:"followups",icon:Ea,label:"Follow-up",accent:"#A855F7",badge:Qe.length+Ye.length},{id:"utenti",icon:va,label:"Team",accent:vr.sections.utenti.accent}];return(0,tr.jsxs)("div",{className:"min-h-screen bg-[#0f172a] flex",children:[(0,tr.jsxs)("aside",{className:"hidden lg:flex flex-col w-64 border-r border-[#334155] bg-[#1e293b] p-4",children:[(0,tr.jsx)("div",{className:"mb-8",children:(0,tr.jsx)("img",{src:"/logo.png",alt:"KeyPrime",className:"h-20"})}),(0,tr.jsx)("nav",{className:"space-y-1 flex-1",children:p.map(e=>(0,tr.jsx)(Fr,{icon:e.icon,label:e.label,active:k===e.id,onClick:()=>{_(e.id),R(null)},accent:e.accent,badge:e.badge,isNew:e.isNew},e.id))}),(0,tr.jsx)("div",{className:"border-t border-[#334155] pt-4 mt-4",children:(0,tr.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3",children:[(0,tr.jsx)(zr,{nome:null===n||void 0===n?void 0:n.nome,size:"sm"}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-sm font-medium text-white truncate",children:null===n||void 0===n?void 0:n.nome}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Admin"})]}),(0,tr.jsx)("button",{onClick:ye,className:"text-zinc-500 hover:text-white transition-colors",children:(0,tr.jsx)(wa,{className:"w-4 h-4"})})]})})]}),(0,tr.jsxs)("main",{className:"flex-1 overflow-auto",children:[(0,tr.jsxs)("div",{className:"lg:hidden sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between px-4 py-4",children:[(0,tr.jsx)("button",{onClick:()=>C(!0),className:"text-zinc-400",children:(0,tr.jsx)(Aa,{className:"w-6 h-6"})}),(0,tr.jsx)("img",{src:"/logo.png",alt:"KeyPrime",className:"h-16"}),(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("button",{onClick:ve,className:"text-zinc-400 hover:text-white",title:"Aggiorna",children:(0,tr.jsx)(ya,{className:"w-5 h-5 ".concat(v?"animate-spin":"")})}),(0,tr.jsxs)("button",{onClick:()=>G(!0),className:"relative text-zinc-400",children:[(0,tr.jsx)(ja,{className:"w-5 h-5"}),tt>0&&(0,tr.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center",children:tt})]})]})]}),(0,tr.jsx)("div",{className:"flex gap-1 px-4 pb-3 overflow-x-auto",children:p.map(e=>(0,tr.jsxs)("button",{onClick:()=>{_(e.id),R(null)},className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all ".concat(k===e.id?"text-white":"text-zinc-500 hover:text-white"),style:k===e.id?{background:"".concat(e.accent,"20"),color:e.accent}:{},children:[(0,tr.jsx)(e.icon,{className:"w-4 h-4"}),e.label,e.badge>0&&(0,tr.jsx)("span",{className:"px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full",children:e.badge})]},e.id))})]}),(0,tr.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,tr.jsxs)("div",{className:"hidden lg:flex items-center justify-between mb-8",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("h1",{className:"text-2xl font-semibold text-white capitalize",children:k}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm mt-1",children:["dashboard"===k&&"Panoramica generale","vendite"===k&&"".concat(s.length," transazioni totali"),"pipeline"===k&&"Gestisci il flusso di vendita","crm"===k&&"".concat(d.length," clienti in database"),"offplan"===k&&"Progetti Off-Plan \u2022 ".concat(re.length," salvati"),"calculator"===k&&"Calcola rendimenti immobiliari UAE","tasks"===k&&"".concat(u.length," task da completare"),"followups"===k&&"".concat(Qe.length+Ye.length," follow-up da gestire"),"commissioni"===k&&"".concat(br(a.comm)," AED commissioni totali"),"utenti"===k&&"".concat(o.length," membri del team")]})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsxs)("button",{onClick:()=>oe(!0),className:"hidden lg:flex items-center gap-2 px-4 py-2 bg-zinc-700/50 hover:bg-zinc-700 rounded-xl text-zinc-400 text-sm transition-colors",children:[(0,tr.jsx)(da,{className:"w-4 h-4"}),(0,tr.jsx)("span",{children:"Cerca..."}),(0,tr.jsx)("kbd",{className:"ml-2 px-1.5 py-0.5 bg-zinc-700 rounded text-xs",children:"\u2318K"})]}),(0,tr.jsxs)("button",{onClick:()=>G(!0),className:"relative p-2 text-zinc-400 hover:text-white transition-colors",children:[(0,tr.jsx)(ja,{className:"w-5 h-5"}),tt>0&&(0,tr.jsx)("span",{className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:tt})]}),(0,tr.jsx)(Lr,{variant:"secondary",icon:ya,onClick:ve,children:"Aggiorna"})]})]}),"dashboard"===k&&(0,tr.jsxs)("div",{className:"space-y-6",children:[(0,tr.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,tr.jsx)("div",{className:"flex gap-2",children:[{id:"all",label:"Tutto"},{id:"30",label:"30 giorni"},{id:"60",label:"60 giorni"},{id:"90",label:"90 giorni"}].map(e=>(0,tr.jsx)("button",{onClick:()=>te(e.id),className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat(ee===e.id?"bg-violet-500/20 text-violet-400":"bg-zinc-700/50 text-zinc-400 hover:text-white"),children:e.label},e.id))}),(0,tr.jsx)(Lr,{variant:"secondary",icon:Ta,onClick:()=>((e,t,n,a,r)=>{const s=(new Date).toLocaleDateString("it-IT",{day:"2-digit",month:"long",year:"numeric"}),i=Object.entries(a).sort((e,t)=>t[1]-e[1]).slice(0,5),o=Object.entries(r).sort((e,t)=>t[1]-e[1]).slice(0,5),l=t.length>0?(n.length/t.length*100).toFixed(1):0,c='<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>KeyPrime Report - '.concat(s,'</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', sans-serif; padding: 40px; max-width: 900px; margin: 0 auto; color: #1a1a1a; }\n    .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 2px solid #f0f0f0; }\n    .logo { font-size: 28px; font-weight: 700; color: #1e293b; }\n    .logo span { color: #A78BFA; }\n    .date { color: #666; font-size: 14px; }\n    h1 { font-size: 24px; font-weight: 600; margin-bottom: 8px; }\n    h2 { font-size: 16px; font-weight: 600; color: #666; margin: 32px 0 16px; text-transform: uppercase; letter-spacing: 0.5px; }\n    .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 32px; }\n    .stat { background: linear-gradient(135deg, #f8f8f8 0%, #f0f0f0 100%); padding: 20px; border-radius: 12px; text-align: center; }\n    .stat-value { font-size: 28px; font-weight: 700; color: #1e293b; }\n    .stat-value.purple { color: #A78BFA; }\n    .stat-value.green { color: #34D399; }\n    .stat-value.blue { color: #60A5FA; }\n    .stat-value.amber { color: #FBBF24; }\n    .stat-label { font-size: 12px; color: #666; margin-top: 4px; text-transform: uppercase; }\n    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }\n    .card { background: #f8f8f8; border-radius: 12px; padding: 20px; }\n    .card-title { font-size: 14px; font-weight: 600; margin-bottom: 16px; color: #333; }\n    .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e5e5e5; }\n    .row:last-child { border-bottom: none; }\n    .row-label { color: #666; }\n    .row-value { font-weight: 600; }\n    .commission-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 16px; }\n    .commission-item { background: white; padding: 12px; border-radius: 8px; text-align: center; }\n    .commission-value { font-size: 18px; font-weight: 700; }\n    .commission-label { font-size: 11px; color: #666; margin-top: 2px; }\n    .footer { margin-top: 48px; padding-top: 20px; border-top: 1px solid #e5e5e5; text-align: center; color: #999; font-size: 12px; }\n    @media print { body { padding: 20px; } }\n  </style>\n</head>\n<body>\n  <div class="header">\n    <div>\n      <div class="logo">Key<span>Prime</span></div>\n      <h1>Report Dashboard</h1>\n    </div>\n    <div class="date">').concat(s,'</div>\n  </div>\n  \n  <div class="stats">\n    <div class="stat">\n      <div class="stat-value purple">').concat(br(e.valore),'</div>\n      <div class="stat-label">Volume Totale AED</div>\n    </div>\n    <div class="stat">\n      <div class="stat-value blue">').concat(t.length,'</div>\n      <div class="stat-label">Lead Totali</div>\n    </div>\n    <div class="stat">\n      <div class="stat-value green">').concat(n.length,'</div>\n      <div class="stat-label">Vendite Chiuse</div>\n    </div>\n    <div class="stat">\n      <div class="stat-value amber">').concat(l,'%</div>\n      <div class="stat-label">Tasso Conversione</div>\n    </div>\n  </div>\n  \n  <h2>Commissioni</h2>\n  <div class="commission-grid">\n    <div class="commission-item">\n      <div class="commission-value" style="color: #34D399">').concat(br(e.comm),'</div>\n      <div class="commission-label">Totali</div>\n    </div>\n    <div class="commission-item">\n      <div class="commission-value" style="color: #60A5FA">').concat(br(e.ag),'</div>\n      <div class="commission-label">Agenti 70%</div>\n    </div>\n    <div class="commission-item">\n      <div class="commission-value" style="color: #22C55E">').concat(br(e.pell),'</div>\n      <div class="commission-label">Pellegrino</div>\n    </div>\n    <div class="commission-item">\n      <div class="commission-value" style="color: #F97316">').concat(br(e.giov),'</div>\n      <div class="commission-label">Giovanni</div>\n    </div>\n  </div>\n  \n  <div class="grid">\n    <div>\n      <h2>Top Agenti</h2>\n      <div class="card">\n        ').concat(i.length>0?i.map((e,t)=>{let[n,a]=e;return'\n          <div class="row">\n            <span class="row-label">'.concat(t+1,". ").concat(n,'</span>\n            <span class="row-value">').concat(br(a)," AED</span>\n          </div>\n        ")}).join(""):'<p style="color: #999; text-align: center; padding: 20px;">Nessun dato</p>','\n      </div>\n    </div>\n    <div>\n      <h2>Top Zone</h2>\n      <div class="card">\n        ').concat(o.length>0?o.map((e,t)=>{let[n,a]=e;return'\n          <div class="row">\n            <span class="row-label">'.concat(t+1,". ").concat(n,'</span>\n            <span class="row-value">').concat(br(a)," AED</span>\n          </div>\n        ")}).join(""):'<p style="color: #999; text-align: center; padding: 20px;">Nessun dato</p>','\n      </div>\n    </div>\n  </div>\n  \n  <div class="footer">\n    KeyPrime Real Estate CRM \u2022 Report generato automaticamente \u2022 ').concat(s,"\n  </div>\n</body>\n</html>"),d=window.open("","_blank");d.document.write(c),d.document.close(),setTimeout(()=>d.print(),500)})(a,e,t,l,c),children:"Esporta Report"})]}),(Je.length>0||Ge.length>0)&&(0,tr.jsx)(Ar,{hover:!0,onClick:()=>_("tasks"),className:"border-pink-500/20",children:(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsx)("div",{className:"w-12 h-12 rounded-xl bg-pink-500/20 flex items-center justify-center",children:(0,tr.jsx)(ja,{className:"w-6 h-6 text-pink-400"})}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:"Task in scadenza"}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm",children:[Ge.length>0&&(0,tr.jsxs)("span",{className:"text-red-400",children:[Ge.length," scaduti"]}),Ge.length>0&&Je.length>0&&" \u2022 ",Je.length>0&&(0,tr.jsxs)("span",{children:[Je.length," oggi"]})]})]}),(0,tr.jsx)(aa,{className:"w-5 h-5 text-zinc-500"})]})}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,tr.jsx)(Or,{label:"Volume Totale",value:a.valore,subValue:"AED",icon:ka,color:"#A78BFA",onClick:()=>_("vendite")}),(0,tr.jsx)(Or,{label:"Lead Totali",value:s.length,icon:ma,color:"#60A5FA",onClick:()=>_("pipeline")}),(0,tr.jsx)(Or,{label:"Vendite Chiuse",value:t.length,icon:_a,color:"#34D399",onClick:()=>_("vendite")}),(0,tr.jsx)(Or,{label:"Netto KeyPrime",value:a.netto,subValue:"AED",icon:Oa,color:"#FBBF24"})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Commissioni Tot"}),(0,tr.jsx)("p",{className:"text-xl font-semibold text-emerald-400 mt-1",children:br(a.comm)})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Agenti 70%"}),(0,tr.jsx)("p",{className:"text-xl font-semibold text-blue-400 mt-1",children:br(a.ag)})]}),(0,tr.jsxs)(Ar,{className:"border-green-500/20",children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Pellegrino"}),(0,tr.jsx)("p",{className:"text-xl font-semibold text-green-400 mt-1",children:br(a.pell)})]}),(0,tr.jsxs)(Ar,{className:"border-orange-500/20",children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Giovanni"}),(0,tr.jsx)("p",{className:"text-xl font-semibold text-orange-400 mt-1",children:br(a.giov)})]})]}),(0,tr.jsxs)(Ar,{hover:!0,onClick:()=>_("pipeline"),children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,tr.jsx)("h3",{className:"text-white font-semibold",children:"Pipeline"}),(0,tr.jsx)(aa,{className:"w-5 h-5 text-zinc-500"})]}),(0,tr.jsx)("div",{className:"grid grid-cols-5 gap-2",children:Object.entries(r).map(e=>{var t,n;let[a,r]=e;return(0,tr.jsxs)("div",{className:"text-center p-3 rounded-xl",style:{background:null===(t=vr.status[a])||void 0===t?void 0:t.bg},children:[(0,tr.jsx)("div",{className:"text-xl font-semibold text-white",children:r.length}),(0,tr.jsx)("div",{className:"text-xs",style:{color:null===(n=vr.status[a])||void 0===n?void 0:n.color},children:fr[a]||a})]},a)})})]}),(0,tr.jsxs)("div",{className:"grid lg:grid-cols-3 gap-4",children:[(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[(0,tr.jsx)(Ca,{className:"w-5 h-5 text-amber-400"}),"Top Agenti"]}),(0,tr.jsxs)("div",{className:"space-y-3",children:[Object.entries(l).sort((e,t)=>t[1]-e[1]).slice(0,5).map((e,t)=>{let[n,a]=e;return(0,tr.jsxs)("div",{onClick:()=>ae({name:n,type:"agente"}),className:"flex items-center gap-3 p-2 -mx-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors",children:[(0,tr.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ".concat(0===t?"bg-amber-500 text-black":"bg-zinc-700/50 text-zinc-400"),children:t+1}),(0,tr.jsx)(zr,{nome:n,size:"sm"}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsx)("p",{className:"text-white text-sm",children:n}),(0,tr.jsx)(Pr,{value:a,max:Object.values(l).sort((e,t)=>t-e)[0]||1,color:0===t?"#FBBF24":"#52525B",height:"h-1"})]}),(0,tr.jsx)("span",{className:"text-zinc-400 text-sm",children:br(a)}),(0,tr.jsx)(aa,{className:"w-4 h-4 text-zinc-600"})]},n)}),0===Object.keys(l).length&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm text-center py-4",children:"Nessun dato"})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[(0,tr.jsx)(Pa,{className:"w-5 h-5 text-emerald-400"}),"Top Zone"]}),(0,tr.jsxs)("div",{className:"space-y-3",children:[Object.entries(c).sort((e,t)=>t[1]-e[1]).slice(0,5).map((e,t)=>{let[n,a]=e;return(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ".concat(0===t?"bg-emerald-500 text-black":"bg-zinc-700/50 text-zinc-400"),children:t+1}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsx)("p",{className:"text-white text-sm",children:n}),(0,tr.jsx)(Pr,{value:a,max:Object.values(c).sort((e,t)=>t-e)[0]||1,color:0===t?"#34D399":"#52525B",height:"h-1"})]}),(0,tr.jsx)("span",{className:"text-zinc-400 text-sm",children:br(a)})]},n)}),0===Object.keys(c).length&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm text-center py-4",children:"Nessun dato"})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[(0,tr.jsx)(_a,{className:"w-5 h-5 text-violet-400"}),"Trend Mensile"]}),(0,tr.jsxs)("div",{className:"space-y-3",children:[Object.entries(i).sort((e,t)=>e[0].localeCompare(t[0])).slice(-5).map(e=>{let[t,n]=e;return(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("span",{className:"text-zinc-500 text-sm w-16",children:t}),(0,tr.jsx)("div",{className:"flex-1",children:(0,tr.jsx)(Pr,{value:n,max:Math.max(...Object.values(i))||1,color:"#A78BFA"})}),(0,tr.jsx)("span",{className:"text-white text-sm w-20 text-right",children:br(n)})]},t)}),0===Object.keys(i).length&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm text-center py-4",children:"Nessun dato"})]})]})]})]}),"dashboard"===k&&ne&&(0,tr.jsx)(Xr,{agent:ne,sales:e,onBack:()=>ae(null)}),"vendite"===k&&(0,tr.jsx)(Vr,{sales:Ve,filters:Q,setFilters:Y,updateSale:ze,deleteSale:Ee,loading:v}),"pipeline"===k&&(0,tr.jsx)(Kr,{byStato:r,onSelectLead:P,onUpdateSaleStatus:(e,t)=>ze(e,{stato:t})}),"crm"===k&&(D?(0,tr.jsx)(Jr,{cliente:D,sales:s.filter(e=>e.cliente_id===D.id),tasks:h.filter(e=>e.cliente_id===D.id),onBack:()=>R(null),onEdit:()=>L(D),onDelete:()=>Oe(D.id),updateCliente:Te,onAddTask:()=>U({cliente_id:D.id}),onCompleteTask:De,onDeleteTask:Ie,onExportPDF:()=>((e,t)=>{const n=t.filter(e=>"venduto"===e.stato||"incassato"===e.stato).reduce((e,t)=>e+Number(t.valore||0),0),a='<!DOCTYPE html><html><head><meta charset="UTF-8"><title>'.concat(e.nome,"</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;padding:40px;max-width:800px;margin:0 auto;color:#1a1a1a}h1{font-size:28px;font-weight:600;margin-bottom:8px}h2{font-size:14px;font-weight:600;color:#666;margin:24px 0 12px;text-transform:uppercase;letter-spacing:0.5px}.stats{display:flex;gap:16px;margin:24px 0}.stat{flex:1;background:#f5f5f7;padding:16px;border-radius:12px;text-align:center}.stat-val{font-size:24px;font-weight:600}.stat-label{font-size:12px;color:#666;margin-top:4px}.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}.item{background:#f5f5f7;padding:12px 16px;border-radius:8px}.item-label{font-size:11px;color:#666;margin-bottom:2px}.item-value{font-size:14px;font-weight:500}table{width:100%;border-collapse:collapse;margin-top:8px}th,td{padding:10px 12px;text-align:left;font-size:13px}th{background:#f5f5f7;font-weight:500}tr:not(:last-child) td{border-bottom:1px solid #e5e5e5}</style></head><body><h1>").concat(e.nome," ").concat(e.cognome||"",'</h1><p style="color:#666">').concat(e.telefono||""," ").concat(e.email?"\u2022 "+e.email:"",'</p><div class="stats"><div class="stat"><div class="stat-val">').concat(t.length,'</div><div class="stat-label">Lead</div></div><div class="stat"><div class="stat-val">').concat(br(n),'</div><div class="stat-label">Valore AED</div></div><div class="stat"><div class="stat-val">').concat(e.stato,'</div><div class="stat-label">Stato</div></div></div><h2>Informazioni</h2><div class="grid"><div class="item"><div class="item-label">Budget</div><div class="item-value">').concat(e.budget_max?br(e.budget_max)+" AED":"N/A",'</div></div><div class="item"><div class="item-label">Agente</div><div class="item-value">').concat(e.agente_riferimento||"N/A","</div></div></div>").concat(t.length>0?"<h2>Storico Lead</h2><table><tr><th>Data</th><th>Progetto</th><th>Valore</th><th>Stato</th></tr>"+t.map(e=>"<tr><td>"+wr(e.data)+"</td><td>"+e.progetto+"</td><td>"+(e.valore>0?br(e.valore):"TBD")+"</td><td>"+e.stato+"</td></tr>").join("")+"</table>":"","</body></html>"),r=window.open("","_blank");r.document.write(a),r.document.close(),setTimeout(()=>r.print(),500)})(D,s.filter(e=>e.cliente_id===D.id),h.filter(e=>e.cliente_id===D.id))}):(0,tr.jsx)(Gr,{clienti:We,filters:X,setFilters:Z,sales:s,onSelect:R,onCreate:()=>L({}),onDelete:Oe,onUpdateCliente:Te,users:o})),"offplan"===k&&(0,tr.jsx)(es,{clienti:d,onCreateLead:ke,savedListings:re,onSaveListing:je,onRemoveListing:Ne,user:n}),"calculator"===k&&(0,tr.jsx)(bs,{}),"tasks"===k&&(0,tr.jsx)($r,{tasks:h,clienti:d,users:o,onComplete:De,onDelete:Ie,onEdit:U,onCreate:()=>U({})}),"followups"===k&&(0,tr.jsxs)("div",{className:"space-y-6",children:[(0,tr.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,tr.jsxs)(Ar,{className:"border-red-500/20",children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Scaduti"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-red-400 mt-1",children:Ye.length})]}),(0,tr.jsxs)(Ar,{className:"border-purple-500/20",children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Oggi"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-purple-400 mt-1",children:Qe.length})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Prossimi 7 giorni"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-white mt-1",children:$e.filter(e=>{const t=new Date(e.data_reminder),n=new Date,a=new Date;return a.setDate(n.getDate()+7),t>=n&&t<=a}).length})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Totale Attivi"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-white mt-1",children:$e.length})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,tr.jsx)("h3",{className:"text-white font-semibold",children:"Follow-up Programmati"})}),$e.length>0?(0,tr.jsx)("div",{className:"space-y-2",children:$e.map(e=>{const t=s.find(t=>t.id===e.sale_id),n=d.find(t=>t.id===e.cliente_id),a=new Date(e.data_reminder)<new Date,r=new Date(e.data_reminder).toDateString()===(new Date).toDateString();return(0,tr.jsx)("div",{className:"p-4 rounded-xl border ".concat(a?"bg-red-500/10 border-red-500/30":r?"bg-purple-500/10 border-purple-500/30":"bg-zinc-800/50 border-zinc-800"),children:(0,tr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsxs)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat(a?"bg-red-500/20":r?"bg-purple-500/20":"bg-zinc-700"),children:["call"===e.tipo&&"\ud83d\udcde","email"===e.tipo&&"\ud83d\udce7","whatsapp"===e.tipo&&"\ud83d\udcac","meeting"===e.tipo&&"\ud83e\udd1d","viewing"===e.tipo&&"\ud83c\udfe0",!e.tipo&&"\u23f0"]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:n?"".concat(n.nome," ").concat(n.cognome):"Cliente"}),(0,tr.jsx)("p",{className:"text-zinc-400 text-sm",children:(null===t||void 0===t?void 0:t.progetto)||"Lead"}),e.nota&&(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:e.nota})]})]}),(0,tr.jsxs)("div",{className:"text-right flex items-center gap-3",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"font-medium ".concat(a?"text-red-400":r?"text-purple-400":"text-white"),children:new Date(e.data_reminder).toLocaleDateString("it-IT",{day:"numeric",month:"short"})}),e.ora_reminder&&(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:e.ora_reminder.slice(0,5)}),a&&(0,tr.jsx)("span",{className:"text-red-400 text-xs font-medium",children:"SCADUTO"}),r&&!a&&(0,tr.jsx)("span",{className:"text-purple-400 text-xs font-medium",children:"OGGI"})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,tr.jsx)("button",{onClick:()=>Fe(e.id),className:"p-2 text-zinc-500 hover:text-green-400 transition-colors",title:"Completa",children:(0,tr.jsx)(na,{className:"w-4 h-4"})}),(0,tr.jsx)("button",{onClick:()=>Be(e.id),className:"p-2 text-zinc-500 hover:text-red-400 transition-colors",title:"Elimina",children:(0,tr.jsx)(Da,{className:"w-4 h-4"})})]})]})]})},e.id)})}):(0,tr.jsx)("p",{className:"text-zinc-500 text-center py-8",children:"Nessun follow-up programmato"})]})]}),"commissioni"===k&&(0,tr.jsxs)("div",{className:"space-y-6",children:[(0,tr.jsx)("div",{className:"flex gap-2",children:[{id:"all",label:"Tutto"},{id:"30",label:"30 giorni"},{id:"90",label:"90 giorni"},{id:"365",label:"Anno"}].map(e=>(0,tr.jsx)("button",{onClick:()=>te(e.id),className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat(ee===e.id?"bg-emerald-500/20 text-emerald-400":"bg-zinc-700/50 text-zinc-400 hover:text-white"),children:e.label},e.id))}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,tr.jsxs)(Ar,{className:"border-emerald-500/20 bg-emerald-500/5",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-sm",children:"Commissioni Totali"}),(0,tr.jsx)("p",{className:"text-3xl font-bold text-emerald-400 mt-2",children:br(a.comm)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"AED"})]}),(0,tr.jsxs)(Ar,{className:"border-green-500/20",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-sm",children:"\ud83d\udcb0 Pellegrino"}),(0,tr.jsx)("p",{className:"text-2xl font-bold text-green-400 mt-2",children:br(a.pell)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Quota netta"})]}),(0,tr.jsxs)(Ar,{className:"border-orange-500/20",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-sm",children:"\ud83d\udcb0 Giovanni"}),(0,tr.jsx)("p",{className:"text-2xl font-bold text-orange-400 mt-2",children:br(a.giov)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Quota netta"})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-sm",children:"Agenti (70%)"}),(0,tr.jsx)("p",{className:"text-2xl font-bold text-blue-400 mt-2",children:br(a.ag)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Da pagare"})]})]}),(()=>{const t=e.filter(e=>"venduto"===e.stato||"incassato"===e.stato),n=t.reduce((e,t)=>e+Number(t.valore)*(t.commission_pct||5)/100,0),a=t.filter(e=>e.pagato).reduce((e,t)=>e+Number(t.valore)*(t.commission_pct||5)/100,0),r=n-a,s=n>0?a/n*100:0;return(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Stato Pagamenti"}),(0,tr.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,tr.jsxs)("div",{className:"text-center p-4 bg-emerald-500/10 rounded-xl",children:[(0,tr.jsx)("p",{className:"text-emerald-400 text-2xl font-bold",children:br(n)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Maturate"})]}),(0,tr.jsxs)("div",{className:"text-center p-4 bg-green-500/10 rounded-xl",children:[(0,tr.jsx)("p",{className:"text-green-400 text-2xl font-bold",children:br(a)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Pagate \u2713"})]}),(0,tr.jsxs)("div",{className:"text-center p-4 bg-amber-500/10 rounded-xl",children:[(0,tr.jsx)("p",{className:"text-amber-400 text-2xl font-bold",children:br(r)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Da Pagare"})]})]}),(0,tr.jsxs)("div",{className:"relative h-4 bg-zinc-700/50 rounded-full overflow-hidden",children:[(0,tr.jsx)("div",{className:"absolute left-0 top-0 h-full bg-gradient-to-r from-green-500 to-emerald-400 rounded-full transition-all duration-500",style:{width:"".concat(s,"%")}}),(0,tr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,tr.jsxs)("span",{className:"text-xs font-medium text-white drop-shadow",children:[s.toFixed(0),"% pagato"]})})]})]})})(),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Commissioni per Agente"}),(0,tr.jsx)("div",{className:"space-y-3",children:Object.entries(e.filter(e=>"venduto"===e.stato||"incassato"===e.stato).reduce((e,t)=>{const n=t.agente||"Non assegnato";e[n]||(e[n]={totale:0,pagate:0,count:0});const a=Number(t.valore)*(t.commission_pct||5)/100*.7;return e[n].totale+=a,t.pagato&&(e[n].pagate+=a),e[n].count++,e},{})).sort((e,t)=>t[1].totale-e[1].totale).map(e=>{let[t,n]=e;return(0,tr.jsxs)("div",{className:"flex items-center justify-between p-3 bg-zinc-800/50 rounded-xl",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)(zr,{nome:t,size:"sm"}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:t}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-xs",children:[n.count," vendite"]})]})]}),(0,tr.jsxs)("div",{className:"text-right",children:[(0,tr.jsxs)("p",{className:"text-blue-400 font-semibold",children:[br(n.totale)," AED"]}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-xs",children:[n.pagate>0&&(0,tr.jsxs)("span",{className:"text-green-400",children:[br(n.pagate)," pagati"]}),n.totale-n.pagate>0&&(0,tr.jsxs)("span",{className:"text-amber-400 ml-2",children:[br(n.totale-n.pagate)," pending"]})]})]})]},t)})})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Dettaglio Vendite"}),(0,tr.jsx)("div",{className:"overflow-x-auto",children:(0,tr.jsxs)("table",{className:"w-full",children:[(0,tr.jsx)("thead",{children:(0,tr.jsxs)("tr",{className:"text-left text-zinc-500 text-xs border-b border-zinc-800",children:[(0,tr.jsx)("th",{className:"pb-3",children:"Progetto"}),(0,tr.jsx)("th",{className:"pb-3",children:"Agente"}),(0,tr.jsx)("th",{className:"pb-3 text-right",children:"Valore"}),(0,tr.jsx)("th",{className:"pb-3 text-right",children:"Comm."}),(0,tr.jsx)("th",{className:"pb-3 text-center",children:"Stato"})]})}),(0,tr.jsx)("tbody",{className:"divide-y divide-zinc-800",children:e.filter(e=>"venduto"===e.stato||"incassato"===e.stato).slice(0,20).map(e=>{const t=Number(e.valore)*(e.commission_pct||5)/100;return(0,tr.jsxs)("tr",{className:"text-sm",children:[(0,tr.jsxs)("td",{className:"py-3",children:[(0,tr.jsx)("p",{className:"text-white",children:e.progetto}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:e.zona})]}),(0,tr.jsx)("td",{className:"py-3 text-zinc-300",children:e.agente||"-"}),(0,tr.jsx)("td",{className:"py-3 text-right text-white",children:br(e.valore)}),(0,tr.jsx)("td",{className:"py-3 text-right text-emerald-400",children:br(t)}),(0,tr.jsx)("td",{className:"py-3 text-center",children:e.pagato?(0,tr.jsx)("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Pagata \u2713"}):(0,tr.jsx)("span",{className:"px-2 py-1 bg-amber-500/20 text-amber-400 text-xs rounded-full",children:"Pending"})})]},e.id)})})]})})]})]}),"utenti"===k&&(0,tr.jsx)(Yr,{users:o,onCreate:()=>B({}),onEdit:B,onDelete:He})]})]}),S&&(0,tr.jsxs)("div",{className:"fixed inset-0 z-50 lg:hidden",children:[(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800/60",onClick:()=>C(!1)}),(0,tr.jsxs)("aside",{className:"absolute left-0 top-0 bottom-0 w-72 bg-[#1e293b] p-4 animate-slideRight",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,tr.jsx)("img",{src:"/logo.png",alt:"KeyPrime",className:"h-16"}),(0,tr.jsx)("button",{onClick:()=>C(!1),className:"text-zinc-400",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]}),(0,tr.jsx)("nav",{className:"space-y-1",children:p.map(e=>(0,tr.jsx)(Fr,{icon:e.icon,label:e.label,active:k===e.id,onClick:()=>{_(e.id),C(!1),R(null)},accent:e.accent,badge:e.badge,isNew:e.isNew},e.id))}),(0,tr.jsx)("div",{className:"absolute bottom-4 left-4 right-4",children:(0,tr.jsx)(Lr,{variant:"danger",icon:wa,onClick:ye,className:"w-full",children:"Esci"})})]})]}),O&&(0,tr.jsx)(rs,{sale:O,cliente:d.find(e=>e.id===(null===O||void 0===O?void 0:O.cliente_id)),rate:.7,onClose:()=>P(null),onUpdateSale:ze,onConvert:()=>$(O),isAdmin:!0,activities:m.filter(e=>e.sale_id===(null===O||void 0===O?void 0:O.id)),followUps:g.filter(e=>e.sale_id===(null===O||void 0===O?void 0:O.id)),onAddActivity:Le,onCreateFollowUp:Ue,onCompleteFollowUp:Fe,onDeleteActivity:Me,onDeleteFollowUp:Be,userName:null===n||void 0===n?void 0:n.nome}),J&&(0,tr.jsx)(ss,{sale:J,onConvert:Ce,onCancel:()=>$(null)}),I&&(0,tr.jsx)(cs,{cliente:I.id?I:null,onSave:I.id?e=>Te(I.id,e):Ae,onClose:()=>L(null)}),M&&(0,tr.jsx)(ds,{task:M.id?M:null,clienti:d,users:o,onSave:M.id?e=>(async(e,t)=>{await sr.from("tasks").update(t).eq("id",e),me(),U(null),de("Salvato")})(M.id,e):Pe,onClose:()=>U(null)}),F&&(0,tr.jsx)(us,{user:F.id?F:null,onSave:F.id?e=>(async(e,t)=>{await sr.from("user_credentials").update(t).eq("id",e),he(),B(null),de("Salvato")})(F.id,e):qe,onClose:()=>B(null)}),K&&(0,tr.jsx)(is,{tasks:Xe,unreadIds:et,recentSales:Ze,onClose:()=>{G(!1)},onGoToTask:()=>{G(!1),_("tasks")},onMarkAsRead:nt,userId:null===n||void 0===n?void 0:n.id}),ie&&(0,tr.jsx)(qr,{isOpen:ie,onClose:()=>oe(!1),sales:s,clienti:d,tasks:h,onSelectSale:P,onSelectCliente:R,onSelectTask:()=>_("tasks"),setActiveTab:_}),j&&(0,tr.jsx)(Cr,{message:j.message,type:j.type,onClose:()=>N(null)})]})}return null}function Vr(e){let{sales:t,filters:n,setFilters:a,updateSale:r,deleteSale:s,loading:i}=e;return(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"flex flex-wrap gap-3 items-center",children:[(0,tr.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,tr.jsx)(da,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500"}),(0,tr.jsx)("input",{type:"text",placeholder:"Cerca progetto, cliente, agente...",value:n.search,onChange:e=>a(c(c({},n),{},{search:e.target.value})),className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-2.5 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-emerald-500/50"})]}),(0,tr.jsxs)("select",{value:n.stato,onChange:e=>a(c(c({},n),{},{stato:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-emerald-500/50",children:[(0,tr.jsx)("option",{value:"",children:"Tutti gli stati"}),mr.map(e=>(0,tr.jsx)("option",{value:e,children:fr[e]||e},e))]})]}),(0,tr.jsxs)(Ar,{padding:"p-0",className:"overflow-hidden",children:[(0,tr.jsx)("div",{className:"overflow-x-auto",children:(0,tr.jsxs)("table",{className:"w-full",children:[(0,tr.jsx)("thead",{children:(0,tr.jsxs)("tr",{className:"border-b border-[#334155]",children:[(0,tr.jsx)("th",{className:"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Data"}),(0,tr.jsx)("th",{className:"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Progetto"}),(0,tr.jsx)("th",{className:"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Zona"}),(0,tr.jsx)("th",{className:"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Cliente"}),(0,tr.jsx)("th",{className:"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Agente"}),(0,tr.jsx)("th",{className:"text-right text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Valore"}),(0,tr.jsx)("th",{className:"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"%"}),(0,tr.jsx)("th",{className:"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Stato"}),(0,tr.jsx)("th",{className:"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Ref"}),(0,tr.jsx)("th",{className:"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3",children:"Pag"}),(0,tr.jsx)("th",{className:"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3"})]})}),(0,tr.jsx)("tbody",{className:"divide-y divide-[#334155]",children:t.map(e=>{var t,n;return(0,tr.jsxs)("tr",{className:"hover:bg-white/5 transition-colors",children:[(0,tr.jsx)("td",{className:"px-4 py-3 text-sm text-zinc-400",children:wr(e.data)}),(0,tr.jsx)("td",{className:"px-4 py-3",children:(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("span",{className:"text-white text-sm font-medium",children:e.progetto}),(0,tr.jsx)("br",{}),(0,tr.jsx)("span",{className:"text-xs text-zinc-500",children:e.developer})]}),e.note&&(0,tr.jsx)("span",{title:e.note,className:"text-amber-400 cursor-help",children:(0,tr.jsx)(Ra,{className:"w-3.5 h-3.5"})}),e.pf_url&&(0,tr.jsx)("a",{href:e.pf_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:(0,tr.jsx)(Ia,{className:"w-3.5 h-3.5"})})]})}),(0,tr.jsx)("td",{className:"px-4 py-3 text-sm text-zinc-400",children:e.zona||"-"}),(0,tr.jsx)("td",{className:"px-4 py-3 text-sm text-blue-400",children:e.cliente_nome||"-"}),(0,tr.jsx)("td",{className:"px-4 py-3 text-sm text-zinc-400",children:e.agente||e.segnalatore||"-"}),(0,tr.jsx)("td",{className:"px-4 py-3 text-right text-sm font-medium text-white",children:e.valore>0?br(e.valore):"-"}),(0,tr.jsx)("td",{className:"px-4 py-3 text-center",children:(0,tr.jsx)("select",{value:e.commission_pct||5,onChange:t=>r(e.id,{commission_pct:parseInt(t.target.value)}),className:"bg-zinc-700/50 rounded px-2 py-1 text-xs text-white w-14 focus:outline-none",children:pr.map(e=>(0,tr.jsxs)("option",{value:e,children:[e,"%"]},e))})}),(0,tr.jsx)("td",{className:"px-4 py-3 text-center",children:(0,tr.jsx)("select",{value:e.stato||"lead",onChange:t=>r(e.id,{stato:t.target.value}),className:"rounded px-2 py-1 text-xs text-white w-20 focus:outline-none",style:{background:null===(t=vr.status[e.stato||"lead"])||void 0===t?void 0:t.bg,color:null===(n=vr.status[e.stato||"lead"])||void 0===n?void 0:n.color},children:mr.map(e=>(0,tr.jsx)("option",{value:e,className:"bg-zinc-800",children:fr[e]||e},e))})}),(0,tr.jsx)("td",{className:"px-4 py-3 text-center",children:(0,tr.jsxs)("select",{value:e.referente||"",onChange:t=>r(e.id,{referente:t.target.value||null}),className:"rounded px-2 py-1 text-xs font-medium w-12 focus:outline-none ".concat("Pellegrino"===e.referente?"bg-green-500/20 text-green-400":"Giovanni"===e.referente?"bg-orange-500/20 text-orange-400":"bg-zinc-700/50 text-zinc-500"),children:[(0,tr.jsx)("option",{value:"",children:"-"}),(0,tr.jsx)("option",{value:"Pellegrino",children:"P"}),(0,tr.jsx)("option",{value:"Giovanni",children:"G"})]})}),(0,tr.jsx)("td",{className:"px-4 py-3 text-center",children:(0,tr.jsx)("button",{onClick:()=>r(e.id,{pagato:!e.pagato}),className:"px-2.5 py-1 rounded-lg text-xs font-medium transition-colors ".concat(e.pagato?"bg-emerald-500/20 text-emerald-400":"bg-zinc-700/50 text-zinc-500 hover:text-zinc-300"),children:e.pagato?"\u2713":"\u25cb"})}),(0,tr.jsx)("td",{className:"px-4 py-3 text-center",children:(0,tr.jsx)("button",{onClick:()=>s(e.id),className:"text-zinc-600 hover:text-red-400 transition-colors",children:(0,tr.jsx)(Da,{className:"w-4 h-4"})})})]},e.id)})})]})}),0===t.length&&(0,tr.jsx)("div",{className:"text-center py-12 text-zinc-500",children:"Nessuna vendita trovata"})]})]})}function Wr(e){let{leads:t,clienti:n,onSelectLead:r,onUpdateStatus:s,onDelete:i,onAssign:o,theme:l,users:c,isAdmin:d}=e;const[u,h]=(0,a.useState)([]),[p,m]=(0,a.useState)("created_at"),[f,g]=(0,a.useState)("desc"),[x,v]=(0,a.useState)(""),[b,y]=(0,a.useState)(""),[w,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),_=e=>n.find(t=>t.id===e),S=t.filter(e=>{if(x&&e.stato!==x)return!1;if(b){var t,n,a,r,s;const i=b.toLowerCase(),o=_(e.cliente_id);return(null===(t=e.progetto)||void 0===t?void 0:t.toLowerCase().includes(i))||(null===(n=e.zona)||void 0===n?void 0:n.toLowerCase().includes(i))||(null===(a=e.developer)||void 0===a?void 0:a.toLowerCase().includes(i))||(null===o||void 0===o||null===(r=o.nome)||void 0===r?void 0:r.toLowerCase().includes(i))||(null===o||void 0===o||null===(s=o.cognome)||void 0===s?void 0:s.toLowerCase().includes(i))}return!0}).sort((e,t)=>{let n=e[p],a=t[p];var r,s;"cliente"===p&&(n=(null===(r=_(e.cliente_id))||void 0===r?void 0:r.nome)||"",a=(null===(s=_(t.cliente_id))||void 0===s?void 0:s.nome)||"");return"asc"===f?n>a?1:-1:n<a?1:-1}),C=(e,t)=>{"delete"===e?window.confirm("Eliminare ".concat(u.length," lead?"))&&(u.forEach(e=>i(e)),h([])):"status"===e?(u.forEach(e=>s(e,t)),h([])):"assign"===e&&o&&(o(u,t),h([])),k(null)},z=e=>{let{field:t,children:n}=e;return(0,tr.jsx)("th",{className:"text-left py-3 px-4 text-zinc-400 font-medium text-sm cursor-pointer hover:text-white transition-colors",onClick:()=>{p===t?g(e=>"asc"===e?"desc":"asc"):(m(t),g("asc"))},children:(0,tr.jsxs)("span",{className:"flex items-center gap-1",children:[n,p===t&&(0,tr.jsx)("span",{className:"text-orange-400",children:"asc"===f?"\u2191":"\u2193"})]})})};return(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,tr.jsxs)("div",{className:"relative",children:[(0,tr.jsx)(da,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),(0,tr.jsx)("input",{type:"text",placeholder:"Cerca lead...",value:b,onChange:e=>y(e.target.value),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg pl-9 pr-4 py-2 text-white text-sm w-64 focus:border-orange-500 focus:outline-none"})]}),(0,tr.jsxs)("select",{value:x,onChange:e=>v(e.target.value),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none",children:[(0,tr.jsx)("option",{value:"",children:"Tutti gli stati"}),mr.map(e=>(0,tr.jsx)("option",{value:e,children:fr[e]||e},e))]})]}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm",children:[S.length," lead"]})]}),u.length>0&&(0,tr.jsx)(Ar,{className:"bg-orange-500/10 border-orange-500/30",children:(0,tr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,tr.jsxs)("p",{className:"text-orange-400 font-medium",children:[u.length," lead selezionati"]}),(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsxs)("select",{value:"",onChange:e=>C("status",e.target.value),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm",children:[(0,tr.jsx)("option",{value:"",children:"Cambia stato..."}),mr.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),d&&(null===c||void 0===c?void 0:c.length)>0&&(0,tr.jsxs)("select",{value:"",onChange:e=>C("assign",e.target.value),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm",children:[(0,tr.jsx)("option",{value:"",children:"Assegna a..."}),c.map(e=>(0,tr.jsx)("option",{value:e.nome,children:e.nome},e.id))]}),(0,tr.jsxs)(Lr,{variant:"danger",size:"sm",onClick:()=>C("delete"),children:[(0,tr.jsx)(Da,{className:"w-4 h-4 mr-1"})," Elimina"]}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>h([]),children:(0,tr.jsx)(ia,{className:"w-4 h-4"})})]})]})}),(0,tr.jsx)(Ar,{padding:"p-0",className:"overflow-hidden",children:(0,tr.jsxs)("div",{className:"overflow-x-auto",children:[(0,tr.jsxs)("table",{className:"w-full",children:[(0,tr.jsx)("thead",{className:"bg-zinc-700/50/50 border-b border-zinc-700",children:(0,tr.jsxs)("tr",{children:[(0,tr.jsx)("th",{className:"w-12 py-3 px-4",children:(0,tr.jsx)("input",{type:"checkbox",checked:u.length===S.length&&S.length>0,onChange:()=>{u.length===S.length?h([]):h(S.map(e=>e.id))},className:"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-orange-500 focus:ring-orange-500"})}),(0,tr.jsx)(z,{field:"cliente",children:"Cliente"}),(0,tr.jsx)(z,{field:"progetto",children:"Progetto"}),(0,tr.jsx)(z,{field:"zona",children:"Zona"}),(0,tr.jsx)(z,{field:"valore",children:"Valore"}),(0,tr.jsx)(z,{field:"stato",children:"Stato"}),(0,tr.jsx)(z,{field:"created_at",children:"Data"}),d&&(0,tr.jsx)(z,{field:"assegnato_a",children:"Agente"}),(0,tr.jsx)("th",{className:"w-20 py-3 px-4"})]})}),(0,tr.jsx)("tbody",{className:"divide-y divide-zinc-800",children:S.map(e=>{const t=_(e.cliente_id),n=u.includes(e.id);return(0,tr.jsxs)("tr",{className:"hover:bg-zinc-700/50/50 cursor-pointer transition-colors ".concat(n?"bg-orange-500/10":""),children:[(0,tr.jsx)("td",{className:"py-3 px-4",onClick:e=>e.stopPropagation(),children:(0,tr.jsx)("input",{type:"checkbox",checked:n,onChange:()=>{return t=e.id,void h(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-orange-500 focus:ring-orange-500"})}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>r(e),children:(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[t&&(0,tr.jsx)(zr,{nome:t.nome,size:"sm"}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:t?"".concat(t.nome," ").concat(t.cognome||""):"N/A"}),(null===t||void 0===t?void 0:t.telefono)&&(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:t.telefono})]})]})}),(0,tr.jsxs)("td",{className:"py-3 px-4",onClick:()=>r(e),children:[(0,tr.jsx)("p",{className:"text-white",children:e.progetto||"-"}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:e.developer||""})]}),(0,tr.jsx)("td",{className:"py-3 px-4 text-zinc-300",onClick:()=>r(e),children:e.zona||"-"}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>r(e),children:(0,tr.jsx)("span",{className:"text-emerald-400 font-semibold",children:e.valore>0?(a=e.valore,new Intl.NumberFormat("it-IT",{style:"currency",currency:"AED",maximumFractionDigits:0}).format(a)):"TBD"})}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>r(e),children:(0,tr.jsx)(Er,{status:e.stato||"lead"})}),(0,tr.jsx)("td",{className:"py-3 px-4 text-zinc-500 text-sm",onClick:()=>r(e),children:e.created_at?new Date(e.created_at).toLocaleDateString("it-IT"):"-"}),d&&(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>r(e),children:e.assegnato_a?(0,tr.jsx)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full",children:e.assegnato_a}):(0,tr.jsx)("span",{className:"text-zinc-600 text-sm",children:"-"})}),(0,tr.jsx)("td",{className:"py-3 px-4",children:(0,tr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,tr.jsx)("button",{onClick:t=>{t.stopPropagation(),r(e)},className:"p-1.5 text-zinc-400 hover:text-white hover:bg-zinc-700 rounded-lg transition-colors",children:(0,tr.jsx)(La,{className:"w-4 h-4"})}),(0,tr.jsx)("button",{onClick:t=>{t.stopPropagation(),window.confirm("Eliminare?")&&i(e.id)},className:"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:(0,tr.jsx)(Da,{className:"w-4 h-4"})})]})})]},e.id);var a})})]}),0===S.length&&(0,tr.jsxs)("div",{className:"py-12 text-center",children:[(0,tr.jsx)(ma,{className:"w-12 h-12 text-zinc-600 mx-auto mb-3"}),(0,tr.jsx)("p",{className:"text-zinc-500",children:"Nessun lead trovato"})]})]})})]})}function Kr(e){let{byStato:t,onSelectLead:n,onUpdateSaleStatus:r}=e;const[s,i]=(0,a.useState)(null),[o,l]=(0,a.useState)(null),c=e=>{e.target.style.opacity="1",i(null),l(null)},d=()=>{l(null)};return(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsx)("div",{className:"flex items-center justify-between",children:(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Trascina le card per cambiare stato"})}),(0,tr.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:mr.map(e=>{var a,u,h,p;return(0,tr.jsxs)("div",{className:"space-y-3",onDragOver:t=>((e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",l(t)})(t,e),onDragLeave:d,onDrop:t=>((e,t)=>{e.preventDefault(),s&&s.stato!==t&&r(s.id,t),i(null),l(null)})(t,e),children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("div",{className:"w-3 h-3 rounded-full",style:{background:null===(a=vr.status[e])||void 0===a?void 0:a.color}}),(0,tr.jsx)("span",{className:"text-sm font-medium text-white",children:fr[e]||e})]}),(0,tr.jsx)("span",{className:"text-xs text-zinc-500 bg-zinc-700/50 px-2 py-0.5 rounded-full",children:(null===(u=t[e])||void 0===u?void 0:u.length)||0})]}),(0,tr.jsxs)("div",{className:"space-y-2 min-h-[200px] rounded-xl p-2 transition-all ".concat(o===e?"bg-white/5 ring-2 ring-violet-500/50":""),children:[null===(h=t[e])||void 0===h?void 0:h.map(t=>{var a;return(0,tr.jsx)("div",{draggable:!0,onDragStart:e=>((e,t)=>{i(t),e.dataTransfer.effectAllowed="move",e.target.style.opacity="0.5"})(e,t),onDragEnd:c,className:"cursor-grab active:cursor-grabbing ".concat((null===s||void 0===s?void 0:s.id)===t.id?"opacity-50":""),children:(0,tr.jsxs)(Ar,{hover:!0,onClick:()=>n(t),padding:"p-3",className:"border-l-2",style:{borderLeftColor:null===(a=vr.status[e])||void 0===a?void 0:a.color},children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium truncate",children:t.progetto||"TBD"}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs truncate",children:t.developer}),t.cliente_nome&&(0,tr.jsx)("p",{className:"text-blue-400 text-xs mt-1",children:t.cliente_nome}),t.valore>0&&(0,tr.jsxs)("p",{className:"text-emerald-400 text-sm font-medium mt-2",children:[br(t.valore)," AED"]})]})},t.id)}),!(null!==(p=t[e])&&void 0!==p&&p.length)&&(0,tr.jsx)("div",{className:"text-center py-8 text-zinc-600 text-sm border-2 border-dashed border-zinc-800 rounded-xl",children:"Trascina qui"})]})]},e)})})]})}function Gr(e){let{clienti:t,filters:n,setFilters:r,sales:s,onSelect:i,onCreate:o,onDelete:l,onUpdateCliente:d,users:u}=e;const[h,p]=(0,a.useState)([]),[m,f]=(0,a.useState)("created_at"),[g,x]=(0,a.useState)("desc"),v=e=>{const t=s.filter(t=>t.cliente_id===e),n=t.filter(e=>"venduto"===e.stato||"incassato"===e.stato);return{leads:t.length,value:n.reduce((e,t)=>e+Number(t.valore||0),0)}},b=[...t].sort((e,t)=>{let n=e[m],a=t[m];return"leads"===m?(n=v(e.id).leads,a=v(t.id).leads):"value"===m&&(n=v(e.id).value,a=v(t.id).value),"asc"===g?n>a?1:-1:n<a?1:-1}),y=async(e,t)=>{if(console.log("Bulk action:",e,t,"IDs:",h),"delete"===e){if(window.confirm("Eliminare ".concat(h.length," clienti?"))){for(const e of h)await l(e,!0);p([])}}else if("stato"===e){if(!d)return void console.error("onUpdateCliente not provided");for(const e of h)console.log("Updating stato for",e,"to",t),await d(e,{stato:t});p([])}else if("assegnato"===e){if(!d)return void console.error("onUpdateCliente not provided");for(const e of h)console.log("Assigning",e,"to",t),await d(e,{assegnato_a:t});p([])}},w=e=>{let{field:t,children:n,className:a=""}=e;return(0,tr.jsx)("th",{className:"text-left py-3 px-4 text-zinc-400 font-medium text-sm cursor-pointer hover:text-white transition-colors ".concat(a),onClick:()=>{m===t?x(e=>"asc"===e?"desc":"asc"):(f(t),x("asc"))},children:(0,tr.jsxs)("span",{className:"flex items-center gap-1",children:[n,m===t&&(0,tr.jsx)("span",{className:"text-amber-400",children:"asc"===g?"\u2191":"\u2193"})]})})};return(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3 flex-wrap flex-1",children:[(0,tr.jsxs)("div",{className:"relative min-w-[250px]",children:[(0,tr.jsx)(da,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500"}),(0,tr.jsx)("input",{type:"text",placeholder:"Cerca cliente...",value:n.search,onChange:e=>r(c(c({},n),{},{search:e.target.value})),className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-2.5 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-amber-500/50"})]}),(0,tr.jsxs)("select",{value:n.stato,onChange:e=>r(c(c({},n),{},{stato:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none",children:[(0,tr.jsx)("option",{value:"",children:"Tutti gli stati"}),gr.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]})]}),(0,tr.jsx)(Lr,{icon:Ma,onClick:o,children:"Nuovo Cliente"})]}),h.length>0&&(0,tr.jsx)(Ar,{className:"bg-amber-500/10 border-amber-500/30",children:(0,tr.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,tr.jsxs)("p",{className:"text-amber-400 font-medium",children:[h.length," clienti selezionati"]}),(0,tr.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,tr.jsxs)("select",{value:"",onChange:e=>y("stato",e.target.value),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm",children:[(0,tr.jsx)("option",{value:"",children:"Cambia stato..."}),gr.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(null===u||void 0===u?void 0:u.length)>0&&(0,tr.jsxs)("select",{value:"",onChange:e=>y("assegnato",e.target.value),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm",children:[(0,tr.jsx)("option",{value:"",children:"Assegna a..."}),u.map(e=>(0,tr.jsx)("option",{value:e.nome,children:e.nome},e.id))]}),(0,tr.jsxs)(Lr,{variant:"danger",size:"sm",onClick:()=>y("delete"),children:[(0,tr.jsx)(Da,{className:"w-4 h-4 mr-1"})," Elimina"]}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>p([]),children:(0,tr.jsx)(ia,{className:"w-4 h-4"})})]})]})}),(0,tr.jsx)(Ar,{padding:"p-0",className:"overflow-hidden",children:(0,tr.jsxs)("div",{className:"overflow-x-auto",children:[(0,tr.jsxs)("table",{className:"w-full",children:[(0,tr.jsx)("thead",{className:"bg-zinc-700/50/50 border-b border-zinc-700",children:(0,tr.jsxs)("tr",{children:[(0,tr.jsx)("th",{className:"w-12 py-3 px-4",children:(0,tr.jsx)("input",{type:"checkbox",checked:h.length===b.length&&b.length>0,onChange:()=>{h.length===b.length?p([]):p(b.map(e=>e.id))},className:"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-amber-500 focus:ring-amber-500"})}),(0,tr.jsx)(w,{field:"nome",children:"Cliente"}),(0,tr.jsx)(w,{field:"telefono",children:"Telefono"}),(0,tr.jsx)(w,{field:"email",children:"Email"}),(0,tr.jsx)(w,{field:"stato",children:"Stato"}),(0,tr.jsx)(w,{field:"assegnato_a",children:"Agente"}),(0,tr.jsx)(w,{field:"leads",children:"Lead"}),(0,tr.jsx)(w,{field:"value",children:"Valore"}),(0,tr.jsx)(w,{field:"budget_max",children:"Budget"}),(0,tr.jsx)(w,{field:"created_at",children:"Data"}),(0,tr.jsx)("th",{className:"w-20 py-3 px-4"})]})}),(0,tr.jsx)("tbody",{className:"divide-y divide-zinc-800",children:b.map(e=>{const t=v(e.id),n=h.includes(e.id);return(0,tr.jsxs)("tr",{className:"hover:bg-zinc-700/50/50 cursor-pointer transition-colors ".concat(n?"bg-amber-500/10":""),children:[(0,tr.jsx)("td",{className:"py-3 px-4",onClick:e=>e.stopPropagation(),children:(0,tr.jsx)("input",{type:"checkbox",checked:n,onChange:()=>{return t=e.id,void p(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-amber-500 focus:ring-amber-500"})}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>i(e),children:(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)(zr,{nome:e.nome,cognome:e.cognome,size:"sm"}),(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("p",{className:"text-white font-medium",children:[e.nome," ",e.cognome||""]}),e.azienda&&(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:e.azienda})]})]})}),(0,tr.jsx)("td",{className:"py-3 px-4 text-zinc-300",onClick:()=>i(e),children:e.telefono||"-"}),(0,tr.jsx)("td",{className:"py-3 px-4 text-zinc-300 text-sm",onClick:()=>i(e),children:e.email||"-"}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>i(e),children:(0,tr.jsx)(Er,{status:e.stato,type:"cliente"})}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>i(e),children:e.assegnato_a?(0,tr.jsx)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full",children:e.assegnato_a}):(0,tr.jsx)("span",{className:"text-zinc-600",children:"-"})}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>i(e),children:t.leads>0?(0,tr.jsx)("span",{className:"text-blue-400 font-medium",children:t.leads}):(0,tr.jsx)("span",{className:"text-zinc-600",children:"0"})}),(0,tr.jsx)("td",{className:"py-3 px-4",onClick:()=>i(e),children:t.value>0?(0,tr.jsx)("span",{className:"text-emerald-400 font-semibold",children:br(t.value)}):(0,tr.jsx)("span",{className:"text-zinc-600",children:"-"})}),(0,tr.jsx)("td",{className:"py-3 px-4 text-zinc-300",onClick:()=>i(e),children:e.budget_max?br(e.budget_max):"-"}),(0,tr.jsx)("td",{className:"py-3 px-4 text-zinc-500 text-sm",onClick:()=>i(e),children:e.created_at?new Date(e.created_at).toLocaleDateString("it-IT"):"-"}),(0,tr.jsx)("td",{className:"py-3 px-4",children:(0,tr.jsxs)("div",{className:"flex items-center gap-1",children:[(0,tr.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e)},className:"p-1.5 text-zinc-400 hover:text-white hover:bg-zinc-700 rounded-lg transition-colors",title:"Dettagli",children:(0,tr.jsx)(La,{className:"w-4 h-4"})}),(0,tr.jsx)("button",{onClick:t=>{t.stopPropagation(),window.confirm("Eliminare questo cliente?")&&l(e.id)},className:"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Elimina",children:(0,tr.jsx)(Da,{className:"w-4 h-4"})})]})})]},e.id)})})]}),0===b.length&&(0,tr.jsxs)("div",{className:"py-12 text-center",children:[(0,tr.jsx)(za,{className:"w-12 h-12 text-zinc-600 mx-auto mb-3"}),(0,tr.jsx)("p",{className:"text-zinc-500",children:"Nessun cliente trovato"}),(0,tr.jsx)(Lr,{className:"mt-4",icon:Ma,onClick:o,children:"Aggiungi Cliente"})]})]})})]})}function Jr(e){let{cliente:t,sales:n,tasks:r,onBack:s,onEdit:i,onDelete:o,updateCliente:l,onAddTask:c,onCompleteTask:d,onDeleteTask:u,onExportPDF:h}=e;const[p,m]=(0,a.useState)("info"),f=n.filter(e=>"venduto"===e.stato||"incassato"===e.stato).reduce((e,t)=>e+Number(t.valore||0),0);return(0,tr.jsxs)("div",{className:"space-y-6",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsx)(Lr,{variant:"ghost",icon:ba,onClick:s,children:"Indietro"}),(0,tr.jsx)("div",{className:"flex-1"}),(0,tr.jsx)(Lr,{variant:"ghost",icon:Ra,onClick:h,children:"PDF"}),(0,tr.jsx)(Lr,{variant:"ghost",icon:Ua,onClick:i,children:"Modifica"}),(0,tr.jsx)(Lr,{variant:"danger",icon:Da,onClick:o})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,tr.jsx)(zr,{nome:t.nome,cognome:t.cognome,size:"xl"}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsxs)("h1",{className:"text-2xl font-semibold text-white",children:[t.nome," ",t.cognome]}),(0,tr.jsxs)("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[(0,tr.jsx)(Er,{status:t.stato,type:"cliente"}),t.nazionalita&&(0,tr.jsx)("span",{className:"text-zinc-500 text-sm",children:t.nazionalita}),t.assegnato_a&&(0,tr.jsxs)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full flex items-center gap-1",children:[(0,tr.jsx)(Fa,{className:"w-3 h-3"})," ",t.assegnato_a]})]})]})]}),(0,tr.jsx)(Br,{phone:t.telefono,whatsapp:t.whatsapp||t.telefono,email:t.email,clienteName:t.nome})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,tr.jsxs)(Ar,{padding:"p-4",className:"text-center border-amber-500/20",children:[(0,tr.jsx)("p",{className:"text-2xl font-semibold text-amber-400",children:n.length}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Lead"})]}),(0,tr.jsxs)(Ar,{padding:"p-4",className:"text-center border-emerald-500/20",children:[(0,tr.jsx)("p",{className:"text-2xl font-semibold text-emerald-400",children:br(f)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Valore"})]}),(0,tr.jsxs)(Ar,{padding:"p-4",className:"text-center border-pink-500/20",children:[(0,tr.jsx)("p",{className:"text-2xl font-semibold text-pink-400",children:r.filter(e=>"pending"===e.stato).length}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Task"})]})]}),(0,tr.jsx)("div",{className:"flex gap-2 border-b border-[#334155]",children:["info","lead","task"].map(e=>(0,tr.jsx)("button",{onClick:()=>m(e),className:"px-4 py-3 text-sm font-medium border-b-2 transition-colors ".concat(p===e?"text-white border-amber-500":"text-zinc-500 border-transparent hover:text-white"),children:"info"===e?"Informazioni":"lead"===e?"Lead (".concat(n.length,")"):"Task (".concat(r.length,")")},e))}),"info"===p&&(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Telefono"}),(0,tr.jsx)("p",{className:"text-white",children:t.telefono||"-"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Email"}),(0,tr.jsx)("p",{className:"text-white truncate",children:t.email||"-"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Budget Min"}),(0,tr.jsx)("p",{className:"text-amber-400",children:t.budget_min?br(t.budget_min):"-"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Budget Max"}),(0,tr.jsx)("p",{className:"text-amber-400",children:t.budget_max?br(t.budget_max):"-"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Assegnato a"}),(0,tr.jsx)("p",{className:"text-blue-400",children:t.assegnato_a||"-"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Agente Rif."}),(0,tr.jsx)("p",{className:"text-white",children:t.agente_riferimento||"-"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Fonte"}),(0,tr.jsx)("p",{className:"text-white",children:t.fonte||"-"})]})]}),t.note&&(0,tr.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#334155]",children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-1",children:"Note"}),(0,tr.jsx)("p",{className:"text-white text-sm",children:t.note})]}),(0,tr.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#334155]",children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-2",children:"Stato"}),(0,tr.jsx)("div",{className:"flex flex-wrap gap-2",children:gr.map(e=>(0,tr.jsx)("button",{onClick:()=>l(t.id,{stato:e}),className:"px-3 py-1.5 rounded-lg text-xs font-medium transition-all ".concat(t.stato===e?"bg-amber-500 text-black":"bg-zinc-700/50 text-zinc-400 hover:text-white"),children:e},e))})]})]}),"lead"===p&&(0,tr.jsx)("div",{className:"space-y-2",children:0===n.length?(0,tr.jsx)(Dr,{icon:ma,title:"Nessun lead",description:"Non ci sono lead per questo cliente"}):n.map(e=>(0,tr.jsx)(Ar,{padding:"p-4",children:(0,tr.jsxs)("div",{className:"flex justify-between items-start",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:e.progetto}),(0,tr.jsx)(Er,{status:e.stato||"lead"})]}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm",children:[e.developer," \u2022 ",e.zona]})]}),(0,tr.jsxs)("div",{className:"text-right",children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:e.valore>0?br(e.valore):"TBD"}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:wr(e.data)})]})]})},e.id))}),"task"===p&&(0,tr.jsxs)("div",{className:"space-y-3",children:[(0,tr.jsx)(Lr,{icon:Na,onClick:c,className:"w-full",variant:"secondary",children:"Nuovo Task"}),0===r.length?(0,tr.jsx)(Dr,{icon:ha,title:"Nessun task",description:"Non ci sono task per questo cliente"}):r.map(e=>(0,tr.jsx)(Ar,{padding:"p-4",className:"completato"===e.stato?"opacity-50":Nr(e.scadenza)?"border-red-500/30":"",children:(0,tr.jsxs)("div",{className:"flex justify-between items-start",children:[(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("p",{className:"text-white font-medium ".concat("completato"===e.stato?"line-through":""),children:e.titolo}),(0,tr.jsx)(Er,{status:e.priorita,type:"priority"})]}),e.scadenza&&(0,tr.jsx)("p",{className:"text-sm mt-1 ".concat(Nr(e.scadenza)&&"completato"!==e.stato?"text-red-400":"text-zinc-500"),children:yr(e.scadenza)})]}),(0,tr.jsxs)("div",{className:"flex gap-1",children:["completato"!==e.stato&&(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:na,onClick:()=>d(e.id)}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:Da,onClick:()=>u(e.id)})]})]})},e.id))]})]})}function $r(e){let{tasks:t,clienti:n,users:r,onComplete:s,onDelete:i,onEdit:o,onCreate:l}=e;const[c,d]=(0,a.useState)("pending"),u=t.filter(e=>"pending"===c?"pending"===e.stato:"overdue"===c?"pending"===e.stato&&Nr(e.scadenza):"today"===c?"pending"===e.stato&&kr(e.scadenza):"completed"!==c||"completato"===e.stato),h={pending:t.filter(e=>"pending"===e.stato).length,overdue:t.filter(e=>"pending"===e.stato&&Nr(e.scadenza)).length,today:t.filter(e=>"pending"===e.stato&&kr(e.scadenza)).length};return(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"flex flex-wrap gap-3 items-center",children:[(0,tr.jsx)(Lr,{icon:Na,onClick:l,children:"Nuovo Task"}),(0,tr.jsx)("div",{className:"flex-1"}),(0,tr.jsx)("div",{className:"flex gap-2",children:[{id:"pending",label:"Pending",count:h.pending,color:"#60A5FA"},{id:"overdue",label:"Scaduti",count:h.overdue,color:"#EF4444"},{id:"today",label:"Oggi",count:h.today,color:"#FBBF24"},{id:"completed",label:"Fatto",color:"#34D399"}].map(e=>(0,tr.jsxs)("button",{onClick:()=>d(e.id),className:"px-3 py-1.5 rounded-lg text-xs font-medium transition-all ".concat(c===e.id?"text-white":"text-zinc-500 hover:text-white"),style:c===e.id?{background:"".concat(e.color,"20"),color:e.color}:{},children:[e.label," ",void 0!==e.count&&"(".concat(e.count,")")]},e.id))})]}),(0,tr.jsx)("div",{className:"space-y-2",children:0===u.length?(0,tr.jsx)(Dr,{icon:ha,title:"Nessun task",description:"pending"===c?"Tutti i task sono completati!":"Nessun task in questa categoria"}):u.map(e=>{const t=(a=e.cliente_id,n.find(e=>e.id===a));var a;return(0,tr.jsx)(Ar,{padding:"p-4",className:"".concat("completato"===e.stato?"opacity-50":""," ").concat(Nr(e.scadenza)&&"completato"!==e.stato?"border-red-500/30 bg-red-500/5":""),children:(0,tr.jsxs)("div",{className:"flex items-start gap-4",children:[(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[(0,tr.jsx)("p",{className:"text-white font-medium ".concat("completato"===e.stato?"line-through":""),children:e.titolo}),(0,tr.jsx)(Er,{status:e.priorita,type:"priority"}),Nr(e.scadenza)&&"completato"!==e.stato&&(0,tr.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-red-500/20 text-red-400 animate-pulse",children:"Scaduto"})]}),e.descrizione&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:e.descrizione}),e.note&&(0,tr.jsxs)("p",{className:"text-blue-400 text-sm mt-1 bg-blue-500/10 px-2 py-1 rounded",children:["\ud83d\udcdd ",e.note]}),(0,tr.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[e.scadenza&&(0,tr.jsxs)("span",{className:"flex items-center gap-1 ".concat(Nr(e.scadenza)&&"completato"!==e.stato?"text-red-400":"text-zinc-500"),children:[(0,tr.jsx)(Ea,{className:"w-3 h-3"}),yr(e.scadenza)]}),e.assegnato_a&&(0,tr.jsxs)("span",{className:"text-blue-400 flex items-center gap-1",children:[(0,tr.jsx)(Fa,{className:"w-3 h-3"}),e.assegnato_a]}),t&&(0,tr.jsx)("span",{className:"text-amber-400",children:t.nome})]})]}),(0,tr.jsxs)("div",{className:"flex gap-1",children:["completato"!==e.stato&&(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:Ua,onClick:()=>o(e)}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:na,onClick:()=>s(e.id)})]}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:Da,onClick:()=>i(e.id)})]})]})},e.id)})})]})}function Qr(e){let{tasks:t,allTasks:n,clienti:r,onComplete:s,onAddNote:i}=e;const[o,l]=(0,a.useState)("pending"),c=n.filter(e=>"completato"===e.stato),d="completed"===o?c:t.filter(e=>"overdue"!==o||Nr(e.scadenza));return(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsx)(Tr,{icon:ha,title:"I tuoi Task",accent:"244,114,182"}),(0,tr.jsx)("div",{className:"flex gap-2 mb-4",children:[{id:"pending",label:"Da fare",count:t.length},{id:"overdue",label:"Scaduti",count:t.filter(e=>Nr(e.scadenza)).length},{id:"completed",label:"Completati",count:c.length}].map(e=>(0,tr.jsxs)("button",{onClick:()=>l(e.id),className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat(o===e.id?"bg-pink-500/20 text-pink-400":"text-zinc-500 hover:text-white"),children:[e.label," (",e.count,")"]},e.id))}),(0,tr.jsx)("div",{className:"space-y-2",children:0===d.length?(0,tr.jsx)(Dr,{icon:na,title:"pending"===o?"Tutto fatto!":"Nessun task",description:"Non ci sono task in questa categoria"}):d.map(e=>{const t=(n=e.cliente_id,r.find(e=>e.id===n));var n;return(0,tr.jsx)(Ar,{padding:"p-4",className:"completato"===e.stato?"opacity-50":Nr(e.scadenza)?"border-red-500/30":"",children:(0,tr.jsxs)("div",{className:"flex items-start gap-4",children:[(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,tr.jsx)("p",{className:"text-white font-medium ".concat("completato"===e.stato?"line-through":""),children:e.titolo}),(0,tr.jsx)(Er,{status:e.priorita,type:"priority"}),Nr(e.scadenza)&&"completato"!==e.stato&&(0,tr.jsx)("span",{className:"px-2 py-0.5 rounded text-xs bg-red-500/20 text-red-400",children:"Scaduto"})]}),e.descrizione&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:e.descrizione}),e.note&&(0,tr.jsxs)("p",{className:"text-blue-400 text-sm mt-2 bg-blue-500/10 px-3 py-2 rounded-lg",children:["\ud83d\udcdd ",e.note]}),(0,tr.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[e.scadenza&&(0,tr.jsxs)("span",{className:"flex items-center gap-1 ".concat(Nr(e.scadenza)&&"completato"!==e.stato?"text-red-400":"text-zinc-500"),children:[(0,tr.jsx)(Ea,{className:"w-3 h-3"}),yr(e.scadenza)]}),t&&(0,tr.jsx)("span",{className:"text-amber-400",children:t.nome})]})]}),"completato"!==e.stato&&(0,tr.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,tr.jsx)("button",{onClick:()=>i(e),className:"w-10 h-10 rounded-xl bg-blue-500/10 text-blue-400 flex items-center justify-center hover:bg-blue-500/20 transition-colors",children:(0,tr.jsx)(la,{className:"w-5 h-5"})}),(0,tr.jsx)("button",{onClick:()=>s(e.id),className:"w-10 h-10 rounded-xl bg-emerald-500/10 text-emerald-400 flex items-center justify-center hover:bg-emerald-500/20 transition-colors",children:(0,tr.jsx)(na,{className:"w-5 h-5"})})]})]})},e.id)})})]})}function Yr(e){let{users:t,onCreate:n,onEdit:r,onDelete:s}=e;const[i,o]=(0,a.useState)(null),l=e=>{navigator.clipboard.writeText("KeyPrime\n".concat("undefined"!==typeof window?window.location.origin:"","\n").concat(e.username," / ").concat(e.password)),o(e.id),setTimeout(()=>o(null),2e3)};return(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,tr.jsxs)("p",{className:"text-zinc-500",children:[t.length," membri"]}),(0,tr.jsx)(Lr,{icon:Ma,onClick:n,children:"Nuovo Utente"})]}),(0,tr.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,tr.jsx)(Ar,{padding:"p-4",children:(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsx)(zr,{nome:e.nome,size:"lg"}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:e.nome}),(0,tr.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs ".concat("admin"===e.ruolo?"bg-violet-500/20 text-violet-400":"agente_admin"===e.ruolo?"bg-purple-500/20 text-purple-400":"agente"===e.ruolo?"bg-blue-500/20 text-blue-400":"bg-emerald-500/20 text-emerald-400"),children:"agente_admin"===e.ruolo?"Ag. Admin":e.ruolo}),!e.attivo&&(0,tr.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs bg-red-500/20 text-red-400",children:"Disattivo"})]}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm mt-1",children:[e.username," / ",e.password,e.email&&" \u2022 ".concat(e.email)]})]}),(0,tr.jsxs)("div",{className:"flex gap-2",children:[(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:i===e.id?na:Ba,onClick:()=>l(e)}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:Ua,onClick:()=>r(e)}),"admin"!==e.ruolo&&(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",icon:Da,onClick:()=>s(e.id)})]})]})},e.id))})]})}function Xr(e){let{agent:t,sales:n,onBack:a}=e;const r=n.filter(e=>"agente"===t.type?e.agente===t.name:e.segnalatore===t.name),s=r.filter(e=>"venduto"===e.stato||"incassato"===e.stato),i=r.reduce((e,t)=>e+Number(t.valore||0),0),o=s.reduce((e,t)=>e+Number(t.valore||0),0),l="agente"===t.type?.7:.3,c=s.reduce((e,t)=>e+Number(t.valore||0)*(t.commission_pct||5)/100*l,0),d=s.filter(e=>e.pagato).reduce((e,t)=>e+Number(t.valore||0)*(t.commission_pct||5)/100*l,0),u=mr.reduce((e,t)=>(e[t]=r.filter(e=>(e.stato||"lead")===t).length,e),{}),h=r.reduce((e,t)=>(t.zona&&(e[t.zona]=(e[t.zona]||0)+Number(t.valore||0)),e),{}),p=r.reduce((e,t)=>{var n;const a=(null===(n=t.data)||void 0===n?void 0:n.substring(0,7))||"N/A";return e[a]=(e[a]||0)+Number(t.valore||0),e},{});return(0,tr.jsx)("div",{className:"fixed inset-0 z-50 bg-[#0f172a] overflow-auto",children:(0,tr.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,tr.jsx)(Lr,{variant:"ghost",icon:ba,onClick:a,children:"Indietro"}),(0,tr.jsx)("div",{className:"flex-1"})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,tr.jsx)(zr,{nome:t.name,size:"xl"}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("h1",{className:"text-2xl font-semibold text-white",children:t.name}),(0,tr.jsx)("p",{className:"text-zinc-500 capitalize",children:t.type})]})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Volume Totale"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-white mt-1",children:br(i)}),(0,tr.jsx)("p",{className:"text-zinc-600 text-xs",children:"AED"})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Lead"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-blue-400 mt-1",children:r.length})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Vendite Chiuse"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-emerald-400 mt-1",children:s.length}),(0,tr.jsxs)("p",{className:"text-zinc-600 text-xs",children:[br(o)," AED"]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Commissioni"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-amber-400 mt-1",children:br(c)}),(0,tr.jsxs)("p",{className:"text-emerald-400 text-xs",children:["Pagate: ",br(d)]})]})]}),(0,tr.jsxs)(Ar,{className:"mb-6",children:[(0,tr.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Pipeline"}),(0,tr.jsx)("div",{className:"grid grid-cols-5 gap-2",children:mr.map(e=>{var t,n;return(0,tr.jsxs)("div",{className:"text-center p-3 rounded-xl",style:{background:null===(t=vr.status[e])||void 0===t?void 0:t.bg},children:[(0,tr.jsx)("div",{className:"text-xl font-semibold text-white",children:u[e]||0}),(0,tr.jsx)("div",{className:"text-xs",style:{color:null===(n=vr.status[e])||void 0===n?void 0:n.color},children:fr[e]||e})]},e)})})]}),(0,tr.jsxs)("div",{className:"grid lg:grid-cols-2 gap-4 mb-6",children:[(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[(0,tr.jsx)(Pa,{className:"w-4 h-4 text-emerald-400"}),"Zone"]}),(0,tr.jsxs)("div",{className:"space-y-2",children:[Object.entries(h).sort((e,t)=>t[1]-e[1]).slice(0,5).map(e=>{let[t,n]=e;return(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("span",{className:"text-zinc-400 text-sm w-24 truncate",children:t}),(0,tr.jsx)("div",{className:"flex-1",children:(0,tr.jsx)(Pr,{value:n,max:Object.values(h).sort((e,t)=>t-e)[0]||1,color:"#34D399"})}),(0,tr.jsx)("span",{className:"text-white text-sm w-20 text-right",children:br(n)})]},t)}),0===Object.keys(h).length&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Nessun dato"})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[(0,tr.jsx)(_a,{className:"w-4 h-4 text-violet-400"}),"Trend"]}),(0,tr.jsxs)("div",{className:"space-y-2",children:[Object.entries(p).sort((e,t)=>e[0].localeCompare(t[0])).slice(-5).map(e=>{let[t,n]=e;return(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("span",{className:"text-zinc-400 text-sm w-16",children:t}),(0,tr.jsx)("div",{className:"flex-1",children:(0,tr.jsx)(Pr,{value:n,max:Math.max(...Object.values(p))||1,color:"#A78BFA"})}),(0,tr.jsx)("span",{className:"text-white text-sm w-20 text-right",children:br(n)})]},t)}),0===Object.keys(p).length&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:"Nessun dato"})]})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Ultimi Lead"}),(0,tr.jsxs)("div",{className:"space-y-2",children:[r.slice(0,10).map(e=>{var t,n;return(0,tr.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-zinc-700/50/50 rounded-xl",children:[(0,tr.jsx)("div",{className:"w-1 h-10 rounded-full",style:{background:null===(t=vr.status[e.stato||"lead"])||void 0===t?void 0:t.color}}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium truncate",children:e.progetto||"TBD"}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-xs",children:[e.developer," \u2022 ",e.zona]})]}),(0,tr.jsxs)("div",{className:"text-right",children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium",children:e.valore>0?br(e.valore):"TBD"}),(0,tr.jsx)("p",{className:"text-xs",style:{color:null===(n=vr.status[e.stato||"lead"])||void 0===n?void 0:n.color},children:e.stato||"lead"})]})]},e.id)}),0===r.length&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm text-center py-4",children:"Nessun lead"})]})]})]})})}function Zr(e){var t,n,r,s;let{projects:i,onSelectProject:o,selectedProject:l,onAreaClick:d}=e;const u=(0,a.useRef)(null),h=(0,a.useRef)(null),p=(0,a.useRef)(null),m=(0,a.useRef)({}),[f,g]=(0,a.useState)(!1),[x,v]=(0,a.useState)(null),[b,y]=(0,a.useState)(null),w=a.useMemo(()=>{const e={};return i.forEach(t=>{var n,a;let r=null;if(null!==(n=t.coordinates)&&void 0!==n&&n.lat&&null!==(a=t.coordinates)&&void 0!==a&&a.lon)r={lat:t.coordinates.lat,lng:t.coordinates.lon,zoom:14};else{var s,i;r=(e=>{if(!e)return null;const t=e.toLowerCase();for(const[n,a]of Object.entries(lr))if(t.includes(n.toLowerCase()))return a;for(const[n,a]of Object.entries(lr))if(n.toLowerCase().split(" ").some(e=>e.length>3&&t.includes(e)))return a;return null})((null===(s=t.location)||void 0===s?void 0:s.full_name)||(null===(i=t.location)||void 0===i?void 0:i.name)||"Unknown")}if(r){const n=.008*(Math.random()-.5),a=.008*(Math.random()-.5);e[t.project_id]=c(c({},t),{},{coords:{lat:r.lat+n,lng:r.lng+a,zoom:r.zoom}})}}),e},[i]);(0,a.useEffect)(()=>{if(u.current&&!h.current){if(!document.getElementById("leaflet-css")){const e=document.createElement("link");e.id="leaflet-css",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",e.rel="stylesheet",document.head.appendChild(e)}if(window.L)setTimeout(e,100);else{const t=document.createElement("script");t.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",t.async=!0,t.onload=()=>setTimeout(e,100),t.onerror=()=>v("Errore caricamento Leaflet"),document.head.appendChild(t)}return()=>{h.current&&(h.current.remove(),h.current=null)}}function e(){if(u.current&&!h.current)try{h.current=window.L.map(u.current,{center:[cr,dr],zoom:10,zoomControl:!1}),window.L.control.zoom({position:"bottomright"}).addTo(h.current),window.L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',maxZoom:19}).addTo(h.current),p.current=window.L.layerGroup().addTo(h.current),g(!0)}catch(e){console.error("Map init error:",e),v("Errore inizializzazione mappa")}}},[]),(0,a.useEffect)(()=>{h.current&&f&&window.L&&p.current&&(p.current.clearLayers(),m.current={},Object.values(w).forEach(e=>{const{coords:t}=e,n=e.price_from,a=n>0?"From "+(n>=1e6?(n/1e6).toFixed(1)+"M":Math.round(n/1e3)+"K"):"Price TBD",r=(null===l||void 0===l?void 0:l.project_id)===e.project_id,s='\n        <div class="pf-marker '.concat(r?"selected":"",'">\n          <span>').concat(a,"</span>\n        </div>\n      "),i=window.L.divIcon({html:s,className:"pf-marker-container",iconSize:[90,28],iconAnchor:[45,28]}),o=window.L.marker([t.lat,t.lng],{icon:i}).addTo(p.current);o.on("click",t=>{window.L.DomEvent.stopPropagation(t),N(!0),y(e),setTimeout(()=>N(!1),100)}),m.current[e.project_id]=o}))},[f,w,l,o]),(0,a.useEffect)(()=>{if(!h.current||!f||!l)return;const e=w[l.project_id];null!==e&&void 0!==e&&e.coords&&h.current.flyTo([e.coords.lat,e.coords.lng],14,{duration:.5})},[l,f,w]);const[j,N]=(0,a.useState)(!1);return x?(0,tr.jsx)("div",{className:"w-full h-full bg-zinc-800 flex items-center justify-center",children:(0,tr.jsxs)("div",{className:"text-center",children:[(0,tr.jsx)(qa,{className:"w-12 h-12 text-red-400 mx-auto mb-3"}),(0,tr.jsx)("p",{className:"text-red-400",children:x})]})}):(0,tr.jsxs)("div",{className:"relative w-full h-full",onClick:()=>{j||y(null),N(!1)},children:[(0,tr.jsx)("div",{ref:u,className:"absolute inset-0",style:{background:"#1a1a1a"}}),!f&&(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800 flex items-center justify-center z-[1000]",children:(0,tr.jsx)(ya,{className:"w-8 h-8 text-orange-400 animate-spin"})}),b&&(0,tr.jsx)("div",{className:"absolute top-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-[1000] animate-fadeIn",children:(0,tr.jsxs)("div",{className:"bg-zinc-800 border border-zinc-700 rounded-2xl overflow-hidden shadow-2xl",children:[(0,tr.jsxs)("div",{className:"relative h-40",children:[null!==(t=b.images)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.medium_image_url?(0,tr.jsx)("img",{src:b.images[0].medium_image_url,alt:"",className:"w-full h-full object-cover"}):(0,tr.jsx)("div",{className:"w-full h-full bg-zinc-700/50 flex items-center justify-center",children:(0,tr.jsx)(ga,{className:"w-12 h-12 text-zinc-600"})}),(0,tr.jsx)("button",{onClick:e=>{e.stopPropagation(),y(null)},className:"absolute top-2 right-2 p-1.5 bg-zinc-800/50 rounded-full text-white hover:bg-zinc-800/70",children:(0,tr.jsx)(ia,{className:"w-4 h-4"})}),(0,tr.jsx)("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-orange-500 text-white text-xs font-medium rounded-lg",children:"completed"===b.construction_phase_key?"\u2713 Completato":"under_construction"===b.construction_phase_key?"\ud83c\udfd7\ufe0f In Costruzione":"\ud83d\ude80 Lancio"})]}),(0,tr.jsxs)("div",{className:"p-4",children:[(0,tr.jsx)("h3",{className:"text-white font-semibold truncate",children:b.title}),(0,tr.jsx)("p",{className:"text-zinc-400 text-sm truncate",children:(null===(r=b.location)||void 0===r?void 0:r.full_name)||(null===(s=b.location)||void 0===s?void 0:s.name)}),(0,tr.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,tr.jsx)("p",{className:"text-orange-400 font-bold",children:b.price_from>0?"AED "+(k=b.price_from,k&&0!==k?parseFloat(k).toLocaleString():"TBD"):"TBD"}),b.url?(0,tr.jsxs)("a",{href:b.url,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"px-3 py-1.5 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg flex items-center gap-1",children:[(0,tr.jsx)(Ia,{className:"w-3.5 h-3.5"})," PropertyFinder"]}):(0,tr.jsx)(Lr,{size:"sm",onClick:e=>{e.stopPropagation(),y(null)},children:"Chiudi"})]})]})]})}),(0,tr.jsx)("div",{className:"absolute bottom-4 left-4 z-[1000]",children:(0,tr.jsx)("div",{className:"bg-zinc-800/90 backdrop-blur border border-zinc-700 rounded-xl px-3 py-2",children:(0,tr.jsxs)("p",{className:"text-white text-sm font-medium",children:[Object.keys(w).length," progetti sulla mappa"]})})}),(0,tr.jsx)("style",{children:"\n        .pf-marker-container { background: transparent !important; border: none !important; }\n        .pf-marker {\n          background: #DC2626;\n          color: white;\n          padding: 5px 10px;\n          border-radius: 4px;\n          font-size: 11px;\n          font-weight: 600;\n          box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n          cursor: pointer;\n          transition: all 0.15s ease;\n          white-space: nowrap;\n          text-align: center;\n        }\n        .pf-marker:hover {\n          background: #B91C1C;\n          transform: scale(1.05);\n          z-index: 1000 !important;\n        }\n        .pf-marker.selected {\n          background: #1D4ED8;\n          transform: scale(1.1);\n          z-index: 1001 !important;\n        }\n        .leaflet-control-zoom { border: none !important; border-radius: 8px !important; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.2); }\n        .leaflet-control-zoom a { \n          background: white !important; \n          color: #333 !important; \n          border: none !important;\n          border-bottom: 1px solid #eee !important;\n          width: 32px !important;\n          height: 32px !important;\n          line-height: 32px !important;\n        }\n        .leaflet-control-zoom a:hover { background: #f5f5f5 !important; }\n        .leaflet-control-zoom-in { border-radius: 8px 8px 0 0 !important; }\n        .leaflet-control-zoom-out { border-radius: 0 0 8px 8px !important; border-bottom: none !important; }\n      "})]});var k}function es(e){let{clienti:t,onCreateLead:n,savedListings:r,onSaveListing:s,onRemoveListing:i,user:o}=e;const[l,d]=(0,a.useState)("list"),[u,h]=(0,a.useState)([]),[p,m]=(0,a.useState)([]),[f,g]=(0,a.useState)(!1),[x,v]=(0,a.useState)(null),[b,y]=(0,a.useState)({search:"",location:"",emirate:"",minPrice:"",maxPrice:"",bedrooms:"",developer:"",status:"",deliveryYear:"",sortBy:"hotness"}),[w,j]=(0,a.useState)(null),[N,k]=(0,a.useState)(null),[_,S]=(0,a.useState)(1),[C,z]=(0,a.useState)(1),[E,A]=(0,a.useState)(0),[T,O]=(0,a.useState)(null),[P,D]=(0,a.useState)(""),[R,I]=(0,a.useState)({byZone:[],byDeveloper:[],avgPrice:0}),[L,M]=(0,a.useState)(!1),U=["Dubai","Abu Dhabi","Ras Al Khaimah","Sharjah","Ajman","Umm Al Quwain"],F={Dubai:["Dubai Marina","Downtown Dubai","Business Bay","Palm Jumeirah","JBR","Dubai Hills Estate","Mohammed Bin Rashid City","Dubai Creek Harbour","Jumeirah Village Circle","JVC","JLT","Dubai South","DAMAC Hills","DAMAC Hills 2","Arabian Ranches","Meydan","DIFC","Dubai Islands","Expo City","City Walk","Sobha Hartland","Tilal Al Ghaf","The Valley","Motor City","Sports City","Al Furjan","Discovery Gardens","International City","Dubai Silicon Oasis","Arjan","Al Barsha","Jumeirah","Umm Suqeim","Al Quoz","Deira","Bur Dubai"],"Abu Dhabi":["Yas Island","Saadiyat Island","Al Reem Island","Al Raha Beach","Khalifa City","Masdar City","Al Ghadeer","Al Shamkha","Corniche"],"Ras Al Khaimah":["Al Marjan Island","Mina Al Arab","Al Hamra Village","Hayat Island","RAK Central","Yasmin Village"],Sharjah:["Aljada","Al Mamzar Sharjah","Al Nahda Sharjah","Al Majaz","Muwaileh","Al Khan"],Ajman:["Ajman Downtown","Ajman Corniche","Al Rashidiya","Al Nuaimiya","Emirates City"],"Umm Al Quwain":["UAQ Marina","UAQ Corniche","Al Salamah"]},B=b.emirate?F[b.emirate]||[]:Object.values(F).flat(),q=["Emaar Properties","Damac Properties","Sobha Realty","Nakheel","Meraas","Aldar Properties","Azizi Developments","Binghatti","Ellington","Omniyat Group","Danube Properties","Select Group","Deyaar","MAG","Reportage Properties"],H=["Studio","1","2","3","4","5+"];(0,a.useEffect)(()=>{V(),W()},[]);const V=async()=>{try{const{data:e}=await sr.from("pf_projects").select("location_name, price_from").neq("construction_phase","completed");if(e){const t={};let n=0,a=0;e.forEach(e=>{const r=e.location_name||"Altro";t[r]||(t[r]={count:0,totalPrice:0}),t[r].count++,e.price_from>0&&(t[r].totalPrice+=e.price_from,n+=e.price_from,a++)});const r=Object.entries(t).map(e=>{let[t,n]=e;return{name:t,count:n.count,avgPrice:n.totalPrice/n.count||0}}).sort((e,t)=>t.count-e.count).slice(0,10);I(e=>c(c({},e),{},{byZone:r,avgPrice:n/a||0}))}const{data:t}=await sr.from("pf_projects").select("developer_name").not("developer_name","is",null).neq("construction_phase","completed");if(t){const e={};t.forEach(t=>{const n=t.developer_name;e[n]=(e[n]||0)+1});const n=Object.entries(e).map(e=>{let[t,n]=e;return{name:t,count:n}}).sort((e,t)=>t.count-e.count).slice(0,10);I(e=>c(c({},e),{},{byDeveloper:n}))}}catch(e){console.error("Stats error:",e)}},W=async()=>{try{const{data:e}=await sr.from("pf_projects").select("project_id, title, location_name, location_full, price_from, construction_phase, url, raw_data").neq("construction_phase","completed").not("raw_data->location->coordinates","is",null).limit(2e3);if(e){const t=e.map(e=>{var t,n,a;return{project_id:e.project_id,title:e.title,location:{name:e.location_name,full_name:e.location_full},price_from:e.price_from,construction_phase_key:e.construction_phase,url:e.url,images:null===(t=e.raw_data)||void 0===t?void 0:t.images,coordinates:null===(n=e.raw_data)||void 0===n||null===(a=n.location)||void 0===a?void 0:a.coordinates}}).filter(e=>{var t,n;return(null===(t=e.coordinates)||void 0===t?void 0:t.lat)&&(null===(n=e.coordinates)||void 0===n?void 0:n.lon)});m(t)}}catch(e){console.error("Map projects error:",e)}},K=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;g(!0),v(null),S(e);try{let t=sr.from("pf_projects").select("*",{count:"exact"});if(t=b.status?t.eq("construction_phase",b.status):t.neq("construction_phase","completed"),t=t.or("delivery_date.is.null,delivery_date.gte.2024-01-01"),b.search&&(t=t.or("title.ilike.%".concat(b.search,"%,location_full.ilike.%").concat(b.search,"%,developer_name.ilike.%").concat(b.search,"%"))),b.emirate&&(t=t.ilike("location_full","%".concat(b.emirate,"%"))),b.location&&(t=t.or("location_name.ilike.%".concat(b.location,"%,location_full.ilike.%").concat(b.location,"%"))),b.developer&&(t=t.ilike("developer_name","%".concat(b.developer,"%"))),b.minPrice&&(t=t.gte("price_from",parseInt(b.minPrice))),b.maxPrice&&(t=t.lte("price_from",parseInt(b.maxPrice))),b.deliveryYear){const e="".concat(b.deliveryYear,"-01-01"),n="".concat(b.deliveryYear,"-12-31");t=t.gte("delivery_date",e).lte("delivery_date",n)}switch(b.bedrooms&&("Studio"===b.bedrooms?t=t.contains("bedrooms",{available:[0]}):"5+"!==b.bedrooms&&(t=t.contains("bedrooms",{available:[parseInt(b.bedrooms)]}))),b.sortBy){case"price_asc":t=t.order("price_from",{ascending:!0,nullsFirst:!1});break;case"price_desc":t=t.order("price_from",{ascending:!1,nullsFirst:!1});break;case"delivery":t=t.order("delivery_date",{ascending:!0,nullsFirst:!1});break;default:t=t.order("hotness_level",{ascending:!1,nullsFirst:!1})}t=t.range(24*(e-1),24*e-1);const{data:n,error:a,count:r}=await t;if(a)throw a;const s=(n||[]).map(e=>{var t,n,a,r,s;return{project_id:e.project_id,title:e.title,location:{name:e.location_name,full_name:e.location_full},developer:{name:e.developer_name,logo:null===(t=e.raw_data)||void 0===t||null===(n=t.developer)||void 0===n?void 0:n.logo},price_from:e.price_from,bedrooms:e.bedrooms,delivery_date:e.delivery_date,construction_phase_key:e.construction_phase,hotness_level:e.hotness_level,images:e.images||[],payment_plans:e.payment_plans,url:e.url,brochure_url:e.brochure_url||(null===(a=e.raw_data)||void 0===a||null===(r=a.brochure)||void 0===r?void 0:r.url)||(null===(s=e.raw_data)||void 0===s?void 0:s.brochure)||(e.project_id&&e.project_id.includes("-")?"https://new-projects-media.propertyfinder.com/project/".concat(e.project_id,"/brochure/application/original.pdf"):null)}});let i=s;"5+"===b.bedrooms&&(i=s.filter(e=>{var t,n;return null===(t=e.bedrooms)||void 0===t||null===(n=t.available)||void 0===n?void 0:n.some(e=>e>=5)})),h(i),A(r||0),z(Math.ceil((r||0)/24))}catch(t){console.error("Supabase Error:",t),v("Errore nel caricamento progetti.")}finally{g(!1)}},G=e=>{e>=1&&e<=C&&(K(e),window.scrollTo({top:0,behavior:"smooth"}))};(0,a.useEffect)(()=>{K(1)},[]);const J=e=>null===r||void 0===r?void 0:r.some(t=>t.property_id===e),$=e=>{if(!e||0===e)return"TBD";const t=parseFloat(e);return t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(0)+"K":t.toLocaleString()},Q=e=>{var t;if(null===e||void 0===e||null===(t=e.available)||void 0===t||!t.length)return null;const n=e.available;if(1===n.length)return 0===n[0]?"Studio":n[0]+" BR";const a=Math.min(...n),r=Math.max(...n);return 0===a?"Studio - "+r+" BR":a+" - "+r+" BR"},Y=e=>{if(!e)return null;const t=new Date(e);return"Q"+Math.ceil((t.getMonth()+1)/3)+" "+t.getFullYear()},X=e=>{var t;if(null===e||void 0===e||null===(t=e.plans)||void 0===t||!t[0])return null;const n=e.plans[0].summary;return n.down_payment+"/"+n.during_construction+"/"+n.handover},Z=(e,t)=>{O(e),D(t)},ee=T||u;return(0,tr.jsxs)("div",{className:"h-full flex flex-col",children:[(0,tr.jsxs)("div",{className:"flex-shrink-0 mb-4",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[(0,tr.jsx)(ga,{className:"w-6 h-6 text-orange-400"}),"Off-Plan Projects"]}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm mt-1",children:[E>0?E.toLocaleString()+" progetti":"Cerca progetti",P&&" \u2022 "+P]})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>M(!L),icon:fa,children:L?"Nascondi":"Stats"}),(0,tr.jsxs)("div",{className:"flex items-center gap-2 bg-zinc-700/50/50 p-1 rounded-xl",children:[(0,tr.jsx)("button",{onClick:()=>{d("list"),O(null)},className:"p-2 rounded-lg transition-colors "+("list"===l?"bg-orange-500 text-white":"text-zinc-400 hover:text-white"),title:"Lista",children:(0,tr.jsx)(Ha,{className:"w-5 h-5"})}),(0,tr.jsx)("button",{onClick:()=>d("map"),className:"p-2 rounded-lg transition-colors "+("map"===l?"bg-orange-500 text-white":"text-zinc-400 hover:text-white"),title:"Mappa",children:(0,tr.jsx)(Va,{className:"w-5 h-5"})}),(0,tr.jsxs)("button",{onClick:()=>d("saved"),className:"p-2 rounded-lg transition-colors relative "+("saved"===l?"bg-orange-500 text-white":"text-zinc-400 hover:text-white"),title:"Salvati",children:[(0,tr.jsx)("svg",{className:"w-5 h-5",fill:"saved"===l?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,tr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),(null===r||void 0===r?void 0:r.length)>0&&(0,tr.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-orange-500 rounded-full text-[10px] flex items-center justify-center text-white font-bold",children:r.length})]})]})]})]}),L&&(0,tr.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,tr.jsxs)(Ar,{className:"p-4",children:[(0,tr.jsxs)("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[(0,tr.jsx)(Pa,{className:"w-4 h-4 text-orange-400"}),"Top Zone"]}),(0,tr.jsx)("div",{className:"space-y-2",children:R.byZone.slice(0,5).map((e,t)=>(0,tr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,tr.jsx)("span",{className:"text-zinc-400 text-sm truncate flex-1",children:e.name}),(0,tr.jsx)("span",{className:"text-white text-sm font-medium ml-2",children:e.count})]},e.name))})]}),(0,tr.jsxs)(Ar,{className:"p-4",children:[(0,tr.jsxs)("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[(0,tr.jsx)(ga,{className:"w-4 h-4 text-orange-400"}),"Top Developer"]}),(0,tr.jsx)("div",{className:"space-y-2",children:R.byDeveloper.slice(0,5).map((e,t)=>(0,tr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,tr.jsx)("span",{className:"text-zinc-400 text-sm truncate flex-1",children:e.name}),(0,tr.jsx)("span",{className:"text-white text-sm font-medium ml-2",children:e.count})]},e.name))})]}),(0,tr.jsxs)(Ar,{className:"p-4",children:[(0,tr.jsxs)("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[(0,tr.jsx)(ka,{className:"w-4 h-4 text-orange-400"}),"Statistiche"]}),(0,tr.jsxs)("div",{className:"space-y-3",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:"Totale Progetti"}),(0,tr.jsx)("p",{className:"text-white text-xl font-bold",children:E.toLocaleString()})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:"Prezzo Medio"}),(0,tr.jsxs)("p",{className:"text-orange-400 text-xl font-bold",children:["AED ",(R.avgPrice/1e6).toFixed(1),"M"]})]})]})]})]}),(0,tr.jsxs)(Ar,{className:"mb-4",children:[(0,tr.jsxs)("div",{className:"relative mb-3",children:[(0,tr.jsx)(da,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),(0,tr.jsx)("input",{type:"text",placeholder:"Cerca progetto, zona o developer...",value:b.search,onChange:e=>y(t=>c(c({},t),{},{search:e.target.value})),onKeyDown:e=>"Enter"===e.key&&K(1),className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-3 text-white placeholder:text-zinc-600 focus:border-orange-500 focus:outline-none"})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-9 gap-3",children:[(0,tr.jsxs)("select",{value:b.emirate,onChange:e=>y(t=>c(c({},t),{},{emirate:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none",children:[(0,tr.jsx)("option",{value:"",children:"\ud83c\udde6\ud83c\uddea Emirato"}),U.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(0,tr.jsxs)("select",{value:b.location,onChange:e=>y(t=>c(c({},t),{},{location:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none",children:[(0,tr.jsx)("option",{value:"",children:"Tutte le zone"}),B.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(0,tr.jsxs)("select",{value:b.developer,onChange:e=>y(t=>c(c({},t),{},{developer:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none",children:[(0,tr.jsx)("option",{value:"",children:"Developer"}),q.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(0,tr.jsxs)("select",{value:b.bedrooms,onChange:e=>y(t=>c(c({},t),{},{bedrooms:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none",children:[(0,tr.jsx)("option",{value:"",children:"Camere"}),H.map(e=>(0,tr.jsx)("option",{value:e,children:"Studio"===e?"Studio":e+" BR"},e))]}),(0,tr.jsx)("select",{value:b.status,onChange:e=>y(t=>c(c({},t),{},{status:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none",children:[{value:"",label:"Tutti gli stati"},{value:"completed",label:"Completato"},{value:"under_construction",label:"In Costruzione"},{value:"launch",label:"Lancio"}].map(e=>(0,tr.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,tr.jsxs)("select",{value:b.deliveryYear,onChange:e=>y(t=>c(c({},t),{},{deliveryYear:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none",children:[(0,tr.jsx)("option",{value:"",children:"Consegna"}),["2024","2025","2026","2027","2028","2029","2030"].map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(0,tr.jsx)("input",{type:"number",placeholder:"Min AED",value:b.minPrice,onChange:e=>y(t=>c(c({},t),{},{minPrice:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none"}),(0,tr.jsx)("input",{type:"number",placeholder:"Max AED",value:b.maxPrice,onChange:e=>y(t=>c(c({},t),{},{maxPrice:e.target.value})),className:"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none"}),(0,tr.jsx)(Lr,{onClick:()=>{O(null),K(1)},icon:da,disabled:f,children:f?"...":"Cerca"})]}),(0,tr.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-zinc-800",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("span",{className:"text-zinc-500 text-sm",children:"Ordina:"}),(0,tr.jsx)("select",{value:b.sortBy,onChange:e=>{y(t=>c(c({},t),{},{sortBy:e.target.value})),K(1)},className:"bg-transparent border-none text-orange-400 text-sm focus:outline-none cursor-pointer",children:[{value:"hotness",label:"Pi\xf9 popolari"},{value:"price_asc",label:"Prezzo \u2191"},{value:"price_desc",label:"Prezzo \u2193"},{value:"delivery",label:"Consegna pi\xf9 vicina"}].map(e=>(0,tr.jsx)("option",{value:e.value,children:e.label},e.value))})]}),u.length>0&&(0,tr.jsxs)(Lr,{variant:"ghost",size:"sm",onClick:async()=>{try{let e=sr.from("pf_projects").select("title, location_full, developer_name, price_from, construction_phase, delivery_date, url");b.search&&(e=e.or("title.ilike.%".concat(b.search,"%,location_full.ilike.%").concat(b.search,"%,developer_name.ilike.%").concat(b.search,"%"))),b.location&&(e=e.or("location_name.ilike.%".concat(b.location,"%,location_full.ilike.%").concat(b.location,"%"))),b.developer&&(e=e.ilike("developer_name","%".concat(b.developer,"%"))),b.minPrice&&(e=e.gte("price_from",parseInt(b.minPrice))),b.maxPrice&&(e=e.lte("price_from",parseInt(b.maxPrice))),b.status&&(e=e.eq("construction_phase",b.status)),b.deliveryYear&&(e=e.gte("delivery_date","".concat(b.deliveryYear,"-01-01")).lte("delivery_date","".concat(b.deliveryYear,"-12-31"))),e=e.order("hotness_level",{ascending:!1}).limit(1e3);const{data:t}=await e;if(null===t||void 0===t||!t.length)return;const n=["Progetto","Location","Developer","Prezzo Da (AED)","Stato","Consegna","URL"],a=t.map(e=>[e.title,e.location_full,e.developer_name,e.price_from,"completed"===e.construction_phase?"Completato":"under_construction"===e.construction_phase?"In Costruzione":"Lancio",e.delivery_date,e.url]),r=[n.join(","),...a.map(e=>e.map(e=>'"'.concat((e||"").toString().replace(/"/g,'""'),'"')).join(","))].join("\n"),s=new Blob([r],{type:"text/csv"}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download="offplan-projects-".concat((new Date).toISOString().split("T")[0],".csv"),o.click(),URL.revokeObjectURL(i)}catch(e){console.error("Export error:",e)}},children:[(0,tr.jsx)(Wa,{className:"w-4 h-4 mr-1"}),"Export CSV"]})]}),(b.emirate||b.location||b.developer||b.status||b.deliveryYear||b.minPrice||b.maxPrice||b.bedrooms)&&(0,tr.jsxs)(Lr,{variant:"ghost",size:"sm",onClick:()=>{y({search:"",emirate:"",location:"",minPrice:"",maxPrice:"",bedrooms:"",developer:"",status:"",deliveryYear:"",sortBy:"hotness"}),K(1)},children:[(0,tr.jsx)(ia,{className:"w-4 h-4 mr-1"}),"Reset filtri"]})]})]}),T&&(0,tr.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,tr.jsxs)("span",{className:"text-zinc-400 text-sm",children:["Filtrato: ",(0,tr.jsx)("span",{className:"text-orange-400",children:P})]}),(0,tr.jsxs)(Lr,{variant:"ghost",size:"sm",onClick:()=>{O(null),D("")},children:[(0,tr.jsx)(ia,{className:"w-4 h-4 mr-1"}),"Rimuovi"]})]})]}),x&&(0,tr.jsx)(Ar,{className:"border-red-500/20 bg-red-500/5 mb-4",children:(0,tr.jsxs)("div",{className:"flex items-center gap-3 text-red-400",children:[(0,tr.jsx)(qa,{className:"w-5 h-5"}),(0,tr.jsx)("span",{children:x}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>K(1),children:"Riprova"})]})}),(0,tr.jsxs)("div",{className:"flex-1 min-h-0",children:["list"===l&&(0,tr.jsx)("div",{className:"h-full overflow-y-auto",children:f&&0===u.length?(0,tr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(e=>(0,tr.jsxs)(Ar,{className:"animate-pulse",children:[(0,tr.jsx)("div",{className:"h-40 bg-zinc-700/50 rounded-xl mb-3"}),(0,tr.jsx)("div",{className:"h-4 bg-zinc-700/50 rounded w-3/4 mb-2"}),(0,tr.jsx)("div",{className:"h-3 bg-zinc-700/50 rounded w-1/2"})]},e))}):ee.length>0?(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ee.map(e=>{var t,n,a,r;return(0,tr.jsxs)(Ar,{hover:!0,className:"overflow-hidden group cursor-pointer",onClick:()=>j(e),children:[(0,tr.jsxs)("div",{className:"relative h-40 -mx-4 -mt-4 mb-3 overflow-hidden",children:[null!==(t=e.images)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.medium_image_url?(0,tr.jsx)("img",{src:e.images[0].medium_image_url,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):(0,tr.jsx)("div",{className:"w-full h-full bg-zinc-700/50 flex items-center justify-center",children:(0,tr.jsx)(ga,{className:"w-12 h-12 text-zinc-600"})}),(0,tr.jsxs)("div",{className:"absolute top-2 left-2 flex gap-1",children:[(0,tr.jsx)("span",{className:"px-2 py-1 text-white text-xs font-medium rounded-lg "+("completed"===e.construction_phase_key?"bg-green-500/90":"under_construction"===e.construction_phase_key?"bg-orange-500/90":"bg-blue-500/90"),children:"completed"===e.construction_phase_key?"Completato":"under_construction"===e.construction_phase_key?"In Costruzione":"Lancio"}),e.hotness_level>=80&&(0,tr.jsx)("span",{className:"px-2 py-1 bg-gradient-to-r from-red-500 to-orange-500 text-white text-xs font-medium rounded-lg",children:"\ud83d\udd25"})]}),Y(e.delivery_date)&&(0,tr.jsx)("div",{className:"absolute top-2 right-12 px-2 py-1 bg-zinc-800/70 text-white text-xs rounded-lg",children:Y(e.delivery_date)}),(0,tr.jsx)("button",{onClick:t=>{t.stopPropagation(),J(e.project_id)?i(e.project_id):s(e)},className:"absolute top-2 right-2 p-2 rounded-full transition-colors "+(J(e.project_id)?"bg-orange-500 text-white":"bg-zinc-800/50 text-white hover:bg-orange-500"),children:(0,tr.jsx)("svg",{className:"w-4 h-4",fill:J(e.project_id)?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,tr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})})]}),(0,tr.jsxs)("div",{className:"space-y-2",children:[(0,tr.jsx)("p",{className:"text-white font-medium line-clamp-1",children:e.title}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm line-clamp-1",children:null===(a=e.location)||void 0===a?void 0:a.full_name}),(0,tr.jsxs)("div",{className:"flex items-center gap-3 text-xs text-zinc-400",children:[Q(e.bedrooms)&&(0,tr.jsxs)("span",{className:"flex items-center gap-1",children:[(0,tr.jsx)(ga,{className:"w-3.5 h-3.5"}),Q(e.bedrooms)]}),e.payment_plans&&(0,tr.jsx)("span",{children:X(e.payment_plans)})]}),(0,tr.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,tr.jsx)("p",{className:"text-orange-400 font-semibold",children:e.price_from>0?"da AED "+$(e.price_from):"Prezzo TBD"}),(null===(r=e.developer)||void 0===r?void 0:r.name)&&(0,tr.jsx)("span",{className:"text-zinc-500 text-xs truncate max-w-[100px]",children:e.developer.name})]})]}),(0,tr.jsxs)("div",{className:"flex gap-2 mt-3 pt-3 border-t border-zinc-800",children:[(0,tr.jsxs)(Lr,{variant:"ghost",size:"sm",className:"flex-1",onClick:t=>{t.stopPropagation(),j(e)},children:[(0,tr.jsx)(La,{className:"w-4 h-4 mr-1"}),"Dettagli"]}),(0,tr.jsxs)(Lr,{variant:"secondary",size:"sm",className:"flex-1",onClick:t=>{t.stopPropagation(),k(e)},children:[(0,tr.jsx)(Na,{className:"w-4 h-4 mr-1"}),"Lead"]})]})]},e.project_id)})}),C>1&&(0,tr.jsxs)("div",{className:"flex items-center justify-center gap-2 pt-6 pb-4",children:[(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>G(_-1),disabled:1===_,children:(0,tr.jsx)(ba,{className:"w-4 h-4"})}),Array.from({length:Math.min(5,C)},(e,t)=>{let n;return n=C<=5||_<=3?t+1:_>=C-2?C-4+t:_-2+t,(0,tr.jsx)("button",{onClick:()=>G(n),className:"w-10 h-10 rounded-lg text-sm font-medium transition-colors ".concat(_===n?"bg-orange-500 text-white":"bg-zinc-700/50 text-zinc-400 hover:bg-zinc-700"),children:n},n)}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>G(_+1),disabled:_===C,children:(0,tr.jsx)(aa,{className:"w-4 h-4"})}),(0,tr.jsxs)("span",{className:"text-zinc-500 text-sm ml-4",children:[E.toLocaleString()," progetti"]})]})]}):(0,tr.jsx)(Dr,{icon:ga,title:"Nessun risultato",description:"Modifica i filtri"})}),"map"===l&&(0,tr.jsxs)("div",{className:"fixed inset-0 z-50 bg-[#0f172a]",children:[(0,tr.jsxs)("div",{className:"absolute top-0 left-0 right-0 z-20 bg-[#0f172a]/95 backdrop-blur border-b border-zinc-800",children:[(0,tr.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("img",{src:"/logo.png",alt:"KeyPrime",className:"h-8 lg:h-10"}),(0,tr.jsx)("span",{className:"text-zinc-500 hidden sm:inline",children:"|"}),(0,tr.jsxs)("span",{className:"text-zinc-400 text-sm",children:[ee.length," progetti"]})]}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>d("list"),icon:ia,children:"Chiudi"})]}),(0,tr.jsxs)("div",{className:"px-4 pb-3 flex items-center gap-2 overflow-x-auto scrollbar-hide",children:[(0,tr.jsxs)("select",{value:b.emirate,onChange:e=>y(t=>c(c({},t),{},{emirate:e.target.value})),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[100px] flex-shrink-0",children:[(0,tr.jsx)("option",{value:"",children:"\ud83c\udde6\ud83c\uddea Emirato"}),U.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(0,tr.jsxs)("select",{value:b.location,onChange:e=>y(t=>c(c({},t),{},{location:e.target.value})),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[120px] flex-shrink-0",children:[(0,tr.jsx)("option",{value:"",children:"Tutte le zone"}),B.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(0,tr.jsxs)("select",{value:b.developer,onChange:e=>y(t=>c(c({},t),{},{developer:e.target.value})),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[130px] flex-shrink-0",children:[(0,tr.jsx)("option",{value:"",children:"Tutti i developer"}),q.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),(0,tr.jsxs)("select",{value:b.bedrooms,onChange:e=>y(t=>c(c({},t),{},{bedrooms:e.target.value})),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[90px] flex-shrink-0",children:[(0,tr.jsx)("option",{value:"",children:"Camere"}),H.map(e=>(0,tr.jsx)("option",{value:e,children:"Studio"===e?"Studio":e+" BR"},e))]}),(0,tr.jsx)(Lr,{onClick:()=>K(1),size:"sm",className:"flex-shrink-0",disabled:f,children:f?"...":"Cerca"})]})]}),(0,tr.jsxs)("div",{className:"absolute inset-0 pt-24 lg:pt-28",children:[(0,tr.jsxs)("div",{className:"hidden lg:flex h-full",children:[(0,tr.jsxs)("div",{className:"w-96 h-full bg-[#1e293b] border-r border-zinc-800 flex flex-col",children:[(0,tr.jsx)("div",{className:"p-3 border-b border-zinc-800",children:(0,tr.jsxs)("div",{className:"relative",children:[(0,tr.jsx)(da,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),(0,tr.jsx)("input",{type:"text",placeholder:"Cerca progetto...",value:b.search,onChange:e=>y(t=>c(c({},t),{},{search:e.target.value})),onKeyDown:e=>"Enter"===e.key&&K(1),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg pl-10 pr-4 py-2 text-white text-sm placeholder:text-zinc-500 focus:border-orange-500 focus:outline-none"})]})}),(0,tr.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[ee.map(e=>{var t,n,a;return(0,tr.jsx)("div",{onClick:()=>j(e),className:"p-3 border-b border-zinc-800/50 cursor-pointer hover:bg-zinc-700/30 transition-colors "+((null===w||void 0===w?void 0:w.project_id)===e.project_id?"bg-orange-500/10 border-l-2 border-l-orange-500":""),children:(0,tr.jsxs)("div",{className:"flex gap-3",children:[(0,tr.jsx)("div",{className:"w-20 h-16 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700",children:null!==(t=e.images)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.medium_image_url?(0,tr.jsx)("img",{src:e.images[0].medium_image_url,alt:"",className:"w-full h-full object-cover"}):(0,tr.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,tr.jsx)(ga,{className:"w-6 h-6 text-zinc-600"})})}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("h3",{className:"font-medium text-white text-sm truncate",children:e.title}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 truncate",children:null===(a=e.location)||void 0===a?void 0:a.full_name}),(0,tr.jsx)("p",{className:"text-orange-400 font-semibold text-sm mt-1",children:e.price_from>0?"From "+$(e.price_from):"TBD"}),(0,tr.jsxs)("div",{className:"flex items-center gap-2 text-xs text-zinc-500",children:[Q(e.bedrooms)&&(0,tr.jsx)("span",{children:Q(e.bedrooms)}),Y(e.delivery_date)&&(0,tr.jsxs)("span",{children:["\u2022 ",Y(e.delivery_date)]})]})]})]})},e.project_id)}),C>1&&(0,tr.jsxs)("div",{className:"p-3 flex items-center justify-center gap-2 border-t border-zinc-800",children:[(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>G(_-1),disabled:1===_,children:(0,tr.jsx)(ba,{className:"w-4 h-4"})}),(0,tr.jsxs)("span",{className:"text-zinc-400 text-sm",children:["Pag. ",_,"/",C]}),(0,tr.jsx)(Lr,{variant:"ghost",size:"sm",onClick:()=>G(_+1),disabled:_===C,children:(0,tr.jsx)(aa,{className:"w-4 h-4"})})]})]})]}),(0,tr.jsx)("div",{className:"flex-1 relative",children:(0,tr.jsx)(Zr,{projects:u,onSelectProject:j,selectedProject:w,onAreaClick:Z})})]}),(0,tr.jsxs)("div",{className:"lg:hidden h-full flex flex-col",children:[(0,tr.jsx)("div",{className:"flex-1 relative",children:(0,tr.jsx)(Zr,{projects:u,onSelectProject:j,selectedProject:w,onAreaClick:Z})}),(0,tr.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-[#0f172a] via-[#0f172a]/95 to-transparent pt-8 pb-4",children:[(0,tr.jsx)("div",{className:"flex gap-3 overflow-x-auto px-4 pb-2 snap-x snap-mandatory scrollbar-hide",children:ee.map(e=>{var t,n,a;return(0,tr.jsx)("div",{onClick:()=>j(e),className:"flex-shrink-0 w-72 bg-[#1e293b] rounded-xl p-3 border transition-all snap-start "+((null===w||void 0===w?void 0:w.project_id)===e.project_id?"border-orange-500 scale-[1.02]":"border-zinc-800"),children:(0,tr.jsxs)("div",{className:"flex gap-3",children:[(0,tr.jsx)("div",{className:"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700",children:null!==(t=e.images)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.medium_image_url?(0,tr.jsx)("img",{src:e.images[0].medium_image_url,alt:"",className:"w-full h-full object-cover"}):(0,tr.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,tr.jsx)(ga,{className:"w-8 h-8 text-zinc-600"})})}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("h3",{className:"font-medium text-white text-sm line-clamp-1",children:e.title}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 line-clamp-1",children:null===(a=e.location)||void 0===a?void 0:a.full_name}),(0,tr.jsx)("p",{className:"text-orange-400 font-bold mt-1",children:e.price_from>0?"From "+$(e.price_from):"TBD"}),(0,tr.jsxs)("div",{className:"flex items-center gap-2 text-xs text-zinc-500 mt-0.5",children:[Q(e.bedrooms)&&(0,tr.jsx)("span",{children:Q(e.bedrooms)}),Y(e.delivery_date)&&(0,tr.jsxs)("span",{children:["\u2022 ",Y(e.delivery_date)]})]})]})]})},e.project_id)})}),(0,tr.jsx)("div",{className:"flex items-center justify-center gap-2 mt-2",children:(0,tr.jsxs)("span",{className:"text-zinc-500 text-xs",children:[ee.length," progetti \u2022 Scorri \u2192"]})})]})]})]})]}),"saved"===l&&(0,tr.jsx)("div",{className:"h-full overflow-y-auto",children:(null===r||void 0===r?void 0:r.length)>0?(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsx)("div",{className:"mb-4",children:(0,tr.jsxs)("p",{className:"text-zinc-400 text-sm",children:[r.length," progetti salvati"]})}),(0,tr.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(e=>{var t,n,a,r,s;const o=e.property_data||{project_id:e.property_id,title:e.title,price_from:e.price,location:{full_name:e.location_full,name:e.location_path},developer:{name:e.agent_name},images:e.image_url?[{medium_image_url:e.image_url}]:[],construction_phase_key:e.completion_status,url:e.pf_url},l=(null===(t=o.images)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.medium_image_url)||e.image_url;return(0,tr.jsxs)(Ar,{hover:!0,className:"overflow-hidden group cursor-pointer",onClick:()=>j(o),children:[(0,tr.jsxs)("div",{className:"relative h-40 -mx-4 -mt-4 mb-3 overflow-hidden",children:[l?(0,tr.jsx)("img",{src:l,alt:o.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):(0,tr.jsx)("div",{className:"w-full h-full bg-zinc-700/50 flex items-center justify-center",children:(0,tr.jsx)(ga,{className:"w-12 h-12 text-zinc-600"})}),(0,tr.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e.property_id)},className:"absolute top-2 right-2 p-2 rounded-full bg-orange-500 text-white hover:bg-red-500 transition-colors",title:"Rimuovi dai salvati",children:(0,tr.jsx)(ia,{className:"w-4 h-4"})}),e.completion_status&&(0,tr.jsx)("span",{className:"absolute top-2 left-2 px-2 py-1 text-white text-xs font-medium rounded-lg "+("completed"===e.completion_status?"bg-green-500/90":"under_construction"===e.completion_status?"bg-orange-500/90":"bg-blue-500/90"),children:"completed"===e.completion_status?"Completato":"under_construction"===e.completion_status?"In Costruzione":"Lancio"})]}),(0,tr.jsxs)("div",{className:"space-y-2",children:[(0,tr.jsx)("p",{className:"text-white font-medium line-clamp-1",children:o.title||e.title}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm line-clamp-1",children:(null===(a=o.location)||void 0===a?void 0:a.full_name)||e.location_full}),(0,tr.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,tr.jsx)("p",{className:"text-orange-400 font-semibold",children:(o.price_from||e.price)>0?"da AED "+parseFloat(o.price_from||e.price).toLocaleString():"Prezzo TBD"}),((null===(r=o.developer)||void 0===r?void 0:r.name)||e.agent_name)&&(0,tr.jsx)("span",{className:"text-zinc-500 text-xs truncate max-w-[100px]",children:(null===(s=o.developer)||void 0===s?void 0:s.name)||e.agent_name})]})]}),(0,tr.jsxs)("div",{className:"flex gap-2 mt-3 pt-3 border-t border-zinc-800",children:[(0,tr.jsxs)(Lr,{variant:"ghost",size:"sm",className:"flex-1",onClick:e=>{e.stopPropagation(),j(o)},children:[(0,tr.jsx)(La,{className:"w-4 h-4 mr-1"}),"Dettagli"]}),(0,tr.jsxs)(Lr,{variant:"secondary",size:"sm",className:"flex-1",onClick:e=>{e.stopPropagation(),k(o)},children:[(0,tr.jsx)(Na,{className:"w-4 h-4 mr-1"}),"Lead"]})]})]},e.id)})})]}):(0,tr.jsx)(Dr,{icon:ga,title:"Nessun progetto salvato",description:"Salva i progetti che ti interessano cliccando sull'icona segnalibro",actionLabel:"Cerca Progetti",onAction:()=>d("list")})})]}),w&&(0,tr.jsx)(ts,{listing:w,onClose:()=>j(null),onCreateLead:()=>{k(w),j(null)},isSaved:J(w.project_id),onToggleSave:()=>J(w.project_id)?i(w.project_id):s(w)}),N&&(0,tr.jsx)(ns,{listing:N,clienti:t,onClose:()=>k(null),onCreateLead:n,user:o})]})}function ts(e){var t,n,r,s,i,o,l,d,u,h,p,m,f,g;let{listing:x,onClose:v,onCreateLead:b,isSaved:y,onToggleSave:w}=e;const[j,N]=(0,a.useState)(0),[k,_]=(0,a.useState)(!1),[S,C]=(0,a.useState)(!1),[z,E]=(0,a.useState)(null),[A,T]=(0,a.useState)(null),[O,P]=(0,a.useState)(null),[D,R]=(0,a.useState)(!1),[I,L]=(0,a.useState)(!1),[M,U]=(0,a.useState)(!1);(0,a.useEffect)(()=>{null!==x&&void 0!==x&&x.url&&(R(!0),fetch("/api/get-brochure?url=".concat(encodeURIComponent(x.url))).then(e=>e.json()).then(e=>{e.success&&(e.brochure_url&&E(e.brochure_url),e.video_url&&(T(e.video_url),P(e.video_type)))}).catch(()=>{}).finally(()=>R(!1)))},[null===x||void 0===x?void 0:x.url]);const F=e=>e&&0!==e?parseFloat(e).toLocaleString():"Su richiesta",B=e=>{var t;if(null===e||void 0===e||null===(t=e.available)||void 0===t||!t.length)return null;const n=e.available;if(1===n.length)return 0===n[0]?"Studio":"".concat(n[0]," Camere");const a=Math.min(...n),r=Math.max(...n);return 0===a?"Studio - ".concat(r," Camere"):"".concat(a," - ").concat(r," Camere")},q=e=>{if(!e)return null;const t=new Date(e),n=Math.ceil((t.getMonth()+1)/3);return"Q".concat(n," ").concat(t.getFullYear())},H=e=>{switch(e){case"completed":return{text:"Completato",color:"bg-green-500",icon:"\u2713"};case"under_construction":return{text:"In Costruzione",color:"bg-orange-500",icon:"\ud83c\udfd7\ufe0f"};case"not_started":return{text:"Nuovo Lancio",color:"bg-blue-500",icon:"\ud83d\ude80"};default:return{text:"Off-Plan",color:"bg-orange-500",icon:"\ud83d\udccb"}}},V=H(x.construction_phase_key),W=(e=>{const t={"Dubai Marina":{rating:"\u2b50\u2b50\u2b50\u2b50\u2b50",type:"Premium Waterfront",highlights:["Vista mare","Ristoranti di lusso","Beach access","Metro vicina"],roi:"6-8%"},"Palm Jumeirah":{rating:"\u2b50\u2b50\u2b50\u2b50\u2b50",type:"Ultra Luxury",highlights:["Isola iconica","Spiagge private","Hotel 5 stelle","Alta domanda"],roi:"5-7%"},"Downtown Dubai":{rating:"\u2b50\u2b50\u2b50\u2b50\u2b50",type:"Iconic Location",highlights:["Burj Khalifa","Dubai Mall","Fountain view","Business hub"],roi:"5-7%"},"Business Bay":{rating:"\u2b50\u2b50\u2b50\u2b50",type:"Business District",highlights:["Canal view","Corporate hub","In crescita","Buon ROI"],roi:"7-9%"},JBR:{rating:"\u2b50\u2b50\u2b50\u2b50\u2b50",type:"Beachfront Living",highlights:["The Walk","Beach access","Family friendly","Turisti"],roi:"6-8%"},"Dubai Creek Harbour":{rating:"\u2b50\u2b50\u2b50\u2b50",type:"Future Icon",highlights:["Creek Tower","Waterfront","Nuova area","Alto potenziale"],roi:"8-10%"},"MBR City":{rating:"\u2b50\u2b50\u2b50\u2b50",type:"Master Community",highlights:["Meydan","Crystal Lagoon","Golf course","Family area"],roi:"7-9%"},"Dubai Hills":{rating:"\u2b50\u2b50\u2b50\u2b50",type:"Green Community",highlights:["Golf club","Dubai Hills Mall","Parchi","Scuole"],roi:"6-8%"},JVC:{rating:"\u2b50\u2b50\u2b50",type:"Affordable Living",highlights:["Entry level","Community feel","ROI alto","In sviluppo"],roi:"8-10%"},"Jumeirah Village":{rating:"\u2b50\u2b50\u2b50",type:"Value Investment",highlights:["Prezzi competitivi","Comunit\xe0","Buon rental"],roi:"8-10%"},DIFC:{rating:"\u2b50\u2b50\u2b50\u2b50\u2b50",type:"Financial Hub",highlights:["Centro finanziario","Art galleries","Fine dining","Lusso"],roi:"5-6%"},"Yas Island":{rating:"\u2b50\u2b50\u2b50\u2b50",type:"Entertainment Hub",highlights:["Ferrari World","Yas Marina","Beach","Abu Dhabi"],roi:"6-8%"},"Saadiyat Island":{rating:"\u2b50\u2b50\u2b50\u2b50\u2b50",type:"Cultural District",highlights:["Louvre Abu Dhabi","Beaches","Golf","Exclusive"],roi:"5-7%"}},n=(e||"").toLowerCase();for(const[a,r]of Object.entries(t))if(n.includes(a.toLowerCase()))return c({name:a},r);return{name:e,rating:"\u2b50\u2b50\u2b50",type:"Emerging Area",highlights:["In sviluppo","Potenziale crescita"],roi:"7-10%"}})((null===(t=x.location)||void 0===t?void 0:t.full_name)||(null===(n=x.location)||void 0===n?void 0:n.name)),K=x.images||[];(null===(r=x.location)||void 0===r?void 0:r.lat)&&(null===(s=x.location)||void 0===s||s.lng);return k?(0,tr.jsxs)("div",{className:"fixed inset-0 z-[60] bg-zinc-800",children:[(0,tr.jsx)("button",{onClick:()=>_(!1),className:"absolute top-4 right-4 z-10 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20",children:(0,tr.jsx)(ia,{className:"w-6 h-6"})}),(0,tr.jsxs)("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur rounded-full text-white text-sm",children:[j+1," / ",K.length]}),(0,tr.jsx)("div",{className:"h-full flex items-center justify-center p-4",children:K[j]&&(0,tr.jsx)("img",{src:K[j].medium_image_url||K[j].small_image_url,alt:"",className:"max-h-full max-w-full object-contain"})}),K.length>1&&(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsx)("button",{onClick:()=>N(e=>e>0?e-1:K.length-1),className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20",children:(0,tr.jsx)(ba,{className:"w-6 h-6"})}),(0,tr.jsx)("button",{onClick:()=>N(e=>e<K.length-1?e+1:0),className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20",children:(0,tr.jsx)(aa,{className:"w-6 h-6"})})]}),(0,tr.jsx)("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center gap-2 px-4 overflow-x-auto",children:K.slice(0,10).map((e,t)=>(0,tr.jsx)("button",{onClick:()=>N(t),className:"flex-shrink-0 w-16 h-12 rounded-lg overflow-hidden border-2 transition-all ".concat(t===j?"border-orange-500 scale-110":"border-transparent opacity-60 hover:opacity-100"),children:(0,tr.jsx)("img",{src:e.small_image_url||e.medium_image_url,alt:"",className:"w-full h-full object-cover"})},t))})]}):(0,tr.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 md:p-4",children:[(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800/80 backdrop-blur-sm",onClick:v}),(0,tr.jsxs)("div",{className:"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden animate-scaleIn",children:[(0,tr.jsxs)("div",{className:"relative h-72 md:h-80",children:[null!==(i=K[j])&&void 0!==i&&i.medium_image_url?(0,tr.jsx)("img",{src:K[j].medium_image_url,alt:x.title,className:"w-full h-full object-cover cursor-pointer",onClick:()=>_(!0)}):(0,tr.jsx)("div",{className:"w-full h-full bg-zinc-700/50 flex items-center justify-center",children:(0,tr.jsx)(ga,{className:"w-20 h-20 text-zinc-600"})}),(0,tr.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-[#1e293b] via-transparent to-black/30"}),(0,tr.jsxs)("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-start",children:[(0,tr.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,tr.jsxs)("span",{className:"px-3 py-1.5 ".concat(V.color," text-white text-sm font-medium rounded-full flex items-center gap-1.5 shadow-lg"),children:[(0,tr.jsx)("span",{children:V.icon})," ",V.text]}),x.hotness_level>=80&&(0,tr.jsx)("span",{className:"px-3 py-1.5 bg-gradient-to-r from-red-500 to-orange-500 text-white text-sm font-medium rounded-full flex items-center gap-1.5 shadow-lg",children:"\ud83d\udd25 Popolare"}),q(x.delivery_date)&&(0,tr.jsxs)("span",{className:"px-3 py-1.5 bg-zinc-800/60 backdrop-blur text-white text-sm rounded-full",children:["\ud83d\udcc5 ",q(x.delivery_date)]})]}),(0,tr.jsxs)("div",{className:"flex gap-2",children:[(0,tr.jsx)("button",{onClick:w,className:"p-2.5 rounded-full shadow-lg transition-all ".concat(y?"bg-orange-500 text-white":"bg-zinc-800/60 backdrop-blur text-white hover:bg-orange-500"),children:(0,tr.jsx)("svg",{className:"w-5 h-5",fill:y?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,tr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})}),(0,tr.jsx)("button",{onClick:v,className:"p-2.5 bg-zinc-800/60 backdrop-blur rounded-full text-white hover:bg-zinc-800/80 shadow-lg",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]})]}),K.length>1&&(0,tr.jsxs)("div",{className:"absolute bottom-20 left-0 right-0 flex justify-center gap-1.5",children:[K.slice(0,8).map((e,t)=>(0,tr.jsx)("button",{onClick:()=>N(t),className:"w-2 h-2 rounded-full transition-all ".concat(t===j?"bg-orange-500 w-6":"bg-white/50 hover:bg-white/80")},t)),K.length>8&&(0,tr.jsxs)("span",{className:"text-white/50 text-xs ml-1",children:["+",K.length-8]})]}),(0,tr.jsxs)("div",{className:"absolute bottom-4 left-4 right-4",children:[(0,tr.jsx)("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",children:x.title}),(0,tr.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-white/80",children:[(0,tr.jsx)(Pa,{className:"w-4 h-4"}),(0,tr.jsx)("span",{children:null===(o=x.location)||void 0===o?void 0:o.full_name})]})]}),K.length>1&&(0,tr.jsxs)("button",{onClick:()=>_(!0),className:"absolute bottom-4 right-4 px-3 py-1.5 bg-zinc-800/60 backdrop-blur text-white text-sm rounded-full hover:bg-zinc-800/80 flex items-center gap-1.5",children:[(0,tr.jsx)(La,{className:"w-4 h-4"})," ",K.length," foto"]})]}),(0,tr.jsxs)("div",{className:"p-4 md:p-6 overflow-y-auto max-h-[calc(95vh-20rem)]",children:[(0,tr.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6 pb-6 border-b border-zinc-800",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-3xl font-bold text-orange-400",children:x.price_from>0?"AED ".concat(F(x.price_from)):"Prezzo su richiesta"}),x.price_from>0&&(0,tr.jsx)("p",{className:"text-zinc-500 text-sm mt-1",children:"Prezzo iniziale"})]}),B(x.bedrooms)&&(0,tr.jsx)("div",{className:"flex items-center gap-4 text-zinc-300",children:(0,tr.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-700/50/50 rounded-xl",children:[(0,tr.jsx)("svg",{className:"w-5 h-5 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,tr.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),(0,tr.jsx)("span",{className:"font-medium",children:B(x.bedrooms)})]})})]}),(null===(l=x.bedrooms)||void 0===l||null===(d=l.available)||void 0===d?void 0:d.length)>0&&x.price_from>0&&(0,tr.jsxs)("div",{className:"mb-6 p-4 bg-zinc-700/50/30 border border-zinc-700/50 rounded-xl",children:[(0,tr.jsxs)("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[(0,tr.jsx)(ka,{className:"w-4 h-4 text-orange-400"}),"Prezzi per Tipologia"]}),(0,tr.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:x.bedrooms.available.sort((e,t)=>e-t).map((e,t)=>{const n=x.price_from,a=0===e?1:1+.35*e,r=Math.round(n*a);return(0,tr.jsxs)("div",{className:"bg-zinc-800/50 border border-zinc-700/30 rounded-lg p-3 text-center",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-xs mb-1",children:0===e?"Studio":e+" BR"}),(0,tr.jsxs)("p",{className:"text-orange-400 font-semibold",children:["da ",F(r)]})]},t)})}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-2 text-center",children:"* Prezzi indicativi, contattare per quotazione esatta"})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[(0,tr.jsxs)("div",{className:"bg-gradient-to-br from-orange-500/10 to-orange-600/5 border border-orange-500/20 rounded-xl p-4 text-center",children:[(0,tr.jsx)("p",{className:"text-orange-400 text-2xl font-bold",children:V.icon}),(0,tr.jsx)("p",{className:"text-white font-medium mt-1",children:V.text}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Stato progetto"})]}),q(x.delivery_date)&&(0,tr.jsxs)("div",{className:"bg-zinc-700/50/50 rounded-xl p-4 text-center",children:[(0,tr.jsx)("p",{className:"text-blue-400 text-2xl font-bold",children:"\ud83d\udcc5"}),(0,tr.jsx)("p",{className:"text-white font-medium mt-1",children:q(x.delivery_date)}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Consegna prevista"})]}),(null===(u=x.payment_plans)||void 0===u||null===(h=u.plans)||void 0===h||null===(p=h[0])||void 0===p||null===(m=p.summary)||void 0===m?void 0:m.down_payment)&&(0,tr.jsxs)("div",{className:"bg-zinc-700/50/50 rounded-xl p-4 text-center",children:[(0,tr.jsxs)("p",{className:"text-green-400 text-2xl font-bold",children:[x.payment_plans.plans[0].summary.down_payment,"%"]}),(0,tr.jsx)("p",{className:"text-white font-medium mt-1",children:"Anticipo"}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Down payment"})]}),(0,tr.jsxs)("div",{className:"bg-zinc-700/50/50 rounded-xl p-4 text-center",children:[(0,tr.jsx)("p",{className:"text-purple-400 text-2xl font-bold",children:W.roi}),(0,tr.jsx)("p",{className:"text-white font-medium mt-1",children:"ROI Stimato"}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Rendimento annuo"})]})]}),x.developer&&(0,tr.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-zinc-800/80 to-zinc-800/40 border border-zinc-700/50 rounded-xl mb-6",children:[x.developer.logo?(0,tr.jsx)("img",{src:x.developer.logo,alt:x.developer.name,className:"w-16 h-16 rounded-xl object-contain bg-white p-2"}):(0,tr.jsx)("div",{className:"w-16 h-16 rounded-xl bg-orange-500/20 flex items-center justify-center",children:(0,tr.jsx)(ga,{className:"w-8 h-8 text-orange-400"})}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-xs uppercase tracking-wider",children:"Developer"}),(0,tr.jsx)("p",{className:"text-xl font-semibold text-white",children:x.developer.name}),x.developer.projects_count&&(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm",children:[x.developer.projects_count," progetti"]})]}),(0,tr.jsx)("div",{className:"text-right",children:(0,tr.jsx)("span",{className:"px-3 py-1 bg-orange-500/20 text-orange-400 text-xs font-medium rounded-full",children:"Verificato \u2713"})})]}),"under_construction"===x.construction_phase_key&&(0,tr.jsxs)("div",{className:"bg-gradient-to-r from-orange-500/10 to-amber-500/5 border border-orange-500/20 rounded-xl p-4 mb-6",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold flex items-center gap-2",children:[(0,tr.jsx)(ga,{className:"w-4 h-4 text-orange-400"})," Stato Avanzamento Lavori"]}),(0,tr.jsx)("span",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 text-xs font-medium rounded-full",children:"In Costruzione"})]}),(()=>{let e=x.completion_percentage||x.construction_progress;if(!e){const t=x.delivery_date?new Date(x.delivery_date):null,n=new Date,a=new Date(n.getFullYear()-1,n.getMonth(),1);if(t){const r=t-a,s=n-a;e=Math.min(Math.max(Math.round(s/r*100),5),95)}else e=50}return(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsxs)("div",{className:"relative h-4 bg-zinc-700/50 rounded-full overflow-hidden mb-2",children:[(0,tr.jsx)("div",{className:"absolute left-0 top-0 h-full bg-gradient-to-r from-orange-500 to-amber-400 rounded-full transition-all duration-500",style:{width:"".concat(e,"%")}}),(0,tr.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,tr.jsxs)("span",{className:"text-xs font-bold text-white drop-shadow",children:[e,"%"]})})]}),(0,tr.jsxs)("div",{className:"flex justify-between text-xs text-zinc-500",children:[(0,tr.jsx)("span",{children:"Inizio lavori"}),(0,tr.jsxs)("span",{children:["Consegna: ",q(x.delivery_date)||"TBD"]})]}),(0,tr.jsxs)("div",{className:"mt-3 grid grid-cols-4 gap-2",children:[(0,tr.jsxs)("div",{className:"p-2 rounded-lg text-center text-xs "+(e>=25?"bg-orange-500/20 text-orange-400":"bg-zinc-700/50 text-zinc-500"),children:[(0,tr.jsx)("p",{className:"font-medium",children:"Fondazioni"}),(0,tr.jsx)("p",{children:e>=25?"\u2713":"..."})]}),(0,tr.jsxs)("div",{className:"p-2 rounded-lg text-center text-xs "+(e>=50?"bg-orange-500/20 text-orange-400":"bg-zinc-700/50 text-zinc-500"),children:[(0,tr.jsx)("p",{className:"font-medium",children:"Struttura"}),(0,tr.jsx)("p",{children:e>=50?"\u2713":"..."})]}),(0,tr.jsxs)("div",{className:"p-2 rounded-lg text-center text-xs "+(e>=75?"bg-orange-500/20 text-orange-400":"bg-zinc-700/50 text-zinc-500"),children:[(0,tr.jsx)("p",{className:"font-medium",children:"Finiture"}),(0,tr.jsx)("p",{children:e>=75?"\u2713":"..."})]}),(0,tr.jsxs)("div",{className:"p-2 rounded-lg text-center text-xs "+(e>=95?"bg-green-500/20 text-green-400":"bg-zinc-700/50 text-zinc-500"),children:[(0,tr.jsx)("p",{className:"font-medium",children:"Consegna"}),(0,tr.jsx)("p",{children:e>=95?"\u2713":"..."})]})]})]})})()]}),(0,tr.jsxs)("div",{className:"bg-gradient-to-br from-blue-500/10 to-purple-500/5 border border-blue-500/20 rounded-xl p-4 mb-6",children:[(0,tr.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold flex items-center gap-2",children:[(0,tr.jsx)(Pa,{className:"w-4 h-4 text-blue-400"})," Analisi Location"]}),(0,tr.jsx)("p",{className:"text-zinc-400 text-sm",children:W.name})]}),(0,tr.jsxs)("div",{className:"text-right",children:[(0,tr.jsx)("p",{className:"text-lg",children:W.rating}),(0,tr.jsx)("span",{className:"text-blue-400 text-xs font-medium",children:W.type})]})]}),(0,tr.jsx)("div",{className:"flex flex-wrap gap-2",children:W.highlights.map((e,t)=>(0,tr.jsxs)("span",{className:"px-2.5 py-1 bg-white/5 text-zinc-300 text-xs rounded-full",children:["\u2713 ",e]},t))}),(0,tr.jsxs)("a",{href:(()=>{var e;const t=encodeURIComponent((null===(e=x.location)||void 0===e?void 0:e.full_name)||x.title+" Dubai");return"https://www.google.com/maps/search/?api=1&query=".concat(t)})(),target:"_blank",rel:"noopener noreferrer",className:"mt-4 flex items-center justify-center gap-2 p-3 bg-zinc-700/50/50 hover:bg-zinc-700/50 rounded-xl text-zinc-300 transition-colors",children:[(0,tr.jsx)(Pa,{className:"w-4 h-4"}),(0,tr.jsx)("span",{className:"text-sm",children:"Apri in Google Maps"}),(0,tr.jsx)(ra,{className:"w-4 h-4"})]})]}),(null===(f=x.payment_plans)||void 0===f||null===(g=f.plans)||void 0===g?void 0:g.length)>0&&(0,tr.jsxs)("div",{className:"mb-6",children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[(0,tr.jsx)(ka,{className:"w-4 h-4 text-green-400"})," Piano di Pagamento"]}),(0,tr.jsx)("div",{className:"space-y-3",children:x.payment_plans.plans.map((e,t)=>(0,tr.jsxs)("div",{className:"p-4 bg-zinc-700/50/50 rounded-xl",children:[e.title&&(0,tr.jsx)("p",{className:"text-zinc-300 font-medium mb-3",children:e.title}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,tr.jsxs)("div",{className:"text-center p-3 bg-green-500/10 rounded-lg",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-green-400",children:[e.summary.down_payment,"%"]}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Anticipo"})]}),(0,tr.jsxs)("div",{className:"text-center p-3 bg-orange-500/10 rounded-lg",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-orange-400",children:[e.summary.during_construction,"%"]}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Costruzione"})]}),(0,tr.jsxs)("div",{className:"text-center p-3 bg-blue-500/10 rounded-lg",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-blue-400",children:[e.summary.handover,"%"]}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Consegna"})]}),e.summary.after_handover>0&&(0,tr.jsxs)("div",{className:"text-center p-3 bg-purple-500/10 rounded-lg",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-purple-400",children:[e.summary.after_handover,"%"]}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mt-1",children:"Post-consegna"})]})]})]},t))})]}),K.length>1&&(0,tr.jsxs)("div",{className:"mb-6",children:[(0,tr.jsxs)("h3",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[(0,tr.jsx)(La,{className:"w-4 h-4 text-orange-400"})," Galleria",(0,tr.jsxs)("span",{className:"text-zinc-500 text-sm font-normal",children:["(",K.length," immagini)"]})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:[K.slice(0,12).map((e,t)=>(0,tr.jsxs)("button",{onClick:()=>{N(t),_(!0)},className:"relative h-20 rounded-lg overflow-hidden group",children:[(0,tr.jsx)("img",{src:e.small_image_url||e.medium_image_url,alt:"",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800/0 group-hover:bg-zinc-800/30 transition-colors flex items-center justify-center",children:(0,tr.jsx)(La,{className:"w-5 h-5 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]},t)),K.length>12&&(0,tr.jsx)("button",{onClick:()=>_(!0),className:"h-20 rounded-lg bg-zinc-700/50 flex items-center justify-center text-zinc-400 hover:bg-zinc-700 transition-colors",children:(0,tr.jsxs)("span",{className:"text-sm font-medium",children:["+",K.length-12]})})]})]}),(0,tr.jsxs)("div",{className:"flex flex-wrap gap-3 pt-4 border-t border-zinc-800",children:[(0,tr.jsxs)(Lr,{className:"flex-1 py-3 bg-orange-500 hover:bg-orange-600",onClick:b,children:[(0,tr.jsx)(Na,{className:"w-5 h-5 mr-2"})," Crea Lead"]}),(0,tr.jsxs)(Lr,{variant:"secondary",className:"flex-1 py-3",onClick:()=>{var e,t,n,a,r;const s=B(x.bedrooms)||"Varie tipologie",i=q(x.delivery_date)||"TBD",o=null!==(e=x.payment_plans)&&void 0!==e&&null!==(t=e.plans)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.summary?"\ud83d\udcb3 ".concat(x.payment_plans.plans[0].summary.down_payment,"% anticipo"):"",l="\ud83c\udfd7\ufe0f *".concat(x.title,"*\n\n\ud83d\udccd ").concat(null===(a=x.location)||void 0===a?void 0:a.full_name,"\n\ud83d\udcb0 ").concat(x.price_from>0?"da AED ".concat(F(x.price_from)):"Prezzo su richiesta","\n\ud83c\udfe0 ").concat(s,"\n\ud83d\udcc5 Consegna: ").concat(i,"\n\ud83c\udfe2 Developer: ").concat((null===(r=x.developer)||void 0===r?void 0:r.name)||"TBD","\n").concat(o,"\n\n_Progetto Off-Plan Dubai_\n\n\ud83d\udd17 Per info: contattami!");window.open("https://wa.me/?text=".concat(encodeURIComponent(l)),"_blank")},children:[(0,tr.jsx)(la,{className:"w-5 h-5 mr-2"})," WhatsApp"]}),D?(0,tr.jsx)("div",{className:"flex items-center justify-center gap-2 py-3 px-4 bg-purple-500/10 text-purple-400/50 rounded-xl",children:(0,tr.jsx)(ya,{className:"w-5 h-5 animate-spin"})}):A?(0,tr.jsxs)("button",{onClick:()=>U(!0),className:"flex items-center justify-center gap-2 py-3 px-4 bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 rounded-xl transition-colors",title:"Guarda Video",children:[(0,tr.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,tr.jsx)("path",{d:"M8 5v14l11-7z"})})," Video"]}):null,D?null:z?(0,tr.jsxs)("button",{onClick:()=>L(!0),className:"flex items-center justify-center gap-2 py-3 px-4 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-xl transition-colors",title:"Visualizza Brochure PDF",children:[(0,tr.jsx)(Ra,{className:"w-5 h-5"})," Brochure"]}):null,x.url&&(0,tr.jsx)("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 py-3 px-4 bg-zinc-700/50 hover:bg-zinc-700 text-zinc-300 rounded-xl transition-colors",title:"Vedi su PropertyFinder",children:(0,tr.jsx)(Ia,{className:"w-5 h-5"})}),(0,tr.jsx)(Lr,{variant:"ghost",className:"py-3",onClick:async()=>{C(!0);try{var e,t,n,a,r,s,i;const o=H(x.construction_phase_key),l=null===(e=x.payment_plans)||void 0===e||null===(t=e.plans)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.summary,c=(null===(a=x.images)||void 0===a||null===(r=a[0])||void 0===r?void 0:r.medium_image_url)||"",d='\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: \'Helvetica Neue\', Arial, sans-serif; background: #111; color: #fff; padding: 40px; }\n    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #f97316; padding-bottom: 20px; }\n    .logo { font-size: 28px; font-weight: bold; color: #f97316; }\n    .date { color: #888; font-size: 12px; }\n    .hero { position: relative; margin-bottom: 30px; border-radius: 16px; overflow: hidden; }\n    .hero img { width: 100%; height: 300px; object-fit: cover; }\n    .badge { position: absolute; top: 16px; left: 16px; background: #f97316; color: white; padding: 8px 16px; border-radius: 8px; font-weight: bold; font-size: 14px; }\n    .title { font-size: 32px; font-weight: bold; margin-bottom: 8px; }\n    .location { color: #888; font-size: 16px; margin-bottom: 24px; }\n    .price { font-size: 36px; font-weight: bold; color: #f97316; margin-bottom: 30px; }\n    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px; }\n    .card { background: #1a1a1a; border-radius: 12px; padding: 20px; }\n    .card-title { color: #888; font-size: 12px; text-transform: uppercase; margin-bottom: 8px; }\n    .card-value { font-size: 20px; font-weight: bold; }\n    .section { margin-bottom: 30px; }\n    .section-title { font-size: 18px; font-weight: bold; margin-bottom: 16px; color: #f97316; }\n    .payment-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }\n    .payment-item { background: #1a1a1a; border-radius: 12px; padding: 16px; text-align: center; }\n    .payment-percent { font-size: 28px; font-weight: bold; color: #f97316; }\n    .payment-label { font-size: 12px; color: #888; margin-top: 4px; }\n    .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #333; text-align: center; color: #666; font-size: 12px; }\n    .cta { background: #f97316; color: white; padding: 16px 32px; border-radius: 12px; font-weight: bold; font-size: 16px; display: inline-block; margin-top: 20px; text-decoration: none; }\n    .developer { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }\n    .developer-name { font-size: 16px; color: #ccc; }\n  </style>\n</head>\n<body>\n  <div class="header">\n    <div class="logo">\ud83d\udd11 KeyPrime</div>\n    <div class="date">'.concat((new Date).toLocaleDateString("it-IT",{day:"numeric",month:"long",year:"numeric"}),"</div>\n  </div>\n  \n  ").concat(c?'<div class="hero"><img src="'.concat(c,'" /><div class="badge">').concat(o.icon," ").concat(o.text,"</div></div>"):"",'\n  \n  <div class="developer">\n    <span class="developer-name">by ').concat((null===(s=x.developer)||void 0===s?void 0:s.name)||"Developer",'</span>\n  </div>\n  \n  <h1 class="title">').concat(x.title,'</h1>\n  <p class="location">\ud83d\udccd ').concat((null===(i=x.location)||void 0===i?void 0:i.full_name)||"",'</p>\n  <p class="price">A partire da AED ').concat(F(x.price_from),'</p>\n  \n  <div class="grid">\n    <div class="card">\n      <div class="card-title">Tipologie</div>\n      <div class="card-value">').concat(B(x.bedrooms)||"Varie",'</div>\n    </div>\n    <div class="card">\n      <div class="card-title">Consegna</div>\n      <div class="card-value">').concat(q(x.delivery_date)||"TBA",'</div>\n    </div>\n    <div class="card">\n      <div class="card-title">Stato</div>\n      <div class="card-value">').concat(o.text,'</div>\n    </div>\n    <div class="card">\n      <div class="card-title">Popolarit\xe0</div>\n      <div class="card-value">').concat(x.hotness_level||0,"/100 \ud83d\udd25</div>\n    </div>\n  </div>\n  \n  ").concat(l?'\n  <div class="section">\n    <div class="section-title">Piano di Pagamento</div>\n    <div class="payment-grid">\n      <div class="payment-item">\n        <div class="payment-percent">'.concat(l.down_payment||0,'%</div>\n        <div class="payment-label">Anticipo</div>\n      </div>\n      <div class="payment-item">\n        <div class="payment-percent">').concat(l.during_construction||0,'%</div>\n        <div class="payment-label">In Costruzione</div>\n      </div>\n      <div class="payment-item">\n        <div class="payment-percent">').concat(l.handover||0,'%</div>\n        <div class="payment-label">Alla Consegna</div>\n      </div>\n    </div>\n  </div>\n  '):"",'\n  \n  <div style="text-align: center;">\n    <a href="').concat(x.url||"#",'" class="cta">Scopri di pi\xf9 \u2192</a>\n  </div>\n  \n  <div class="footer">\n    <p>Documento generato da KeyPrime CRM</p>\n    <p>Per info: pellegrino@indubai.it | +971 XXX XXX XXXX</p>\n  </div>\n</body>\n</html>'),u=new Blob([d],{type:"text/html"}),h=URL.createObjectURL(u),p=document.createElement("a");p.href=h,p.download="".concat(x.title.replace(/[^a-zA-Z0-9]/g,"_"),"_KeyPrime.html"),p.click(),URL.revokeObjectURL(h)}catch(o){console.error("PDF error:",o)}C(!1)},disabled:S,title:"Scarica scheda PDF",children:S?(0,tr.jsx)(ya,{className:"w-5 h-5 animate-spin"}):(0,tr.jsx)(Wa,{className:"w-5 h-5"})})]})]})]}),I&&z&&(0,tr.jsx)("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/90",children:(0,tr.jsxs)("div",{className:"relative w-full h-full max-w-5xl max-h-[90vh] bg-zinc-900 rounded-2xl overflow-hidden flex flex-col",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)(Ra,{className:"w-5 h-5 text-blue-400"}),(0,tr.jsxs)("span",{className:"text-white font-medium",children:["Brochure - ",x.title]})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsxs)("a",{href:z,download:!0,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:[(0,tr.jsx)(Wa,{className:"w-4 h-4"})," Scarica PDF"]}),(0,tr.jsx)("button",{onClick:()=>L(!1),className:"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white transition-colors",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]})]}),(0,tr.jsx)("div",{className:"flex-1 bg-zinc-800",children:(0,tr.jsx)("iframe",{src:z+"#toolbar=1&navpanes=0",className:"w-full h-full",title:"Brochure PDF"})})]})}),M&&A&&(0,tr.jsx)("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/95",children:(0,tr.jsxs)("div",{className:"relative w-full h-full max-w-5xl max-h-[90vh] bg-zinc-900 rounded-2xl overflow-hidden flex flex-col",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800",children:[(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)("svg",{className:"w-5 h-5 text-purple-400",fill:"currentColor",viewBox:"0 0 24 24",children:(0,tr.jsx)("path",{d:"M8 5v14l11-7z"})}),(0,tr.jsxs)("span",{className:"text-white font-medium",children:["Video - ",x.title]})]}),(0,tr.jsx)("button",{onClick:()=>U(!1),className:"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white transition-colors",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]}),(0,tr.jsx)("div",{className:"flex-1 bg-black flex items-center justify-center",children:"youtube"===O||"vimeo"===O?(0,tr.jsx)("iframe",{src:A+(A.includes("?")?"&":"?")+"autoplay=1",className:"w-full h-full",title:"Project Video",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):(0,tr.jsx)("video",{src:A,controls:!0,autoPlay:!0,className:"w-full h-full object-contain",children:"Il tuo browser non supporta il video."})})]})})]})}function ns(e){var t,n,r;let{listing:s,clienti:i,onClose:o,onCreateLead:l,user:d}=e;const[u,h]=(0,a.useState)(null),[p,m]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1),[x,v]=(0,a.useState)({nome:"",cognome:"",telefono:"",email:""}),b=i.filter(e=>"".concat(e.nome," ").concat(e.cognome," ").concat(e.telefono).toLowerCase().includes(p.toLowerCase())),y=u||f&&x.nome.trim();return(0,tr.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,tr.jsx)("div",{className:"absolute inset-0 bg-zinc-800/70 backdrop-blur-sm",onClick:o}),(0,tr.jsxs)("div",{className:"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-md animate-scaleIn",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800",children:[(0,tr.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Crea Lead da Annuncio"}),(0,tr.jsx)("button",{onClick:o,className:"text-zinc-400 hover:text-white",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]}),(0,tr.jsxs)("div",{className:"p-4 space-y-4",children:[(0,tr.jsxs)("div",{className:"flex gap-3 p-3 bg-zinc-700/50/50 rounded-xl",children:[(null===(t=s.images)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.small_image_url)&&(0,tr.jsx)("img",{src:s.images[0].small_image_url,alt:"",className:"w-16 h-16 rounded-lg object-cover"}),(0,tr.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium line-clamp-1",children:s.title}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs line-clamp-1",children:null===(r=s.location)||void 0===r?void 0:r.path_name}),(0,tr.jsxs)("p",{className:"text-orange-400 text-sm font-medium mt-1",children:["AED ",parseFloat(s.price).toLocaleString()]})]})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("label",{className:"text-sm text-zinc-400 mb-2 block",children:["Associa a Cliente ",(0,tr.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,tr.jsx)("input",{type:"text",placeholder:"Cerca cliente o digita nome per crearne uno nuovo...",value:p,onChange:e=>{m(e.target.value),h(null),g(!1)},className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none"}),p&&!f&&!u&&(0,tr.jsxs)("div",{className:"mt-2 max-h-40 overflow-y-auto space-y-1",children:[b.slice(0,5).map(e=>(0,tr.jsxs)("button",{onClick:()=>{h(e),m("".concat(e.nome," ").concat(e.cognome))},className:"w-full text-left p-2 rounded-lg flex items-center gap-2 ".concat((null===u||void 0===u?void 0:u.id)===e.id?"bg-orange-500/20 text-orange-400":"hover:bg-zinc-700/50 text-zinc-300"),children:[(0,tr.jsx)(zr,{nome:e.nome,cognome:e.cognome,size:"xs"}),(0,tr.jsxs)("span",{className:"text-sm",children:[e.nome," ",e.cognome]})]},e.id)),(0,tr.jsxs)("button",{onClick:()=>{g(!0),v(e=>c(c({},e),{},{nome:p.split(" ")[0],cognome:p.split(" ")[1]||""}))},className:"w-full text-left p-2 rounded-lg text-orange-400 hover:bg-zinc-700/50 text-sm",children:['+ Crea nuovo cliente "',p,'"']})]}),u&&(0,tr.jsxs)("div",{className:"mt-2 flex items-center gap-2 p-2 bg-emerald-500/20 rounded-lg",children:[(0,tr.jsx)(zr,{nome:u.nome,cognome:u.cognome,size:"xs"}),(0,tr.jsxs)("span",{className:"text-sm text-emerald-400",children:[u.nome," ",u.cognome]}),(0,tr.jsx)("button",{onClick:()=>{h(null),m("")},className:"ml-auto text-zinc-400 hover:text-white",children:(0,tr.jsx)(ia,{className:"w-4 h-4"})})]})]}),f&&(0,tr.jsxs)("div",{className:"space-y-3 p-3 bg-zinc-700/30 rounded-xl border border-orange-500/30",children:[(0,tr.jsx)("p",{className:"text-sm text-orange-400 font-medium",children:"Nuovo Cliente"}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,tr.jsx)("input",{type:"text",placeholder:"Nome *",value:x.nome,onChange:e=>v(t=>c(c({},t),{},{nome:e.target.value})),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm"}),(0,tr.jsx)("input",{type:"text",placeholder:"Cognome",value:x.cognome,onChange:e=>v(t=>c(c({},t),{},{cognome:e.target.value})),className:"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm"})]}),(0,tr.jsx)("input",{type:"tel",placeholder:"Telefono",value:x.telefono,onChange:e=>v(t=>c(c({},t),{},{telefono:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm"}),(0,tr.jsx)("input",{type:"email",placeholder:"Email",value:x.email,onChange:e=>v(t=>c(c({},t),{},{email:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm"})]}),!y&&(0,tr.jsx)("p",{className:"text-xs text-zinc-500 text-center",children:"Seleziona un cliente esistente o creane uno nuovo per continuare"})]}),(0,tr.jsxs)("div",{className:"flex gap-3 p-4 border-t border-zinc-800",children:[(0,tr.jsx)(Lr,{variant:"secondary",className:"flex-1",onClick:o,children:"Annulla"}),(0,tr.jsx)(Lr,{className:"flex-1",onClick:()=>{var e,t,n,a,r,i;if(!y)return;const c={progetto:(null===(e=s.title)||void 0===e?void 0:e.substring(0,50))||(null===(t=s.location)||void 0===t?void 0:t.name),developer:(null===(n=s.location)||void 0===n?void 0:n.name)||"TBD",zona:(null===(a=s.location)||void 0===a||null===(r=a.path_name)||void 0===r||null===(i=r.split(",")[1])||void 0===i?void 0:i.trim())||"Dubai",valore:parseFloat(s.price)||0,stato:"lead",agente:(null===d||void 0===d?void 0:d.nome)||"",pf_property_id:s.property_id,pf_url:s.url,note:"Off-Plan: ".concat(s.property_type," - ").concat(s.bedrooms||"N/A"," BR - ").concat(s.size||"N/A"," sqft")};u?(c.cliente_id=u.id,c.cliente_nome="".concat(u.nome," ").concat(u.cognome)):f&&x.nome&&(c.newCliente=x),l(c),o()},disabled:!y,style:{opacity:y?1:.5},children:"Crea Lead"})]})]})]})}function as(e){let{onLogin:t,loading:n}=e;const[r,s]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1);return(0,tr.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(r,i)},className:"space-y-4",children:[(0,tr.jsx)(Rr,{label:"Username",type:"text",value:r,onChange:e=>s(e.target.value),placeholder:"Inserisci username"}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:"Password"}),(0,tr.jsxs)("div",{className:"relative",children:[(0,tr.jsx)("input",{type:l?"text":"password",value:i,onChange:e=>o(e.target.value),placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 pr-12 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] transition-all"}),(0,tr.jsx)("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-500 hover:text-white transition-colors",children:l?(0,tr.jsx)(Ka,{className:"w-5 h-5"}):(0,tr.jsx)(La,{className:"w-5 h-5"})})]})]}),(0,tr.jsx)(Lr,{type:"submit",disabled:n||!r||!i,className:"w-full py-3",children:n?"Accesso...":"Accedi"})]})}function rs(e){let{sale:t,cliente:n,rate:r,onClose:s,onUpdateSale:i,onConvert:o,isAdmin:l,activities:d=[],followUps:u=[],onAddActivity:h,onCreateFollowUp:p,onCompleteFollowUp:m,onDeleteActivity:f,onDeleteFollowUp:g,userName:x}=e;const v="venduto"===(null===t||void 0===t?void 0:t.stato)||"incassato"===(null===t||void 0===t?void 0:t.stato)?Number(t.valore)*(t.commission_pct||5)/100*r:0,[b,y]=(0,a.useState)(!1),[w,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)("info"),[_,S]=(0,a.useState)(!1),[C,z]=(0,a.useState)(!1),[E,A]=(0,a.useState)({tipo:"call",contenuto:""}),[T,O]=(0,a.useState)({tipo:"call",data_reminder:"",ora_reminder:"",nota:""}),[P,D]=(0,a.useState)({progetto:(null===t||void 0===t?void 0:t.progetto)||"",developer:(null===t||void 0===t?void 0:t.developer)||"",zona:(null===t||void 0===t?void 0:t.zona)||"",valore:(null===t||void 0===t?void 0:t.valore)||""}),R=[{id:"call",label:"Chiamata",icon:"\ud83d\udcde",color:"blue"},{id:"email",label:"Email",icon:"\ud83d\udce7",color:"purple"},{id:"whatsapp",label:"WhatsApp",icon:"\ud83d\udcac",color:"green"},{id:"meeting",label:"Incontro",icon:"\ud83e\udd1d",color:"orange"},{id:"viewing",label:"Visita",icon:"\ud83c\udfe0",color:"pink"},{id:"note",label:"Nota",icon:"\ud83d\udcdd",color:"zinc"}];(0,a.useEffect)(()=>{t&&D({progetto:t.progetto||"",developer:t.developer||"",zona:t.zona||"",valore:t.valore||""})},[t]);return(0,tr.jsx)(Ur,{isOpen:!!t,onClose:s,title:(null===t||void 0===t?void 0:t.progetto)||"Lead",children:(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"flex items-center justify-between",children:[(0,tr.jsx)(Er,{status:(null===t||void 0===t?void 0:t.stato)||"lead"}),(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)("span",{className:"text-zinc-500 text-sm",children:(I=null===t||void 0===t?void 0:t.data,I?new Date(I).toLocaleDateString("it-IT",{day:"2-digit",month:"short",year:"numeric"}):"-")}),(0,tr.jsx)("button",{onClick:()=>y(!b),className:"p-1.5 rounded-lg bg-zinc-700/50 text-zinc-400 hover:text-white",children:(0,tr.jsx)(Ua,{className:"w-4 h-4"})})]})]}),b?(0,tr.jsx)("div",{className:"space-y-3",children:(0,tr.jsxs)(Ar,{className:"border-blue-500/20 bg-blue-500/5",children:[(0,tr.jsx)("p",{className:"text-blue-400 text-xs font-medium mb-3",children:"Modifica Lead"}),(0,tr.jsxs)("div",{className:"space-y-3",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs",children:"Progetto/Immobile"}),(0,tr.jsx)("input",{type:"text",value:P.progetto,onChange:e=>D(c(c({},P),{},{progetto:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1"})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs",children:"Developer"}),(0,tr.jsx)("input",{type:"text",value:P.developer,onChange:e=>D(c(c({},P),{},{developer:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs",children:"Zona"}),(0,tr.jsx)("input",{type:"text",value:P.zona,onChange:e=>D(c(c({},P),{},{zona:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1"})]})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs",children:"Valore (AED)"}),(0,tr.jsx)("input",{type:"number",value:P.valore,onChange:e=>D(c(c({},P),{},{valore:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1"})]})]}),(0,tr.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:()=>y(!1),className:"flex-1",disabled:w,children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:async()=>{console.log("handleSave called, sale:",t),console.log("sale.id:",null===t||void 0===t?void 0:t.id),null!==t&&void 0!==t&&t.id?(j(!0),await i(t.id,{progetto:P.progetto,developer:P.developer,zona:P.zona,valore:P.valore?parseFloat(P.valore):0}),j(!1),y(!1),s()):console.error("No sale.id!")},className:"flex-1",disabled:w,children:w?(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsx)(ya,{className:"w-4 h-4 animate-spin mr-2"}),"Salvataggio..."]}):"Salva"})]})]})}):(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsxs)(Ar,{className:"border-amber-500/20 bg-amber-500/5",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-sm",children:"Valore"}),(0,tr.jsx)("p",{className:"text-2xl font-semibold text-white mt-1",children:(null===t||void 0===t?void 0:t.valore)>0?"".concat(br(t.valore)," AED"):"TBD"}),v>0&&(0,tr.jsxs)("p",{className:"text-emerald-400 text-sm mt-1",children:["Commissione: ",br(v)," AED ",null!==t&&void 0!==t&&t.pagato?"\u2713":""]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-2",children:"Immobile"}),(0,tr.jsx)("p",{className:"text-white font-medium text-lg",children:(null===t||void 0===t?void 0:t.progetto)||"N/A"}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:"Developer"}),(0,tr.jsx)("p",{className:"text-white text-sm",children:(null===t||void 0===t?void 0:t.developer)||"N/A"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:"Zona"}),(0,tr.jsx)("p",{className:"text-white text-sm",children:(null===t||void 0===t?void 0:t.zona)||"N/A"})]})]}),(null===t||void 0===t?void 0:t.pf_url)&&(0,tr.jsxs)("a",{href:t.pf_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 mt-3 text-blue-400 text-sm hover:underline",children:[(0,tr.jsx)(ga,{className:"w-3 h-3"})," Vedi su PropertyFinder"]})]})]}),n&&!b&&(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-2",children:"Cliente"}),(0,tr.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,tr.jsx)(zr,{nome:n.nome,cognome:n.cognome}),(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("p",{className:"text-white font-medium",children:[n.nome," ",n.cognome]}),(0,tr.jsx)("p",{className:"text-zinc-500 text-sm",children:n.telefono})]})]}),(0,tr.jsx)(Br,{phone:n.telefono,whatsapp:n.whatsapp||n.telefono,email:n.email,clienteName:n.nome})]}),!b&&(0,tr.jsxs)("div",{className:"border-t border-zinc-800 pt-4",children:[(0,tr.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,tr.jsxs)("button",{onClick:()=>k("activities"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ".concat("activities"===N?"bg-blue-500/20 text-blue-400":"bg-zinc-700/50 text-zinc-400 hover:text-white"),children:["\ud83d\udcdd Attivit\xe0 (",d.length,")"]}),(0,tr.jsxs)("button",{onClick:()=>k("followups"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ".concat("followups"===N?"bg-purple-500/20 text-purple-400":"bg-zinc-700/50 text-zinc-400 hover:text-white"),children:["\u23f0 Follow-up (",u.filter(e=>!e.completato).length,")"]})]}),"activities"===N&&(0,tr.jsxs)("div",{className:"space-y-3",children:[_?(0,tr.jsxs)(Ar,{className:"border-blue-500/20 bg-blue-500/5",children:[(0,tr.jsx)("div",{className:"flex gap-2 mb-3 overflow-x-auto pb-1",children:R.map(e=>(0,tr.jsxs)("button",{onClick:()=>A(c(c({},E),{},{tipo:e.id})),className:"px-3 py-1.5 rounded-lg text-xs whitespace-nowrap transition-all ".concat(E.tipo===e.id?"bg-blue-500 text-white":"bg-zinc-700/50 text-zinc-400 hover:text-white"),children:[e.icon," ",e.label]},e.id))}),(0,tr.jsx)("textarea",{value:E.contenuto,onChange:e=>A(c(c({},E),{},{contenuto:e.target.value})),placeholder:"Descrivi l'attivit\xe0...",className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm resize-none",rows:3}),(0,tr.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:()=>S(!1),className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:async()=>{E.contenuto.trim()&&(await h(t.id,E.tipo,E.contenuto),A({tipo:"call",contenuto:""}),S(!1))},className:"flex-1",disabled:!E.contenuto.trim(),children:"Salva"})]})]}):(0,tr.jsxs)("button",{onClick:()=>S(!0),className:"w-full py-2 border-2 border-dashed border-zinc-700 rounded-xl text-zinc-400 hover:text-white hover:border-zinc-600 transition-colors flex items-center justify-center gap-2",children:[(0,tr.jsx)(Na,{className:"w-4 h-4"})," Registra attivit\xe0"]}),d.length>0?(0,tr.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:d.map(e=>{const t=R.find(t=>t.id===e.tipo)||R[5];return(0,tr.jsx)("div",{className:"p-3 bg-zinc-800/50 rounded-xl group",children:(0,tr.jsxs)("div",{className:"flex items-start justify-between",children:[(0,tr.jsxs)("div",{className:"flex items-start gap-2",children:[(0,tr.jsx)("span",{className:"text-lg",children:t.icon}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-white text-sm",children:e.contenuto}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-xs mt-1",children:[e.created_by," \u2022 ",new Date(e.created_at).toLocaleDateString("it-IT",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]})]})]}),(0,tr.jsx)("button",{onClick:()=>f(e.id),className:"opacity-0 group-hover:opacity-100 p-1 text-zinc-500 hover:text-red-400 transition-all",children:(0,tr.jsx)(ia,{className:"w-3 h-3"})})]})},e.id)})}):(0,tr.jsx)("p",{className:"text-zinc-500 text-sm text-center py-4",children:"Nessuna attivit\xe0 registrata"})]}),"followups"===N&&(0,tr.jsxs)("div",{className:"space-y-3",children:[C?(0,tr.jsxs)(Ar,{className:"border-purple-500/20 bg-purple-500/5",children:[(0,tr.jsx)("div",{className:"flex gap-2 mb-3 overflow-x-auto pb-1",children:R.slice(0,5).map(e=>(0,tr.jsxs)("button",{onClick:()=>O(c(c({},T),{},{tipo:e.id})),className:"px-3 py-1.5 rounded-lg text-xs whitespace-nowrap transition-all ".concat(T.tipo===e.id?"bg-purple-500 text-white":"bg-zinc-700/50 text-zinc-400 hover:text-white"),children:[e.icon," ",e.label]},e.id))}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs",children:"Data"}),(0,tr.jsx)("input",{type:"date",value:T.data_reminder,onChange:e=>O(c(c({},T),{},{data_reminder:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs",children:"Ora (opz.)"}),(0,tr.jsx)("input",{type:"time",value:T.ora_reminder,onChange:e=>O(c(c({},T),{},{ora_reminder:e.target.value})),className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1"})]})]}),(0,tr.jsx)("textarea",{value:T.nota,onChange:e=>O(c(c({},T),{},{nota:e.target.value})),placeholder:"Note (opzionale)...",className:"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm resize-none",rows:2}),(0,tr.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:()=>z(!1),className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:async()=>{T.data_reminder&&(await p(c({sale_id:t.id,cliente_id:null===n||void 0===n?void 0:n.id},T)),O({tipo:"call",data_reminder:"",ora_reminder:"",nota:""}),z(!1))},className:"flex-1 bg-purple-500 hover:bg-purple-600",disabled:!T.data_reminder,children:"Salva"})]})]}):(0,tr.jsxs)("button",{onClick:()=>z(!0),className:"w-full py-2 border-2 border-dashed border-zinc-700 rounded-xl text-zinc-400 hover:text-white hover:border-zinc-600 transition-colors flex items-center justify-center gap-2",children:[(0,tr.jsx)(Na,{className:"w-4 h-4"})," Programma follow-up"]}),u.length>0?(0,tr.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:u.map(e=>{const t=R.find(t=>t.id===e.tipo)||R[0],n=new Date(e.data_reminder)<new Date&&!e.completato,a=new Date(e.data_reminder).toDateString()===(new Date).toDateString();return(0,tr.jsx)("div",{className:"p-3 rounded-xl border transition-all ".concat(e.completato?"bg-zinc-800/30 border-zinc-800 opacity-60":n?"bg-red-500/10 border-red-500/30":a?"bg-purple-500/10 border-purple-500/30":"bg-zinc-800/50 border-zinc-800"),children:(0,tr.jsxs)("div",{className:"flex items-start justify-between",children:[(0,tr.jsxs)("div",{className:"flex items-start gap-2",children:[(0,tr.jsx)("span",{className:"text-lg",children:t.icon}),(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsxs)("p",{className:"text-sm font-medium ".concat(e.completato?"text-zinc-500 line-through":n?"text-red-400":"text-white"),children:[new Date(e.data_reminder).toLocaleDateString("it-IT",{day:"numeric",month:"short"}),e.ora_reminder&&" alle ".concat(e.ora_reminder.slice(0,5))]}),a&&!e.completato&&(0,tr.jsx)("span",{className:"px-1.5 py-0.5 bg-purple-500 text-white text-[10px] font-bold rounded",children:"OGGI"}),n&&!e.completato&&(0,tr.jsx)("span",{className:"px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded",children:"SCADUTO"})]}),e.nota&&(0,tr.jsx)("p",{className:"text-zinc-400 text-xs mt-1",children:e.nota})]})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-1",children:[!e.completato&&(0,tr.jsx)("button",{onClick:()=>m(e.id),className:"p-1.5 text-zinc-500 hover:text-green-400 transition-colors",title:"Completato",children:(0,tr.jsx)(na,{className:"w-4 h-4"})}),(0,tr.jsx)("button",{onClick:()=>g(e.id),className:"p-1.5 text-zinc-500 hover:text-red-400 transition-colors",title:"Elimina",children:(0,tr.jsx)(ia,{className:"w-4 h-4"})})]})]})},e.id)})}):(0,tr.jsx)("p",{className:"text-zinc-500 text-sm text-center py-4",children:"Nessun follow-up programmato"})]})]}),!b&&(0,tr.jsxs)("div",{children:[(0,tr.jsx)("p",{className:"text-zinc-500 text-xs mb-2",children:"Cambia stato"}),(0,tr.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:mr.slice(0,-1).map(e=>{var n,a;return(0,tr.jsx)("button",{onClick:()=>{i(t.id,{stato:e}),e!==t.stato&&s()},className:"px-4 py-2 rounded-xl text-sm whitespace-nowrap transition-all ".concat((null===t||void 0===t?void 0:t.stato)===e?"text-white":"text-zinc-500 hover:text-white"),style:(null===t||void 0===t?void 0:t.stato)===e?{background:null===(n=vr.status[e])||void 0===n?void 0:n.bg,color:null===(a=vr.status[e])||void 0===a?void 0:a.color}:{background:"#334155"},children:fr[e]||e},e)})})]}),!b&&["prenotato","trattativa"].includes(null===t||void 0===t?void 0:t.stato)&&(0,tr.jsx)(Lr,{onClick:o,icon:ka,className:"w-full py-3 bg-emerald-500 hover:bg-emerald-600 text-white",children:"Registra Vendita"}),l&&!b&&(0,tr.jsx)(Lr,{variant:"danger",icon:Da,className:"w-full",children:"Elimina Lead"})]})});var I}function ss(e){let{sale:t,onConvert:n,onCancel:r}=e;const[s,i]=(0,a.useState)((null===t||void 0===t?void 0:t.valore)||"");return(0,tr.jsx)(Mr,{isOpen:!!t,onClose:r,title:"\ud83c\udf89 Registra Vendita",size:"sm",children:(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)(Ar,{padding:"p-3",className:"bg-zinc-700/50/50",children:[(0,tr.jsx)("p",{className:"text-white font-medium",children:null===t||void 0===t?void 0:t.progetto}),(0,tr.jsxs)("p",{className:"text-zinc-500 text-sm",children:[null===t||void 0===t?void 0:t.developer," \u2022 ",null===t||void 0===t?void 0:t.zona]})]}),(0,tr.jsx)(Rr,{label:"Valore finale (AED)",type:"number",value:s,onChange:e=>i(e.target.value),placeholder:"es. 1500000",autoFocus:!0}),(0,tr.jsxs)("div",{className:"flex gap-3",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:r,className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:()=>s&&n(t.id,parseFloat(s)),disabled:!s,className:"flex-1 bg-emerald-500 hover:bg-emerald-600",children:"Conferma"})]})]})})}function is(e){let{tasks:t,unreadIds:n,onClose:a,onGoToTask:r,recentSales:s=[],onMarkAsRead:i,userId:o}=e;const l=[...s.map(e=>({type:"sale",id:"sale_"+e.id,data:e})),...t.map(e=>({type:"task",id:"task_".concat(e.id,"_").concat(o),data:e}))];return(0,tr.jsx)(Ur,{isOpen:!0,onClose:a,title:"Notifiche",children:0===l.length?(0,tr.jsx)(Dr,{icon:ja,title:"Nessuna notifica",description:"Sei in pari con tutto!"}):(0,tr.jsxs)("div",{className:"space-y-2",children:[s.map(e=>(0,tr.jsx)(Ar,{padding:"p-3",className:n.includes("sale_"+e.id)?"border-l-2 border-l-emerald-500":"",children:(0,tr.jsxs)("div",{className:"flex items-start gap-3",children:[(0,tr.jsx)("div",{className:"w-8 h-8 rounded-full bg-emerald-500/20 flex items-center justify-center",children:(0,tr.jsx)(ka,{className:"w-4 h-4 text-emerald-400"})}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsxs)("p",{className:"text-white text-sm font-medium",children:["Nuova ","venduto"===e.stato?"Vendita":"Lead"]}),(0,tr.jsxs)("p",{className:"text-zinc-400 text-xs",children:[e.progetto," \u2022 ",e.agente||e.segnalatore]}),(0,tr.jsxs)("p",{className:"text-emerald-400 text-xs font-medium mt-1",children:[br(e.valore)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,tr.jsx)("span",{className:"text-zinc-500 text-xs",children:wr(e.created_at)}),n.includes("sale_"+e.id)&&(0,tr.jsx)("button",{onClick:t=>{t.stopPropagation(),i("sale_"+e.id)},className:"text-xs text-zinc-500 hover:text-white",children:(0,tr.jsx)(na,{className:"w-4 h-4"})})]})]})},"sale_"+e.id)),t.map(e=>{const t="task_".concat(e.id,"_").concat(o),a=n.includes(t);return(0,tr.jsx)(Ar,{padding:"p-3",className:a?"border-l-2 border-l-pink-500":"",children:(0,tr.jsxs)("div",{className:"flex items-start gap-3",children:[(0,tr.jsx)("div",{className:"w-2 h-2 rounded-full mt-1.5 ".concat(Nr(e.scadenza)?"bg-red-500":"bg-amber-500")}),(0,tr.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:r,children:[(0,tr.jsx)("p",{className:"text-white text-sm font-medium",children:e.titolo}),(0,tr.jsxs)("p",{className:"text-xs ".concat(Nr(e.scadenza)?"text-red-400":"text-zinc-500"),children:[e.scadenza?yr(e.scadenza):"Senza scadenza",Nr(e.scadenza)&&" \u2022 Scaduto!"]}),e.created_by&&(0,tr.jsxs)("p",{className:"text-zinc-600 text-xs mt-1",children:["Da: ",e.created_by]})]}),(0,tr.jsxs)("div",{className:"flex items-center gap-2",children:[(0,tr.jsx)(Er,{status:e.priorita,type:"priority"}),a&&(0,tr.jsx)("button",{onClick:e=>{e.stopPropagation(),i(t)},className:"p-1 text-zinc-500 hover:text-white hover:bg-zinc-700 rounded transition-colors",title:"Segna come letta",children:(0,tr.jsx)(na,{className:"w-4 h-4"})})]})]})},e.id)})]})})}function os(e){let{currentPassword:t,onSave:n,onClose:r}=e;const[s,i]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[u,h]=(0,a.useState)("");return(0,tr.jsx)(Mr,{isOpen:!0,onClose:r,title:"Cambia Password",size:"sm",children:(0,tr.jsxs)("div",{className:"space-y-4",children:[u&&(0,tr.jsx)("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 rounded-xl px-4 py-3 text-sm",children:u}),(0,tr.jsx)(Rr,{label:"Password attuale",type:"password",value:s,onChange:e=>i(e.target.value)}),(0,tr.jsx)(Rr,{label:"Nuova password",type:"password",value:o,onChange:e=>l(e.target.value)}),(0,tr.jsx)(Rr,{label:"Conferma password",type:"password",value:c,onChange:e=>d(e.target.value)}),(0,tr.jsxs)("div",{className:"flex gap-3",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:r,className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:()=>{s===t?o.length<6?h("Minimo 6 caratteri"):o===c?n(o):h("Le password non coincidono"):h("Password attuale errata")},className:"flex-1",children:"Salva"})]})]})})}function ls(e){let{task:t,onSave:n,onClose:r}=e;const[s,i]=(0,a.useState)((null===t||void 0===t?void 0:t.note)||"");return(0,tr.jsx)(Mr,{isOpen:!0,onClose:r,title:"Aggiungi Nota",size:"sm",children:(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsx)(Ar,{padding:"p-3",className:"bg-zinc-700/50/50",children:(0,tr.jsx)("p",{className:"text-white font-medium",children:null===t||void 0===t?void 0:t.titolo})}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:"Nota"}),(0,tr.jsx)("textarea",{value:s,onChange:e=>i(e.target.value),placeholder:"Scrivi una nota...",className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] h-24 resize-none",autoFocus:!0})]}),(0,tr.jsx)("p",{className:"text-zinc-600 text-xs",children:"L'admin ricever\xe0 una notifica email"}),(0,tr.jsxs)("div",{className:"flex gap-3",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:r,className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:()=>n(t.id,s),icon:Ga,className:"flex-1",children:"Invia"})]})]})})}function cs(e){let{cliente:t,onSave:n,onClose:r}=e;const[s,i]=(0,a.useState)(t||{nome:"",cognome:"",email:"",telefono:"",whatsapp:"",nazionalita:"",budget_min:"",budget_max:"",stato:"nuovo",fonte:"",note:""});return(0,tr.jsx)(Mr,{isOpen:!0,onClose:r,title:t?"Modifica Cliente":"Nuovo Cliente",children:(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{label:"Nome *",value:s.nome,onChange:e=>i(c(c({},s),{},{nome:e.target.value}))}),(0,tr.jsx)(Rr,{label:"Cognome",value:s.cognome||"",onChange:e=>i(c(c({},s),{},{cognome:e.target.value}))})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{label:"Telefono",type:"tel",value:s.telefono||"",onChange:e=>i(c(c({},s),{},{telefono:e.target.value}))}),(0,tr.jsx)(Rr,{label:"WhatsApp",type:"tel",value:s.whatsapp||"",onChange:e=>i(c(c({},s),{},{whatsapp:e.target.value}))})]}),(0,tr.jsx)(Rr,{label:"Email",type:"email",value:s.email||"",onChange:e=>i(c(c({},s),{},{email:e.target.value}))}),(0,tr.jsx)(Rr,{label:"Nazionalit\xe0",value:s.nazionalita||"",onChange:e=>i(c(c({},s),{},{nazionalita:e.target.value}))}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{label:"Budget Min",type:"number",value:s.budget_min||"",onChange:e=>i(c(c({},s),{},{budget_min:e.target.value}))}),(0,tr.jsx)(Rr,{label:"Budget Max",type:"number",value:s.budget_max||"",onChange:e=>i(c(c({},s),{},{budget_max:e.target.value}))})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Ir,{label:"Stato",value:s.stato||"nuovo",onChange:e=>i(c(c({},s),{},{stato:e.target.value})),children:gr.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))}),(0,tr.jsx)(Rr,{label:"Fonte",value:s.fonte||"",onChange:e=>i(c(c({},s),{},{fonte:e.target.value}))})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:"Note"}),(0,tr.jsx)("textarea",{value:s.note||"",onChange:e=>i(c(c({},s),{},{note:e.target.value})),className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm h-20 resize-none focus:outline-none focus:border-[#3F3F46]"})]}),(0,tr.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:r,className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:async()=>{s.nome?await n(s):alert("Nome obbligatorio")},className:"flex-1",children:"Salva"})]})]})})}function ds(e){let{task:t,clienti:n,users:r,onSave:s,onClose:i}=e;const[o,l]=(0,a.useState)(t||{titolo:"",descrizione:"",scadenza:"",priorita:"normale",cliente_id:"",assegnato_a:""});return(0,tr.jsx)(Mr,{isOpen:!0,onClose:i,title:null!==t&&void 0!==t&&t.id?"Modifica Task":"Nuovo Task",children:(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsx)(Rr,{label:"Titolo *",value:o.titolo,onChange:e=>l(c(c({},o),{},{titolo:e.target.value})),autoFocus:!0}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:"Descrizione"}),(0,tr.jsx)("textarea",{value:o.descrizione||"",onChange:e=>l(c(c({},o),{},{descrizione:e.target.value})),className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm h-20 resize-none focus:outline-none focus:border-[#3F3F46]"})]}),(0,tr.jsx)(Rr,{label:"Scadenza",type:"datetime-local",value:o.scadenza?o.scadenza.slice(0,16):"",onChange:e=>l(c(c({},o),{},{scadenza:e.target.value?new Date(e.target.value).toISOString():""}))}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:"Priorit\xe0"}),(0,tr.jsx)("div",{className:"flex gap-2",children:xr.map(e=>{var t,n;return(0,tr.jsx)("button",{onClick:()=>l(c(c({},o),{},{priorita:e})),className:"flex-1 px-3 py-2 rounded-xl text-sm transition-all ".concat(o.priorita===e?"text-white":"text-zinc-500"),style:o.priorita===e?{background:null===(t=vr.priority[e])||void 0===t?void 0:t.bg,color:null===(n=vr.priority[e])||void 0===n?void 0:n.color}:{background:"#334155"},children:e},e)})})]}),(0,tr.jsxs)(Ir,{label:"Cliente",value:o.cliente_id||"",onChange:e=>l(c(c({},o),{},{cliente_id:e.target.value})),children:[(0,tr.jsx)("option",{value:"",children:"Nessun cliente"}),n.map(e=>(0,tr.jsxs)("option",{value:e.id,children:[e.nome," ",e.cognome]},e.id))]}),(0,tr.jsxs)(Ir,{label:"Assegna a",value:o.assegnato_a||"",onChange:e=>l(c(c({},o),{},{assegnato_a:e.target.value})),children:[(0,tr.jsx)("option",{value:"",children:"Non assegnato"}),r.filter(e=>"admin"!==e.ruolo).map(e=>(0,tr.jsxs)("option",{value:e.nome,children:[e.nome," (",e.ruolo,")"]},e.id))]}),(0,tr.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:i,className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:async()=>{o.titolo?await s(c(c({},o),{},{cliente_id:o.cliente_id||null,scadenza:o.scadenza||null})):alert("Titolo obbligatorio")},className:"flex-1",children:"Salva"})]})]})})}function us(e){let{user:t,onSave:n,onClose:r}=e;const[s,i]=(0,a.useState)(t||{nome:"",username:"",password:"",email:"",ruolo:"agente",referente:"Pellegrino",attivo:!0}),[o,l]=(0,a.useState)(!1);return(0,tr.jsx)(Mr,{isOpen:!0,onClose:r,title:t?"Modifica Utente":"Nuovo Utente",children:(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsx)(Rr,{label:"Nome *",value:s.nome,onChange:e=>i(c(c({},s),{},{nome:e.target.value}))}),(0,tr.jsx)(Rr,{label:"Email",type:"email",value:s.email||"",onChange:e=>i(c(c({},s),{},{email:e.target.value})),placeholder:"Per notifiche"}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{label:"Username *",value:s.username,onChange:e=>i(c(c({},s),{},{username:e.target.value}))}),(0,tr.jsx)(Rr,{label:"Password *",value:s.password,onChange:e=>i(c(c({},s),{},{password:e.target.value}))})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsxs)(Ir,{label:"Ruolo",value:s.ruolo,onChange:e=>i(c(c({},s),{},{ruolo:e.target.value})),children:[(0,tr.jsx)("option",{value:"admin",children:"Admin"}),(0,tr.jsx)("option",{value:"agente",children:"Agente"}),(0,tr.jsx)("option",{value:"agente_admin",children:"Agente Admin (70/30)"}),(0,tr.jsx)("option",{value:"segnalatore",children:"Segnalatore"})]}),(0,tr.jsxs)(Ir,{label:"Referente",value:s.referente,onChange:e=>i(c(c({},s),{},{referente:e.target.value})),disabled:"agente_admin"===s.ruolo,children:[(0,tr.jsx)("option",{value:"Pellegrino",children:"Pellegrino"}),(0,tr.jsx)("option",{value:"Giovanni",children:"Giovanni"})]})]}),"agente_admin"===s.ruolo&&(0,tr.jsx)(Ar,{padding:"p-3",className:"bg-violet-500/10 border-violet-500/20",children:(0,tr.jsxs)("p",{className:"text-violet-400 text-sm",children:["\ud83d\udca1 ",(0,tr.jsx)("strong",{children:"Agente Admin:"})," 70% commissione all'agente, 30% a Pellegrino"]})}),t&&(0,tr.jsxs)(Ar,{padding:"p-3",className:"flex items-center gap-3",children:[(0,tr.jsx)("input",{type:"checkbox",id:"attivo",checked:s.attivo,onChange:e=>i(c(c({},s),{},{attivo:e.target.checked})),className:"w-4 h-4 rounded"}),(0,tr.jsx)("label",{htmlFor:"attivo",className:"text-zinc-300 text-sm",children:"Utente attivo"})]}),(0,tr.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,tr.jsx)(Lr,{variant:"secondary",onClick:r,className:"flex-1",children:"Annulla"}),(0,tr.jsx)(Lr,{onClick:async()=>{s.nome&&s.username&&s.password?(l(!0),await n(s),l(!1)):alert("Compila i campi obbligatori")},className:"flex-1",disabled:o,children:o?"Salvataggio...":"Salva"})]})]})})}function hs(e){let{clienti:t,onSelect:n,onCreateNew:r,selectedClient:s}=e;const[i,o]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1),d=i.length>=2?t.filter(e=>"".concat(e.nome," ").concat(e.cognome," ").concat(e.telefono).toLowerCase().includes(i.toLowerCase())).slice(0,5):[];return s?(0,tr.jsx)(Ar,{padding:"p-3",className:"border-emerald-500/20 bg-emerald-500/5",children:(0,tr.jsxs)("div",{className:"flex items-center gap-3",children:[(0,tr.jsx)(zr,{nome:s.nome,cognome:s.cognome,size:"sm"}),(0,tr.jsxs)("div",{className:"flex-1",children:[(0,tr.jsxs)("p",{className:"text-white font-medium",children:[s.nome," ",s.cognome]}),(0,tr.jsx)("p",{className:"text-emerald-400 text-sm",children:s.telefono})]}),(0,tr.jsx)("button",{onClick:()=>n(null),className:"text-zinc-500 hover:text-white",children:(0,tr.jsx)(ia,{className:"w-5 h-5"})})]})}):(0,tr.jsxs)("div",{className:"relative",children:[(0,tr.jsxs)("div",{className:"relative",children:[(0,tr.jsx)(da,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500"}),(0,tr.jsx)("input",{type:"text",placeholder:"Cerca cliente...",value:i,onChange:e=>{o(e.target.value),c(!0)},onFocus:()=>c(!0),className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46]"})]}),l&&i.length>=2&&(0,tr.jsxs)("div",{className:"absolute z-10 w-full mt-2 bg-[#1e293b] border border-[#334155] rounded-xl overflow-hidden shadow-xl",children:[d.map(e=>(0,tr.jsxs)("button",{onClick:()=>{n(e),o(""),c(!1)},className:"w-full text-left px-4 py-3 hover:bg-white/5 border-b border-[#334155] last:border-0 flex items-center gap-3 transition-colors",children:[(0,tr.jsx)(zr,{nome:e.nome,cognome:e.cognome,size:"sm"}),(0,tr.jsxs)("div",{children:[(0,tr.jsxs)("p",{className:"text-white text-sm",children:[e.nome," ",e.cognome]}),(0,tr.jsx)("p",{className:"text-zinc-500 text-xs",children:e.telefono})]})]},e.id)),0===d.length&&(0,tr.jsx)("div",{className:"px-4 py-3 text-zinc-500 text-sm",children:"Nessun risultato"}),(0,tr.jsxs)("button",{onClick:()=>{r(),c(!1)},className:"w-full text-left px-4 py-3 bg-blue-500/10 text-blue-400 flex items-center gap-2 hover:bg-blue-500/20 transition-colors",children:[(0,tr.jsx)(Ma,{className:"w-4 h-4"})," Nuovo cliente"]})]}),!i&&(0,tr.jsxs)("button",{onClick:r,className:"w-full mt-3 border border-dashed border-[#3F3F46] rounded-xl py-3 text-zinc-500 text-sm flex items-center justify-center gap-2 hover:border-amber-500 hover:text-amber-400 transition-colors",children:[(0,tr.jsx)(Ma,{className:"w-4 h-4"})," Crea nuovo cliente"]})]})}function ps(e){let{value:t,onChange:n,options:r,placeholder:s,label:i}=e;const[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)("");return(0,a.useEffect)(()=>{t&&!r.includes(t)&&"Altro"!==t&&(l(!0),d(t))},[t,r]),(0,tr.jsxs)("div",{children:[i&&(0,tr.jsx)("label",{className:"block text-sm text-zinc-400 mb-2",children:i}),(0,tr.jsxs)("select",{value:o?"Altro":t,onChange:e=>{"Altro"===e.target.value?(l(!0),d(""),n("")):(l(!1),n(e.target.value))},className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-[#3F3F46] appearance-none",children:[(0,tr.jsx)("option",{value:"",children:s}),r.map(e=>(0,tr.jsx)("option",{value:e,children:e},e))]}),o&&(0,tr.jsx)("input",{type:"text",value:c,onChange:e=>{d(e.target.value),n(e.target.value)},placeholder:"Specifica...",className:"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm mt-2 focus:outline-none focus:border-[#3F3F46]",autoFocus:!0})]})}function ms(e){let{type:t,userName:n,clienti:r,onSubmit:s}=e;const[i,o]=(0,a.useState)(null),[l,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)({data:(new Date).toISOString().split("T")[0],developer:"",progetto:"",zona:"",valore:"",stato:"lead",cliente_nome:"",cliente_cognome:"",cliente_email:"",cliente_telefono:"",cliente_whatsapp:"",cliente_nazionalita:"",cliente_budget_min:"",cliente_budget_max:"",cliente_note:""});return(0,tr.jsxs)("form",{onSubmit:e=>{null===e||void 0===e||e.preventDefault(),i||u.cliente_nome?s(c(c({},u),{},{cliente_id:null===i||void 0===i?void 0:i.id,cliente_nome:(null===i||void 0===i?void 0:i.nome)||u.cliente_nome,developer:u.developer||"TBD",progetto:u.progetto||"TBD",zona:u.zona||"TBD",valore:u.valore?parseFloat(u.valore):0,agente:"agente"===t?n:null,segnalatore:"segnalatore"===t?n:null})):alert("Seleziona o crea un cliente")},className:"space-y-6",children:[(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h4",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[(0,tr.jsx)(Fa,{className:"w-4 h-4 text-amber-400"})," Cliente"]}),(0,tr.jsx)(hs,{clienti:r,selectedClient:i,onSelect:e=>{o(e),d(!1)},onCreateNew:()=>{o(null),d(!0)}}),l&&!i&&(0,tr.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#334155] space-y-3",children:[(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{placeholder:"Nome *",value:u.cliente_nome,onChange:e=>h(c(c({},u),{},{cliente_nome:e.target.value}))}),(0,tr.jsx)(Rr,{placeholder:"Cognome",value:u.cliente_cognome,onChange:e=>h(c(c({},u),{},{cliente_cognome:e.target.value}))})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{type:"tel",placeholder:"Telefono",value:u.cliente_telefono,onChange:e=>h(c(c({},u),{},{cliente_telefono:e.target.value}))}),(0,tr.jsx)(Rr,{type:"email",placeholder:"Email",value:u.cliente_email,onChange:e=>h(c(c({},u),{},{cliente_email:e.target.value}))})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{type:"number",placeholder:"Budget Min",value:u.cliente_budget_min,onChange:e=>h(c(c({},u),{},{cliente_budget_min:e.target.value}))}),(0,tr.jsx)(Rr,{type:"number",placeholder:"Budget Max",value:u.cliente_budget_max,onChange:e=>h(c(c({},u),{},{cliente_budget_max:e.target.value}))})]})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h4",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[(0,tr.jsx)(ga,{className:"w-4 h-4 text-blue-400"})," Immobile"]}),(0,tr.jsxs)("div",{className:"space-y-3",children:[(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(ps,{value:u.developer,onChange:e=>h(c(c({},u),{},{developer:e})),options:hr,placeholder:"Developer"}),(0,tr.jsx)(ps,{value:u.zona,onChange:e=>h(c(c({},u),{},{zona:e})),options:ur,placeholder:"Zona"})]}),(0,tr.jsx)(Rr,{placeholder:"Progetto",value:u.progetto,onChange:e=>h(c(c({},u),{},{progetto:e.target.value}))}),(0,tr.jsx)(Rr,{type:"number",placeholder:"Valore (AED)",value:u.valore,onChange:e=>h(c(c({},u),{},{valore:e.target.value}))})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsx)("h4",{className:"text-white font-medium mb-4",children:"Stato iniziale"}),(0,tr.jsx)("div",{className:"flex flex-wrap gap-2",children:mr.slice(0,4).map(e=>{var t,n;return(0,tr.jsx)("button",{type:"button",onClick:()=>h(c(c({},u),{},{stato:e})),className:"px-4 py-2 rounded-xl text-sm transition-all ".concat(u.stato===e?"text-white":"text-zinc-500"),style:u.stato===e?{background:null===(t=vr.status[e])||void 0===t?void 0:t.bg,color:null===(n=vr.status[e])||void 0===n?void 0:n.color}:{background:"#334155"},children:fr[e]||e},e)})})]}),(0,tr.jsx)("button",{type:"submit",id:"submitBtn",className:"hidden",children:"Submit"})]})}function fs(e){let{type:t,userName:n,clienti:r,onSubmit:s}=e;const[i,o]=(0,a.useState)(null),[l,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)({data:(new Date).toISOString().split("T")[0],developer:"",progetto:"",zona:"",valore:"",nuovo_cliente_nome:"",nuovo_cliente_cognome:"",nuovo_cliente_telefono:"",nuovo_cliente_email:""});return(0,tr.jsxs)("form",{onSubmit:e=>{null===e||void 0===e||e.preventDefault(),i||u.nuovo_cliente_nome?u.developer&&u.progetto&&u.zona&&u.valore?s({data:u.data,developer:u.developer,progetto:u.progetto,zona:u.zona,valore:parseFloat(u.valore),agente:"agente"===t?n:null,segnalatore:"segnalatore"===t?n:null,cliente_id:null===i||void 0===i?void 0:i.id,cliente_nome:(null===i||void 0===i?void 0:i.nome)||u.nuovo_cliente_nome,nuovo_cliente_nome:u.nuovo_cliente_nome,nuovo_cliente_cognome:u.nuovo_cliente_cognome,nuovo_cliente_telefono:u.nuovo_cliente_telefono,nuovo_cliente_email:u.nuovo_cliente_email}):alert("Compila tutti i campi dell'immobile"):alert("Seleziona o inserisci il cliente")},className:"space-y-6",children:[(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h4",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[(0,tr.jsx)(Fa,{className:"w-4 h-4 text-amber-400"})," Cliente Acquirente"]}),(0,tr.jsx)(hs,{clienti:r,selectedClient:i,onSelect:e=>{o(e),d(!1)},onCreateNew:()=>{o(null),d(!0)}}),l&&!i&&(0,tr.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#334155] space-y-3",children:[(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{placeholder:"Nome *",value:u.nuovo_cliente_nome,onChange:e=>h(c(c({},u),{},{nuovo_cliente_nome:e.target.value}))}),(0,tr.jsx)(Rr,{placeholder:"Cognome",value:u.nuovo_cliente_cognome,onChange:e=>h(c(c({},u),{},{nuovo_cliente_cognome:e.target.value}))})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,tr.jsx)(Rr,{type:"tel",placeholder:"Telefono",value:u.nuovo_cliente_telefono,onChange:e=>h(c(c({},u),{},{nuovo_cliente_telefono:e.target.value}))}),(0,tr.jsx)(Rr,{type:"email",placeholder:"Email",value:u.nuovo_cliente_email,onChange:e=>h(c(c({},u),{},{nuovo_cliente_email:e.target.value}))})]})]})]}),(0,tr.jsxs)(Ar,{children:[(0,tr.jsxs)("h4",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[(0,tr.jsx)(ka,{className:"w-4 h-4 text-emerald-400"})," Dettagli Vendita"]}),(0,tr.jsxs)("div",{className:"space-y-3",children:[(0,tr.jsx)(Rr,{label:"Data",type:"date",value:u.data,onChange:e=>h(c(c({},u),{},{data:e.target.value}))}),(0,tr.jsx)(ps,{label:"Developer *",value:u.developer,onChange:e=>h(c(c({},u),{},{developer:e})),options:hr,placeholder:"Seleziona developer"}),(0,tr.jsx)(Rr,{label:"Progetto *",value:u.progetto,onChange:e=>h(c(c({},u),{},{progetto:e.target.value})),placeholder:"Nome progetto"}),(0,tr.jsx)(ps,{label:"Zona *",value:u.zona,onChange:e=>h(c(c({},u),{},{zona:e})),options:ur,placeholder:"Seleziona zona"}),(0,tr.jsx)(Rr,{label:"Valore (AED) *",type:"number",value:u.valore,onChange:e=>h(c(c({},u),{},{valore:e.target.value})),placeholder:"es. 1500000"})]})]}),(0,tr.jsx)("button",{type:"submit",id:"submitBtn",className:"hidden",children:"Submit"})]})}const gs={"Palm Jumeirah":{emirate:"Dubai",cat:"Ultra Premium",e:"\ud83c\udf34",lt:5.5,rent:18e4,sqft:2800,occ:78,night:1200,opAppr:15,opDisc:10,opHand:30,secAppr:8,scNew:22,scOld:30,dewa:8e3,ageNew:"2020+",ageMid:"2010-19",ageOld:"2005-09"},"Emirates Hills":{emirate:"Dubai",cat:"Ultra Premium",e:"\u26f3",lt:4,rent:25e4,sqft:3500,occ:50,night:2500,opAppr:8,opDisc:5,opHand:36,secAppr:5,scNew:5,scOld:7,dewa:15e3,ageNew:"2020+",ageMid:"2008-19",ageOld:"2003-07"},"Bluewaters Island":{emirate:"Dubai",cat:"Ultra Premium",e:"\ud83c\udfa1",lt:5.2,rent:16e4,sqft:3e3,occ:75,night:1100,opAppr:12,opDisc:8,opHand:24,secAppr:7,scNew:25,scOld:32,dewa:7500,ageNew:"2020+",ageMid:"2018-19",ageOld:null},"Downtown Dubai":{emirate:"Dubai",cat:"Premium",e:"\ud83c\udfd9\ufe0f",lt:5.8,rent:13e4,sqft:2400,occ:82,night:900,opAppr:18,opDisc:12,opHand:30,secAppr:8,scNew:18,scOld:28,dewa:7500,ageNew:"2020+",ageMid:"2010-19",ageOld:"2006-09"},"Dubai Marina":{emirate:"Dubai",cat:"Premium",e:"\u26f5",lt:6.2,rent:105e3,sqft:1700,occ:82,night:700,opAppr:12,opDisc:10,opHand:24,secAppr:6,scNew:15,scOld:22,dewa:6500,ageNew:"2018+",ageMid:"2008-17",ageOld:"2003-07"},DIFC:{emirate:"Dubai",cat:"Premium",e:"\ud83c\udfe6",lt:5,rent:15e4,sqft:3200,occ:65,night:950,opAppr:10,opDisc:8,opHand:30,secAppr:6,scNew:28,scOld:38,dewa:8e3,ageNew:"2020+",ageMid:"2010-19",ageOld:"2005-09"},Jumeirah:{emirate:"Dubai",cat:"Premium",e:"\ud83c\udfd6\ufe0f",lt:4.8,rent:14e4,sqft:2600,occ:60,night:1e3,opAppr:8,opDisc:5,opHand:30,secAppr:5,scNew:8,scOld:12,dewa:9e3,ageNew:"2015+",ageMid:"2000-14",ageOld:"1990-99"},"Al Wasl":{emirate:"Dubai",cat:"Premium",e:"\ud83c\udf07",lt:5,rent:135e3,sqft:2500,occ:55,night:900,opAppr:7,opDisc:5,opHand:28,secAppr:5,scNew:8,scOld:12,dewa:8500,ageNew:"2018+",ageMid:"2005-17",ageOld:"1995-04"},JBR:{emirate:"Dubai",cat:"High-End",e:"\ud83c\udfd6\ufe0f",lt:6,rent:11e4,sqft:1900,occ:85,night:800,opAppr:10,opDisc:8,opHand:24,secAppr:5,scNew:14,scOld:18,dewa:6e3,ageNew:"2018+",ageMid:"2008-17",ageOld:"2005-07"},"Dubai Creek Harbour":{emirate:"Dubai",cat:"High-End",e:"\ud83c\udf0a",lt:6.5,rent:95e3,sqft:1600,occ:70,night:600,opAppr:25,opDisc:15,opHand:30,secAppr:12,scNew:14,scOld:18,dewa:6e3,ageNew:"2020+",ageMid:"2018-19",ageOld:null},"Dubai Hills Estate":{emirate:"Dubai",cat:"High-End",e:"\ud83c\udf33",lt:6.5,rent:1e5,sqft:1700,occ:60,night:650,opAppr:20,opDisc:12,opHand:28,secAppr:10,scNew:12,scOld:16,dewa:6500,ageNew:"2020+",ageMid:"2017-19",ageOld:null},"MBR City":{emirate:"Dubai",cat:"High-End",e:"\ud83d\udc51",lt:6.8,rent:9e4,sqft:1500,occ:65,night:550,opAppr:22,opDisc:15,opHand:30,secAppr:12,scNew:11,scOld:15,dewa:6e3,ageNew:"2020+",ageMid:"2016-19",ageOld:null},"City Walk":{emirate:"Dubai",cat:"High-End",e:"\ud83d\udecd\ufe0f",lt:5.5,rent:12e4,sqft:2200,occ:72,night:750,opAppr:12,opDisc:8,opHand:24,secAppr:7,scNew:18,scOld:24,dewa:7e3,ageNew:"2020+",ageMid:"2015-19",ageOld:null},"Sobha Hartland":{emirate:"Dubai",cat:"High-End",e:"\ud83c\udf3f",lt:6.2,rent:95e3,sqft:1650,occ:62,night:580,opAppr:18,opDisc:12,opHand:28,secAppr:10,scNew:13,scOld:17,dewa:6200,ageNew:"2020+",ageMid:"2018-19",ageOld:null},"Arabian Ranches":{emirate:"Dubai",cat:"High-End",e:"\ud83d\udc0e",lt:5.5,rent:12e4,sqft:1800,occ:50,night:700,opAppr:10,opDisc:8,opHand:28,secAppr:6,scNew:4,scOld:6,dewa:8e3,ageNew:"2020+",ageMid:"2008-19",ageOld:"2004-07"},"Wasl Gate":{emirate:"Dubai",cat:"High-End",e:"\ud83d\udeaa",lt:6.5,rent:85e3,sqft:1400,occ:68,night:520,opAppr:15,opDisc:10,opHand:26,secAppr:8,scNew:12,scOld:16,dewa:5800,ageNew:"2020+",ageMid:"2016-19",ageOld:null},"Business Bay":{emirate:"Dubai",cat:"Mid-Market",e:"\ud83d\udcbc",lt:7.2,rent:78e3,sqft:1350,occ:75,night:500,opAppr:15,opDisc:12,opHand:24,secAppr:8,scNew:14,scOld:20,dewa:5500,ageNew:"2020+",ageMid:"2012-19",ageOld:"2008-11"},JLT:{emirate:"Dubai",cat:"Mid-Market",e:"\ud83c\udfe2",lt:7.5,rent:68e3,sqft:1050,occ:70,night:420,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:11,scOld:16,dewa:5e3,ageNew:"2018+",ageMid:"2008-17",ageOld:"2006-07"},JVC:{emirate:"Dubai",cat:"Mid-Market",e:"\ud83c\udfd8\ufe0f",lt:8,rent:55e3,sqft:850,occ:78,night:350,opAppr:18,opDisc:15,opHand:22,secAppr:10,scNew:9,scOld:14,dewa:4500,ageNew:"2020+",ageMid:"2015-19",ageOld:"2010-14"},JVT:{emirate:"Dubai",cat:"Mid-Market",e:"\ud83d\udcd0",lt:7.8,rent:52e3,sqft:820,occ:72,night:330,opAppr:16,opDisc:14,opHand:22,secAppr:9,scNew:9,scOld:13,dewa:4400,ageNew:"2020+",ageMid:"2015-19",ageOld:"2010-14"},"Al Barsha":{emirate:"Dubai",cat:"Mid-Market",e:"\ud83c\udfec",lt:7,rent:65e3,sqft:1100,occ:68,night:400,opAppr:8,opDisc:6,opHand:24,secAppr:4,scNew:10,scOld:15,dewa:5e3,ageNew:"2018+",ageMid:"2008-17",ageOld:"2000-07"},Tecom:{emirate:"Dubai",cat:"Mid-Market",e:"\ud83d\udcbb",lt:7.3,rent:62e3,sqft:1e3,occ:68,night:400,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:10,scOld:15,dewa:4800,ageNew:"2018+",ageMid:"2005-17",ageOld:"2002-04"},"Sports City":{emirate:"Dubai",cat:"Value",e:"\u26bd",lt:8.5,rent:48e3,sqft:700,occ:72,night:320,opAppr:12,opDisc:12,opHand:20,secAppr:7,scNew:8,scOld:12,dewa:4200,ageNew:"2020+",ageMid:"2012-19",ageOld:"2008-11"},Arjan:{emirate:"Dubai",cat:"Value",e:"\ud83e\udd8b",lt:7.8,rent:5e4,sqft:800,occ:65,night:300,opAppr:18,opDisc:15,opHand:20,secAppr:10,scNew:8,scOld:12,dewa:4300,ageNew:"2020+",ageMid:"2016-19",ageOld:null},"Al Furjan":{emirate:"Dubai",cat:"Value",e:"\ud83c\udfe1",lt:7.3,rent:58e3,sqft:950,occ:62,night:350,opAppr:14,opDisc:12,opHand:22,secAppr:8,scNew:8,scOld:11,dewa:4800,ageNew:"2020+",ageMid:"2015-19",ageOld:"2012-14"},"Motor City":{emirate:"Dubai",cat:"Value",e:"\ud83c\udfce\ufe0f",lt:7.5,rent:52e3,sqft:850,occ:58,night:320,opAppr:10,opDisc:10,opHand:22,secAppr:6,scNew:9,scOld:13,dewa:4600,ageNew:"2018+",ageMid:"2008-17",ageOld:"2005-07"},Mudon:{emirate:"Dubai",cat:"Value",e:"\ud83c\udfe0",lt:7.2,rent:6e4,sqft:1e3,occ:55,night:380,opAppr:12,opDisc:10,opHand:24,secAppr:7,scNew:5,scOld:7,dewa:5e3,ageNew:"2020+",ageMid:"2015-19",ageOld:null},Mirdif:{emirate:"Dubai",cat:"Value",e:"\ud83c\udf3a",lt:6.8,rent:55e3,sqft:950,occ:55,night:350,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:7,scOld:10,dewa:5e3,ageNew:"2018+",ageMid:"2008-17",ageOld:"2000-07"},"Silicon Oasis":{emirate:"Dubai",cat:"Affordable",e:"\ud83d\udcbb",lt:9,rent:45e3,sqft:650,occ:68,night:280,opAppr:15,opDisc:12,opHand:22,secAppr:8,scNew:7,scOld:11,dewa:4e3,ageNew:"2020+",ageMid:"2012-19",ageOld:"2008-11"},"International City":{emirate:"Dubai",cat:"Affordable",e:"\ud83c\udf0d",lt:9.5,rent:35e3,sqft:480,occ:65,night:220,opAppr:8,opDisc:8,opHand:20,secAppr:5,scNew:5,scOld:8,dewa:3500,ageNew:"2018+",ageMid:"2008-17",ageOld:"2005-07"},"Discovery Gardens":{emirate:"Dubai",cat:"Affordable",e:"\ud83c\udf3b",lt:9.2,rent:38e3,sqft:520,occ:60,night:240,opAppr:5,opDisc:5,opHand:20,secAppr:3,scNew:6,scOld:10,dewa:3800,ageNew:"2015+",ageMid:"2008-14",ageOld:"2005-07"},DIP:{emirate:"Dubai",cat:"Affordable",e:"\ud83c\udfed",lt:9.8,rent:32e3,sqft:420,occ:55,night:200,opAppr:8,opDisc:8,opHand:22,secAppr:4,scNew:5,scOld:8,dewa:3200,ageNew:"2018+",ageMid:"2008-17",ageOld:"2005-07"},"Al Nahda Dubai":{emirate:"Dubai",cat:"Affordable",e:"\ud83c\udfe0",lt:8.5,rent:4e4,sqft:580,occ:62,night:250,opAppr:6,opDisc:6,opHand:22,secAppr:4,scNew:6,scOld:10,dewa:3600,ageNew:"2015+",ageMid:"2005-14",ageOld:"1998-04"},Deira:{emirate:"Dubai",cat:"Affordable",e:"\ud83d\udd4c",lt:8.2,rent:42e3,sqft:620,occ:65,night:280,opAppr:6,opDisc:5,opHand:24,secAppr:3,scNew:7,scOld:12,dewa:3800,ageNew:"2015+",ageMid:"2000-14",ageOld:"1990-99"},"Bur Dubai":{emirate:"Dubai",cat:"Affordable",e:"\ud83d\udef6",lt:7.8,rent:45e3,sqft:700,occ:70,night:320,opAppr:5,opDisc:5,opHand:24,secAppr:3,scNew:8,scOld:14,dewa:4e3,ageNew:"2015+",ageMid:"2000-14",ageOld:"1985-99"},"Jebel Ali":{emirate:"Dubai",cat:"Affordable",e:"\ud83d\udea2",lt:8.8,rent:38e3,sqft:550,occ:58,night:240,opAppr:10,opDisc:10,opHand:24,secAppr:6,scNew:6,scOld:10,dewa:3600,ageNew:"2018+",ageMid:"2008-17",ageOld:"2000-07"},"Dubai South":{emirate:"Dubai",cat:"Emerging",e:"\u2708\ufe0f",lt:8.5,rent:4e4,sqft:600,occ:55,night:250,opAppr:25,opDisc:20,opHand:28,secAppr:15,scNew:7,scOld:10,dewa:3800,ageNew:"2022+",ageMid:"2018-21",ageOld:null},"Expo City":{emirate:"Dubai",cat:"Emerging",e:"\ud83c\udfaa",lt:7.5,rent:55e3,sqft:900,occ:60,night:350,opAppr:30,opDisc:18,opHand:30,secAppr:18,scNew:10,scOld:14,dewa:4500,ageNew:"2022+",ageMid:null,ageOld:null},"Damac Hills":{emirate:"Dubai",cat:"Emerging",e:"\ud83c\udfcc\ufe0f",lt:7.8,rent:52e3,sqft:820,occ:62,night:320,opAppr:18,opDisc:15,opHand:24,secAppr:10,scNew:8,scOld:12,dewa:4300,ageNew:"2020+",ageMid:"2017-19",ageOld:null},"Damac Hills 2":{emirate:"Dubai",cat:"Emerging",e:"\ud83c\udfe1",lt:8.5,rent:42e3,sqft:620,occ:55,night:280,opAppr:20,opDisc:18,opHand:22,secAppr:12,scNew:6,scOld:9,dewa:4e3,ageNew:"2021+",ageMid:"2019-20",ageOld:null},"Town Square":{emirate:"Dubai",cat:"Emerging",e:"\ud83c\udfea",lt:8.2,rent:48e3,sqft:720,occ:58,night:290,opAppr:15,opDisc:12,opHand:22,secAppr:9,scNew:7,scOld:10,dewa:4100,ageNew:"2020+",ageMid:"2017-19",ageOld:null},"Tilal Al Ghaf":{emirate:"Dubai",cat:"Emerging",e:"\ud83c\udf34",lt:6.5,rent:85e3,sqft:1400,occ:50,night:500,opAppr:25,opDisc:15,opHand:30,secAppr:15,scNew:5,scOld:7,dewa:6e3,ageNew:"2022+",ageMid:null,ageOld:null},"The Valley":{emirate:"Dubai",cat:"Emerging",e:"\ud83c\udfde\ufe0f",lt:7,rent:55e3,sqft:900,occ:48,night:350,opAppr:28,opDisc:20,opHand:32,secAppr:15,scNew:6,scOld:8,dewa:4500,ageNew:"2024+",ageMid:null,ageOld:null},"Al Marjan Island":{emirate:"RAK",cat:"Premium",e:"\ud83c\udfdd\ufe0f",lt:7.5,rent:7e4,sqft:1200,occ:72,night:550,opAppr:25,opDisc:15,opHand:28,secAppr:15,scNew:14,scOld:18,dewa:4500,ageNew:"2022+",ageMid:"2018-21",ageOld:null},"Mina Al Arab":{emirate:"RAK",cat:"High-End",e:"\ud83c\udf0a",lt:7,rent:65e3,sqft:1e3,occ:68,night:480,opAppr:20,opDisc:12,opHand:26,secAppr:12,scNew:12,scOld:16,dewa:4200,ageNew:"2020+",ageMid:"2016-19",ageOld:null},"Al Hamra Village":{emirate:"RAK",cat:"Mid-Market",e:"\u26f3",lt:7.8,rent:55e3,sqft:850,occ:65,night:380,opAppr:15,opDisc:10,opHand:24,secAppr:10,scNew:10,scOld:14,dewa:3800,ageNew:"2018+",ageMid:"2008-17",ageOld:"2005-07"},"Yasmin Village RAK":{emirate:"RAK",cat:"Affordable",e:"\ud83c\udf38",lt:11,rent:35e3,sqft:450,occ:70,night:250,opAppr:10,opDisc:8,opHand:20,secAppr:6,scNew:6,scOld:9,dewa:3e3,ageNew:"2015+",ageMid:"2008-14",ageOld:"2005-07"},"Hayat Island":{emirate:"RAK",cat:"Emerging",e:"\ud83c\udfd6\ufe0f",lt:7.2,rent:6e4,sqft:950,occ:62,night:420,opAppr:22,opDisc:15,opHand:28,secAppr:14,scNew:11,scOld:15,dewa:4e3,ageNew:"2023+",ageMid:null,ageOld:null},"Saadiyat Island":{emirate:"Abu Dhabi",cat:"Ultra Premium",e:"\ud83c\udfdb\ufe0f",lt:5,rent:18e4,sqft:2800,occ:60,night:1100,opAppr:12,opDisc:8,opHand:30,secAppr:7,scNew:20,scOld:28,dewa:8e3,ageNew:"2020+",ageMid:"2015-19",ageOld:null},"Yas Island":{emirate:"Abu Dhabi",cat:"Premium",e:"\ud83c\udfa2",lt:6,rent:95e3,sqft:1500,occ:70,night:650,opAppr:15,opDisc:10,opHand:28,secAppr:8,scNew:14,scOld:18,dewa:5500,ageNew:"2020+",ageMid:"2012-19",ageOld:null},"Al Reem Island":{emirate:"Abu Dhabi",cat:"High-End",e:"\ud83c\udf06",lt:7,rent:75e3,sqft:1200,occ:72,night:500,opAppr:12,opDisc:10,opHand:26,secAppr:7,scNew:12,scOld:16,dewa:5e3,ageNew:"2018+",ageMid:"2010-17",ageOld:"2008-09"},"Al Raha Beach":{emirate:"Abu Dhabi",cat:"High-End",e:"\ud83c\udfd6\ufe0f",lt:6.5,rent:85e3,sqft:1350,occ:65,night:550,opAppr:10,opDisc:8,opHand:26,secAppr:6,scNew:13,scOld:17,dewa:5200,ageNew:"2018+",ageMid:"2008-17",ageOld:null},"Khalifa City":{emirate:"Abu Dhabi",cat:"Mid-Market",e:"\ud83c\udfd8\ufe0f",lt:7.5,rent:55e3,sqft:850,occ:68,night:380,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:8,scOld:12,dewa:4200,ageNew:"2018+",ageMid:"2008-17",ageOld:"2000-07"},"Masdar City":{emirate:"Abu Dhabi",cat:"Emerging",e:"\ud83c\udf31",lt:7.8,rent:58e3,sqft:900,occ:65,night:400,opAppr:18,opDisc:15,opHand:28,secAppr:10,scNew:10,scOld:14,dewa:4500,ageNew:"2020+",ageMid:"2015-19",ageOld:null},"Al Mamzar SHJ":{emirate:"Sharjah",cat:"Mid-Market",e:"\ud83c\udfd6\ufe0f",lt:8,rent:42e3,sqft:650,occ:65,night:300,opAppr:8,opDisc:6,opHand:24,secAppr:5,scNew:6,scOld:10,dewa:3500,ageNew:"2015+",ageMid:"2005-14",ageOld:"1995-04"},"Al Nahda SHJ":{emirate:"Sharjah",cat:"Affordable",e:"\ud83c\udfe2",lt:9,rent:35e3,sqft:500,occ:75,night:250,opAppr:5,opDisc:5,opHand:22,secAppr:3,scNew:5,scOld:8,dewa:3e3,ageNew:"2015+",ageMid:"2000-14",ageOld:"1990-99"},Aljada:{emirate:"Sharjah",cat:"Emerging",e:"\ud83c\udfd7\ufe0f",lt:7.8,rent:52e3,sqft:800,occ:60,night:350,opAppr:18,opDisc:15,opHand:26,secAppr:10,scNew:9,scOld:12,dewa:4e3,ageNew:"2022+",ageMid:null,ageOld:null},"Ajman Downtown":{emirate:"Ajman",cat:"Affordable",e:"\ud83c\udfd9\ufe0f",lt:10.5,rent:28e3,sqft:380,occ:70,night:200,opAppr:8,opDisc:8,opHand:20,secAppr:5,scNew:4,scOld:7,dewa:2500,ageNew:"2018+",ageMid:"2008-17",ageOld:"2000-07"},"Ajman Corniche":{emirate:"Ajman",cat:"Mid-Market",e:"\ud83c\udf05",lt:9,rent:35e3,sqft:500,occ:65,night:250,opAppr:10,opDisc:8,opHand:22,secAppr:6,scNew:5,scOld:9,dewa:3e3,ageNew:"2018+",ageMid:"2008-17",ageOld:"2000-07"},"UAQ Marina":{emirate:"UAQ",cat:"Affordable",e:"\u26f5",lt:9.5,rent:3e4,sqft:420,occ:55,night:220,opAppr:12,opDisc:10,opHand:24,secAppr:7,scNew:5,scOld:8,dewa:2800,ageNew:"2020+",ageMid:"2015-19",ageOld:null}},xs={rent:[.55,1,1.55,2.1,2.8],night:[.65,1,1.45,1.9,2.5],dewa:[.6,1,1.4,1.8,2.3]},vs={new:{sc:1,maint:0,rent:1.05,appr:1.2},mid:{sc:1.2,maint:5e3,rent:1,appr:1},old:{sc:1.5,maint:12e3,rent:.92,appr:.7}};function bs(){const[e,t]=(0,a.useState)("all"),[n,r]=(0,a.useState)("Business Bay"),[s,i]=(0,a.useState)(12e5),[o,l]=(0,a.useState)(850),[d,u]=(0,a.useState)(1),[h,p]=(0,a.useState)("offplan"),[m,f]=(0,a.useState)("new"),[g,x]=(0,a.useState)("overview"),v=gs[n],b=vs[m],y="offplan"===h?v.scNew:"old"===m?v.scOld:v.scNew,w=y*o*b.sc+v.dewa*xs.dewa[d]+1e3+b.maint,j=v.rent*xs.rent[d]*b.rent,N=j-w,k=(N/s*100).toFixed(1),_=v.night*xs.night[d]*365*v.occ/100,S=_-w-2500-.28*_,C=(S/s*100).toFixed(1),z=("offplan"===h?v.opAppr:v.secAppr)*b.appr,E="offplan"===h?v.opDisc:0,A=s*(1-E/100),T=A*(1+z/100),O=T-A,P=e=>new Intl.NumberFormat("it-IT").format(Math.round(e)),D={};Object.entries(gs).forEach(e=>{let[t,n]=e;const a=n.emirate;D[a]||(D[a]={}),D[a][n.cat]||(D[a][n.cat]=[]),D[a][n.cat].push(c({name:t},n))});const R="all"===e?D:{[e]:D[e]};return(0,tr.jsxs)("div",{className:"space-y-4",children:[(0,tr.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[(0,tr.jsx)("button",{onClick:()=>t("all"),className:"py-1.5 px-4 rounded-full text-sm font-medium whitespace-nowrap transition-all ".concat("all"===e?"bg-emerald-500 text-white":"bg-[#334155] text-zinc-400 hover:bg-[#475569]"),children:"\ud83c\udde6\ud83c\uddea Tutti"}),["Dubai","Abu Dhabi","RAK","Sharjah","Ajman","UAQ"].map(n=>(0,tr.jsxs)("button",{onClick:()=>t(n),className:"py-1.5 px-4 rounded-full text-sm font-medium whitespace-nowrap transition-all ".concat(e===n?"bg-emerald-500 text-white":"bg-[#334155] text-zinc-400 hover:bg-[#475569]"),children:["RAK"===n?"\ud83c\udfdd\ufe0f":"Dubai"===n?"\ud83c\udf06":"Abu Dhabi"===n?"\ud83c\udfdb\ufe0f":"Sharjah"===n?"\ud83d\udcda":"Ajman"===n?"\ud83c\udfe0":"\u26f5"," ",n]},n))]}),(0,tr.jsxs)("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-[#334155]",children:[(0,tr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[(0,tr.jsxs)("div",{className:"col-span-2",children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs block mb-1",children:"Zona"}),(0,tr.jsx)("select",{value:n,onChange:e=>r(e.target.value),className:"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white",children:Object.entries(R).map(e=>{let[t,n]=e;return(0,tr.jsx)("optgroup",{label:"\u2501\u2501 ".concat(t," \u2501\u2501"),children:Object.entries(n||{}).map(e=>{let[t,n]=e;return(0,tr.jsxs)(a.Fragment,{children:[(0,tr.jsxs)("option",{disabled:!0,className:"text-zinc-500",children:["\u2500\u2500 ",t," \u2500\u2500"]}),(n||[]).map(e=>(0,tr.jsxs)("option",{value:e.name,children:[e.e," ",e.name]},e.name))]},t)})},t)})})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs block mb-1",children:"Prezzo (AED)"}),(0,tr.jsx)("input",{type:"number",value:s,onChange:e=>i(+e.target.value),className:"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs block mb-1",children:"Sqft"}),(0,tr.jsx)("input",{type:"number",value:o,onChange:e=>l(+e.target.value),className:"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white"})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs block mb-1",children:"Camere"}),(0,tr.jsx)("select",{value:d,onChange:e=>u(+e.target.value),className:"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white",children:["Studio","1BR","2BR","3BR","4+BR"].map((e,t)=>(0,tr.jsx)("option",{value:t,children:e},t))})]}),(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs block mb-1",children:"Mercato"}),(0,tr.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white",children:[(0,tr.jsx)("option",{value:"offplan",children:"\ud83c\udfd7\ufe0f Off-Plan"}),(0,tr.jsx)("option",{value:"secondary",children:"\ud83c\udfe2 Secondary"})]})]})]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3 mt-3",children:["secondary"===h&&(0,tr.jsxs)("div",{children:[(0,tr.jsx)("label",{className:"text-zinc-500 text-xs block mb-1",children:"Et\xe0 Edificio"}),(0,tr.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white",children:[(0,tr.jsxs)("option",{value:"new",children:["\ud83c\udd95 ",v.ageNew]}),v.ageMid&&(0,tr.jsxs)("option",{value:"mid",children:["\ud83d\udcc5 ",v.ageMid]}),v.ageOld&&(0,tr.jsxs)("option",{value:"old",children:["\ud83c\udfda\ufe0f ",v.ageOld]})]})]}),(0,tr.jsxs)("div",{className:"bg-[#334155]/50 rounded-lg p-2",children:[(0,tr.jsxs)("p",{className:"text-zinc-500 text-xs",children:[v.emirate," \u2022 ",v.cat]}),(0,tr.jsxs)("p",{className:"text-white font-medium text-sm",children:[v.e," ",n]})]}),(0,tr.jsxs)("div",{className:"bg-amber-500/10 rounded-lg p-2 text-center border border-amber-500/20",children:[(0,tr.jsx)("p",{className:"text-amber-400 text-xs",children:"SC/sqft"}),(0,tr.jsxs)("p",{className:"text-white font-bold",children:[y," AED"]})]}),"offplan"===h?(0,tr.jsxs)(tr.Fragment,{children:[(0,tr.jsxs)("div",{className:"bg-emerald-500/10 rounded-lg p-2 text-center border border-emerald-500/20",children:[(0,tr.jsx)("p",{className:"text-emerald-400 text-xs",children:"Discount"}),(0,tr.jsxs)("p",{className:"text-white font-bold",children:["-",E,"%"]})]}),(0,tr.jsxs)("div",{className:"bg-purple-500/10 rounded-lg p-2 text-center border border-purple-500/20",children:[(0,tr.jsx)("p",{className:"text-purple-400 text-xs",children:"Apprezzamento"}),(0,tr.jsxs)("p",{className:"text-white font-bold",children:["+",v.opAppr,"%"]})]})]}):(0,tr.jsxs)("div",{className:"bg-red-500/10 rounded-lg p-2 text-center border border-red-500/20",children:[(0,tr.jsx)("p",{className:"text-red-400 text-xs",children:"Manutenzione"}),(0,tr.jsxs)("p",{className:"text-white font-bold",children:[P(b.maint),"/y"]})]})]})]}),(0,tr.jsx)("div",{className:"flex gap-2 overflow-x-auto",children:["overview","rental","capital","costs"].map(e=>(0,tr.jsx)("button",{onClick:()=>x(e),className:"py-2 px-4 rounded-lg text-sm font-medium transition-all ".concat(g===e?"bg-emerald-500 text-white":"bg-[#334155] text-zinc-400 hover:bg-[#475569]"),children:"overview"===e?"\ud83d\udcca Overview":"rental"===e?"\ud83c\udfe0 Rental":"capital"===e?"\ud83d\udcc8 Capital":"\ud83d\udcb0 Costi"},e))}),"overview"===g&&(0,tr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,tr.jsxs)("div",{className:"bg-blue-500/10 rounded-xl p-4 text-center border border-blue-500/20",children:[(0,tr.jsxs)("p",{className:"text-3xl font-bold text-blue-400",children:[k,"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Yield LT Netto"})]}),(0,tr.jsxs)("div",{className:"bg-purple-500/10 rounded-xl p-4 text-center border border-purple-500/20",children:[(0,tr.jsxs)("p",{className:"text-3xl font-bold text-purple-400",children:[C,"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Yield ST Netto"})]}),(0,tr.jsxs)("div",{className:"bg-emerald-500/10 rounded-xl p-4 text-center border border-emerald-500/20",children:[(0,tr.jsxs)("p",{className:"text-3xl font-bold text-emerald-400",children:["+",z.toFixed(0),"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Apprezzamento"})]}),(0,tr.jsxs)("div",{className:"bg-amber-500/10 rounded-xl p-4 text-center border border-amber-500/20",children:[(0,tr.jsx)("p",{className:"text-3xl font-bold text-amber-400",children:P(w)}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500 mt-1",children:"Costi/Anno"})]}),(0,tr.jsxs)("div",{className:"col-span-2 bg-[#1e293b] rounded-xl p-4 border border-[#334155]",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-xs mb-3",children:"Revenue Annuo Netto"}),(0,tr.jsxs)("div",{className:"space-y-2",children:[(0,tr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"\ud83c\udfe0 Long Term"}),(0,tr.jsxs)("span",{className:"text-blue-400 font-bold text-lg",children:[P(N)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"\ud83c\udfd6\ufe0f Short Term"}),(0,tr.jsxs)("span",{className:"text-purple-400 font-bold text-lg",children:[P(S)," AED"]})]})]})]}),(0,tr.jsxs)("div",{className:"col-span-2 bg-[#1e293b] rounded-xl p-4 border border-[#334155]",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-xs mb-3",children:"Capital Gain"}),(0,tr.jsxs)("div",{className:"space-y-2",children:[(0,tr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Valore Futuro"}),(0,tr.jsxs)("span",{className:"text-emerald-400 font-bold text-lg",children:[P(T)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between items-center",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Profitto"}),(0,tr.jsxs)("span",{className:"text-emerald-400 font-bold text-lg",children:["+",P(O)," AED"]})]})]})]}),(0,tr.jsxs)("div",{className:"col-span-full bg-[#1e293b] rounded-xl p-4 border border-[#334155]",children:[(0,tr.jsx)("p",{className:"text-zinc-400 text-xs mb-3",children:"ROI Totale 3 anni (rent + appreciation)"}),(0,tr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,tr.jsx)("div",{className:"flex-1 bg-[#334155] rounded-full h-4 overflow-hidden",children:(0,tr.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-emerald-500 transition-all",style:{width:"".concat(Math.min((3*N+O)/s*100,100),"%")}})}),(0,tr.jsxs)("span",{className:"text-white font-bold text-xl",children:[((3*N+O)/s*100).toFixed(0),"%"]})]})]})]}),"rental"===g&&(0,tr.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,tr.jsxs)("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-blue-500/30",children:[(0,tr.jsx)("h3",{className:"font-semibold text-white mb-4",children:"\ud83c\udfe0 Long Term Rental"}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,tr.jsxs)("div",{className:"bg-blue-500/10 rounded-lg p-3 text-center",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-blue-400",children:[(j/s*100).toFixed(1),"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Yield Lordo"})]}),(0,tr.jsxs)("div",{className:"bg-emerald-500/10 rounded-lg p-3 text-center",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-emerald-400",children:[k,"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Yield Netto"})]})]}),(0,tr.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Affitto Annuo"}),(0,tr.jsxs)("span",{className:"text-white",children:[P(j)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Mensile"}),(0,tr.jsxs)("span",{className:"text-white",children:[P(j/12)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"(-) Costi Annui"}),(0,tr.jsxs)("span",{className:"text-red-400",children:["-",P(w)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 font-medium",children:[(0,tr.jsx)("span",{className:"text-white",children:"= Netto Annuo"}),(0,tr.jsxs)("span",{className:"text-emerald-400",children:[P(N)," AED"]})]})]})]}),(0,tr.jsxs)("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-purple-500/30",children:[(0,tr.jsx)("h3",{className:"font-semibold text-white mb-4",children:"\ud83c\udfd6\ufe0f Short Term / Airbnb"}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,tr.jsxs)("div",{className:"bg-purple-500/10 rounded-lg p-3 text-center",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-purple-400",children:[(_/s*100).toFixed(1),"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Yield Lordo"})]}),(0,tr.jsxs)("div",{className:"bg-emerald-500/10 rounded-lg p-3 text-center",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-emerald-400",children:[C,"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Yield Netto"})]})]}),(0,tr.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Tariffa/Notte"}),(0,tr.jsxs)("span",{className:"text-white",children:[P(v.night*xs.night[d])," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Occupancy Media"}),(0,tr.jsxs)("span",{className:"text-white",children:[v.occ,"%"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Revenue Lordo"}),(0,tr.jsxs)("span",{className:"text-white",children:[P(_)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 font-medium",children:[(0,tr.jsx)("span",{className:"text-white",children:"= Netto Annuo"}),(0,tr.jsxs)("span",{className:"text-emerald-400",children:[P(S)," AED"]})]})]})]})]}),"capital"===g&&(0,tr.jsxs)("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-emerald-500/30",children:[(0,tr.jsxs)("h3",{className:"font-semibold text-white mb-4",children:["\ud83d\udcc8 Capital Appreciation - ","offplan"===h?"Off-Plan":"Secondary"]}),(0,tr.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[(0,tr.jsxs)("div",{className:"bg-emerald-500/10 rounded-lg p-3 text-center",children:[(0,tr.jsxs)("p",{className:"text-2xl font-bold text-emerald-400",children:["+",z.toFixed(0),"%"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Apprezzamento"})]}),(0,tr.jsxs)("div",{className:"bg-[#334155] rounded-lg p-3 text-center",children:[(0,tr.jsx)("p",{className:"text-xl font-bold text-white",children:P(O)}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Profitto (AED)"})]}),(0,tr.jsxs)("div",{className:"bg-[#334155] rounded-lg p-3 text-center",children:[(0,tr.jsx)("p",{className:"text-xl font-bold text-white",children:P(T)}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Valore Futuro"})]}),"offplan"===h&&(0,tr.jsxs)("div",{className:"bg-orange-500/10 rounded-lg p-3 text-center",children:[(0,tr.jsxs)("p",{className:"text-xl font-bold text-orange-400",children:[v.opHand,"m"]}),(0,tr.jsx)("p",{className:"text-xs text-zinc-500",children:"Handover"})]})]}),(0,tr.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Prezzo Acquisto"}),(0,tr.jsxs)("span",{className:"text-white",children:[P(s)," AED"]})]}),"offplan"===h&&(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsxs)("span",{className:"text-zinc-400",children:["(-) Launch Discount ",E,"%"]}),(0,tr.jsxs)("span",{className:"text-emerald-400",children:["-",P(s-A)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Prezzo Effettivo"}),(0,tr.jsxs)("span",{className:"text-white",children:[P(A)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 border-b border-[#334155]",children:[(0,tr.jsxs)("span",{className:"text-zinc-400",children:["(+) Apprezzamento ",z.toFixed(0),"%"]}),(0,tr.jsxs)("span",{className:"text-emerald-400",children:["+",P(O)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 font-medium text-lg",children:[(0,tr.jsx)("span",{className:"text-white",children:"= Valore Futuro"}),(0,tr.jsxs)("span",{className:"text-emerald-400",children:[P(T)," AED"]})]})]})]}),"costs"===g&&(0,tr.jsxs)("div",{className:"bg-[#1e293b] rounded-xl p-4 border border-red-500/30",children:[(0,tr.jsx)("h3",{className:"font-semibold text-white mb-4",children:"\ud83d\udcb0 Breakdown Costi Annuali"}),(0,tr.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,tr.jsxs)("div",{className:"flex justify-between py-3 border-b border-[#334155]",children:[(0,tr.jsxs)("span",{className:"text-zinc-400",children:["Service Charge (",y," \xd7 ",o," sqft)"]}),(0,tr.jsxs)("span",{className:"text-amber-400 font-bold",children:[P(y*o*b.sc)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-3 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"DEWA (Utilities)"}),(0,tr.jsxs)("span",{className:"text-blue-400 font-bold",children:[P(v.dewa*xs.dewa[d])," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-3 border-b border-[#334155]",children:[(0,tr.jsx)("span",{className:"text-zinc-400",children:"Assicurazione"}),(0,tr.jsx)("span",{className:"text-green-400 font-bold",children:"~1,000 AED"})]}),b.maint>0&&(0,tr.jsxs)("div",{className:"flex justify-between py-3 border-b border-[#334155]",children:[(0,tr.jsxs)("span",{className:"text-zinc-400",children:["Manutenzione (edificio ",m,")"]}),(0,tr.jsxs)("span",{className:"text-red-400 font-bold",children:[P(b.maint)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-3 font-bold text-lg",children:[(0,tr.jsx)("span",{className:"text-white",children:"TOTALE ANNUO"}),(0,tr.jsxs)("span",{className:"text-red-400",children:[P(w)," AED"]})]}),(0,tr.jsxs)("div",{className:"flex justify-between py-2 text-zinc-500",children:[(0,tr.jsx)("span",{children:"Mensile"}),(0,tr.jsxs)("span",{children:[P(w/12)," AED/mese"]})]})]}),(0,tr.jsx)("div",{className:"mt-4 p-3 bg-amber-500/10 rounded-lg border border-amber-500/20",children:(0,tr.jsxs)("p",{className:"text-amber-400 text-xs",children:["\ud83d\udccc Service Charge ",n,": ",y," AED/sqft \u2022 ",y>20?"Premium (alto)":y>12?"Nella media":"Budget (basso)"]})})]}),(0,tr.jsx)("p",{className:"text-zinc-600 text-xs text-center",children:"\u26a0\ufe0f Stime basate su dati 2024-2025 (RERA, Bayut, DLD). Consulta un professionista prima di investire."})]})}const ys=document.createElement("style");ys.textContent="\n  @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }\n  @keyframes slideRight { from { transform: translateX(-100%); } to { transform: translateX(0); } }\n  @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }\n  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\n  .animate-slideUp { animation: slideUp 0.3s ease-out; }\n  .animate-slideRight { animation: slideRight 0.3s ease-out; }\n  .animate-scaleIn { animation: scaleIn 0.2s ease-out; }\n  .animate-fadeIn { animation: fadeIn 0.2s ease-out; }\n  * { -webkit-tap-highlight-color: transparent; }\n  input, select, textarea { font-size: 16px !important; }\n  .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }\n  .scrollbar-hide::-webkit-scrollbar { display: none; }\n","undefined"!==typeof document&&document.head.appendChild(ys);r.createRoot(document.getElementById("root")).render((0,tr.jsx)(a.StrictMode,{children:(0,tr.jsx)(Hr,{})}))})();
//# sourceMappingURL=main.41ac610d.js.map