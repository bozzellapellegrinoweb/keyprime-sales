{"ast":null,"code":"import _objectSpread from\"/home/claude/keyprime-sales/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/home/claude/keyprime-sales/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"label\"],_excluded2=[\"label\",\"children\"],_excluded3=[\"children\",\"variant\",\"size\",\"icon\",\"className\"];/* eslint-disable */import React,{useState,useEffect,useRef}from'react';import{createClient}from'@supabase/supabase-js';import{Download,Trash2,Check,RefreshCw,AlertCircle,LogOut,Eye,EyeOff,Copy,UserPlus,Search,Phone,Mail,X,Edit2,TrendingUp,DollarSign,Target,Users,Menu,Key,Bell,MapPin,Award,User,MessageCircle,ChevronLeft,ChevronRight,Clock,FileText,Plus,Send,LayoutDashboard,PieChart,ListTodo,Settings,Building2,ArrowUpRight,ArrowDownRight,Sparkles,Command,Printer,Map,List,ExternalLink,Calculator}from'lucide-react';import{Capacitor}from'@capacitor/core';import{StatusBar,Style}from'@capacitor/status-bar';import{Keyboard}from'@capacitor/keyboard';import{Haptics,ImpactStyle}from'@capacitor/haptics';// Initialize native plugins\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const initNativePlugins=async()=>{if(Capacitor.isNativePlatform()){try{// Status bar dark with app background\nawait StatusBar.setStyle({style:Style.Dark});await StatusBar.setBackgroundColor({color:'#0f172a'});// Keyboard listeners for better UX\nKeyboard.addListener('keyboardWillShow',()=>{document.body.classList.add('keyboard-open');});Keyboard.addListener('keyboardWillHide',()=>{document.body.classList.remove('keyboard-open');});}catch(e){console.log('Native plugin init error:',e);}}};// Haptic feedback helper\nconst hapticFeedback=async function(){let style=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'light';if(Capacitor.isNativePlatform()){try{await Haptics.impact({style:style==='heavy'?ImpactStyle.Heavy:ImpactStyle.Light});}catch(e){}}};initNativePlugins();const supabase=createClient('https://wqtylxrrerhbxagdzftn.supabase.co','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndxdHlseHJyZXJoYnhhZ2R6ZnRuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2NjkyNjAsImV4cCI6MjA4NzI0NTI2MH0.oXUs9ITNi6lEFat_5FH0x-Exw5MDgRhwx6T0yL3xiWQ');// Send Push Notification - disabled (OneSignal API requires paid plan)\nconst sendPushNotification=async function(title,message){let url=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;// Push notifications disabled - using email notifications instead\nconsole.log('Push disabled:',title,message);};// Config\nconst ADMIN_EMAIL='bozzellapellegrino@gmail.com';// Leaflet Config (no token needed - free!)\nconst LEAFLET_TILE_URL='https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png';const LEAFLET_ATTRIBUTION='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> &copy; <a href=\"https://carto.com/attributions\">CARTO</a>';// Dubai Areas with coordinates for map\nconst DUBAI_AREAS_COORDS={'Dubai Marina':{lat:25.0805,lng:55.1403,zoom:14},'Palm Jumeirah':{lat:25.1124,lng:55.1390,zoom:13},'Downtown Dubai':{lat:25.1972,lng:55.2744,zoom:14},'Business Bay':{lat:25.1851,lng:55.2628,zoom:14},'JBR':{lat:25.0780,lng:55.1340,zoom:15},'Dubai Hills Estate':{lat:25.1026,lng:55.2427,zoom:13},'Dubai Hills':{lat:25.1026,lng:55.2427,zoom:13},'Mohammed Bin Rashid City':{lat:25.1695,lng:55.3147,zoom:13},'MBR City':{lat:25.1695,lng:55.3147,zoom:13},'Dubai Creek Harbour':{lat:25.2048,lng:55.3461,zoom:14},'Dubai Creek':{lat:25.2048,lng:55.3461,zoom:14},'Jumeirah Village Circle':{lat:25.0655,lng:55.2094,zoom:14},'JVC':{lat:25.0655,lng:55.2094,zoom:14},'JLT':{lat:25.0750,lng:55.1550,zoom:14},'Dubai South':{lat:24.8966,lng:55.1581,zoom:12},'DAMAC Hills':{lat:25.0285,lng:55.2430,zoom:13},'DAMAC Hills 2':{lat:25.0050,lng:55.2750,zoom:13},'Arabian Ranches':{lat:25.0597,lng:55.2671,zoom:13},'Meydan':{lat:25.1606,lng:55.2958,zoom:13},'DIFC':{lat:25.2104,lng:55.2796,zoom:15},'Al Marjan Island':{lat:25.7955,lng:55.7283,zoom:13},'Dubai Islands':{lat:25.2750,lng:55.3150,zoom:12},'Expo City':{lat:24.9600,lng:55.1580,zoom:13},'Yas Island':{lat:24.4957,lng:54.6030,zoom:13},'Saadiyat Island':{lat:24.5465,lng:54.4330,zoom:13},'Al Reem Island':{lat:24.4950,lng:54.4050,zoom:13},'Sobha Hartland':{lat:25.1850,lng:55.3250,zoom:14},'Tilal Al Ghaf':{lat:25.0350,lng:55.2100,zoom:13},'Emaar Beachfront':{lat:25.0850,lng:55.1350,zoom:14},'Bluewaters Island':{lat:25.0800,lng:55.1200,zoom:14},'City Walk':{lat:25.2050,lng:55.2600,zoom:14},'Abu Dhabi':{lat:24.4539,lng:54.3773,zoom:11},'Sharjah':{lat:25.3463,lng:55.4209,zoom:11},'Ajman':{lat:25.4052,lng:55.5136,zoom:11},'Ras Al Khaimah':{lat:25.7895,lng:55.9432,zoom:11}};const DUBAI_CENTER={lat:25.1972,lng:55.2744};const DEFAULT_ZOOM=10;// Get coordinates for location name\nconst getLocationCoords=locationName=>{if(!locationName)return null;const locLower=locationName.toLowerCase();for(const[area,coords]of Object.entries(DUBAI_AREAS_COORDS)){if(locLower.includes(area.toLowerCase()))return coords;}for(const[area,coords]of Object.entries(DUBAI_AREAS_COORDS)){const areaWords=area.toLowerCase().split(' ');if(areaWords.some(word=>word.length>3&&locLower.includes(word)))return coords;}return null;};// Data\nconst zones=['Palm Jumeirah','Dubai Marina','Downtown','Dubai Creek','JBR','Business Bay','JLT','DIFC','MBR City','Dubai Hills','Altro'];const developers=['Emaar','Damac','Sobha','Meraas','Nakheel','Dubai Properties','Azizi','Danube','Binghatti','Altro'];const commissions=[2,4,5,6];const pipelineStati=['lead','trattativa','EOI','venduto','incassato'];const pipelineLabels={'lead':'Lead','trattativa':'Trattativa','EOI':'EOI','venduto':'Venduto (SPA)','incassato':'Incassato'};const clienteStati=['nuovo','contattato','interessato','trattativa','acquistato','perso'];const taskPriorita=['bassa','normale','alta','urgente'];// Theme Colors - Section Based\nconst theme={bg:{primary:'#0f172a',secondary:'#1e293b',tertiary:'#1e293b',elevated:'#1F1F23'},border:{subtle:'#334155',default:'#3F3F46',strong:'#52525B'},text:{primary:'#FAFAFA',secondary:'#A1A1AA',tertiary:'#71717A',muted:'#52525B'},sections:{dashboard:{accent:'#A78BFA',bg:'rgba(167,139,250,0.08)',border:'rgba(167,139,250,0.2)'},vendite:{accent:'#34D399',bg:'rgba(52,211,153,0.08)',border:'rgba(52,211,153,0.2)'},pipeline:{accent:'#60A5FA',bg:'rgba(96,165,250,0.08)',border:'rgba(96,165,250,0.2)'},crm:{accent:'#FBBF24',bg:'rgba(251,191,36,0.08)',border:'rgba(251,191,36,0.2)'},tasks:{accent:'#F472B6',bg:'rgba(244,114,182,0.08)',border:'rgba(244,114,182,0.2)'},utenti:{accent:'#22D3EE',bg:'rgba(34,211,238,0.08)',border:'rgba(34,211,238,0.2)'},offplan:{accent:'#F97316',bg:'rgba(249,115,22,0.08)',border:'rgba(249,115,22,0.2)'},calculator:{accent:'#10B981',bg:'rgba(16,185,129,0.08)',border:'rgba(16,185,129,0.2)'}},status:{lead:{color:'#71717A',bg:'rgba(113,113,122,0.15)'},trattativa:{color:'#60A5FA',bg:'rgba(96,165,250,0.15)'},EOI:{color:'#FBBF24',bg:'rgba(251,191,36,0.15)'},prenotato:{color:'#FBBF24',bg:'rgba(251,191,36,0.15)'},// legacy\nvenduto:{color:'#34D399',bg:'rgba(52,211,153,0.15)'},incassato:{color:'#22C55E',bg:'rgba(34,197,94,0.15)'}},priority:{bassa:{color:'#71717A',bg:'rgba(113,113,122,0.15)'},normale:{color:'#60A5FA',bg:'rgba(96,165,250,0.15)'},alta:{color:'#FBBF24',bg:'rgba(251,191,36,0.15)'},urgente:{color:'#EF4444',bg:'rgba(239,68,68,0.15)'}}};// Utilities\nconst fmt=n=>(n||0).toLocaleString('en-AE',{minimumFractionDigits:0,maximumFractionDigits:0});const fmtDate=d=>d?new Date(d).toLocaleDateString('it-IT',{day:'2-digit',month:'short',year:'numeric'}):'-';const fmtDateTime=d=>d?new Date(d).toLocaleString('it-IT',{day:'2-digit',month:'short',hour:'2-digit',minute:'2-digit'}):'-';const fmtShort=d=>d?new Date(d).toLocaleDateString('it-IT',{day:'2-digit',month:'short'}):'-';const getWhatsAppLink=function(phone){let msg=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';return\"https://wa.me/\".concat((phone||'').replace(/\\D/g,'')).concat(msg?\"?text=\".concat(encodeURIComponent(msg)):'');};const getBaseUrl=()=>typeof window!=='undefined'?window.location.origin:'';const isOverdue=d=>d&&new Date(d)<new Date();const isToday=d=>d&&new Date(d).toDateString()===new Date().toDateString();const getInitials=(nome,cognome)=>\"\".concat((nome||'')[0]||'').concat((cognome||'')[0]||'').toUpperCase()||'?';// Email Functions - via serverless to avoid CORS\nconst sendEmail=async(to,subject,html)=>{try{const response=await fetch('/api/send-email',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({to,subject,html})});const data=await response.json();return data.success||false;}catch(e){console.log('Email error:',e);return false;}};const notifyTaskCompleted=async(task,agentName)=>{await sendEmail(ADMIN_EMAIL,\"\\u2705 Task completato: \".concat(task.titolo),\"<div style=\\\"font-family:-apple-system,sans-serif;padding:20px\\\"><h2>Task Completato</h2><p><strong>\".concat(task.titolo,\"</strong></p><p>Completato da: \").concat(agentName,\"</p></div>\"));};const notifyTaskNote=async(task,agentName,note)=>{await sendEmail(ADMIN_EMAIL,\"\\uD83D\\uDCAC Nota: \".concat(task.titolo),\"<div style=\\\"font-family:-apple-system,sans-serif;padding:20px\\\"><h2>Nuova Nota</h2><p><strong>\".concat(task.titolo,\"</strong></p><p>Da: \").concat(agentName,\"</p><p>Nota: \").concat(note,\"</p></div>\"));};const notifyNewTaskToAgent=async(task,agentEmail)=>{if(!agentEmail)return;await sendEmail(agentEmail,\"\\uD83D\\uDCCB Nuovo Task: \".concat(task.titolo),\"<div style=\\\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\\\"><h2 style=\\\"color:#a78bfa\\\">\\uD83D\\uDCCB Nuovo Task Assegnato</h2><p style=\\\"font-size:18px;margin:16px 0\\\"><strong>\".concat(task.titolo,\"</strong></p><p style=\\\"color:#94a3b8\\\">Priorit\\xE0: \").concat(task.priorita||'normale',\"</p><p style=\\\"color:#94a3b8\\\">Scadenza: \").concat(task.scadenza?new Date(task.scadenza).toLocaleDateString('it-IT'):'Nessuna',\"</p>\").concat(task.descrizione?\"<p style=\\\"margin-top:16px;padding:12px;background:#1e293b;border-radius:8px\\\">\".concat(task.descrizione,\"</p>\"):'',\"<a href=\\\"https://keyprime-sales-1npw.vercel.app\\\" style=\\\"display:inline-block;margin-top:20px;padding:12px 24px;background:#8b5cf6;color:white;text-decoration:none;border-radius:8px\\\">Apri KeyPrime</a></div>\"));};const notifyNewSaleToAdmin=async(sale,agentName)=>{await sendEmail(ADMIN_EMAIL,\"\\uD83C\\uDF89 Nuova Vendita: \".concat(sale.progetto),\"<div style=\\\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\\\"><h2 style=\\\"color:#10b981\\\">\\uD83C\\uDF89 Nuova Vendita Chiusa!</h2><p style=\\\"font-size:24px;margin:16px 0\\\"><strong>\".concat(sale.progetto,\"</strong></p><p style=\\\"font-size:20px;color:#10b981\\\">\").concat(sale.valore?sale.valore.toLocaleString():0,\" AED</p><p style=\\\"color:#94a3b8\\\">Agente: \").concat(agentName,\"</p><p style=\\\"color:#94a3b8\\\">Developer: \").concat(sale.developer||'N/A',\"</p><a href=\\\"https://keyprime-sales-1npw.vercel.app\\\" style=\\\"display:inline-block;margin-top:20px;padding:12px 24px;background:#10b981;color:white;text-decoration:none;border-radius:8px\\\">Apri KeyPrime</a></div>\"));};const notifyNewLeadToAdmin=async(lead,agentName)=>{await sendEmail(ADMIN_EMAIL,\"\\uD83C\\uDFAF Nuovo Lead: \".concat(lead.progetto),\"<div style=\\\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\\\"><h2 style=\\\"color:#3b82f6\\\">\\uD83C\\uDFAF Nuovo Lead</h2><p style=\\\"font-size:18px;margin:16px 0\\\"><strong>\".concat(lead.progetto,\"</strong></p><p style=\\\"color:#94a3b8\\\">Zona: \").concat(lead.zona||'N/A',\"</p><p style=\\\"color:#94a3b8\\\">Agente: \").concat(agentName,\"</p><a href=\\\"https://keyprime-sales-1npw.vercel.app\\\" style=\\\"display:inline-block;margin-top:20px;padding:12px 24px;background:#3b82f6;color:white;text-decoration:none;border-radius:8px\\\">Apri KeyPrime</a></div>\"));};// PDF Generator\nconst generateClientePDF=(cliente,sales,tasks)=>{const tv=sales.filter(s=>s.stato==='venduto'||s.stato==='incassato').reduce((sum,s)=>sum+Number(s.valore||0),0);const html=\"<!DOCTYPE html><html><head><meta charset=\\\"UTF-8\\\"><title>\".concat(cliente.nome,\"</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;padding:40px;max-width:800px;margin:0 auto;color:#1a1a1a}h1{font-size:28px;font-weight:600;margin-bottom:8px}h2{font-size:14px;font-weight:600;color:#666;margin:24px 0 12px;text-transform:uppercase;letter-spacing:0.5px}.stats{display:flex;gap:16px;margin:24px 0}.stat{flex:1;background:#f5f5f7;padding:16px;border-radius:12px;text-align:center}.stat-val{font-size:24px;font-weight:600}.stat-label{font-size:12px;color:#666;margin-top:4px}.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}.item{background:#f5f5f7;padding:12px 16px;border-radius:8px}.item-label{font-size:11px;color:#666;margin-bottom:2px}.item-value{font-size:14px;font-weight:500}table{width:100%;border-collapse:collapse;margin-top:8px}th,td{padding:10px 12px;text-align:left;font-size:13px}th{background:#f5f5f7;font-weight:500}tr:not(:last-child) td{border-bottom:1px solid #e5e5e5}</style></head><body><h1>\").concat(cliente.nome,\" \").concat(cliente.cognome||'',\"</h1><p style=\\\"color:#666\\\">\").concat(cliente.telefono||'',\" \").concat(cliente.email?'• '+cliente.email:'',\"</p><div class=\\\"stats\\\"><div class=\\\"stat\\\"><div class=\\\"stat-val\\\">\").concat(sales.length,\"</div><div class=\\\"stat-label\\\">Lead</div></div><div class=\\\"stat\\\"><div class=\\\"stat-val\\\">\").concat(fmt(tv),\"</div><div class=\\\"stat-label\\\">Valore AED</div></div><div class=\\\"stat\\\"><div class=\\\"stat-val\\\">\").concat(cliente.stato,\"</div><div class=\\\"stat-label\\\">Stato</div></div></div><h2>Informazioni</h2><div class=\\\"grid\\\"><div class=\\\"item\\\"><div class=\\\"item-label\\\">Budget</div><div class=\\\"item-value\\\">\").concat(cliente.budget_max?fmt(cliente.budget_max)+' AED':'N/A',\"</div></div><div class=\\\"item\\\"><div class=\\\"item-label\\\">Agente</div><div class=\\\"item-value\\\">\").concat(cliente.agente_riferimento||'N/A',\"</div></div></div>\").concat(sales.length>0?'<h2>Storico Lead</h2><table><tr><th>Data</th><th>Progetto</th><th>Valore</th><th>Stato</th></tr>'+sales.map(s=>'<tr><td>'+fmtShort(s.data)+'</td><td>'+s.progetto+'</td><td>'+(s.valore>0?fmt(s.valore):'TBD')+'</td><td>'+s.stato+'</td></tr>').join('')+'</table>':'',\"</body></html>\");const w=window.open('','_blank');w.document.write(html);w.document.close();setTimeout(()=>w.print(),500);};// ==================== UI COMPONENTS ====================\n// Toast\nconst Toast=_ref=>{let{message,type='success',onClose}=_ref;useEffect(()=>{const t=setTimeout(onClose,2500);return()=>clearTimeout(t);},[onClose]);const colors={success:'bg-emerald-500',error:'bg-red-500',info:'bg-blue-500'};return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 \".concat(colors[type],\" text-white px-5 py-3 rounded-full shadow-2xl flex items-center gap-2 animate-slideUp\"),children:[/*#__PURE__*/_jsx(Check,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:message})]});};// Avatar\nconst Avatar=_ref2=>{let{nome,cognome,size='md',color}=_ref2;const sizes={sm:'w-8 h-8 text-xs',md:'w-10 h-10 text-sm',lg:'w-12 h-12 text-base',xl:'w-14 h-14 text-lg'};const colors=['bg-violet-500','bg-blue-500','bg-emerald-500','bg-amber-500','bg-pink-500','bg-cyan-500'];const bgColor=color||colors[Math.abs((nome||'').charCodeAt(0)||0)%colors.length];return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(sizes[size],\" \").concat(bgColor,\" rounded-full flex items-center justify-center font-semibold text-white shrink-0\"),children:getInitials(nome,cognome)});};// Status Badge\nconst StatusBadge=_ref3=>{let{status,type='pipeline'}=_ref3;const config=type==='pipeline'?theme.status[status]:type==='priority'?theme.priority[status]:theme.status[status];if(!config)return null;const label=pipelineLabels[status]||status;return/*#__PURE__*/_jsx(\"span\",{className:\"px-2.5 py-1 rounded-full text-xs font-medium\",style:{background:config.bg,color:config.color},children:label});};// Card Component\nconst Card=_ref4=>{let{children,className='',hover=false,onClick,padding='p-5'}=_ref4;return/*#__PURE__*/_jsx(\"div\",{onClick:onClick,className:\"bg-[#1e293b] border border-[#334155] rounded-2xl \".concat(padding,\" \").concat(hover?'hover:border-[#3F3F46] hover:bg-[#1F1F23] cursor-pointer transition-all duration-200':'',\" \").concat(className),children:children});};// Section Header\nconst SectionHeader=_ref5=>{let{icon:Icon,title,accent,action,actionLabel,onAction}=_ref5;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-xl flex items-center justify-center\",style:{background:\"rgba(\".concat(accent,\", 0.15)\")},children:/*#__PURE__*/_jsx(Icon,{className:\"w-5 h-5\",style:{color:\"rgb(\".concat(accent,\")\")}})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-white\",children:title})]}),action&&/*#__PURE__*/_jsxs(\"button\",{onClick:onAction,className:\"flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all hover:bg-white/5\",style:{color:\"rgb(\".concat(accent,\")\")},children:[actionLabel,\" \",/*#__PURE__*/_jsx(ChevronRight,{className:\"w-4 h-4\"})]})]});};// Metric Card\nconst MetricCard=_ref6=>{let{label,value,subValue,icon:Icon,color,trend,onClick}=_ref6;return/*#__PURE__*/_jsxs(Card,{hover:!!onClick,onClick:onClick,className:\"relative overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-zinc-500 mb-1\",children:label}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-white\",children:typeof value==='number'?fmt(value):value}),subValue&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-zinc-500 mt-1\",children:subValue})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-11 h-11 rounded-xl flex items-center justify-center\",style:{background:\"\".concat(color,\"15\")},children:/*#__PURE__*/_jsx(Icon,{className:\"w-5 h-5\",style:{color}})})]}),trend!==undefined&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1 mt-3 text-sm \".concat(trend>=0?'text-emerald-400':'text-red-400'),children:[trend>=0?/*#__PURE__*/_jsx(ArrowUpRight,{className:\"w-4 h-4\"}):/*#__PURE__*/_jsx(ArrowDownRight,{className:\"w-4 h-4\"}),Math.abs(trend),\"% vs last month\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -right-8 -bottom-8 w-32 h-32 rounded-full opacity-5\",style:{background:color}})]});};// Progress Bar\nconst ProgressBar=_ref7=>{let{value,max,color='#A78BFA',height='h-2',showLabel=false}=_ref7;const pct=max>0?Math.min(value/max*100,100):0;return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(height,\" bg-zinc-700/50 rounded-full overflow-hidden\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full rounded-full transition-all duration-700 ease-out\",style:{width:\"\".concat(pct,\"%\"),background:color}})}),showLabel&&/*#__PURE__*/_jsxs(\"span\",{className:\"absolute right-0 -top-6 text-xs text-zinc-500\",children:[pct.toFixed(0),\"%\"]})]});};// Empty State\nconst EmptyState=_ref8=>{let{icon:Icon,title,description,action,onAction}=_ref8;return/*#__PURE__*/_jsxs(Card,{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-2xl bg-zinc-700/50 flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(Icon,{className:\"w-8 h-8 text-zinc-600\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-white mb-2\",children:title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm mb-6 max-w-sm mx-auto\",children:description}),action&&/*#__PURE__*/_jsx(\"button\",{onClick:onAction,className:\"px-5 py-2.5 bg-white text-zinc-900 rounded-xl font-medium text-sm hover:bg-zinc-100 transition-colors\",children:action})]});};// Input\nconst Input=_ref9=>{let{label}=_ref9,props=_objectWithoutProperties(_ref9,_excluded);return/*#__PURE__*/_jsxs(\"div\",{children:[label&&/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:label}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},props),{},{className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] focus:ring-1 focus:ring-[#3F3F46] transition-all\"}))]});};// Select\nconst Select=_ref0=>{let{label,children}=_ref0,props=_objectWithoutProperties(_ref0,_excluded2);return/*#__PURE__*/_jsxs(\"div\",{children:[label&&/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:label}),/*#__PURE__*/_jsx(\"select\",_objectSpread(_objectSpread({},props),{},{className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-[#3F3F46] transition-all appearance-none cursor-pointer\",children:children}))]});};// Button\nconst Button=_ref1=>{let{children,variant='primary',size='md',icon:Icon,className=''}=_ref1,props=_objectWithoutProperties(_ref1,_excluded3);const variants={primary:'bg-white text-zinc-900 hover:bg-zinc-100',secondary:'bg-zinc-700/50 text-white hover:bg-zinc-700',ghost:'bg-transparent text-zinc-400 hover:text-white hover:bg-white/5',danger:'bg-red-500/10 text-red-400 hover:bg-red-500/20'};const sizes={sm:'px-3 py-1.5 text-xs',md:'px-4 py-2.5 text-sm',lg:'px-6 py-3 text-base'};return/*#__PURE__*/_jsxs(\"button\",_objectSpread(_objectSpread({},props),{},{className:\"\".concat(variants[variant],\" \").concat(sizes[size],\" rounded-xl font-medium flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed \").concat(className),children:[Icon&&/*#__PURE__*/_jsx(Icon,{className:\"w-4 h-4\"}),children]}));};// Modal\nconst Modal=_ref10=>{let{isOpen,onClose,title,children,size='md'}=_ref10;if(!isOpen)return null;const sizes={sm:'max-w-sm',md:'max-w-md',lg:'max-w-lg',xl:'max-w-xl'};return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full \".concat(sizes[size],\" max-h-[85vh] overflow-hidden animate-scaleIn\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-5 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white\",children:title}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-zinc-500 hover:text-white transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-5 overflow-y-auto max-h-[calc(85vh-80px)]\",children:children})]})]});};// Bottom Sheet\nconst BottomSheet=_ref11=>{let{isOpen,onClose,title,children}=_ref11;if(!isOpen)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 md:flex md:items-center md:justify-center md:p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-0 left-0 right-0 md:relative md:max-w-lg md:w-full bg-[#1e293b] border-t md:border border-[#334155] rounded-t-3xl md:rounded-2xl max-h-[90vh] overflow-hidden animate-slideUp\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-5 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white\",children:title}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-zinc-500 hover:text-white transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-5 overflow-y-auto max-h-[calc(90vh-80px)]\",children:children})]})]});};// Sidebar Nav Item\nconst NavItem=_ref12=>{let{icon:Icon,label,active,onClick,accent,badge,isNew}=_ref12;return/*#__PURE__*/_jsxs(\"button\",{onClick:onClick,className:\"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all relative \".concat(active?'bg-white/10 text-white':'text-zinc-400 hover:text-white hover:bg-white/5'),children:[/*#__PURE__*/_jsx(Icon,{className:\"w-5 h-5\",style:active?{color:accent}:{}}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium flex-1\",children:label}),badge>0&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 bg-red-500 text-white text-xs rounded-full\",children:badge}),isNew&&/*#__PURE__*/_jsx(\"span\",{className:\"px-1.5 py-0.5 bg-emerald-500 text-white text-[10px] font-bold rounded animate-pulse\",children:\"LIVE\"})]});};// Quick Actions Row\nconst QuickActions=_ref13=>{let{phone,whatsapp,email,clienteName}=_ref13;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[phone&&/*#__PURE__*/_jsxs(\"a\",{href:\"tel:\".concat(phone),className:\"flex-1 bg-zinc-700/50 hover:bg-zinc-700 text-white rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors\",children:[/*#__PURE__*/_jsx(Phone,{className:\"w-4 h-4\"}),\"Chiama\"]}),(whatsapp||phone)&&/*#__PURE__*/_jsxs(\"a\",{href:getWhatsAppLink(whatsapp||phone,clienteName?\"Ciao \".concat(clienteName,\", \"):''),target:\"_blank\",rel:\"noopener noreferrer\",className:\"flex-1 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"w-4 h-4\"}),\"WhatsApp\"]}),email&&/*#__PURE__*/_jsxs(\"a\",{href:\"mailto:\".concat(email),className:\"flex-1 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors\",children:[/*#__PURE__*/_jsx(Mail,{className:\"w-4 h-4\"}),\"Email\"]})]});};// Global Search Modal (CMD+K)\nconst GlobalSearch=_ref14=>{let{isOpen,onClose,sales,clienti,tasks,onSelectSale,onSelectCliente,onSelectTask,setActiveTab}=_ref14;const[query,setQuery]=useState('');const inputRef=useRef(null);useEffect(()=>{if(isOpen&&inputRef.current){inputRef.current.focus();}if(!isOpen)setQuery('');},[isOpen]);if(!isOpen)return null;const q=query.toLowerCase();const filteredSales=q.length>=2?sales.filter(s=>\"\".concat(s.progetto,\" \").concat(s.developer,\" \").concat(s.zona,\" \").concat(s.cliente_nome,\" \").concat(s.agente).toLowerCase().includes(q)).slice(0,5):[];const filteredClienti=q.length>=2?clienti.filter(c=>\"\".concat(c.nome,\" \").concat(c.cognome,\" \").concat(c.telefono,\" \").concat(c.email).toLowerCase().includes(q)).slice(0,5):[];const filteredTasks=q.length>=2?tasks.filter(t=>\"\".concat(t.titolo,\" \").concat(t.descrizione).toLowerCase().includes(q)).slice(0,3):[];const hasResults=filteredSales.length>0||filteredClienti.length>0||filteredTasks.length>0;return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 flex items-start justify-center pt-[15vh]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-xl shadow-2xl overflow-hidden animate-scaleIn\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 px-4 py-4 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-5 h-5 text-zinc-500\"}),/*#__PURE__*/_jsx(\"input\",{ref:inputRef,type:\"text\",value:query,onChange:e=>setQuery(e.target.value),placeholder:\"Cerca lead, clienti, task...\",className:\"flex-1 bg-transparent text-white text-lg placeholder:text-zinc-600 focus:outline-none\"}),/*#__PURE__*/_jsx(\"kbd\",{className:\"hidden sm:flex items-center gap-1 px-2 py-1 bg-zinc-700/50 rounded text-xs text-zinc-500\",children:\"ESC\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-[50vh] overflow-y-auto\",children:query.length<2?/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 text-center\",children:[/*#__PURE__*/_jsx(Command,{className:\"w-12 h-12 text-zinc-700 mx-auto mb-3\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500\",children:\"Digita almeno 2 caratteri per cercare\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-600 text-sm mt-2\",children:[\"Premi \",/*#__PURE__*/_jsx(\"kbd\",{className:\"px-1.5 py-0.5 bg-zinc-700/50 rounded text-xs\",children:\"\\u2318K\"}),\" ovunque per aprire\"]})]}):!hasResults?/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 text-center text-zinc-500\",children:[\"Nessun risultato per \\\"\",query,\"\\\"\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"p-2\",children:[filteredSales.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider\",children:\"Lead / Vendite\"}),filteredSales.map(s=>{var _theme$status;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onSelectSale(s);onClose();},className:\"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-8 rounded-full\",style:{background:(_theme$status=theme.status[s.stato||'lead'])===null||_theme$status===void 0?void 0:_theme$status.color}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium truncate\",children:s.progetto||'TBD'}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-xs truncate\",children:[s.developer,\" \\u2022 \",s.cliente_nome||'No cliente']})]}),/*#__PURE__*/_jsx(StatusBadge,{status:s.stato||'lead'})]},s.id);})]}),filteredClienti.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider\",children:\"Clienti\"}),filteredClienti.map(c=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onSelectCliente(c);setActiveTab('crm');onClose();},className:\"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors\",children:[/*#__PURE__*/_jsx(Avatar,{nome:c.nome,cognome:c.cognome,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-white text-sm font-medium truncate\",children:[c.nome,\" \",c.cognome]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs truncate\",children:c.telefono||c.email||'No contatto'})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-amber-400 text-xs\",children:c.stato})]},c.id))]}),filteredTasks.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider\",children:\"Task\"}),filteredTasks.map(t=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setActiveTab('tasks');onClose();},className:\"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-lg flex items-center justify-center \".concat(t.stato==='completato'?'bg-emerald-500/20':'bg-pink-500/20'),children:/*#__PURE__*/_jsx(ListTodo,{className:\"w-4 h-4 \".concat(t.stato==='completato'?'text-emerald-400':'text-pink-400')})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium truncate \".concat(t.stato==='completato'?'line-through opacity-50':''),children:t.titolo}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs truncate\",children:t.assegnato_a||'Non assegnato'})]}),/*#__PURE__*/_jsx(StatusBadge,{status:t.priorita,type:\"priority\"})]},t.id))]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-3 border-t border-[#334155] flex items-center justify-between text-xs text-zinc-600\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"KeyPrime Search\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Naviga con\"}),/*#__PURE__*/_jsx(\"kbd\",{className:\"px-1.5 py-0.5 bg-zinc-700/50 rounded\",children:\"\\u2191\\u2193\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Seleziona con\"}),/*#__PURE__*/_jsx(\"kbd\",{className:\"px-1.5 py-0.5 bg-zinc-700/50 rounded\",children:\"\\u21B5\"})]})]})]})]});};// Dashboard PDF Export\nconst generateDashboardPDF=(totals,sales,vendite,byAgente,byZona)=>{const today=new Date().toLocaleDateString('it-IT',{day:'2-digit',month:'long',year:'numeric'});const topAgenti=Object.entries(byAgente).sort((a,b)=>b[1]-a[1]).slice(0,5);const topZone=Object.entries(byZona).sort((a,b)=>b[1]-a[1]).slice(0,5);const conversionRate=sales.length>0?(vendite.length/sales.length*100).toFixed(1):0;const html=\"<!DOCTYPE html>\\n<html>\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <title>KeyPrime Report - \".concat(today,\"</title>\\n  <style>\\n    * { margin: 0; padding: 0; box-sizing: border-box; }\\n    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; padding: 40px; max-width: 900px; margin: 0 auto; color: #1a1a1a; }\\n    .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 2px solid #f0f0f0; }\\n    .logo { font-size: 28px; font-weight: 700; color: #1e293b; }\\n    .logo span { color: #A78BFA; }\\n    .date { color: #666; font-size: 14px; }\\n    h1 { font-size: 24px; font-weight: 600; margin-bottom: 8px; }\\n    h2 { font-size: 16px; font-weight: 600; color: #666; margin: 32px 0 16px; text-transform: uppercase; letter-spacing: 0.5px; }\\n    .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 32px; }\\n    .stat { background: linear-gradient(135deg, #f8f8f8 0%, #f0f0f0 100%); padding: 20px; border-radius: 12px; text-align: center; }\\n    .stat-value { font-size: 28px; font-weight: 700; color: #1e293b; }\\n    .stat-value.purple { color: #A78BFA; }\\n    .stat-value.green { color: #34D399; }\\n    .stat-value.blue { color: #60A5FA; }\\n    .stat-value.amber { color: #FBBF24; }\\n    .stat-label { font-size: 12px; color: #666; margin-top: 4px; text-transform: uppercase; }\\n    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }\\n    .card { background: #f8f8f8; border-radius: 12px; padding: 20px; }\\n    .card-title { font-size: 14px; font-weight: 600; margin-bottom: 16px; color: #333; }\\n    .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e5e5e5; }\\n    .row:last-child { border-bottom: none; }\\n    .row-label { color: #666; }\\n    .row-value { font-weight: 600; }\\n    .commission-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 16px; }\\n    .commission-item { background: white; padding: 12px; border-radius: 8px; text-align: center; }\\n    .commission-value { font-size: 18px; font-weight: 700; }\\n    .commission-label { font-size: 11px; color: #666; margin-top: 2px; }\\n    .footer { margin-top: 48px; padding-top: 20px; border-top: 1px solid #e5e5e5; text-align: center; color: #999; font-size: 12px; }\\n    @media print { body { padding: 20px; } }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"header\\\">\\n    <div>\\n      <div class=\\\"logo\\\">Key<span>Prime</span></div>\\n      <h1>Report Dashboard</h1>\\n    </div>\\n    <div class=\\\"date\\\">\").concat(today,\"</div>\\n  </div>\\n  \\n  <div class=\\\"stats\\\">\\n    <div class=\\\"stat\\\">\\n      <div class=\\\"stat-value purple\\\">\").concat(fmt(totals.valore),\"</div>\\n      <div class=\\\"stat-label\\\">Volume Totale AED</div>\\n    </div>\\n    <div class=\\\"stat\\\">\\n      <div class=\\\"stat-value blue\\\">\").concat(sales.length,\"</div>\\n      <div class=\\\"stat-label\\\">Lead Totali</div>\\n    </div>\\n    <div class=\\\"stat\\\">\\n      <div class=\\\"stat-value green\\\">\").concat(vendite.length,\"</div>\\n      <div class=\\\"stat-label\\\">Vendite Chiuse</div>\\n    </div>\\n    <div class=\\\"stat\\\">\\n      <div class=\\\"stat-value amber\\\">\").concat(conversionRate,\"%</div>\\n      <div class=\\\"stat-label\\\">Tasso Conversione</div>\\n    </div>\\n  </div>\\n  \\n  <h2>Commissioni</h2>\\n  <div class=\\\"commission-grid\\\">\\n    <div class=\\\"commission-item\\\">\\n      <div class=\\\"commission-value\\\" style=\\\"color: #34D399\\\">\").concat(fmt(totals.comm),\"</div>\\n      <div class=\\\"commission-label\\\">Totali</div>\\n    </div>\\n    <div class=\\\"commission-item\\\">\\n      <div class=\\\"commission-value\\\" style=\\\"color: #60A5FA\\\">\").concat(fmt(totals.ag),\"</div>\\n      <div class=\\\"commission-label\\\">Agenti 70%</div>\\n    </div>\\n    <div class=\\\"commission-item\\\">\\n      <div class=\\\"commission-value\\\" style=\\\"color: #22C55E\\\">\").concat(fmt(totals.pell),\"</div>\\n      <div class=\\\"commission-label\\\">Pellegrino</div>\\n    </div>\\n    <div class=\\\"commission-item\\\">\\n      <div class=\\\"commission-value\\\" style=\\\"color: #F97316\\\">\").concat(fmt(totals.giov),\"</div>\\n      <div class=\\\"commission-label\\\">Giovanni</div>\\n    </div>\\n  </div>\\n  \\n  <div class=\\\"grid\\\">\\n    <div>\\n      <h2>Top Agenti</h2>\\n      <div class=\\\"card\\\">\\n        \").concat(topAgenti.length>0?topAgenti.map((_ref15,i)=>{let[name,value]=_ref15;return\"\\n          <div class=\\\"row\\\">\\n            <span class=\\\"row-label\\\">\".concat(i+1,\". \").concat(name,\"</span>\\n            <span class=\\\"row-value\\\">\").concat(fmt(value),\" AED</span>\\n          </div>\\n        \");}).join(''):'<p style=\"color: #999; text-align: center; padding: 20px;\">Nessun dato</p>',\"\\n      </div>\\n    </div>\\n    <div>\\n      <h2>Top Zone</h2>\\n      <div class=\\\"card\\\">\\n        \").concat(topZone.length>0?topZone.map((_ref16,i)=>{let[zone,value]=_ref16;return\"\\n          <div class=\\\"row\\\">\\n            <span class=\\\"row-label\\\">\".concat(i+1,\". \").concat(zone,\"</span>\\n            <span class=\\\"row-value\\\">\").concat(fmt(value),\" AED</span>\\n          </div>\\n        \");}).join(''):'<p style=\"color: #999; text-align: center; padding: 20px;\">Nessun dato</p>',\"\\n      </div>\\n    </div>\\n  </div>\\n  \\n  <div class=\\\"footer\\\">\\n    KeyPrime Real Estate CRM \\u2022 Report generato automaticamente \\u2022 \").concat(today,\"\\n  </div>\\n</body>\\n</html>\");const w=window.open('','_blank');w.document.write(html);w.document.close();setTimeout(()=>w.print(),500);};// ==================== MAIN APP ====================\nexport default function App(){const[view,setView]=useState('login');const[user,setUser]=useState(null);const[sales,setSales]=useState([]);const[users,setUsers]=useState([]);const[clienti,setClienti]=useState([]);const[tasks,setTasks]=useState([]);const[activities,setActivities]=useState([]);const[followUps,setFollowUps]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[toast,setToast]=useState(null);const[activeTab,setActiveTab]=useState('dashboard');const[mobileMenuOpen,setMobileMenuOpen]=useState(false);const[submitting,setSubmitting]=useState(false);// Modals\nconst[showForm,setShowForm]=useState(null);const[showLeadDetail,setShowLeadDetail]=useState(null);const[showClienteDetail,setShowClienteDetail]=useState(null);const[showClienteModal,setShowClienteModal]=useState(null);const[showTaskModal,setShowTaskModal]=useState(null);const[showUserModal,setShowUserModal]=useState(null);const[showNoteModal,setShowNoteModal]=useState(null);const[showPasswordModal,setShowPasswordModal]=useState(false);const[showNotifications,setShowNotifications]=useState(false);const[convertingSale,setConvertingSale]=useState(null);// Filters\nconst[filters,setFilters]=useState({search:'',stato:''});const[clienteFilters,setClienteFilters]=useState({search:'',stato:''});const[periodFilter,setPeriodFilter]=useState('all');// all, 30, 60, 90\nconst[showAgentDetail,setShowAgentDetail]=useState(null);// Saved Listings (PropertyFinder)\nconst[savedListings,setSavedListings]=useState([]);// Global Search\nconst[showGlobalSearch,setShowGlobalSearch]=useState(false);// Keyboard shortcut for global search\nuseEffect(()=>{const handleKeyDown=e=>{if((e.metaKey||e.ctrlKey)&&e.key==='k'){e.preventDefault();setShowGlobalSearch(true);}if(e.key==='Escape'){setShowGlobalSearch(false);}};window.addEventListener('keydown',handleKeyDown);return()=>window.removeEventListener('keydown',handleKeyDown);},[]);// Notifications\nconst[readNotificationIds,setReadNotificationIds]=useState(()=>{const saved=localStorage.getItem('keyprime_read_notifications');return saved?JSON.parse(saved):[];});const showToast=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';return setToast({message,type});};// Auth\nuseEffect(()=>{const s=localStorage.getItem('keyprime_user');if(s){const u=JSON.parse(s);setUser(u);setActiveTab(u.ruolo==='admin'?'dashboard':'home');// agente_admin usa la stessa view di agente\nconst viewRole=u.ruolo==='admin'?'admin':u.ruolo==='agente_admin'?'agente':u.ruolo;setView(viewRole);}},[]);// Data Loading\nconst loadSales=async()=>{setLoading(true);const{data}=await supabase.from('sales_with_commissions').select('*').order('created_at',{ascending:false});setSales(data||[]);setLoading(false);};const loadUsers=async()=>{const{data}=await supabase.from('user_credentials').select('*').order('created_at',{ascending:false});setUsers(data||[]);};const loadClienti=async()=>{const{data}=await supabase.from('clienti').select('*').order('created_at',{ascending:false});setClienti(data||[]);};const loadTasks=async()=>{const{data}=await supabase.from('tasks').select('*').order('scadenza',{ascending:true});setTasks(data||[]);};const loadActivities=async()=>{const{data}=await supabase.from('lead_activities').select('*').order('created_at',{ascending:false});setActivities(data||[]);};const loadFollowUps=async()=>{const{data}=await supabase.from('follow_ups').select('*').order('data_reminder',{ascending:true});setFollowUps(data||[]);};const loadSavedListings=async()=>{const{data}=await supabase.from('saved_listings').select('*').eq('user_id',user===null||user===void 0?void 0:user.id).order('created_at',{ascending:false});setSavedListings(data||[]);};useEffect(()=>{if(user){loadSales();loadClienti();loadTasks();loadActivities();loadFollowUps();loadSavedListings();if(user.ruolo==='admin')loadUsers();}},[user]);// Global refresh function\nconst refreshAllData=async()=>{setLoading(true);showToast('Aggiornamento...');await Promise.all([loadSales(),loadClienti(),loadTasks(),loadActivities(),loadFollowUps(),loadSavedListings(),(user===null||user===void 0?void 0:user.ruolo)==='admin'?loadUsers():Promise.resolve()]);setLoading(false);showToast('Dati aggiornati ✓');};// Auth Handlers\nconst handleLogin=async(username,password)=>{setLoading(true);setError(null);const{data}=await supabase.from('user_credentials').select('*').eq('username',username).eq('password',password).eq('attivo',true).single();if(!data){setError('Credenziali non valide');setLoading(false);return;}setUser(data);localStorage.setItem('keyprime_user',JSON.stringify(data));setActiveTab(data.ruolo==='admin'?'dashboard':'home');// agente_admin usa la stessa view di agente\nconst viewRole=data.ruolo==='admin'?'admin':data.ruolo==='agente_admin'?'agente':data.ruolo;setView(viewRole);setLoading(false);};const handleLogout=()=>{setUser(null);localStorage.removeItem('keyprime_user');setView('login');setMobileMenuOpen(false);};const changePassword=async np=>{await supabase.from('user_credentials').update({password:np}).eq('id',user.id);const u=_objectSpread(_objectSpread({},user),{},{password:np});setUser(u);localStorage.setItem('keyprime_user',JSON.stringify(u));setShowPasswordModal(false);showToast('Password aggiornata');};// Saved Listings Handlers\nconst saveListing=async listing=>{var _listing$location,_listing$location2,_listing$location3,_listing$bedrooms,_listing$bedrooms$ava,_listing$images,_listing$images$,_listing$developer;const{error}=await supabase.from('saved_listings').insert([{property_id:listing.project_id,title:listing.title,price:parseFloat(listing.price_from)||0,location_full:(_listing$location=listing.location)===null||_listing$location===void 0?void 0:_listing$location.full_name,location_path:((_listing$location2=listing.location)===null||_listing$location2===void 0?void 0:_listing$location2.path_name)||((_listing$location3=listing.location)===null||_listing$location3===void 0?void 0:_listing$location3.name),property_type:'off-plan',size:null,bedrooms:((_listing$bedrooms=listing.bedrooms)===null||_listing$bedrooms===void 0?void 0:(_listing$bedrooms$ava=_listing$bedrooms.available)===null||_listing$bedrooms$ava===void 0?void 0:_listing$bedrooms$ava.join(','))||null,bathrooms:null,furnished:null,image_url:(_listing$images=listing.images)===null||_listing$images===void 0?void 0:(_listing$images$=_listing$images[0])===null||_listing$images$===void 0?void 0:_listing$images$.medium_image_url,pf_url:listing.url,completion_status:listing.construction_phase_key,agent_name:(_listing$developer=listing.developer)===null||_listing$developer===void 0?void 0:_listing$developer.name,agent_email:null,description:listing.title,created_by:user===null||user===void 0?void 0:user.nome,user_id:user===null||user===void 0?void 0:user.id,// Track which user saved this\nproperty_data:listing}]);if(error){console.error('Save error:',error);showToast('Errore nel salvataggio');}else{loadSavedListings();showToast('Progetto salvato ✓');}};const removeListing=async propertyId=>{await supabase.from('saved_listings').delete().eq('property_id',propertyId);loadSavedListings();showToast('Annuncio rimosso');};const createLeadFromListing=async leadData=>{// If creating new cliente first\nlet cliente_id=leadData.cliente_id;if(leadData.newCliente&&leadData.newCliente.nome){const{data:cd}=await supabase.from('clienti').insert([{nome:leadData.newCliente.nome,cognome:leadData.newCliente.cognome||'',telefono:leadData.newCliente.telefono||'',email:leadData.newCliente.email||'',stato:'nuovo',fonte:'Off-Plan',agente_riferimento:user===null||user===void 0?void 0:user.nome,created_by:user===null||user===void 0?void 0:user.nome,referente:user===null||user===void 0?void 0:user.referente}]).select().single();if(cd){cliente_id=cd.id;leadData.cliente_nome=\"\".concat(cd.nome,\" \").concat(cd.cognome);loadClienti();}}// Create lead\nawait supabase.from('sales').insert([{data:new Date().toISOString().split('T')[0],developer:leadData.developer,progetto:leadData.progetto,zona:leadData.zona,valore:leadData.valore||0,stato:'lead',agente:user===null||user===void 0?void 0:user.nome,referente:user===null||user===void 0?void 0:user.referente,cliente_id:cliente_id,inserted_by:user===null||user===void 0?void 0:user.nome,inserted_as:user===null||user===void 0?void 0:user.ruolo}]);// Notifica email per nuovo lead (solo se non è admin a creare)\nif((user===null||user===void 0?void 0:user.ruolo)!=='admin'){await notifyNewLeadToAdmin({progetto:leadData.progetto,zona:leadData.zona},user===null||user===void 0?void 0:user.nome);}loadSales();showToast('Lead creato da Off-Plan');};// Sales Handlers\nconst addLead=async ld=>{if(submitting)return;setSubmitting(true);try{let cliente_id=ld.cliente_id;if(!cliente_id&&ld.cliente_nome){const{data:cd,error:clienteError}=await supabase.from('clienti').insert([{nome:ld.cliente_nome,cognome:ld.cliente_cognome,email:ld.cliente_email,telefono:ld.cliente_telefono,whatsapp:ld.cliente_whatsapp,nazionalita:ld.cliente_nazionalita,budget_min:ld.cliente_budget_min?parseFloat(ld.cliente_budget_min):null,budget_max:ld.cliente_budget_max?parseFloat(ld.cliente_budget_max):null,note:ld.cliente_note,stato:'nuovo',fonte:'Agente',agente_riferimento:user===null||user===void 0?void 0:user.nome,created_by:user===null||user===void 0?void 0:user.nome,referente:user===null||user===void 0?void 0:user.referente}]).select().single();if(clienteError){console.error('Cliente error:',clienteError);}if(cd)cliente_id=cd.id;}const{error}=await supabase.from('sales').insert([{data:ld.data,developer:ld.developer,progetto:ld.progetto,zona:ld.zona,valore:ld.valore||0,agente:ld.agente,segnalatore:ld.segnalatore,referente:user===null||user===void 0?void 0:user.referente,commission_pct:5,inserted_by:user===null||user===void 0?void 0:user.nome,inserted_as:user===null||user===void 0?void 0:user.ruolo,pagato:false,stato:ld.stato||'lead',cliente_id}]);if(error){console.error('Insert error:',error);showToast('Errore: '+error.message);setSubmitting(false);return;}showToast('Lead aggiunto');setShowForm(null);loadSales();loadClienti();}catch(err){console.error('addLead error:',err);showToast('Errore salvataggio');}setSubmitting(false);};const addSale=async sd=>{if(submitting)return;setSubmitting(true);try{let cliente_id=sd.cliente_id;if(!cliente_id&&sd.nuovo_cliente_nome){const{data:cd,error:clienteError}=await supabase.from('clienti').insert([{nome:sd.nuovo_cliente_nome,cognome:sd.nuovo_cliente_cognome||'',telefono:sd.nuovo_cliente_telefono||'',email:sd.nuovo_cliente_email||'',stato:'acquistato',fonte:'Vendita',agente_riferimento:user===null||user===void 0?void 0:user.nome,created_by:user===null||user===void 0?void 0:user.nome,referente:user===null||user===void 0?void 0:user.referente}]).select().single();if(clienteError){console.error('Cliente error:',clienteError);}if(cd)cliente_id=cd.id;}if(sd.cliente_id)await supabase.from('clienti').update({stato:'acquistato'}).eq('id',sd.cliente_id);const{error}=await supabase.from('sales').insert([{data:sd.data,developer:sd.developer,progetto:sd.progetto,zona:sd.zona,valore:sd.valore,agente:sd.agente,segnalatore:sd.segnalatore,cliente_id,referente:user===null||user===void 0?void 0:user.referente,commission_pct:5,inserted_by:user===null||user===void 0?void 0:user.nome,inserted_as:user===null||user===void 0?void 0:user.ruolo,pagato:false,stato:'venduto'}]);if(error){console.error('Insert error:',error);showToast('Errore: '+error.message);setSubmitting(false);return;}showToast('Vendita registrata');setShowForm(null);loadSales();loadClienti();}catch(err){console.error('addSale error:',err);showToast('Errore salvataggio');}setSubmitting(false);};const convertLeadToSale=async(id,v)=>{const sale=sales.find(s=>s.id===id);if(sale!==null&&sale!==void 0&&sale.cliente_id)await supabase.from('clienti').update({stato:'acquistato'}).eq('id',sale.cliente_id);await supabase.from('sales').update({stato:'venduto',valore:v}).eq('id',id);setConvertingSale(null);setShowLeadDetail(null);showToast('Vendita confermata!');loadSales();loadClienti();};const updateSale=async(id,u)=>{const s=sales.find(x=>x.id===id);// Notifica email per vendita chiusa\nif(u.stato==='vinto'&&(s===null||s===void 0?void 0:s.stato)!=='vinto'){await notifyNewSaleToAdmin(s,s.agente||s.segnalatore||'N/A');}// Notifica email per lead incassato\nif(u.stato==='incassato'&&(s===null||s===void 0?void 0:s.stato)!=='incassato'){await sendEmail(ADMIN_EMAIL,\"\\uD83D\\uDCB0 Incasso: \".concat(s.progetto),\"<div style=\\\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\\\"><h2 style=\\\"color:#10b981\\\">\\uD83D\\uDCB0 Incasso Registrato!</h2><p style=\\\"font-size:24px;margin:16px 0\\\"><strong>\".concat(s.progetto,\"</strong></p><p style=\\\"font-size:20px;color:#10b981\\\">\").concat(fmt(s.valore),\" AED</p></div>\"));}if(u.pagato===true&&!(s!==null&&s!==void 0&&s.pagato)){const tn=s.agente||s.segnalatore;if(tn){const{data:tu}=await supabase.from('user_credentials').select('*').eq('nome',tn).single();if(tu!==null&&tu!==void 0&&tu.email){const ca=Number(s.valore)*(s.commission_pct||5)/100*(s.agente?0.7:0.3);await sendEmail(tu.email,'💰 Commissione',\"<div style=\\\"font-family:-apple-system,sans-serif;padding:20px\\\"><h2>Commissione Pagata!</h2><p>\".concat(s.progetto,\": \").concat(fmt(ca),\" AED</p></div>\"));}}}console.log('Updating sale:',id,u);const{error}=await supabase.from('sales').update(u).eq('id',id);if(error){console.error('Update error:',error);console.error('Error details:',JSON.stringify(error,null,2));showToast('Errore: '+(error.message||error.details||'Sconosciuto'));return;}console.log('Update success, reloading...');await loadSales();showToast('Salvato');};const deleteSale=async id=>{if(!window.confirm('Eliminare questo lead?'))return;await supabase.from('sales').delete().eq('id',id);showToast('Eliminato');loadSales();};// Cliente Handlers\nconst createCliente=async d=>{await supabase.from('clienti').insert([_objectSpread(_objectSpread({},d),{},{created_by:user===null||user===void 0?void 0:user.nome,referente:user===null||user===void 0?void 0:user.referente})]);loadClienti();setShowClienteModal(null);showToast('Cliente creato');};const updateCliente=async(id,d)=>{await supabase.from('clienti').update(d).eq('id',id);// Se cambio l'agente assegnato, aggiorno anche tutti i lead di questo cliente\nif(d.assegnato_a){await supabase.from('sales').update({assegnato_a:d.assegnato_a}).eq('cliente_id',id);await loadSales();// Refresh sales per aggiornare dashboard\n}await loadClienti();setShowClienteModal(null);if((showClienteDetail===null||showClienteDetail===void 0?void 0:showClienteDetail.id)===id)setShowClienteDetail(prev=>_objectSpread(_objectSpread({},prev),d));showToast('Salvato');};const deleteCliente=async function(id){let skipConfirm=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!skipConfirm&&!window.confirm('Eliminare?'))return;await supabase.from('clienti').delete().eq('id',id);await loadClienti();setShowClienteDetail(null);showToast('Eliminato');};// Task Handlers\nconst createTask=async d=>{await supabase.from('tasks').insert([_objectSpread(_objectSpread({},d),{},{created_by:user===null||user===void 0?void 0:user.nome})]);// Notifica email per nuovo task assegnato\nif(d.assegnato_a){const{data:agentData}=await supabase.from('user_credentials').select('email').eq('nome',d.assegnato_a).single();if(agentData!==null&&agentData!==void 0&&agentData.email){await notifyNewTaskToAgent(d,agentData.email);}}loadTasks();setShowTaskModal(null);showToast('Task creato');};const updateTask=async(id,d)=>{await supabase.from('tasks').update(d).eq('id',id);loadTasks();setShowTaskModal(null);showToast('Salvato');};const completeTask=async id=>{const task=tasks.find(t=>t.id===id);await supabase.from('tasks').update({stato:'completato',completed_at:new Date().toISOString()}).eq('id',id);// Notifica email per task completato (per admin)\nif(task&&(user===null||user===void 0?void 0:user.ruolo)!=='admin'){await notifyTaskCompleted(task,user===null||user===void 0?void 0:user.nome);}showToast('Completato!');loadTasks();};const addTaskNote=async(id,note)=>{const task=tasks.find(t=>t.id===id);await supabase.from('tasks').update({note}).eq('id',id);if(task&&(user===null||user===void 0?void 0:user.ruolo)!=='admin')await notifyTaskNote(task,user===null||user===void 0?void 0:user.nome,note);loadTasks();setShowNoteModal(null);showToast('Nota inviata');};const deleteTask=async id=>{if(!window.confirm('Eliminare?'))return;await supabase.from('tasks').delete().eq('id',id);loadTasks();};// Activity Handlers (Lead Notes/Activities)\nconst addActivity=async(saleId,tipo,contenuto)=>{await supabase.from('lead_activities').insert([{sale_id:saleId,tipo,contenuto,created_by:user===null||user===void 0?void 0:user.nome}]);loadActivities();showToast('Attività registrata');};const deleteActivity=async id=>{await supabase.from('lead_activities').delete().eq('id',id);loadActivities();};// Follow-up Handlers\nconst createFollowUp=async data=>{await supabase.from('follow_ups').insert([_objectSpread(_objectSpread({},data),{},{assegnato_a:data.assegnato_a||(user===null||user===void 0?void 0:user.nome)})]);loadFollowUps();showToast('Follow-up programmato');};const completeFollowUp=async id=>{await supabase.from('follow_ups').update({completato:true}).eq('id',id);loadFollowUps();showToast('Follow-up completato');};const deleteFollowUp=async id=>{await supabase.from('follow_ups').delete().eq('id',id);loadFollowUps();};// User Handlers\nconst createUser=async d=>{await supabase.from('user_credentials').insert([d]);loadUsers();setShowUserModal(null);showToast('Utente creato');};const updateUser=async(id,d)=>{await supabase.from('user_credentials').update(d).eq('id',id);loadUsers();setShowUserModal(null);showToast('Salvato');};const deleteUser=async id=>{if(!window.confirm('Eliminare?'))return;await supabase.from('user_credentials').delete().eq('id',id);loadUsers();};// Computed Data\nconst filteredSales=sales.filter(s=>{if(filters.search&&!\"\".concat(s.progetto,\" \").concat(s.developer,\" \").concat(s.agente,\" \").concat(s.cliente_nome).toLowerCase().includes(filters.search.toLowerCase()))return false;if(filters.stato&&s.stato!==filters.stato)return false;return true;});const filteredClienti=clienti.filter(c=>{if(clienteFilters.search&&!\"\".concat(c.nome,\" \").concat(c.cognome,\" \").concat(c.email,\" \").concat(c.telefono).toLowerCase().includes(clienteFilters.search.toLowerCase()))return false;if(clienteFilters.stato&&c.stato!==clienteFilters.stato)return false;return true;});const myPendingTasks=tasks.filter(t=>t.stato==='pending'&&((user===null||user===void 0?void 0:user.ruolo)==='admin'||t.assegnato_a===(user===null||user===void 0?void 0:user.nome)));const overdueTasks=myPendingTasks.filter(t=>isOverdue(t.scadenza));const todayTasks=myPendingTasks.filter(t=>isToday(t.scadenza));// Follow-up reminders\nconst myFollowUps=followUps.filter(f=>!f.completato&&((user===null||user===void 0?void 0:user.ruolo)==='admin'||f.assegnato_a===(user===null||user===void 0?void 0:user.nome)));const todayFollowUps=myFollowUps.filter(f=>isToday(f.data_reminder));const overdueFollowUps=myFollowUps.filter(f=>isOverdue(f.data_reminder));// For agents: show all their assigned tasks as notifications (not just overdue/today)\n// For admin: show overdue/today tasks + recent sales\nconst notificationTasks=(user===null||user===void 0?void 0:user.ruolo)==='admin'?myPendingTasks.filter(t=>isOverdue(t.scadenza)||isToday(t.scadenza)):myPendingTasks;// Agents see ALL their pending tasks\n// Recent sales notifications (last 24 hours for admin)\nconst recentSalesNotifications=(user===null||user===void 0?void 0:user.ruolo)==='admin'?sales.filter(s=>{const created=new Date(s.created_at);const now=new Date();const hoursDiff=(now-created)/(1000*60*60);return hoursDiff<=24&&!readNotificationIds.includes('sale_'+s.id);}):[];// Unread = not in readNotificationIds AND (for agents: created_by !== user, for admin: all)\nconst unreadNotificationIds=[...notificationTasks.filter(t=>{const isRead=readNotificationIds.includes(\"task_\".concat(t.id,\"_\").concat(user===null||user===void 0?void 0:user.id));// For agents: only unread if someone else created it OR it's overdue\nif((user===null||user===void 0?void 0:user.ruolo)!=='admin'){return!isRead&&(t.created_by!==(user===null||user===void 0?void 0:user.nome)||isOverdue(t.scadenza));}return!isRead;}).map(t=>\"task_\".concat(t.id,\"_\").concat(user===null||user===void 0?void 0:user.id)),...recentSalesNotifications.map(s=>'sale_'+s.id)];const notificationCount=unreadNotificationIds.length;const markNotificationsAsRead=()=>{const taskIds=notificationTasks.map(t=>\"task_\".concat(t.id,\"_\").concat(user===null||user===void 0?void 0:user.id));const saleIds=recentSalesNotifications.map(s=>'sale_'+s.id);const allIds=[...new Set([...readNotificationIds,...taskIds,...saleIds])];setReadNotificationIds(allIds);localStorage.setItem('keyprime_read_notifications',JSON.stringify(allIds));};const markSingleNotificationAsRead=notifId=>{const allIds=[...new Set([...readNotificationIds,notifId])];setReadNotificationIds(allIds);localStorage.setItem('keyprime_read_notifications',JSON.stringify(allIds));};// ==================== LOGIN VIEW ====================\nif(view==='login'){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-[#0f172a] flex items-center justify-center p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-10\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"KeyPrime\",className:\"h-20 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Real Estate CRM\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500/10 border border-red-500/20 text-red-400 rounded-xl px-4 py-3 mb-6 text-sm\",children:error}),/*#__PURE__*/_jsx(LoginForm,{onLogin:handleLogin,loading:loading})]})});}// ==================== AGENT/SEGNALATORE VIEW ====================\nif(view==='agente'||view==='segnalatore'){var _tabs$find;// Per agente_admin, usa la view agente ma con ruolo originale per calcoli\nconst type=(user===null||user===void 0?void 0:user.ruolo)==='agente_admin'?'agente':view;const isAgenteAdmin=(user===null||user===void 0?void 0:user.ruolo)==='agente_admin';const mySales=sales.filter(s=>type==='agente'?s.agente===(user===null||user===void 0?void 0:user.nome):s.segnalatore===(user===null||user===void 0?void 0:user.nome));const myTasks=tasks.filter(t=>t.assegnato_a===(user===null||user===void 0?void 0:user.nome)&&t.stato==='pending');const myClienti=clienti.filter(c=>c.created_by===(user===null||user===void 0?void 0:user.nome)||c.agente_riferimento===(user===null||user===void 0?void 0:user.nome));// agente_admin prende 70% come agente normale, il 30% va a Pellegrino\nconst rate=type==='agente'||isAgenteAdmin?0.7:0.3;const myVendite=mySales.filter(s=>s.stato==='venduto'||s.stato==='incassato');const totalComm=myVendite.reduce((sum,s)=>sum+Number(s.valore)*(s.commission_pct||5)/100*rate,0);const pagate=myVendite.filter(s=>s.pagato).reduce((sum,s)=>sum+Number(s.valore)*(s.commission_pct||5)/100*rate,0);const byStato=pipelineStati.reduce((acc,st)=>{acc[st]=mySales.filter(s=>(s.stato||'lead')===st);return acc;},{});const tabs=[{id:'home',icon:LayoutDashboard,label:'Home',accent:theme.sections.dashboard.accent},{id:'leads',icon:Target,label:'Lead',accent:theme.sections.pipeline.accent},{id:'pipeline',icon:PieChart,label:'Pipeline',accent:theme.sections.vendite.accent},{id:'offplan',icon:Building2,label:'Off-Plan',accent:theme.sections.offplan.accent,isNew:true},{id:'calculator',icon:Calculator,label:'Calcolatore ROI',accent:theme.sections.calculator.accent,isNew:true},{id:'tasks',icon:ListTodo,label:'Task',accent:theme.sections.tasks.accent,badge:myTasks.length},{id:'settings',icon:Settings,label:'Account',accent:theme.sections.utenti.accent}];// Form View (same for mobile/desktop)\nif(showForm){return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-[#0f172a]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155] px-4 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between max-w-lg mx-auto\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowForm(null),className:\"text-zinc-400 hover:text-white flex items-center gap-2 transition-colors\",children:[/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-5 h-5\"}),\"Indietro\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-semibold\",children:showForm==='lead'?'Nuovo Lead':'Nuova Vendita'}),/*#__PURE__*/_jsx(\"div\",{className:\"w-20\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 pb-32 max-w-lg mx-auto\",children:[showForm==='lead'&&/*#__PURE__*/_jsx(LeadForm,{type:type,userName:user===null||user===void 0?void 0:user.nome,clienti:myClienti,onSubmit:addLead}),showForm==='vendita'&&/*#__PURE__*/_jsx(SaleForm,{type:type,userName:user===null||user===void 0?void 0:user.nome,clienti:myClienti,onSubmit:addSale})]}),/*#__PURE__*/_jsx(\"div\",{className:\"fixed bottom-0 left-0 right-0 p-4 bg-[#0f172a]/95 backdrop-blur-xl border-t border-[#334155]\",children:/*#__PURE__*/_jsx(Button,{onClick:()=>{var _document$getElementB;return(_document$getElementB=document.getElementById('submitBtn'))===null||_document$getElementB===void 0?void 0:_document$getElementB.click();},className:\"w-full py-4\",disabled:submitting,children:submitting?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"w-4 h-4 animate-spin\"}),\" Salvataggio...\"]}):showForm==='lead'?'Salva Lead':'Registra Vendita'})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-[#0f172a] lg:flex\",children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"hidden lg:flex flex-col w-64 border-r border-[#334155] bg-[#1e293b] p-4 fixed h-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"KeyPrime\",className:\"h-16\"})}),/*#__PURE__*/_jsx(\"nav\",{className:\"space-y-1 flex-1\",children:tabs.map(t=>/*#__PURE__*/_jsx(NavItem,{icon:t.icon,label:t.label,active:activeTab===t.id,onClick:()=>setActiveTab(t.id),accent:t.accent,badge:t.badge,isNew:t.isNew},t.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-4 border-t border-[#334155]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 px-2 py-2\",children:[/*#__PURE__*/_jsx(Avatar,{nome:user===null||user===void 0?void 0:user.nome,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium truncate\",children:user===null||user===void 0?void 0:user.nome}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs capitalize\",children:type})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"text-zinc-500 hover:text-white\",children:/*#__PURE__*/_jsx(LogOut,{className:\"w-4 h-4\"})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 lg:ml-64 pb-24 lg:pb-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:hidden sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-4 py-4\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"KeyPrime\",className:\"h-12\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:refreshAllData,className:\"p-2 text-zinc-400 hover:text-white\",title:\"Aggiorna\",children:/*#__PURE__*/_jsx(RefreshCw,{className:\"w-5 h-5 \".concat(loading?'animate-spin':'')})}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowNotifications(true),className:\"relative p-2 text-zinc-400 hover:text-white\",children:[/*#__PURE__*/_jsx(Bell,{className:\"w-5 h-5\"}),notificationCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-0.5 -right-0.5 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\",children:notificationCount})]}),/*#__PURE__*/_jsx(Avatar,{nome:user===null||user===void 0?void 0:user.nome,size:\"sm\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"hidden lg:block sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-6 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold text-white capitalize\",children:activeTab==='home'?\"Ciao, \".concat(user===null||user===void 0?void 0:user.nome):(_tabs$find=tabs.find(t=>t.id===activeTab))===null||_tabs$find===void 0?void 0:_tabs$find.label}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm\",children:[activeTab==='home'&&'Il tuo riepilogo',activeTab==='leads'&&\"\".concat(mySales.length,\" lead totali\"),activeTab==='pipeline'&&'Stato dei tuoi lead',activeTab==='offplan'&&'Progetti Off-Plan',activeTab==='calculator'&&'Calcola rendimenti immobiliari UAE',activeTab==='tasks'&&\"\".concat(myTasks.length,\" task pendenti\")]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowNotifications(true),className:\"relative p-2 text-zinc-400 hover:text-white bg-[#334155] rounded-xl\",children:[/*#__PURE__*/_jsx(Bell,{className:\"w-5 h-5\"}),notificationCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\",children:notificationCount})]}),/*#__PURE__*/_jsx(\"button\",{onClick:refreshAllData,className:\"p-2 text-zinc-400 hover:text-white bg-[#334155] rounded-xl\",title:\"Aggiorna\",children:/*#__PURE__*/_jsx(RefreshCw,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(Button,{onClick:()=>setShowForm('lead'),icon:Plus,children:\"Nuovo Lead\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>setShowForm('vendita'),variant:\"secondary\",icon:DollarSign,children:\"Vendita\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 lg:p-6 space-y-6\",children:[activeTab==='home'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:hidden grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowForm('lead'),className:\"bg-gradient-to-br from-blue-500/20 to-blue-600/10 border border-blue-500/20 rounded-2xl p-5 text-left\",children:[/*#__PURE__*/_jsx(Target,{className:\"w-6 h-6 text-blue-400 mb-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-medium block\",children:\"Nuovo Lead\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowForm('vendita'),className:\"bg-gradient-to-br from-emerald-500/20 to-emerald-600/10 border border-emerald-500/20 rounded-2xl p-5 text-left\",children:[/*#__PURE__*/_jsx(DollarSign,{className:\"w-6 h-6 text-emerald-400 mb-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-medium block\",children:\"Vendita\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-3\",children:[/*#__PURE__*/_jsx(MetricCard,{label:\"Lead Attivi\",value:mySales.filter(s=>s.stato!=='venduto'&&s.stato!=='incassato').length,icon:Target,color:\"#60A5FA\",onClick:()=>setActiveTab('leads')}),/*#__PURE__*/_jsx(MetricCard,{label:\"Vendite (SPA)\",value:myVendite.length,icon:TrendingUp,color:\"#34D399\"}),/*#__PURE__*/_jsx(MetricCard,{label:\"Comm. Maturate\",value:fmt(totalComm),icon:DollarSign,color:\"#FBBF24\"}),/*#__PURE__*/_jsx(MetricCard,{label:\"Comm. Pagate\",value:fmt(pagate),icon:Check,color:\"#34D399\"})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-medium mb-4\",children:\"Pipeline\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:pipelineStati.map(st=>{var _theme$status$st,_theme$status$st2,_byStato$st;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-xl py-3 px-2\",style:{background:((_theme$status$st=theme.status[st])===null||_theme$status$st===void 0?void 0:_theme$status$st.bg)||'#334155'},children:/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",style:{color:((_theme$status$st2=theme.status[st])===null||_theme$status$st2===void 0?void 0:_theme$status$st2.color)||'#fff'},children:((_byStato$st=byStato[st])===null||_byStato$st===void 0?void 0:_byStato$st.length)||0})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 mt-2\",children:pipelineLabels[st]||st})]},st);})})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-medium\",children:\"Commissioni\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400 text-sm\",children:[fmt(totalComm),\" AED maturate\"]})]}),/*#__PURE__*/_jsx(ProgressBar,{value:pagate,max:totalComm||1,color:\"#34D399\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mt-3 text-sm\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400\",children:[\"\\u2713 Pagate: \",fmt(pagate),\" AED\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-amber-400\",children:[\"\\u23F3 Pending: \",fmt(totalComm-pagate),\" AED\"]})]})]}),myTasks.length>0&&/*#__PURE__*/_jsx(Card,{hover:true,onClick:()=>setActiveTab('tasks'),className:\"border-pink-500/20 bg-pink-500/5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-xl bg-pink-500/20 flex items-center justify-center\",children:/*#__PURE__*/_jsx(ListTodo,{className:\"w-6 h-6 text-pink-400\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-medium\",children:[myTasks.length,\" task da completare\"]})}),/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5 text-zinc-500\"})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-white\",children:\"Lead Aperti\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('leads'),className:\"text-sm text-violet-400\",children:\"Tutti \\u2192\"})]}),mySales.filter(s=>s.stato==='lead'||s.stato==='trattativa'||s.stato==='EOI').length===0?/*#__PURE__*/_jsx(Card,{padding:\"p-6\",className:\"text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500\",children:\"Nessun lead aperto\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-3 lg:grid-cols-2\",children:mySales.filter(s=>s.stato==='lead'||s.stato==='trattativa'||s.stato==='EOI').slice(0,4).map(s=>{var _theme$status2;return/*#__PURE__*/_jsx(Card,{hover:true,onClick:()=>setShowLeadDetail(s),padding:\"p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1 h-12 rounded-full\",style:{background:(_theme$status2=theme.status[s.stato||'lead'])===null||_theme$status2===void 0?void 0:_theme$status2.color}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium truncate\",children:s.progetto}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:s.developer})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-emerald-400 font-medium\",children:s.valore>0?fmt(s.valore):'TBD'}),/*#__PURE__*/_jsx(StatusBadge,{status:s.stato||'lead'})]})]})},s.id);})})]}),myVendite.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-between items-center mb-4\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-white\",children:\"\\uD83C\\uDF89 Vendite Confermate\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-3 lg:grid-cols-2\",children:myVendite.slice(0,4).map(s=>/*#__PURE__*/_jsx(Card,{hover:true,onClick:()=>setShowLeadDetail(s),padding:\"p-4\",className:\"border-emerald-500/20\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1 h-12 rounded-full bg-emerald-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium truncate\",children:s.progetto}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:s.developer})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-emerald-400 font-medium\",children:fmt(s.valore)}),/*#__PURE__*/_jsx(StatusBadge,{status:s.stato})]})]})},s.id))})]})]}),activeTab==='leads'&&/*#__PURE__*/_jsx(LeadsTableView,{leads:mySales,clienti:clienti,onSelectLead:setShowLeadDetail,onUpdateStatus:(id,stato)=>updateSale(id,{stato}),onDelete:deleteSale,theme:theme,users:[],isAdmin:false}),activeTab==='pipeline'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-3\",children:pipelineStati.map(st=>{var _theme$status$st3,_byStato$st2;return/*#__PURE__*/_jsxs(Card,{padding:\"p-4\",className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold\",style:{color:(_theme$status$st3=theme.status[st])===null||_theme$status$st3===void 0?void 0:_theme$status$st3.color},children:((_byStato$st2=byStato[st])===null||_byStato$st2===void 0?void 0:_byStato$st2.length)||0}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 mt-1\",children:pipelineLabels[st]||st})]},st);})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4\",children:pipelineStati.map(st=>{var _theme$status$st4,_byStato$st3;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded-full\",style:{background:(_theme$status$st4=theme.status[st])===null||_theme$status$st4===void 0?void 0:_theme$status$st4.color}}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-medium text-sm\",children:pipelineLabels[st]||st}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-500 text-xs\",children:[\"(\",((_byStato$st3=byStato[st])===null||_byStato$st3===void 0?void 0:_byStato$st3.length)||0,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[(byStato[st]||[]).map(s=>{var _theme$status$st5;return/*#__PURE__*/_jsxs(Card,{hover:true,onClick:()=>setShowLeadDetail(s),padding:\"p-3\",className:\"border-l-2\",style:{borderLeftColor:(_theme$status$st5=theme.status[st])===null||_theme$status$st5===void 0?void 0:_theme$status$st5.color},children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium truncate\",children:s.progetto}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:s.developer}),s.valore>0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-emerald-400 text-sm mt-1\",children:fmt(s.valore)})]},s.id);}),(!byStato[st]||byStato[st].length===0)&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-zinc-600 text-xs\",children:\"Nessun lead\"})]})]},st);})})]}),activeTab==='tasks'&&/*#__PURE__*/_jsx(AgentTasksTab,{tasks:myTasks,allTasks:tasks.filter(t=>t.assegnato_a===(user===null||user===void 0?void 0:user.nome)),clienti:clienti,onComplete:completeTask,onAddNote:t=>setShowNoteModal(t)}),activeTab==='offplan'&&/*#__PURE__*/_jsx(OffPlanTab,{clienti:myClienti,onCreateLead:createLeadFromListing,savedListings:savedListings,onSaveListing:saveListing,onRemoveListing:removeListing,user:user}),activeTab==='calculator'&&/*#__PURE__*/_jsx(ROICalculator,{}),activeTab==='settings'&&/*#__PURE__*/_jsxs(Card,{className:\"max-w-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-6\",children:[/*#__PURE__*/_jsx(Avatar,{nome:user===null||user===void 0?void 0:user.nome,size:\"lg\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-white\",children:user===null||user===void 0?void 0:user.nome}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500\",children:type})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",icon:Key,onClick:()=>setShowPasswordModal(true),className:\"w-full justify-start\",children:\"Cambia Password\"}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",icon:LogOut,onClick:handleLogout,className:\"w-full justify-start\",children:\"Esci\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:hidden fixed bottom-0 left-0 right-0 bg-[#0f172a]/95 backdrop-blur-xl border-t border-[#334155] px-4 py-2 z-30\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-around\",children:tabs.map(t=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab(t.id),className:\"flex flex-col items-center py-2 px-3 \".concat(activeTab===t.id?'text-white':'text-zinc-500'),children:[/*#__PURE__*/_jsx(t.icon,{className:\"w-6 h-6\",style:activeTab===t.id?{color:t.accent}:{}}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs mt-1\",children:t.label})]},t.id))})})]}),showLeadDetail&&/*#__PURE__*/_jsx(LeadDetailSheet,{sale:showLeadDetail,cliente:clienti.find(c=>c.id===(showLeadDetail===null||showLeadDetail===void 0?void 0:showLeadDetail.cliente_id)),rate:rate,onClose:()=>setShowLeadDetail(null),onUpdateSale:updateSale,onConvert:()=>setConvertingSale(showLeadDetail),activities:activities.filter(a=>a.sale_id===(showLeadDetail===null||showLeadDetail===void 0?void 0:showLeadDetail.id)),followUps:followUps.filter(f=>f.sale_id===(showLeadDetail===null||showLeadDetail===void 0?void 0:showLeadDetail.id)),onAddActivity:addActivity,onCreateFollowUp:createFollowUp,onCompleteFollowUp:completeFollowUp,onDeleteActivity:deleteActivity,onDeleteFollowUp:deleteFollowUp,userName:user===null||user===void 0?void 0:user.nome}),convertingSale&&/*#__PURE__*/_jsx(ConvertModal,{sale:convertingSale,onConvert:convertLeadToSale,onCancel:()=>setConvertingSale(null)}),showNotifications&&/*#__PURE__*/_jsx(NotificationsPanel,{tasks:notificationTasks,unreadIds:unreadNotificationIds,recentSales:recentSalesNotifications,onClose:()=>{setShowNotifications(false);},onGoToTask:()=>{setShowNotifications(false);setActiveTab('tasks');},onMarkAsRead:markSingleNotificationAsRead,userId:user===null||user===void 0?void 0:user.id}),showPasswordModal&&/*#__PURE__*/_jsx(PasswordModal,{currentPassword:user===null||user===void 0?void 0:user.password,onSave:changePassword,onClose:()=>setShowPasswordModal(false)}),showNoteModal&&/*#__PURE__*/_jsx(NoteModal,{task:showNoteModal,onSave:addTaskNote,onClose:()=>setShowNoteModal(null)}),toast&&/*#__PURE__*/_jsx(Toast,{message:toast.message,type:toast.type,onClose:()=>setToast(null)})]});}// ==================== ADMIN VIEW ====================\nif(view==='admin'){// Period filter logic\nconst getFilteredByPeriod=salesData=>{if(periodFilter==='all')return salesData;const days=parseInt(periodFilter);const cutoff=new Date();cutoff.setDate(cutoff.getDate()-days);return salesData.filter(s=>s.data&&new Date(s.data)>=cutoff);};const periodSales=getFilteredByPeriod(sales);const vendite=periodSales.filter(s=>s.stato==='venduto'||s.stato==='incassato');const totals=periodSales.reduce((a,s)=>{const c=Number(s.valore)*(s.commission_pct||5)/100;// Check if agent is agente_admin\nconst agentUser=users.find(u=>u.nome===s.agente&&(u.ruolo==='agente'||u.ruolo==='agente_admin'));const isAgenteAdmin=(agentUser===null||agentUser===void 0?void 0:agentUser.ruolo)==='agente_admin';let ag,sg,p,g;if(isAgenteAdmin){if(s.referente==='Giovanni'){// REF = G → Giovanni 70%, Pellegrino 30%\nag=c*0.7;sg=0;g=0;// Giovanni già prende come agente\np=c*0.3;}else{// REF = P → Giovanni diventa segnalatore (30%), Pellegrino 70%\nag=c*0.3;// Giovanni prende solo 30%\nsg=0;g=0;p=c*0.7;// Pellegrino prende 70%\n}}else{// Agenti normali - logica originale\nag=s.agente?c*0.7:0;sg=s.segnalatore?c*0.3:0;const n=c-ag-sg;p=s.referente==='Pellegrino'?n*0.7:s.referente==='Giovanni'?n*0.3:0;g=s.referente==='Giovanni'?n*0.7:s.referente==='Pellegrino'?n*0.3:0;}const n=isAgenteAdmin?0:c-ag-(s.segnalatore?c*0.3:0);return{valore:a.valore+Number(s.valore),comm:a.comm+c,ag:a.ag+ag,sg:a.sg+(s.segnalatore&&!isAgenteAdmin?c*0.3:0),netto:a.netto+n,pell:a.pell+p,giov:a.giov+g};},{valore:0,comm:0,ag:0,sg:0,netto:0,pell:0,giov:0});const byStato=pipelineStati.reduce((a,st)=>{a[st]=periodSales.filter(s=>(s.stato||'lead')===st);return a;},{});const byMonth=periodSales.reduce((a,s)=>{var _s$data;const m=((_s$data=s.data)===null||_s$data===void 0?void 0:_s$data.substring(0,7))||'N/A';a[m]=(a[m]||0)+Number(s.valore);return a;},{});const byAgente=periodSales.reduce((a,s)=>{if(s.agente)a[s.agente]=(a[s.agente]||0)+Number(s.valore);return a;},{});const byZona=periodSales.reduce((a,s)=>{if(s.zona)a[s.zona]=(a[s.zona]||0)+Number(s.valore);return a;},{});const pendingTasks=tasks.filter(t=>t.stato==='pending');const tabs=[{id:'dashboard',icon:LayoutDashboard,label:'Dashboard',accent:theme.sections.dashboard.accent},{id:'commissioni',icon:Award,label:'Commissioni',accent:'#10B981'},{id:'vendite',icon:DollarSign,label:'Vendite',accent:theme.sections.vendite.accent},{id:'pipeline',icon:PieChart,label:'Pipeline',accent:theme.sections.pipeline.accent},{id:'crm',icon:Users,label:'CRM',accent:theme.sections.crm.accent},{id:'offplan',icon:Building2,label:'Off-Plan',accent:theme.sections.offplan.accent,isNew:true},{id:'calculator',icon:Calculator,label:'Calcolatore ROI',accent:theme.sections.calculator.accent,isNew:true},{id:'tasks',icon:ListTodo,label:'Task',accent:theme.sections.tasks.accent,badge:pendingTasks.length},{id:'followups',icon:Clock,label:'Follow-up',accent:'#A855F7',badge:todayFollowUps.length+overdueFollowUps.length},{id:'utenti',icon:Settings,label:'Team',accent:theme.sections.utenti.accent}];return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-[#0f172a] flex\",children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"hidden lg:flex flex-col w-64 border-r border-[#334155] bg-[#1e293b] p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"KeyPrime\",className:\"h-20\"})}),/*#__PURE__*/_jsx(\"nav\",{className:\"space-y-1 flex-1\",children:tabs.map(t=>/*#__PURE__*/_jsx(NavItem,{icon:t.icon,label:t.label,active:activeTab===t.id,onClick:()=>{setActiveTab(t.id);setShowClienteDetail(null);},accent:t.accent,badge:t.badge,isNew:t.isNew},t.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-[#334155] pt-4 mt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 px-4 py-3\",children:[/*#__PURE__*/_jsx(Avatar,{nome:user===null||user===void 0?void 0:user.nome,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-white truncate\",children:user===null||user===void 0?void 0:user.nome}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Admin\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"text-zinc-500 hover:text-white transition-colors\",children:/*#__PURE__*/_jsx(LogOut,{className:\"w-4 h-4\"})})]})})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"flex-1 overflow-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:hidden sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-4 py-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMobileMenuOpen(true),className:\"text-zinc-400\",children:/*#__PURE__*/_jsx(Menu,{className:\"w-6 h-6\"})}),/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"KeyPrime\",className:\"h-16\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:refreshAllData,className:\"text-zinc-400 hover:text-white\",title:\"Aggiorna\",children:/*#__PURE__*/_jsx(RefreshCw,{className:\"w-5 h-5 \".concat(loading?'animate-spin':'')})}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowNotifications(true),className:\"relative text-zinc-400\",children:[/*#__PURE__*/_jsx(Bell,{className:\"w-5 h-5\"}),notificationCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center\",children:notificationCount})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-1 px-4 pb-3 overflow-x-auto\",children:tabs.map(t=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setActiveTab(t.id);setShowClienteDetail(null);},className:\"flex items-center gap-2 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all \".concat(activeTab===t.id?'text-white':'text-zinc-500 hover:text-white'),style:activeTab===t.id?{background:\"\".concat(t.accent,\"20\"),color:t.accent}:{},children:[/*#__PURE__*/_jsx(t.icon,{className:\"w-4 h-4\"}),t.label,t.badge>0&&/*#__PURE__*/_jsx(\"span\",{className:\"px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full\",children:t.badge})]},t.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"hidden lg:flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold text-white capitalize\",children:activeTab}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm mt-1\",children:[activeTab==='dashboard'&&'Panoramica generale',activeTab==='vendite'&&\"\".concat(sales.length,\" transazioni totali\"),activeTab==='pipeline'&&'Gestisci il flusso di vendita',activeTab==='crm'&&\"\".concat(clienti.length,\" clienti in database\"),activeTab==='offplan'&&\"Progetti Off-Plan \\u2022 \".concat(savedListings.length,\" salvati\"),activeTab==='calculator'&&'Calcola rendimenti immobiliari UAE',activeTab==='tasks'&&\"\".concat(pendingTasks.length,\" task da completare\"),activeTab==='followups'&&\"\".concat(todayFollowUps.length+overdueFollowUps.length,\" follow-up da gestire\"),activeTab==='commissioni'&&\"\".concat(fmt(totals.comm),\" AED commissioni totali\"),activeTab==='utenti'&&\"\".concat(users.length,\" membri del team\")]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowGlobalSearch(true),className:\"hidden lg:flex items-center gap-2 px-4 py-2 bg-zinc-700/50 hover:bg-zinc-700 rounded-xl text-zinc-400 text-sm transition-colors\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Cerca...\"}),/*#__PURE__*/_jsx(\"kbd\",{className:\"ml-2 px-1.5 py-0.5 bg-zinc-700 rounded text-xs\",children:\"\\u2318K\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowNotifications(true),className:\"relative p-2 text-zinc-400 hover:text-white transition-colors\",children:[/*#__PURE__*/_jsx(Bell,{className:\"w-5 h-5\"}),notificationCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-0.5 -right-0.5 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\",children:notificationCount})]}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",icon:RefreshCw,onClick:refreshAllData,children:\"Aggiorna\"})]})]}),activeTab==='dashboard'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center justify-between gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:[{id:'all',label:'Tutto'},{id:'30',label:'30 giorni'},{id:'60',label:'60 giorni'},{id:'90',label:'90 giorni'}].map(p=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPeriodFilter(p.id),className:\"px-4 py-2 rounded-xl text-sm font-medium transition-all \".concat(periodFilter===p.id?'bg-violet-500/20 text-violet-400':'bg-zinc-700/50 text-zinc-400 hover:text-white'),children:p.label},p.id))}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",icon:Printer,onClick:()=>generateDashboardPDF(totals,periodSales,vendite,byAgente,byZona),children:\"Esporta Report\"})]}),(todayTasks.length>0||overdueTasks.length>0)&&/*#__PURE__*/_jsx(Card,{hover:true,onClick:()=>setActiveTab('tasks'),className:\"border-pink-500/20\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-xl bg-pink-500/20 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Bell,{className:\"w-6 h-6 text-pink-400\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:\"Task in scadenza\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm\",children:[overdueTasks.length>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-400\",children:[overdueTasks.length,\" scaduti\"]}),overdueTasks.length>0&&todayTasks.length>0&&' • ',todayTasks.length>0&&/*#__PURE__*/_jsxs(\"span\",{children:[todayTasks.length,\" oggi\"]})]})]}),/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5 text-zinc-500\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsx(MetricCard,{label:\"Volume Totale\",value:totals.valore,subValue:\"AED\",icon:DollarSign,color:\"#A78BFA\",onClick:()=>setActiveTab('vendite')}),/*#__PURE__*/_jsx(MetricCard,{label:\"Lead Totali\",value:sales.length,icon:Target,color:\"#60A5FA\",onClick:()=>setActiveTab('pipeline')}),/*#__PURE__*/_jsx(MetricCard,{label:\"Vendite Chiuse\",value:vendite.length,icon:TrendingUp,color:\"#34D399\",onClick:()=>setActiveTab('vendite')}),/*#__PURE__*/_jsx(MetricCard,{label:\"Netto KeyPrime\",value:totals.netto,subValue:\"AED\",icon:Sparkles,color:\"#FBBF24\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Commissioni Tot\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-emerald-400 mt-1\",children:fmt(totals.comm)})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Agenti 70%\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-blue-400 mt-1\",children:fmt(totals.ag)})]}),/*#__PURE__*/_jsxs(Card,{className:\"border-green-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Pellegrino\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-green-400 mt-1\",children:fmt(totals.pell)})]}),/*#__PURE__*/_jsxs(Card,{className:\"border-orange-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Giovanni\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-orange-400 mt-1\",children:fmt(totals.giov)})]})]}),/*#__PURE__*/_jsxs(Card,{hover:true,onClick:()=>setActiveTab('pipeline'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold\",children:\"Pipeline\"}),/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5 text-zinc-500\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:Object.entries(byStato).map(_ref17=>{var _theme$status$st6,_theme$status$st7;let[st,items]=_ref17;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 rounded-xl\",style:{background:(_theme$status$st6=theme.status[st])===null||_theme$status$st6===void 0?void 0:_theme$status$st6.bg},children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-semibold text-white\",children:items.length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs\",style:{color:(_theme$status$st7=theme.status[st])===null||_theme$status$st7===void 0?void 0:_theme$status$st7.color},children:pipelineLabels[st]||st})]},st);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid lg:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Award,{className:\"w-5 h-5 text-amber-400\"}),\"Top Agenti\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[Object.entries(byAgente).sort((a,b)=>b[1]-a[1]).slice(0,5).map((_ref18,i)=>{let[name,value]=_ref18;return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>setShowAgentDetail({name,type:'agente'}),className:\"flex items-center gap-3 p-2 -mx-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold \".concat(i===0?'bg-amber-500 text-black':'bg-zinc-700/50 text-zinc-400'),children:i+1}),/*#__PURE__*/_jsx(Avatar,{nome:name,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm\",children:name}),/*#__PURE__*/_jsx(ProgressBar,{value:value,max:Object.values(byAgente).sort((a,b)=>b-a)[0]||1,color:i===0?'#FBBF24':'#52525B',height:\"h-1\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400 text-sm\",children:fmt(value)}),/*#__PURE__*/_jsx(ChevronRight,{className:\"w-4 h-4 text-zinc-600\"})]},name);}),Object.keys(byAgente).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm text-center py-4\",children:\"Nessun dato\"})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-5 h-5 text-emerald-400\"}),\"Top Zone\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[Object.entries(byZona).sort((a,b)=>b[1]-a[1]).slice(0,5).map((_ref19,i)=>{let[zona,value]=_ref19;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold \".concat(i===0?'bg-emerald-500 text-black':'bg-zinc-700/50 text-zinc-400'),children:i+1}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm\",children:zona}),/*#__PURE__*/_jsx(ProgressBar,{value:value,max:Object.values(byZona).sort((a,b)=>b-a)[0]||1,color:i===0?'#34D399':'#52525B',height:\"h-1\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400 text-sm\",children:fmt(value)})]},zona);}),Object.keys(byZona).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm text-center py-4\",children:\"Nessun dato\"})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-5 h-5 text-violet-400\"}),\"Trend Mensile\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[Object.entries(byMonth).sort((a,b)=>a[0].localeCompare(b[0])).slice(-5).map(_ref20=>{let[month,value]=_ref20;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 text-sm w-16\",children:month}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsx(ProgressBar,{value:value,max:Math.max(...Object.values(byMonth))||1,color:\"#A78BFA\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm w-20 text-right\",children:fmt(value)})]},month);}),Object.keys(byMonth).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm text-center py-4\",children:\"Nessun dato\"})]})]})]})]}),activeTab==='dashboard'&&showAgentDetail&&/*#__PURE__*/_jsx(AgentDetailView,{agent:showAgentDetail,sales:periodSales,onBack:()=>setShowAgentDetail(null)}),activeTab==='vendite'&&/*#__PURE__*/_jsx(VenditeTab,{sales:filteredSales,filters:filters,setFilters:setFilters,updateSale:updateSale,deleteSale:deleteSale,loading:loading}),activeTab==='pipeline'&&/*#__PURE__*/_jsx(PipelineTab,{byStato:byStato,onSelectLead:setShowLeadDetail,onUpdateSaleStatus:(id,stato)=>updateSale(id,{stato})}),activeTab==='crm'&&(showClienteDetail?/*#__PURE__*/_jsx(ClienteDetailView,{cliente:showClienteDetail,sales:sales.filter(s=>s.cliente_id===showClienteDetail.id),tasks:tasks.filter(t=>t.cliente_id===showClienteDetail.id),onBack:()=>setShowClienteDetail(null),onEdit:()=>setShowClienteModal(showClienteDetail),onDelete:()=>deleteCliente(showClienteDetail.id),updateCliente:updateCliente,onAddTask:()=>setShowTaskModal({cliente_id:showClienteDetail.id}),onCompleteTask:completeTask,onDeleteTask:deleteTask,onExportPDF:()=>generateClientePDF(showClienteDetail,sales.filter(s=>s.cliente_id===showClienteDetail.id),tasks.filter(t=>t.cliente_id===showClienteDetail.id))}):/*#__PURE__*/_jsx(CRMTab,{clienti:filteredClienti,filters:clienteFilters,setFilters:setClienteFilters,sales:sales,onSelect:setShowClienteDetail,onCreate:()=>setShowClienteModal({}),onDelete:deleteCliente,onUpdateCliente:updateCliente,users:users})),activeTab==='offplan'&&/*#__PURE__*/_jsx(OffPlanTab,{clienti:clienti,onCreateLead:createLeadFromListing,savedListings:savedListings,onSaveListing:saveListing,onRemoveListing:removeListing,user:user}),activeTab==='calculator'&&/*#__PURE__*/_jsx(ROICalculator,{}),activeTab==='tasks'&&/*#__PURE__*/_jsx(AdminTasksTab,{tasks:tasks,clienti:clienti,users:users,onComplete:completeTask,onDelete:deleteTask,onEdit:setShowTaskModal,onCreate:()=>setShowTaskModal({})}),activeTab==='followups'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(Card,{className:\"border-red-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Scaduti\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-red-400 mt-1\",children:overdueFollowUps.length})]}),/*#__PURE__*/_jsxs(Card,{className:\"border-purple-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Oggi\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-purple-400 mt-1\",children:todayFollowUps.length})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Prossimi 7 giorni\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-white mt-1\",children:myFollowUps.filter(f=>{const d=new Date(f.data_reminder);const today=new Date();const week=new Date();week.setDate(today.getDate()+7);return d>=today&&d<=week;}).length})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Totale Attivi\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-white mt-1\",children:myFollowUps.length})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between mb-4\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold\",children:\"Follow-up Programmati\"})}),myFollowUps.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:myFollowUps.map(f=>{const sale=sales.find(s=>s.id===f.sale_id);const cliente=clienti.find(c=>c.id===f.cliente_id);const isOverdueF=new Date(f.data_reminder)<new Date();const isTodayF=new Date(f.data_reminder).toDateString()===new Date().toDateString();return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 rounded-xl border \".concat(isOverdueF?'bg-red-500/10 border-red-500/30':isTodayF?'bg-purple-500/10 border-purple-500/30':'bg-zinc-800/50 border-zinc-800'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-10 h-10 rounded-full flex items-center justify-center \".concat(isOverdueF?'bg-red-500/20':isTodayF?'bg-purple-500/20':'bg-zinc-700'),children:[f.tipo==='call'&&'📞',f.tipo==='email'&&'📧',f.tipo==='whatsapp'&&'💬',f.tipo==='meeting'&&'🤝',f.tipo==='viewing'&&'🏠',!f.tipo&&'⏰']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:cliente?\"\".concat(cliente.nome,\" \").concat(cliente.cognome):'Cliente'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm\",children:(sale===null||sale===void 0?void 0:sale.progetto)||'Lead'}),f.nota&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:f.nota})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium \".concat(isOverdueF?'text-red-400':isTodayF?'text-purple-400':'text-white'),children:new Date(f.data_reminder).toLocaleDateString('it-IT',{day:'numeric',month:'short'})}),f.ora_reminder&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:f.ora_reminder.slice(0,5)}),isOverdueF&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-400 text-xs font-medium\",children:\"SCADUTO\"}),isTodayF&&!isOverdueF&&/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-400 text-xs font-medium\",children:\"OGGI\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>completeFollowUp(f.id),className:\"p-2 text-zinc-500 hover:text-green-400 transition-colors\",title:\"Completa\",children:/*#__PURE__*/_jsx(Check,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteFollowUp(f.id),className:\"p-2 text-zinc-500 hover:text-red-400 transition-colors\",title:\"Elimina\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})]})]})},f.id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-center py-8\",children:\"Nessun follow-up programmato\"})]})]}),activeTab==='commissioni'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:[{id:'all',label:'Tutto'},{id:'30',label:'30 giorni'},{id:'90',label:'90 giorni'},{id:'365',label:'Anno'}].map(p=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPeriodFilter(p.id),className:\"px-4 py-2 rounded-xl text-sm font-medium transition-all \".concat(periodFilter===p.id?'bg-emerald-500/20 text-emerald-400':'bg-zinc-700/50 text-zinc-400 hover:text-white'),children:p.label},p.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(Card,{className:\"border-emerald-500/20 bg-emerald-500/5\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm\",children:\"Commissioni Totali\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-emerald-400 mt-2\",children:fmt(totals.comm)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"AED\"})]}),/*#__PURE__*/_jsxs(Card,{className:\"border-green-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm\",children:\"\\uD83D\\uDCB0 Pellegrino\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-green-400 mt-2\",children:fmt(totals.pell)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Quota netta\"})]}),/*#__PURE__*/_jsxs(Card,{className:\"border-orange-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm\",children:\"\\uD83D\\uDCB0 Giovanni\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-orange-400 mt-2\",children:fmt(totals.giov)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Quota netta\"})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm\",children:\"Agenti (70%)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-blue-400 mt-2\",children:fmt(totals.ag)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Da pagare\"})]})]}),(()=>{const venduteSales=periodSales.filter(s=>s.stato==='venduto'||s.stato==='incassato');const maturate=venduteSales.reduce((sum,s)=>sum+Number(s.valore)*(s.commission_pct||5)/100,0);const pagate=venduteSales.filter(s=>s.pagato).reduce((sum,s)=>sum+Number(s.valore)*(s.commission_pct||5)/100,0);const daPagare=maturate-pagate;const percentPaid=maturate>0?pagate/maturate*100:0;return/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold mb-4\",children:\"Stato Pagamenti\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-emerald-500/10 rounded-xl\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-emerald-400 text-2xl font-bold\",children:fmt(maturate)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Maturate\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-green-500/10 rounded-xl\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-green-400 text-2xl font-bold\",children:fmt(pagate)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Pagate \\u2713\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-amber-500/10 rounded-xl\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-amber-400 text-2xl font-bold\",children:fmt(daPagare)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Da Pagare\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative h-4 bg-zinc-700/50 rounded-full overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-0 top-0 h-full bg-gradient-to-r from-green-500 to-emerald-400 rounded-full transition-all duration-500\",style:{width:\"\".concat(percentPaid,\"%\")}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-medium text-white drop-shadow\",children:[percentPaid.toFixed(0),\"% pagato\"]})})]})]});})(),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold mb-4\",children:\"Commissioni per Agente\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:Object.entries(periodSales.filter(s=>s.stato==='venduto'||s.stato==='incassato').reduce((acc,s)=>{const agente=s.agente||'Non assegnato';if(!acc[agente])acc[agente]={totale:0,pagate:0,count:0};const comm=Number(s.valore)*(s.commission_pct||5)/100*0.7;acc[agente].totale+=comm;if(s.pagato)acc[agente].pagate+=comm;acc[agente].count++;return acc;},{})).sort((a,b)=>b[1].totale-a[1].totale).map(_ref21=>{let[agente,data]=_ref21;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-zinc-800/50 rounded-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Avatar,{nome:agente,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:agente}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-xs\",children:[data.count,\" vendite\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-400 font-semibold\",children:[fmt(data.totale),\" AED\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-xs\",children:[data.pagate>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-400\",children:[fmt(data.pagate),\" pagati\"]}),data.totale-data.pagate>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-amber-400 ml-2\",children:[fmt(data.totale-data.pagate),\" pending\"]})]})]})]},agente);})})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold mb-4\",children:\"Dettaglio Vendite\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-left text-zinc-500 text-xs border-b border-zinc-800\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"pb-3\",children:\"Progetto\"}),/*#__PURE__*/_jsx(\"th\",{className:\"pb-3\",children:\"Agente\"}),/*#__PURE__*/_jsx(\"th\",{className:\"pb-3 text-right\",children:\"Valore\"}),/*#__PURE__*/_jsx(\"th\",{className:\"pb-3 text-right\",children:\"Comm.\"}),/*#__PURE__*/_jsx(\"th\",{className:\"pb-3 text-center\",children:\"Stato\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-zinc-800\",children:periodSales.filter(s=>s.stato==='venduto'||s.stato==='incassato').slice(0,20).map(s=>{const comm=Number(s.valore)*(s.commission_pct||5)/100;return/*#__PURE__*/_jsxs(\"tr\",{className:\"text-sm\",children:[/*#__PURE__*/_jsxs(\"td\",{className:\"py-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:s.progetto}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:s.zona})]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 text-zinc-300\",children:s.agente||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 text-right text-white\",children:fmt(s.valore)}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 text-right text-emerald-400\",children:fmt(comm)}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 text-center\",children:s.pagato?/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full\",children:\"Pagata \\u2713\"}):/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-amber-500/20 text-amber-400 text-xs rounded-full\",children:\"Pending\"})})]},s.id);})})]})})]})]}),activeTab==='utenti'&&/*#__PURE__*/_jsx(TeamTab,{users:users,onCreate:()=>setShowUserModal({}),onEdit:setShowUserModal,onDelete:deleteUser})]})]}),mobileMenuOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 lg:hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800/60\",onClick:()=>setMobileMenuOpen(false)}),/*#__PURE__*/_jsxs(\"aside\",{className:\"absolute left-0 top-0 bottom-0 w-72 bg-[#1e293b] p-4 animate-slideRight\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"KeyPrime\",className:\"h-16\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMobileMenuOpen(false),className:\"text-zinc-400\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"nav\",{className:\"space-y-1\",children:tabs.map(t=>/*#__PURE__*/_jsx(NavItem,{icon:t.icon,label:t.label,active:activeTab===t.id,onClick:()=>{setActiveTab(t.id);setMobileMenuOpen(false);setShowClienteDetail(null);},accent:t.accent,badge:t.badge,isNew:t.isNew},t.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-4 left-4 right-4\",children:/*#__PURE__*/_jsx(Button,{variant:\"danger\",icon:LogOut,onClick:handleLogout,className:\"w-full\",children:\"Esci\"})})]})]}),showLeadDetail&&/*#__PURE__*/_jsx(LeadDetailSheet,{sale:showLeadDetail,cliente:clienti.find(c=>c.id===(showLeadDetail===null||showLeadDetail===void 0?void 0:showLeadDetail.cliente_id)),rate:0.7,onClose:()=>setShowLeadDetail(null),onUpdateSale:updateSale,onConvert:()=>setConvertingSale(showLeadDetail),isAdmin:true,activities:activities.filter(a=>a.sale_id===(showLeadDetail===null||showLeadDetail===void 0?void 0:showLeadDetail.id)),followUps:followUps.filter(f=>f.sale_id===(showLeadDetail===null||showLeadDetail===void 0?void 0:showLeadDetail.id)),onAddActivity:addActivity,onCreateFollowUp:createFollowUp,onCompleteFollowUp:completeFollowUp,onDeleteActivity:deleteActivity,onDeleteFollowUp:deleteFollowUp,userName:user===null||user===void 0?void 0:user.nome}),convertingSale&&/*#__PURE__*/_jsx(ConvertModal,{sale:convertingSale,onConvert:convertLeadToSale,onCancel:()=>setConvertingSale(null)}),showClienteModal&&/*#__PURE__*/_jsx(ClienteModal,{cliente:showClienteModal.id?showClienteModal:null,onSave:showClienteModal.id?d=>updateCliente(showClienteModal.id,d):createCliente,onClose:()=>setShowClienteModal(null)}),showTaskModal&&/*#__PURE__*/_jsx(TaskModal,{task:showTaskModal.id?showTaskModal:null,clienti:clienti,users:users,onSave:showTaskModal.id?d=>updateTask(showTaskModal.id,d):createTask,onClose:()=>setShowTaskModal(null)}),showUserModal&&/*#__PURE__*/_jsx(UserModal,{user:showUserModal.id?showUserModal:null,onSave:showUserModal.id?d=>updateUser(showUserModal.id,d):createUser,onClose:()=>setShowUserModal(null)}),showNotifications&&/*#__PURE__*/_jsx(NotificationsPanel,{tasks:notificationTasks,unreadIds:unreadNotificationIds,recentSales:recentSalesNotifications,onClose:()=>{setShowNotifications(false);},onGoToTask:()=>{setShowNotifications(false);setActiveTab('tasks');},onMarkAsRead:markSingleNotificationAsRead,userId:user===null||user===void 0?void 0:user.id}),showGlobalSearch&&/*#__PURE__*/_jsx(GlobalSearch,{isOpen:showGlobalSearch,onClose:()=>setShowGlobalSearch(false),sales:sales,clienti:clienti,tasks:tasks,onSelectSale:setShowLeadDetail,onSelectCliente:setShowClienteDetail,onSelectTask:()=>setActiveTab('tasks'),setActiveTab:setActiveTab}),toast&&/*#__PURE__*/_jsx(Toast,{message:toast.message,type:toast.type,onClose:()=>setToast(null)})]});}return null;}// ==================== TAB COMPONENTS ====================\n// Vendite Tab\nfunction VenditeTab(_ref22){let{sales,filters,setFilters,updateSale,deleteSale,loading}=_ref22;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex-1 min-w-[200px]\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cerca progetto, cliente, agente...\",value:filters.search,onChange:e=>setFilters(_objectSpread(_objectSpread({},filters),{},{search:e.target.value})),className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-2.5 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-emerald-500/50\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.stato,onChange:e=>setFilters(_objectSpread(_objectSpread({},filters),{},{stato:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-emerald-500/50\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutti gli stati\"}),pipelineStati.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:pipelineLabels[s]||s},s))]})]}),/*#__PURE__*/_jsxs(Card,{padding:\"p-0\",className:\"overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Data\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Progetto\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Zona\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Cliente\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Agente\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-right text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Valore\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"%\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Stato\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Ref\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\",children:\"Pag\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-[#334155]\",children:sales.map(s=>{var _theme$status3,_theme$status4;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-white/5 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-zinc-400\",children:fmtShort(s.data)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm font-medium\",children:s.progetto}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-zinc-500\",children:s.developer})]}),s.note&&/*#__PURE__*/_jsx(\"span\",{title:s.note,className:\"text-amber-400 cursor-help\",children:/*#__PURE__*/_jsx(FileText,{className:\"w-3.5 h-3.5\"})}),s.pf_url&&/*#__PURE__*/_jsx(\"a\",{href:s.pf_url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-blue-400 hover:text-blue-300\",children:/*#__PURE__*/_jsx(ExternalLink,{className:\"w-3.5 h-3.5\"})})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-zinc-400\",children:s.zona||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-blue-400\",children:s.cliente_nome||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-zinc-400\",children:s.agente||s.segnalatore||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-right text-sm font-medium text-white\",children:s.valore>0?fmt(s.valore):'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsx(\"select\",{value:s.commission_pct||5,onChange:e=>updateSale(s.id,{commission_pct:parseInt(e.target.value)}),className:\"bg-zinc-700/50 rounded px-2 py-1 text-xs text-white w-14 focus:outline-none\",children:commissions.map(c=>/*#__PURE__*/_jsxs(\"option\",{value:c,children:[c,\"%\"]},c))})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsx(\"select\",{value:s.stato||'lead',onChange:e=>updateSale(s.id,{stato:e.target.value}),className:\"rounded px-2 py-1 text-xs text-white w-20 focus:outline-none\",style:{background:(_theme$status3=theme.status[s.stato||'lead'])===null||_theme$status3===void 0?void 0:_theme$status3.bg,color:(_theme$status4=theme.status[s.stato||'lead'])===null||_theme$status4===void 0?void 0:_theme$status4.color},children:pipelineStati.map(st=>/*#__PURE__*/_jsx(\"option\",{value:st,className:\"bg-zinc-800\",children:pipelineLabels[st]||st},st))})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsxs(\"select\",{value:s.referente||'',onChange:e=>updateSale(s.id,{referente:e.target.value||null}),className:\"rounded px-2 py-1 text-xs font-medium w-12 focus:outline-none \".concat(s.referente==='Pellegrino'?'bg-green-500/20 text-green-400':s.referente==='Giovanni'?'bg-orange-500/20 text-orange-400':'bg-zinc-700/50 text-zinc-500'),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Pellegrino\",children:\"P\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Giovanni\",children:\"G\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateSale(s.id,{pagato:!s.pagato}),className:\"px-2.5 py-1 rounded-lg text-xs font-medium transition-colors \".concat(s.pagato?'bg-emerald-500/20 text-emerald-400':'bg-zinc-700/50 text-zinc-500 hover:text-zinc-300'),children:s.pagato?'✓':'○'})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteSale(s.id),className:\"text-zinc-600 hover:text-red-400 transition-colors\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})})]},s.id);})})]})}),sales.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12 text-zinc-500\",children:\"Nessuna vendita trovata\"})]})]});}// Leads Table View with Multi-Select\nfunction LeadsTableView(_ref23){let{leads,clienti,onSelectLead,onUpdateStatus,onDelete,onAssign,theme,users,isAdmin}=_ref23;const[selectedIds,setSelectedIds]=useState([]);const[sortField,setSortField]=useState('created_at');const[sortDir,setSortDir]=useState('desc');const[filterStato,setFilterStato]=useState('');const[searchQuery,setSearchQuery]=useState('');const[showBulkActions,setShowBulkActions]=useState(false);const[bulkAction,setBulkAction]=useState(null);// Usa pipelineStati globale (già definito sopra)\nconst fmt=n=>new Intl.NumberFormat('it-IT',{style:'currency',currency:'AED',maximumFractionDigits:0}).format(n);const getCliente=id=>clienti.find(c=>c.id===id);// Filter and sort leads\nconst filteredLeads=leads.filter(l=>{if(filterStato&&l.stato!==filterStato)return false;if(searchQuery){var _l$progetto,_l$zona,_l$developer,_cliente$nome,_cliente$cognome;const q=searchQuery.toLowerCase();const cliente=getCliente(l.cliente_id);return((_l$progetto=l.progetto)===null||_l$progetto===void 0?void 0:_l$progetto.toLowerCase().includes(q))||((_l$zona=l.zona)===null||_l$zona===void 0?void 0:_l$zona.toLowerCase().includes(q))||((_l$developer=l.developer)===null||_l$developer===void 0?void 0:_l$developer.toLowerCase().includes(q))||(cliente===null||cliente===void 0?void 0:(_cliente$nome=cliente.nome)===null||_cliente$nome===void 0?void 0:_cliente$nome.toLowerCase().includes(q))||(cliente===null||cliente===void 0?void 0:(_cliente$cognome=cliente.cognome)===null||_cliente$cognome===void 0?void 0:_cliente$cognome.toLowerCase().includes(q));}return true;}).sort((a,b)=>{let aVal=a[sortField];let bVal=b[sortField];if(sortField==='cliente'){var _getCliente,_getCliente2;aVal=((_getCliente=getCliente(a.cliente_id))===null||_getCliente===void 0?void 0:_getCliente.nome)||'';bVal=((_getCliente2=getCliente(b.cliente_id))===null||_getCliente2===void 0?void 0:_getCliente2.nome)||'';}if(sortDir==='asc')return aVal>bVal?1:-1;return aVal<bVal?1:-1;});const toggleSelect=id=>{setSelectedIds(prev=>prev.includes(id)?prev.filter(i=>i!==id):[...prev,id]);};const toggleSelectAll=()=>{if(selectedIds.length===filteredLeads.length){setSelectedIds([]);}else{setSelectedIds(filteredLeads.map(l=>l.id));}};const handleBulkAction=(action,value)=>{if(action==='delete'){if(window.confirm(\"Eliminare \".concat(selectedIds.length,\" lead?\"))){selectedIds.forEach(id=>onDelete(id));setSelectedIds([]);}}else if(action==='status'){selectedIds.forEach(id=>onUpdateStatus(id,value));setSelectedIds([]);}else if(action==='assign'&&onAssign){onAssign(selectedIds,value);setSelectedIds([]);}setBulkAction(null);};const SortHeader=_ref24=>{let{field,children}=_ref24;return/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 text-zinc-400 font-medium text-sm cursor-pointer hover:text-white transition-colors\",onClick:()=>{if(sortField===field){setSortDir(d=>d==='asc'?'desc':'asc');}else{setSortField(field);setSortDir('asc');}},children:/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-1\",children:[children,sortField===field&&/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-400\",children:sortDir==='asc'?'↑':'↓'})]})});};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cerca lead...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg pl-9 pr-4 py-2 text-white text-sm w-64 focus:border-orange-500 focus:outline-none\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:filterStato,onChange:e=>setFilterStato(e.target.value),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutti gli stati\"}),pipelineStati.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:pipelineLabels[s]||s},s))]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm\",children:[filteredLeads.length,\" lead\"]})]}),selectedIds.length>0&&/*#__PURE__*/_jsx(Card,{className:\"bg-orange-500/10 border-orange-500/30\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-orange-400 font-medium\",children:[selectedIds.length,\" lead selezionati\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"select\",{value:\"\",onChange:e=>handleBulkAction('status',e.target.value),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Cambia stato...\"}),pipelineStati.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))]}),isAdmin&&(users===null||users===void 0?void 0:users.length)>0&&/*#__PURE__*/_jsxs(\"select\",{value:\"\",onChange:e=>handleBulkAction('assign',e.target.value),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Assegna a...\"}),users.map(u=>/*#__PURE__*/_jsx(\"option\",{value:u.nome,children:u.nome},u.id))]}),/*#__PURE__*/_jsxs(Button,{variant:\"danger\",size:\"sm\",onClick:()=>handleBulkAction('delete'),children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 mr-1\"}),\" Elimina\"]}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>setSelectedIds([]),children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})]})}),/*#__PURE__*/_jsx(Card,{padding:\"p-0\",className:\"overflow-hidden\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-zinc-700/50/50 border-b border-zinc-700\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"w-12 py-3 px-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedIds.length===filteredLeads.length&&filteredLeads.length>0,onChange:toggleSelectAll,className:\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-orange-500 focus:ring-orange-500\"})}),/*#__PURE__*/_jsx(SortHeader,{field:\"cliente\",children:\"Cliente\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"progetto\",children:\"Progetto\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"zona\",children:\"Zona\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"valore\",children:\"Valore\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"stato\",children:\"Stato\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"created_at\",children:\"Data\"}),isAdmin&&/*#__PURE__*/_jsx(SortHeader,{field:\"assegnato_a\",children:\"Agente\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-20 py-3 px-4\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-zinc-800\",children:filteredLeads.map(lead=>{const cliente=getCliente(lead.cliente_id);const isSelected=selectedIds.includes(lead.id);return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-zinc-700/50/50 cursor-pointer transition-colors \".concat(isSelected?'bg-orange-500/10':''),children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isSelected,onChange:()=>toggleSelect(lead.id),className:\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-orange-500 focus:ring-orange-500\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelectLead(lead),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[cliente&&/*#__PURE__*/_jsx(Avatar,{nome:cliente.nome,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:cliente?\"\".concat(cliente.nome,\" \").concat(cliente.cognome||''):'N/A'}),(cliente===null||cliente===void 0?void 0:cliente.telefono)&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:cliente.telefono})]})]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelectLead(lead),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:lead.progetto||'-'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:lead.developer||''})]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-zinc-300\",onClick:()=>onSelectLead(lead),children:lead.zona||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelectLead(lead),children:/*#__PURE__*/_jsx(\"span\",{className:\"text-emerald-400 font-semibold\",children:lead.valore>0?fmt(lead.valore):'TBD'})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelectLead(lead),children:/*#__PURE__*/_jsx(StatusBadge,{status:lead.stato||'lead'})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-zinc-500 text-sm\",onClick:()=>onSelectLead(lead),children:lead.created_at?new Date(lead.created_at).toLocaleDateString('it-IT'):'-'}),isAdmin&&/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelectLead(lead),children:lead.assegnato_a?/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full\",children:lead.assegnato_a}):/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-600 text-sm\",children:\"-\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onSelectLead(lead);},className:\"p-1.5 text-zinc-400 hover:text-white hover:bg-zinc-700 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();if(window.confirm('Eliminare?'))onDelete(lead.id);},className:\"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})})]},lead.id);})})]}),filteredLeads.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"py-12 text-center\",children:[/*#__PURE__*/_jsx(Target,{className:\"w-12 h-12 text-zinc-600 mx-auto mb-3\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500\",children:\"Nessun lead trovato\"})]})]})})]});}// Pipeline Tab\nfunction PipelineTab(_ref25){let{byStato,onSelectLead,onUpdateSaleStatus}=_ref25;const[draggedItem,setDraggedItem]=useState(null);const[dragOverColumn,setDragOverColumn]=useState(null);const handleDragStart=(e,sale)=>{setDraggedItem(sale);e.dataTransfer.effectAllowed='move';e.target.style.opacity='0.5';};const handleDragEnd=e=>{e.target.style.opacity='1';setDraggedItem(null);setDragOverColumn(null);};const handleDragOver=(e,stato)=>{e.preventDefault();e.dataTransfer.dropEffect='move';setDragOverColumn(stato);};const handleDragLeave=()=>{setDragOverColumn(null);};const handleDrop=(e,newStato)=>{e.preventDefault();if(draggedItem&&draggedItem.stato!==newStato){onUpdateSaleStatus(draggedItem.id,newStato);}setDraggedItem(null);setDragOverColumn(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Trascina le card per cambiare stato\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-5 gap-4\",children:pipelineStati.map(st=>{var _theme$status$st8,_byStato$st4,_byStato$st5,_byStato$st6;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",onDragOver:e=>handleDragOver(e,st),onDragLeave:handleDragLeave,onDrop:e=>handleDrop(e,st),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded-full\",style:{background:(_theme$status$st8=theme.status[st])===null||_theme$status$st8===void 0?void 0:_theme$status$st8.color}}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-white\",children:pipelineLabels[st]||st})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-zinc-500 bg-zinc-700/50 px-2 py-0.5 rounded-full\",children:((_byStato$st4=byStato[st])===null||_byStato$st4===void 0?void 0:_byStato$st4.length)||0})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 min-h-[200px] rounded-xl p-2 transition-all \".concat(dragOverColumn===st?'bg-white/5 ring-2 ring-violet-500/50':''),children:[(_byStato$st5=byStato[st])===null||_byStato$st5===void 0?void 0:_byStato$st5.map(s=>{var _theme$status$st9;return/*#__PURE__*/_jsx(\"div\",{draggable:true,onDragStart:e=>handleDragStart(e,s),onDragEnd:handleDragEnd,className:\"cursor-grab active:cursor-grabbing \".concat((draggedItem===null||draggedItem===void 0?void 0:draggedItem.id)===s.id?'opacity-50':''),children:/*#__PURE__*/_jsxs(Card,{hover:true,onClick:()=>onSelectLead(s),padding:\"p-3\",className:\"border-l-2\",style:{borderLeftColor:(_theme$status$st9=theme.status[st])===null||_theme$status$st9===void 0?void 0:_theme$status$st9.color},children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium truncate\",children:s.progetto||'TBD'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs truncate\",children:s.developer}),s.cliente_nome&&/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-400 text-xs mt-1\",children:s.cliente_nome}),s.valore>0&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-emerald-400 text-sm font-medium mt-2\",children:[fmt(s.valore),\" AED\"]})]})},s.id);}),!((_byStato$st6=byStato[st])!==null&&_byStato$st6!==void 0&&_byStato$st6.length)&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-zinc-600 text-sm border-2 border-dashed border-zinc-800 rounded-xl\",children:\"Trascina qui\"})]})]},st);})})]});}// CRM Tab\nfunction CRMTab(_ref26){let{clienti,filters,setFilters,sales,onSelect,onCreate,onDelete,onUpdateCliente,users}=_ref26;const[selectedIds,setSelectedIds]=useState([]);const[sortField,setSortField]=useState('created_at');const[sortDir,setSortDir]=useState('desc');const getClientStats=id=>{const cs=sales.filter(s=>s.cliente_id===id);const vendite=cs.filter(s=>s.stato==='venduto'||s.stato==='incassato');return{leads:cs.length,value:vendite.reduce((sum,s)=>sum+Number(s.valore||0),0)};};// Sort clients\nconst sortedClienti=[...clienti].sort((a,b)=>{let aVal=a[sortField];let bVal=b[sortField];if(sortField==='leads'){aVal=getClientStats(a.id).leads;bVal=getClientStats(b.id).leads;}else if(sortField==='value'){aVal=getClientStats(a.id).value;bVal=getClientStats(b.id).value;}if(sortDir==='asc')return aVal>bVal?1:-1;return aVal<bVal?1:-1;});const toggleSelect=id=>{setSelectedIds(prev=>prev.includes(id)?prev.filter(i=>i!==id):[...prev,id]);};const toggleSelectAll=()=>{if(selectedIds.length===sortedClienti.length){setSelectedIds([]);}else{setSelectedIds(sortedClienti.map(c=>c.id));}};const handleBulkAction=async(action,value)=>{console.log('Bulk action:',action,value,'IDs:',selectedIds);if(action==='delete'){if(window.confirm(\"Eliminare \".concat(selectedIds.length,\" clienti?\"))){for(const id of selectedIds){await onDelete(id,true);}setSelectedIds([]);}}else if(action==='stato'){if(!onUpdateCliente){console.error('onUpdateCliente not provided');return;}for(const id of selectedIds){console.log('Updating stato for',id,'to',value);await onUpdateCliente(id,{stato:value});}setSelectedIds([]);}else if(action==='assegnato'){if(!onUpdateCliente){console.error('onUpdateCliente not provided');return;}for(const id of selectedIds){console.log('Assigning',id,'to',value);await onUpdateCliente(id,{assegnato_a:value});}setSelectedIds([]);}};const SortHeader=_ref27=>{let{field,children,className=''}=_ref27;return/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 text-zinc-400 font-medium text-sm cursor-pointer hover:text-white transition-colors \".concat(className),onClick:()=>{if(sortField===field){setSortDir(d=>d==='asc'?'desc':'asc');}else{setSortField(field);setSortDir('asc');}},children:/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-1\",children:[children,sortField===field&&/*#__PURE__*/_jsx(\"span\",{className:\"text-amber-400\",children:sortDir==='asc'?'↑':'↓'})]})});};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 flex-wrap flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative min-w-[250px]\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cerca cliente...\",value:filters.search,onChange:e=>setFilters(_objectSpread(_objectSpread({},filters),{},{search:e.target.value})),className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-2.5 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-amber-500/50\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.stato,onChange:e=>setFilters(_objectSpread(_objectSpread({},filters),{},{stato:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutti gli stati\"}),clienteStati.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))]})]}),/*#__PURE__*/_jsx(Button,{icon:UserPlus,onClick:onCreate,children:\"Nuovo Cliente\"})]}),selectedIds.length>0&&/*#__PURE__*/_jsx(Card,{className:\"bg-amber-500/10 border-amber-500/30\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between flex-wrap gap-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-amber-400 font-medium\",children:[selectedIds.length,\" clienti selezionati\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 flex-wrap\",children:[/*#__PURE__*/_jsxs(\"select\",{value:\"\",onChange:e=>handleBulkAction('stato',e.target.value),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Cambia stato...\"}),clienteStati.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))]}),(users===null||users===void 0?void 0:users.length)>0&&/*#__PURE__*/_jsxs(\"select\",{value:\"\",onChange:e=>handleBulkAction('assegnato',e.target.value),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Assegna a...\"}),users.map(u=>/*#__PURE__*/_jsx(\"option\",{value:u.nome,children:u.nome},u.id))]}),/*#__PURE__*/_jsxs(Button,{variant:\"danger\",size:\"sm\",onClick:()=>handleBulkAction('delete'),children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 mr-1\"}),\" Elimina\"]}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>setSelectedIds([]),children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})]})}),/*#__PURE__*/_jsx(Card,{padding:\"p-0\",className:\"overflow-hidden\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-zinc-700/50/50 border-b border-zinc-700\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"w-12 py-3 px-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedIds.length===sortedClienti.length&&sortedClienti.length>0,onChange:toggleSelectAll,className:\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-amber-500 focus:ring-amber-500\"})}),/*#__PURE__*/_jsx(SortHeader,{field:\"nome\",children:\"Cliente\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"telefono\",children:\"Telefono\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"stato\",children:\"Stato\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"assegnato_a\",children:\"Agente\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"leads\",children:\"Lead\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"value\",children:\"Valore\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"budget_max\",children:\"Budget\"}),/*#__PURE__*/_jsx(SortHeader,{field:\"created_at\",children:\"Data\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-20 py-3 px-4\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-zinc-800\",children:sortedClienti.map(cliente=>{const stats=getClientStats(cliente.id);const isSelected=selectedIds.includes(cliente.id);return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-zinc-700/50/50 cursor-pointer transition-colors \".concat(isSelected?'bg-amber-500/10':''),children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isSelected,onChange:()=>toggleSelect(cliente.id),className:\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-amber-500 focus:ring-amber-500\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelect(cliente),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Avatar,{nome:cliente.nome,cognome:cliente.cognome,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-medium\",children:[cliente.nome,\" \",cliente.cognome||'']}),cliente.azienda&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:cliente.azienda})]})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-zinc-300\",onClick:()=>onSelect(cliente),children:cliente.telefono||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-zinc-300 text-sm\",onClick:()=>onSelect(cliente),children:cliente.email||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelect(cliente),children:/*#__PURE__*/_jsx(StatusBadge,{status:cliente.stato,type:\"cliente\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelect(cliente),children:cliente.assegnato_a?/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full\",children:cliente.assegnato_a}):/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-600\",children:\"-\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelect(cliente),children:stats.leads>0?/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-400 font-medium\",children:stats.leads}):/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-600\",children:\"0\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",onClick:()=>onSelect(cliente),children:stats.value>0?/*#__PURE__*/_jsx(\"span\",{className:\"text-emerald-400 font-semibold\",children:fmt(stats.value)}):/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-600\",children:\"-\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-zinc-300\",onClick:()=>onSelect(cliente),children:cliente.budget_max?fmt(cliente.budget_max):'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-zinc-500 text-sm\",onClick:()=>onSelect(cliente),children:cliente.created_at?new Date(cliente.created_at).toLocaleDateString('it-IT'):'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onSelect(cliente);},className:\"p-1.5 text-zinc-400 hover:text-white hover:bg-zinc-700 rounded-lg transition-colors\",title:\"Dettagli\",children:/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();if(window.confirm('Eliminare questo cliente?'))onDelete(cliente.id);},className:\"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors\",title:\"Elimina\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})})]},cliente.id);})})]}),sortedClienti.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"py-12 text-center\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-12 h-12 text-zinc-600 mx-auto mb-3\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500\",children:\"Nessun cliente trovato\"}),/*#__PURE__*/_jsx(Button,{className:\"mt-4\",icon:UserPlus,onClick:onCreate,children:\"Aggiungi Cliente\"})]})]})})]});}// Cliente Detail View\nfunction ClienteDetailView(_ref28){let{cliente,sales,tasks,onBack,onEdit,onDelete,updateCliente,onAddTask,onCompleteTask,onDeleteTask,onExportPDF}=_ref28;const[tab,setTab]=useState('info');const totalValue=sales.filter(s=>s.stato==='venduto'||s.stato==='incassato').reduce((sum,s)=>sum+Number(s.valore||0),0);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",icon:ChevronLeft,onClick:onBack,children:\"Indietro\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\"}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",icon:FileText,onClick:onExportPDF,children:\"PDF\"}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",icon:Edit2,onClick:onEdit,children:\"Modifica\"}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",icon:Trash2,onClick:onDelete})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-6\",children:[/*#__PURE__*/_jsx(Avatar,{nome:cliente.nome,cognome:cliente.cognome,size:\"xl\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-semibold text-white\",children:[cliente.nome,\" \",cliente.cognome]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-1 flex-wrap\",children:[/*#__PURE__*/_jsx(StatusBadge,{status:cliente.stato,type:\"cliente\"}),cliente.nazionalita&&/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 text-sm\",children:cliente.nazionalita}),cliente.assegnato_a&&/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full flex items-center gap-1\",children:[/*#__PURE__*/_jsx(User,{className:\"w-3 h-3\"}),\" \",cliente.assegnato_a]})]})]})]}),/*#__PURE__*/_jsx(QuickActions,{phone:cliente.telefono,whatsapp:cliente.whatsapp||cliente.telefono,email:cliente.email,clienteName:cliente.nome})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-3\",children:[/*#__PURE__*/_jsxs(Card,{padding:\"p-4\",className:\"text-center border-amber-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-amber-400\",children:sales.length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Lead\"})]}),/*#__PURE__*/_jsxs(Card,{padding:\"p-4\",className:\"text-center border-emerald-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-emerald-400\",children:fmt(totalValue)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Valore\"})]}),/*#__PURE__*/_jsxs(Card,{padding:\"p-4\",className:\"text-center border-pink-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-pink-400\",children:tasks.filter(t=>t.stato==='pending').length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Task\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 border-b border-[#334155]\",children:['info','lead','task'].map(t=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTab(t),className:\"px-4 py-3 text-sm font-medium border-b-2 transition-colors \".concat(tab===t?'text-white border-amber-500':'text-zinc-500 border-transparent hover:text-white'),children:t==='info'?'Informazioni':t==='lead'?\"Lead (\".concat(sales.length,\")\"):\"Task (\".concat(tasks.length,\")\")},t))}),tab==='info'&&/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Telefono\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:cliente.telefono||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white truncate\",children:cliente.email||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Budget Min\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-amber-400\",children:cliente.budget_min?fmt(cliente.budget_min):'-'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Budget Max\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-amber-400\",children:cliente.budget_max?fmt(cliente.budget_max):'-'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Assegnato a\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-400\",children:cliente.assegnato_a||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Agente Rif.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:cliente.agente_riferimento||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Fonte\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:cliente.fonte||'-'})]})]}),cliente.note&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-[#334155]\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-1\",children:\"Note\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm\",children:cliente.note})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-[#334155]\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-2\",children:\"Stato\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:clienteStati.map(s=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateCliente(cliente.id,{stato:s}),className:\"px-3 py-1.5 rounded-lg text-xs font-medium transition-all \".concat(cliente.stato===s?'bg-amber-500 text-black':'bg-zinc-700/50 text-zinc-400 hover:text-white'),children:s},s))})]})]}),tab==='lead'&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:sales.length===0?/*#__PURE__*/_jsx(EmptyState,{icon:Target,title:\"Nessun lead\",description:\"Non ci sono lead per questo cliente\"}):sales.map(s=>/*#__PURE__*/_jsx(Card,{padding:\"p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:s.progetto}),/*#__PURE__*/_jsx(StatusBadge,{status:s.stato||'lead'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm\",children:[s.developer,\" \\u2022 \",s.zona]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:s.valore>0?fmt(s.valore):'TBD'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:fmtShort(s.data)})]})]})},s.id))}),tab==='task'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(Button,{icon:Plus,onClick:onAddTask,className:\"w-full\",variant:\"secondary\",children:\"Nuovo Task\"}),tasks.length===0?/*#__PURE__*/_jsx(EmptyState,{icon:ListTodo,title:\"Nessun task\",description:\"Non ci sono task per questo cliente\"}):tasks.map(t=>/*#__PURE__*/_jsx(Card,{padding:\"p-4\",className:t.stato==='completato'?'opacity-50':isOverdue(t.scadenza)?'border-red-500/30':'',children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium \".concat(t.stato==='completato'?'line-through':''),children:t.titolo}),/*#__PURE__*/_jsx(StatusBadge,{status:t.priorita,type:\"priority\"})]}),t.scadenza&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-1 \".concat(isOverdue(t.scadenza)&&t.stato!=='completato'?'text-red-400':'text-zinc-500'),children:fmtDateTime(t.scadenza)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1\",children:[t.stato!=='completato'&&/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:Check,onClick:()=>onCompleteTask(t.id)}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:Trash2,onClick:()=>onDeleteTask(t.id)})]})]})},t.id))]})]});}// Admin Tasks Tab\nfunction AdminTasksTab(_ref29){let{tasks,clienti,users,onComplete,onDelete,onEdit,onCreate}=_ref29;const[filter,setFilter]=useState('pending');const filtered=tasks.filter(t=>{if(filter==='pending')return t.stato==='pending';if(filter==='overdue')return t.stato==='pending'&&isOverdue(t.scadenza);if(filter==='today')return t.stato==='pending'&&isToday(t.scadenza);if(filter==='completed')return t.stato==='completato';return true;});const getCliente=id=>clienti.find(c=>c.id===id);const counts={pending:tasks.filter(t=>t.stato==='pending').length,overdue:tasks.filter(t=>t.stato==='pending'&&isOverdue(t.scadenza)).length,today:tasks.filter(t=>t.stato==='pending'&&isToday(t.scadenza)).length};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 items-center\",children:[/*#__PURE__*/_jsx(Button,{icon:Plus,onClick:onCreate,children:\"Nuovo Task\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:[{id:'pending',label:'Pending',count:counts.pending,color:'#60A5FA'},{id:'overdue',label:'Scaduti',count:counts.overdue,color:'#EF4444'},{id:'today',label:'Oggi',count:counts.today,color:'#FBBF24'},{id:'completed',label:'Fatto',color:'#34D399'}].map(f=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setFilter(f.id),className:\"px-3 py-1.5 rounded-lg text-xs font-medium transition-all \".concat(filter===f.id?'text-white':'text-zinc-500 hover:text-white'),style:filter===f.id?{background:\"\".concat(f.color,\"20\"),color:f.color}:{},children:[f.label,\" \",f.count!==undefined&&\"(\".concat(f.count,\")\")]},f.id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:filtered.length===0?/*#__PURE__*/_jsx(EmptyState,{icon:ListTodo,title:\"Nessun task\",description:filter==='pending'?'Tutti i task sono completati!':'Nessun task in questa categoria'}):filtered.map(t=>{const cliente=getCliente(t.cliente_id);return/*#__PURE__*/_jsx(Card,{padding:\"p-4\",className:\"\".concat(t.stato==='completato'?'opacity-50':'',\" \").concat(isOverdue(t.scadenza)&&t.stato!=='completato'?'border-red-500/30 bg-red-500/5':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 flex-wrap mb-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium \".concat(t.stato==='completato'?'line-through':''),children:t.titolo}),/*#__PURE__*/_jsx(StatusBadge,{status:t.priorita,type:\"priority\"}),isOverdue(t.scadenza)&&t.stato!=='completato'&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 rounded text-xs bg-red-500/20 text-red-400 animate-pulse\",children:\"Scaduto\"})]}),t.descrizione&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:t.descrizione}),t.note&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-400 text-sm mt-1 bg-blue-500/10 px-2 py-1 rounded\",children:[\"\\uD83D\\uDCDD \",t.note]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mt-2 text-xs\",children:[t.scadenza&&/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-1 \".concat(isOverdue(t.scadenza)&&t.stato!=='completato'?'text-red-400':'text-zinc-500'),children:[/*#__PURE__*/_jsx(Clock,{className:\"w-3 h-3\"}),fmtDateTime(t.scadenza)]}),t.assegnato_a&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-400 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(User,{className:\"w-3 h-3\"}),t.assegnato_a]}),cliente&&/*#__PURE__*/_jsx(\"span\",{className:\"text-amber-400\",children:cliente.nome})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1\",children:[t.stato!=='completato'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:Edit2,onClick:()=>onEdit(t)}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:Check,onClick:()=>onComplete(t.id)})]}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:Trash2,onClick:()=>onDelete(t.id)})]})]})},t.id);})})]});}// Agent Tasks Tab\nfunction AgentTasksTab(_ref30){let{tasks,allTasks,clienti,onComplete,onAddNote}=_ref30;const[filter,setFilter]=useState('pending');const completedTasks=allTasks.filter(t=>t.stato==='completato');const displayTasks=filter==='completed'?completedTasks:tasks.filter(t=>filter==='overdue'?isOverdue(t.scadenza):true);const getCliente=id=>clienti.find(c=>c.id===id);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(SectionHeader,{icon:ListTodo,title:\"I tuoi Task\",accent:\"244,114,182\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 mb-4\",children:[{id:'pending',label:'Da fare',count:tasks.length},{id:'overdue',label:'Scaduti',count:tasks.filter(t=>isOverdue(t.scadenza)).length},{id:'completed',label:'Completati',count:completedTasks.length}].map(f=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setFilter(f.id),className:\"px-4 py-2 rounded-xl text-sm font-medium transition-all \".concat(filter===f.id?'bg-pink-500/20 text-pink-400':'text-zinc-500 hover:text-white'),children:[f.label,\" (\",f.count,\")\"]},f.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:displayTasks.length===0?/*#__PURE__*/_jsx(EmptyState,{icon:Check,title:filter==='pending'?'Tutto fatto!':'Nessun task',description:\"Non ci sono task in questa categoria\"}):displayTasks.map(t=>{const cliente=getCliente(t.cliente_id);return/*#__PURE__*/_jsx(Card,{padding:\"p-4\",className:t.stato==='completato'?'opacity-50':isOverdue(t.scadenza)?'border-red-500/30':'',children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium \".concat(t.stato==='completato'?'line-through':''),children:t.titolo}),/*#__PURE__*/_jsx(StatusBadge,{status:t.priorita,type:\"priority\"}),isOverdue(t.scadenza)&&t.stato!=='completato'&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 rounded text-xs bg-red-500/20 text-red-400\",children:\"Scaduto\"})]}),t.descrizione&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:t.descrizione}),t.note&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-400 text-sm mt-2 bg-blue-500/10 px-3 py-2 rounded-lg\",children:[\"\\uD83D\\uDCDD \",t.note]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mt-2 text-xs\",children:[t.scadenza&&/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-1 \".concat(isOverdue(t.scadenza)&&t.stato!=='completato'?'text-red-400':'text-zinc-500'),children:[/*#__PURE__*/_jsx(Clock,{className:\"w-3 h-3\"}),fmtDateTime(t.scadenza)]}),cliente&&/*#__PURE__*/_jsx(\"span\",{className:\"text-amber-400\",children:cliente.nome})]})]}),t.stato!=='completato'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onAddNote(t),className:\"w-10 h-10 rounded-xl bg-blue-500/10 text-blue-400 flex items-center justify-center hover:bg-blue-500/20 transition-colors\",children:/*#__PURE__*/_jsx(MessageCircle,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onComplete(t.id),className:\"w-10 h-10 rounded-xl bg-emerald-500/10 text-emerald-400 flex items-center justify-center hover:bg-emerald-500/20 transition-colors\",children:/*#__PURE__*/_jsx(Check,{className:\"w-5 h-5\"})})]})]})},t.id);})})]});}// Team Tab\nfunction TeamTab(_ref31){let{users,onCreate,onEdit,onDelete}=_ref31;const[copiedId,setCopiedId]=useState(null);const copy=u=>{navigator.clipboard.writeText(\"KeyPrime\\n\".concat(getBaseUrl(),\"\\n\").concat(u.username,\" / \").concat(u.password));setCopiedId(u.id);setTimeout(()=>setCopiedId(null),2000);};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500\",children:[users.length,\" membri\"]}),/*#__PURE__*/_jsx(Button,{icon:UserPlus,onClick:onCreate,children:\"Nuovo Utente\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:users.map(u=>/*#__PURE__*/_jsx(Card,{padding:\"p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(Avatar,{nome:u.nome,size:\"lg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:u.nome}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 rounded-full text-xs \".concat(u.ruolo==='admin'?'bg-violet-500/20 text-violet-400':u.ruolo==='agente_admin'?'bg-purple-500/20 text-purple-400':u.ruolo==='agente'?'bg-blue-500/20 text-blue-400':'bg-emerald-500/20 text-emerald-400'),children:u.ruolo==='agente_admin'?'Ag. Admin':u.ruolo}),!u.attivo&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 rounded-full text-xs bg-red-500/20 text-red-400\",children:\"Disattivo\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm mt-1\",children:[u.username,\" / \",u.password,u.email&&\" \\u2022 \".concat(u.email)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:copiedId===u.id?Check:Copy,onClick:()=>copy(u)}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:Edit2,onClick:()=>onEdit(u)}),u.ruolo!=='admin'&&/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",icon:Trash2,onClick:()=>onDelete(u.id)})]})]})},u.id))})]});}// Agent Detail View\nfunction AgentDetailView(_ref32){let{agent,sales,onBack}=_ref32;const agentSales=sales.filter(s=>agent.type==='agente'?s.agente===agent.name:s.segnalatore===agent.name);const vendite=agentSales.filter(s=>s.stato==='venduto'||s.stato==='incassato');const totalVolume=agentSales.reduce((sum,s)=>sum+Number(s.valore||0),0);const totalVendite=vendite.reduce((sum,s)=>sum+Number(s.valore||0),0);const rate=agent.type==='agente'?0.7:0.3;const totalComm=vendite.reduce((sum,s)=>sum+Number(s.valore||0)*(s.commission_pct||5)/100*rate,0);const commPagate=vendite.filter(s=>s.pagato).reduce((sum,s)=>sum+Number(s.valore||0)*(s.commission_pct||5)/100*rate,0);const byStato=pipelineStati.reduce((a,st)=>{a[st]=agentSales.filter(s=>(s.stato||'lead')===st).length;return a;},{});const byZona=agentSales.reduce((a,s)=>{if(s.zona)a[s.zona]=(a[s.zona]||0)+Number(s.valore||0);return a;},{});const byMonth=agentSales.reduce((a,s)=>{var _s$data2;const m=((_s$data2=s.data)===null||_s$data2===void 0?void 0:_s$data2.substring(0,7))||'N/A';a[m]=(a[m]||0)+Number(s.valore||0);return a;},{});return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 bg-[#0f172a] overflow-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-8\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",icon:ChevronLeft,onClick:onBack,children:\"Indietro\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-8\",children:[/*#__PURE__*/_jsx(Avatar,{nome:agent.name,size:\"xl\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold text-white\",children:agent.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 capitalize\",children:agent.type})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8\",children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Volume Totale\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-white mt-1\",children:fmt(totalVolume)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-600 text-xs\",children:\"AED\"})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Lead\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-blue-400 mt-1\",children:agentSales.length})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Vendite Chiuse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-emerald-400 mt-1\",children:vendite.length}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-600 text-xs\",children:[fmt(totalVendite),\" AED\"]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Commissioni\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-amber-400 mt-1\",children:fmt(totalComm)}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-emerald-400 text-xs\",children:[\"Pagate: \",fmt(commPagate)]})]})]}),/*#__PURE__*/_jsxs(Card,{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold mb-4\",children:\"Pipeline\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:pipelineStati.map(st=>{var _theme$status$st0,_theme$status$st1;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 rounded-xl\",style:{background:(_theme$status$st0=theme.status[st])===null||_theme$status$st0===void 0?void 0:_theme$status$st0.bg},children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-semibold text-white\",children:byStato[st]||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs\",style:{color:(_theme$status$st1=theme.status[st])===null||_theme$status$st1===void 0?void 0:_theme$status$st1.color},children:pipelineLabels[st]||st})]},st);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid lg:grid-cols-2 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 text-emerald-400\"}),\"Zone\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[Object.entries(byZona).sort((a,b)=>b[1]-a[1]).slice(0,5).map(_ref33=>{let[zona,value]=_ref33;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400 text-sm w-24 truncate\",children:zona}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsx(ProgressBar,{value:value,max:Object.values(byZona).sort((a,b)=>b-a)[0]||1,color:\"#34D399\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm w-20 text-right\",children:fmt(value)})]},zona);}),Object.keys(byZona).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Nessun dato\"})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-4 h-4 text-violet-400\"}),\"Trend\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[Object.entries(byMonth).sort((a,b)=>a[0].localeCompare(b[0])).slice(-5).map(_ref34=>{let[month,value]=_ref34;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400 text-sm w-16\",children:month}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsx(ProgressBar,{value:value,max:Math.max(...Object.values(byMonth))||1,color:\"#A78BFA\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm w-20 text-right\",children:fmt(value)})]},month);}),Object.keys(byMonth).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:\"Nessun dato\"})]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold mb-4\",children:\"Ultimi Lead\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[agentSales.slice(0,10).map(s=>{var _theme$status5,_theme$status6;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 p-3 bg-zinc-700/50/50 rounded-xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1 h-10 rounded-full\",style:{background:(_theme$status5=theme.status[s.stato||'lead'])===null||_theme$status5===void 0?void 0:_theme$status5.color}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium truncate\",children:s.progetto||'TBD'}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-xs\",children:[s.developer,\" \\u2022 \",s.zona]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium\",children:s.valore>0?fmt(s.valore):'TBD'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs\",style:{color:(_theme$status6=theme.status[s.stato||'lead'])===null||_theme$status6===void 0?void 0:_theme$status6.color},children:s.stato||'lead'})]})]},s.id);}),agentSales.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm text-center py-4\",children:\"Nessun lead\"})]})]})]})});}// ==================== MODALS & FORMS ====================\n// Leaflet Map Component - Airbnb Style\nfunction MapboxMap(_ref35){var _popupProject$images,_popupProject$images$,_popupProject$locatio,_popupProject$locatio2;let{projects,onSelectProject,selectedProject,onAreaClick}=_ref35;const mapContainer=useRef(null);const map=useRef(null);const markersLayer=useRef(null);const markersMap=useRef({});const[mapLoaded,setMapLoaded]=useState(false);const[mapError,setMapError]=useState(null);const[popupProject,setPopupProject]=useState(null);const projectsByLocation=React.useMemo(()=>{const grouped={};projects.forEach(p=>{var _p$coordinates,_p$coordinates2;// Try to use real coordinates first (from allMapProjects)\nlet coords=null;if((_p$coordinates=p.coordinates)!==null&&_p$coordinates!==void 0&&_p$coordinates.lat&&(_p$coordinates2=p.coordinates)!==null&&_p$coordinates2!==void 0&&_p$coordinates2.lon){coords={lat:p.coordinates.lat,lng:p.coordinates.lon,zoom:14};}else{var _p$location,_p$location2;// Fallback to location name lookup\nconst locName=((_p$location=p.location)===null||_p$location===void 0?void 0:_p$location.full_name)||((_p$location2=p.location)===null||_p$location2===void 0?void 0:_p$location2.name)||'Unknown';coords=getLocationCoords(locName);}if(coords){// Add small random offset to prevent overlap\nconst offsetLat=(Math.random()-0.5)*0.008;const offsetLng=(Math.random()-0.5)*0.008;grouped[p.project_id]=_objectSpread(_objectSpread({},p),{},{coords:{lat:coords.lat+offsetLat,lng:coords.lng+offsetLng,zoom:coords.zoom}});}});return grouped;},[projects]);// Load Leaflet\nuseEffect(()=>{if(!mapContainer.current||map.current)return;if(!document.getElementById('leaflet-css')){const link=document.createElement('link');link.id='leaflet-css';link.href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';link.rel='stylesheet';document.head.appendChild(link);}if(!window.L){const script=document.createElement('script');script.src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';script.async=true;script.onload=()=>setTimeout(initMap,100);script.onerror=()=>setMapError('Errore caricamento Leaflet');document.head.appendChild(script);}else{setTimeout(initMap,100);}function initMap(){if(!mapContainer.current||map.current)return;try{map.current=window.L.map(mapContainer.current,{center:[DUBAI_CENTER.lat,DUBAI_CENTER.lng],zoom:DEFAULT_ZOOM,zoomControl:false});window.L.control.zoom({position:'bottomright'}).addTo(map.current);window.L.tileLayer(LEAFLET_TILE_URL,{attribution:LEAFLET_ATTRIBUTION,maxZoom:19}).addTo(map.current);markersLayer.current=window.L.layerGroup().addTo(map.current);setMapLoaded(true);}catch(err){console.error('Map init error:',err);setMapError('Errore inizializzazione mappa');}}return()=>{if(map.current){map.current.remove();map.current=null;}};},[]);// Add markers - PropertyFinder style red price pills\nuseEffect(()=>{if(!map.current||!mapLoaded||!window.L||!markersLayer.current)return;markersLayer.current.clearLayers();markersMap.current={};Object.values(projectsByLocation).forEach(project=>{const{coords}=project;const price=project.price_from;const priceText=price>0?'From '+(price>=1000000?(price/1000000).toFixed(1)+'M':Math.round(price/1000)+'K'):'Price TBD';const isSelected=(selectedProject===null||selectedProject===void 0?void 0:selectedProject.project_id)===project.project_id;const iconHtml=\"\\n        <div class=\\\"pf-marker \".concat(isSelected?'selected':'',\"\\\">\\n          <span>\").concat(priceText,\"</span>\\n        </div>\\n      \");const customIcon=window.L.divIcon({html:iconHtml,className:'pf-marker-container',iconSize:[90,28],iconAnchor:[45,28]});const marker=window.L.marker([coords.lat,coords.lng],{icon:customIcon}).addTo(markersLayer.current);marker.on('click',e=>{// Stop event propagation to prevent map click handler\nwindow.L.DomEvent.stopPropagation(e);setJustOpened(true);setPopupProject(project);// Reset after a tick\nsetTimeout(()=>setJustOpened(false),100);});markersMap.current[project.project_id]=marker;});},[mapLoaded,projectsByLocation,selectedProject,onSelectProject]);// Fly to selected project\nuseEffect(()=>{if(!map.current||!mapLoaded||!selectedProject)return;const project=projectsByLocation[selectedProject.project_id];if(project!==null&&project!==void 0&&project.coords){map.current.flyTo([project.coords.lat,project.coords.lng],14,{duration:0.5});}},[selectedProject,mapLoaded,projectsByLocation]);// Close popup when clicking elsewhere\n// Close popup when clicking elsewhere, but not immediately after opening\nconst[justOpened,setJustOpened]=useState(false);const handleMapClick=()=>{if(!justOpened){setPopupProject(null);}setJustOpened(false);};const formatPrice=price=>{if(!price||price===0)return'TBD';return parseFloat(price).toLocaleString();};if(mapError){return/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-zinc-800 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-12 h-12 text-red-400 mx-auto mb-3\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400\",children:mapError})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full h-full\",onClick:handleMapClick,children:[/*#__PURE__*/_jsx(\"div\",{ref:mapContainer,className:\"absolute inset-0\",style:{background:'#1a1a1a'}}),!mapLoaded&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800 flex items-center justify-center z-[1000]\",children:/*#__PURE__*/_jsx(RefreshCw,{className:\"w-8 h-8 text-orange-400 animate-spin\"})}),popupProject&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-[1000] animate-fadeIn\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-zinc-800 border border-zinc-700 rounded-2xl overflow-hidden shadow-2xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative h-40\",children:[(_popupProject$images=popupProject.images)!==null&&_popupProject$images!==void 0&&(_popupProject$images$=_popupProject$images[0])!==null&&_popupProject$images$!==void 0&&_popupProject$images$.medium_image_url?/*#__PURE__*/_jsx(\"img\",{src:popupProject.images[0].medium_image_url,alt:\"\",className:\"w-full h-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-zinc-700/50 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-12 h-12 text-zinc-600\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setPopupProject(null);},className:\"absolute top-2 right-2 p-1.5 bg-zinc-800/50 rounded-full text-white hover:bg-zinc-800/70\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-2 left-2 px-2 py-1 bg-orange-500 text-white text-xs font-medium rounded-lg\",children:popupProject.construction_phase_key==='completed'?'✓ Completato':popupProject.construction_phase_key==='under_construction'?'🏗️ In Costruzione':'🚀 Lancio'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-semibold truncate\",children:popupProject.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm truncate\",children:((_popupProject$locatio=popupProject.location)===null||_popupProject$locatio===void 0?void 0:_popupProject$locatio.full_name)||((_popupProject$locatio2=popupProject.location)===null||_popupProject$locatio2===void 0?void 0:_popupProject$locatio2.name)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-400 font-bold\",children:popupProject.price_from>0?'AED '+formatPrice(popupProject.price_from):'TBD'}),popupProject.url?/*#__PURE__*/_jsxs(\"a\",{href:popupProject.url,target:\"_blank\",rel:\"noopener noreferrer\",onClick:e=>e.stopPropagation(),className:\"px-3 py-1.5 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg flex items-center gap-1\",children:[/*#__PURE__*/_jsx(ExternalLink,{className:\"w-3.5 h-3.5\"}),\" PropertyFinder\"]}):/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:e=>{e.stopPropagation();setPopupProject(null);},children:\"Chiudi\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-4 left-4 z-[1000]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-zinc-800/90 backdrop-blur border border-zinc-700 rounded-xl px-3 py-2\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-white text-sm font-medium\",children:[Object.keys(projectsByLocation).length,\" progetti sulla mappa\"]})})}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n        .pf-marker-container { background: transparent !important; border: none !important; }\\n        .pf-marker {\\n          background: #DC2626;\\n          color: white;\\n          padding: 5px 10px;\\n          border-radius: 4px;\\n          font-size: 11px;\\n          font-weight: 600;\\n          box-shadow: 0 2px 6px rgba(0,0,0,0.3);\\n          cursor: pointer;\\n          transition: all 0.15s ease;\\n          white-space: nowrap;\\n          text-align: center;\\n        }\\n        .pf-marker:hover {\\n          background: #B91C1C;\\n          transform: scale(1.05);\\n          z-index: 1000 !important;\\n        }\\n        .pf-marker.selected {\\n          background: #1D4ED8;\\n          transform: scale(1.1);\\n          z-index: 1001 !important;\\n        }\\n        .leaflet-control-zoom { border: none !important; border-radius: 8px !important; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.2); }\\n        .leaflet-control-zoom a { \\n          background: white !important; \\n          color: #333 !important; \\n          border: none !important;\\n          border-bottom: 1px solid #eee !important;\\n          width: 32px !important;\\n          height: 32px !important;\\n          line-height: 32px !important;\\n        }\\n        .leaflet-control-zoom a:hover { background: #f5f5f5 !important; }\\n        .leaflet-control-zoom-in { border-radius: 8px 8px 0 0 !important; }\\n        .leaflet-control-zoom-out { border-radius: 0 0 8px 8px !important; border-bottom: none !important; }\\n      \"})]});}// Project Card Compact for Split View - with hover sync\nfunction ProjectCardCompact(_ref36){var _project$images,_project$images$,_project$location,_project$developer;let{project,isSelected,onClick,onHover}=_ref36;const formatPrice=price=>{if(!price||price===0)return'TBD';const num=parseFloat(price);if(num>=1000000)return(num/1000000).toFixed(1)+'M';return num.toLocaleString();};const formatBedrooms=bedrooms=>{var _bedrooms$available;if(!(bedrooms!==null&&bedrooms!==void 0&&(_bedrooms$available=bedrooms.available)!==null&&_bedrooms$available!==void 0&&_bedrooms$available.length))return null;const beds=bedrooms.available;if(beds.length===1)return beds[0]===0?'Studio':beds[0]+'BR';const min=Math.min(...beds);const max=Math.max(...beds);return min===0?'Studio-'+max+'BR':min+'-'+max+'BR';};const formatDelivery=d=>{if(!d)return null;const date=new Date(d);return'Q'+Math.ceil((date.getMonth()+1)/3)+' '+date.getFullYear();};return/*#__PURE__*/_jsx(\"div\",{onClick:onClick,onMouseEnter:()=>onHover&&onHover(project.project_id),onMouseLeave:()=>onHover&&onHover(null),className:'p-3 rounded-xl cursor-pointer transition-all '+(isSelected?'bg-orange-500/20 border-2 border-orange-500':'bg-zinc-700/50/50 border border-transparent hover:bg-zinc-700/50 hover:border-zinc-600'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700\",children:(_project$images=project.images)!==null&&_project$images!==void 0&&(_project$images$=_project$images[0])!==null&&_project$images$!==void 0&&_project$images$.medium_image_url?/*#__PURE__*/_jsx(\"img\",{src:project.images[0].medium_image_url,alt:\"\",className:\"w-full h-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-8 h-8 text-zinc-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium text-sm truncate\",children:project.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs truncate\",children:(_project$location=project.location)===null||_project$location===void 0?void 0:_project$location.full_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-1.5\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-400 font-bold text-sm\",children:project.price_from>0?'AED '+formatPrice(project.price_from):'TBD'}),formatBedrooms(project.bedrooms)&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-500 text-xs\",children:[\"\\u2022 \",formatBedrooms(project.bedrooms)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-1\",children:[formatDelivery(project.delivery_date)&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-blue-400\",children:[\"\\uD83D\\uDCC5 \",formatDelivery(project.delivery_date)]}),((_project$developer=project.developer)===null||_project$developer===void 0?void 0:_project$developer.name)&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-zinc-500 truncate\",children:[\"\\u2022 \",project.developer.name]})]})]})]})});}// Off-Plan Tab with Map Integration - NOW USES SUPABASE\nfunction OffPlanTab(_ref37){let{clienti,onCreateLead,savedListings,onSaveListing,onRemoveListing,user}=_ref37;const[viewMode,setViewMode]=useState('list');const[listings,setListings]=useState([]);const[allMapProjects,setAllMapProjects]=useState([]);// All projects for map\nconst[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[filters,setFilters]=useState({search:'',location:'',emirate:'',// NEW: emirate filter\nminPrice:'',maxPrice:'',bedrooms:'',developer:'',status:'',// completed, under_construction, launch\ndeliveryYear:'',sortBy:'hotness'// hotness, price_asc, price_desc, delivery\n});const[selectedListing,setSelectedListing]=useState(null);const[showAssignModal,setShowAssignModal]=useState(null);const[page,setPage]=useState(1);const[totalPages,setTotalPages]=useState(1);const[totalResults,setTotalResults]=useState(0);const[selectedAreaProjects,setSelectedAreaProjects]=useState(null);const[selectedAreaName,setSelectedAreaName]=useState('');const[stats,setStats]=useState({byZone:[],byDeveloper:[],avgPrice:0});const[showStats,setShowStats]=useState(false);const ITEMS_PER_PAGE=24;const emirates=['Dubai','Abu Dhabi','Ras Al Khaimah','Sharjah','Ajman','Umm Al Quwain'];const zonesByEmirate={'Dubai':['Dubai Marina','Downtown Dubai','Business Bay','Palm Jumeirah','JBR','Dubai Hills Estate','Mohammed Bin Rashid City','Dubai Creek Harbour','Jumeirah Village Circle','JVC','JLT','Dubai South','DAMAC Hills','DAMAC Hills 2','Arabian Ranches','Meydan','DIFC','Dubai Islands','Expo City','City Walk','Sobha Hartland','Tilal Al Ghaf','The Valley','Motor City','Sports City','Al Furjan','Discovery Gardens','International City','Dubai Silicon Oasis','Arjan','Al Barsha','Jumeirah','Umm Suqeim','Al Quoz','Deira','Bur Dubai'],'Abu Dhabi':['Yas Island','Saadiyat Island','Al Reem Island','Al Raha Beach','Khalifa City','Masdar City','Al Ghadeer','Al Shamkha','Corniche'],'Ras Al Khaimah':['Al Marjan Island','Mina Al Arab','Al Hamra Village','Hayat Island','RAK Central','Yasmin Village'],'Sharjah':['Aljada','Al Mamzar Sharjah','Al Nahda Sharjah','Al Majaz','Muwaileh','Al Khan'],'Ajman':['Ajman Downtown','Ajman Corniche','Al Rashidiya','Al Nuaimiya','Emirates City'],'Umm Al Quwain':['UAQ Marina','UAQ Corniche','Al Salamah']};// Get zones based on selected emirate or all\nconst availableZones=filters.emirate?zonesByEmirate[filters.emirate]||[]:Object.values(zonesByEmirate).flat();const topDevelopers=['Emaar Properties','Damac Properties','Sobha Realty','Nakheel','Meraas','Aldar Properties','Azizi Developments','Binghatti','Ellington','Omniyat Group','Danube Properties','Select Group','Deyaar','MAG','Reportage Properties'];const bedroomOptions=['Studio','1','2','3','4','5+'];const statusOptions=[{value:'',label:'Tutti gli stati'},{value:'completed',label:'Completato'},{value:'under_construction',label:'In Costruzione'},{value:'launch',label:'Lancio'}];const deliveryYears=['2024','2025','2026','2027','2028','2029','2030'];const sortOptions=[{value:'hotness',label:'Più popolari'},{value:'price_asc',label:'Prezzo ↑'},{value:'price_desc',label:'Prezzo ↓'},{value:'delivery',label:'Consegna più vicina'}];// Load stats on mount\nuseEffect(()=>{loadStats();loadAllMapProjects();},[]);const loadStats=async()=>{try{// Get projects by zone (excluding completed)\nconst{data:zoneData}=await supabase.from('pf_projects').select('location_name, price_from').neq('construction_phase','completed');if(zoneData){// Group by zone\nconst zoneMap={};let totalPrice=0;let priceCount=0;zoneData.forEach(p=>{const zone=p.location_name||'Altro';if(!zoneMap[zone])zoneMap[zone]={count:0,totalPrice:0};zoneMap[zone].count++;if(p.price_from>0){zoneMap[zone].totalPrice+=p.price_from;totalPrice+=p.price_from;priceCount++;}});const byZone=Object.entries(zoneMap).map(_ref38=>{let[name,data]=_ref38;return{name,count:data.count,avgPrice:data.totalPrice/data.count||0};}).sort((a,b)=>b.count-a.count).slice(0,10);setStats(s=>_objectSpread(_objectSpread({},s),{},{byZone,avgPrice:totalPrice/priceCount||0}));}// Get projects by developer (excluding completed)\nconst{data:devData}=await supabase.from('pf_projects').select('developer_name').not('developer_name','is',null).neq('construction_phase','completed');if(devData){const devMap={};devData.forEach(p=>{const dev=p.developer_name;devMap[dev]=(devMap[dev]||0)+1;});const byDeveloper=Object.entries(devMap).map(_ref39=>{let[name,count]=_ref39;return{name,count};}).sort((a,b)=>b.count-a.count).slice(0,10);setStats(s=>_objectSpread(_objectSpread({},s),{},{byDeveloper}));}}catch(err){console.error('Stats error:',err);}};// Load all projects with coordinates for map (excluding completed)\nconst loadAllMapProjects=async()=>{try{const{data}=await supabase.from('pf_projects').select('project_id, title, location_name, location_full, price_from, construction_phase, url, raw_data').neq('construction_phase','completed').not('raw_data->location->coordinates','is',null).limit(2000);if(data){const mapProjects=data.map(p=>{var _p$raw_data,_p$raw_data2,_p$raw_data2$location;return{project_id:p.project_id,title:p.title,location:{name:p.location_name,full_name:p.location_full},price_from:p.price_from,construction_phase_key:p.construction_phase,url:p.url,images:(_p$raw_data=p.raw_data)===null||_p$raw_data===void 0?void 0:_p$raw_data.images,coordinates:(_p$raw_data2=p.raw_data)===null||_p$raw_data2===void 0?void 0:(_p$raw_data2$location=_p$raw_data2.location)===null||_p$raw_data2$location===void 0?void 0:_p$raw_data2$location.coordinates};}).filter(p=>{var _p$coordinates3,_p$coordinates4;return((_p$coordinates3=p.coordinates)===null||_p$coordinates3===void 0?void 0:_p$coordinates3.lat)&&((_p$coordinates4=p.coordinates)===null||_p$coordinates4===void 0?void 0:_p$coordinates4.lon);});setAllMapProjects(mapProjects);}}catch(err){console.error('Map projects error:',err);}};// Search from Supabase with real SQL filters\nconst searchListings=async function(){let newPage=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;setLoading(true);setError(null);setPage(newPage);try{// Build query with filters\nlet query=supabase.from('pf_projects').select('*',{count:'exact'});// EXCLUDE completed projects by default (they're not off-plan anymore)\n// Only show completed if explicitly filtered\nif(filters.status){query=query.eq('construction_phase',filters.status);}else{query=query.neq('construction_phase','completed');}// Exclude projects with past delivery dates (before 2024)\nquery=query.or('delivery_date.is.null,delivery_date.gte.2024-01-01');// Apply filters\nif(filters.search){query=query.or(\"title.ilike.%\".concat(filters.search,\"%,location_full.ilike.%\").concat(filters.search,\"%,developer_name.ilike.%\").concat(filters.search,\"%\"));}if(filters.emirate){query=query.ilike('location_full',\"%\".concat(filters.emirate,\"%\"));}if(filters.location){query=query.or(\"location_name.ilike.%\".concat(filters.location,\"%,location_full.ilike.%\").concat(filters.location,\"%\"));}if(filters.developer){query=query.ilike('developer_name',\"%\".concat(filters.developer,\"%\"));}if(filters.minPrice){query=query.gte('price_from',parseInt(filters.minPrice));}if(filters.maxPrice){query=query.lte('price_from',parseInt(filters.maxPrice));}if(filters.deliveryYear){const startDate=\"\".concat(filters.deliveryYear,\"-01-01\");const endDate=\"\".concat(filters.deliveryYear,\"-12-31\");query=query.gte('delivery_date',startDate).lte('delivery_date',endDate);}if(filters.bedrooms){if(filters.bedrooms==='Studio'){query=query.contains('bedrooms',{available:[0]});}else if(filters.bedrooms!=='5+'){query=query.contains('bedrooms',{available:[parseInt(filters.bedrooms)]});}}// Apply sorting\nswitch(filters.sortBy){case'price_asc':query=query.order('price_from',{ascending:true,nullsFirst:false});break;case'price_desc':query=query.order('price_from',{ascending:false,nullsFirst:false});break;case'delivery':query=query.order('delivery_date',{ascending:true,nullsFirst:false});break;default:query=query.order('hotness_level',{ascending:false,nullsFirst:false});}// Paginate\nquery=query.range((newPage-1)*ITEMS_PER_PAGE,newPage*ITEMS_PER_PAGE-1);const{data,error:queryError,count}=await query;if(queryError)throw queryError;// Transform data to match expected format\nconst transformedData=(data||[]).map(p=>{var _p$raw_data3,_p$raw_data3$develope,_p$raw_data4,_p$raw_data4$brochure,_p$raw_data5;return{project_id:p.project_id,title:p.title,location:{name:p.location_name,full_name:p.location_full},developer:{name:p.developer_name,logo:(_p$raw_data3=p.raw_data)===null||_p$raw_data3===void 0?void 0:(_p$raw_data3$develope=_p$raw_data3.developer)===null||_p$raw_data3$develope===void 0?void 0:_p$raw_data3$develope.logo},price_from:p.price_from,bedrooms:p.bedrooms,delivery_date:p.delivery_date,construction_phase_key:p.construction_phase,hotness_level:p.hotness_level,images:p.images||[],payment_plans:p.payment_plans,url:p.url,// Try to get brochure from data, or construct from project_id if it's a UUID\nbrochure_url:p.brochure_url||((_p$raw_data4=p.raw_data)===null||_p$raw_data4===void 0?void 0:(_p$raw_data4$brochure=_p$raw_data4.brochure)===null||_p$raw_data4$brochure===void 0?void 0:_p$raw_data4$brochure.url)||((_p$raw_data5=p.raw_data)===null||_p$raw_data5===void 0?void 0:_p$raw_data5.brochure)||(p.project_id&&p.project_id.includes('-')?\"https://new-projects-media.propertyfinder.com/project/\".concat(p.project_id,\"/brochure/application/original.pdf\"):null)};});// Additional client-side filter for 5+ bedrooms\nlet finalData=transformedData;if(filters.bedrooms==='5+'){finalData=transformedData.filter(p=>{var _p$bedrooms,_p$bedrooms$available;return(_p$bedrooms=p.bedrooms)===null||_p$bedrooms===void 0?void 0:(_p$bedrooms$available=_p$bedrooms.available)===null||_p$bedrooms$available===void 0?void 0:_p$bedrooms$available.some(b=>b>=5);});}setListings(finalData);setTotalResults(count||0);setTotalPages(Math.ceil((count||0)/ITEMS_PER_PAGE));}catch(err){console.error('Supabase Error:',err);setError('Errore nel caricamento progetti.');}finally{setLoading(false);}};const handlePageChange=newPage=>{if(newPage>=1&&newPage<=totalPages){searchListings(newPage);window.scrollTo({top:0,behavior:'smooth'});}};// Export filtered projects to CSV\nconst exportProjectsCSV=async()=>{try{// Build same query as search but get all results\nlet query=supabase.from('pf_projects').select('title, location_full, developer_name, price_from, construction_phase, delivery_date, url');if(filters.search)query=query.or(\"title.ilike.%\".concat(filters.search,\"%,location_full.ilike.%\").concat(filters.search,\"%,developer_name.ilike.%\").concat(filters.search,\"%\"));if(filters.location)query=query.or(\"location_name.ilike.%\".concat(filters.location,\"%,location_full.ilike.%\").concat(filters.location,\"%\"));if(filters.developer)query=query.ilike('developer_name',\"%\".concat(filters.developer,\"%\"));if(filters.minPrice)query=query.gte('price_from',parseInt(filters.minPrice));if(filters.maxPrice)query=query.lte('price_from',parseInt(filters.maxPrice));if(filters.status)query=query.eq('construction_phase',filters.status);if(filters.deliveryYear){query=query.gte('delivery_date',\"\".concat(filters.deliveryYear,\"-01-01\")).lte('delivery_date',\"\".concat(filters.deliveryYear,\"-12-31\"));}query=query.order('hotness_level',{ascending:false}).limit(1000);const{data}=await query;if(!(data!==null&&data!==void 0&&data.length))return;const headers=['Progetto','Location','Developer','Prezzo Da (AED)','Stato','Consegna','URL'];const rows=data.map(p=>[p.title,p.location_full,p.developer_name,p.price_from,p.construction_phase==='completed'?'Completato':p.construction_phase==='under_construction'?'In Costruzione':'Lancio',p.delivery_date,p.url]);const csv=[headers.join(','),...rows.map(r=>r.map(c=>\"\\\"\".concat((c||'').toString().replace(/\"/g,'\"\"'),\"\\\"\")).join(','))].join('\\n');const blob=new Blob([csv],{type:'text/csv'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=\"offplan-projects-\".concat(new Date().toISOString().split('T')[0],\".csv\");a.click();URL.revokeObjectURL(url);}catch(err){console.error('Export error:',err);}};useEffect(()=>{searchListings(1);},[]);const isListingSaved=projectId=>savedListings===null||savedListings===void 0?void 0:savedListings.some(s=>s.property_id===projectId);const formatPrice=price=>{if(!price||price===0)return'TBD';const num=parseFloat(price);if(num>=1000000)return(num/1000000).toFixed(1)+'M';if(num>=1000)return(num/1000).toFixed(0)+'K';return num.toLocaleString();};const formatBedrooms=bedrooms=>{var _bedrooms$available2;if(!(bedrooms!==null&&bedrooms!==void 0&&(_bedrooms$available2=bedrooms.available)!==null&&_bedrooms$available2!==void 0&&_bedrooms$available2.length))return null;const beds=bedrooms.available;if(beds.length===1)return beds[0]===0?'Studio':beds[0]+' BR';const min=Math.min(...beds);const max=Math.max(...beds);return min===0?'Studio - '+max+' BR':min+' - '+max+' BR';};const formatDelivery=dateStr=>{if(!dateStr)return null;const date=new Date(dateStr);const quarter=Math.ceil((date.getMonth()+1)/3);return'Q'+quarter+' '+date.getFullYear();};const formatPaymentPlan=plans=>{var _plans$plans;if(!(plans!==null&&plans!==void 0&&(_plans$plans=plans.plans)!==null&&_plans$plans!==void 0&&_plans$plans[0]))return null;const plan=plans.plans[0].summary;return plan.down_payment+'/'+plan.during_construction+'/'+plan.handover;};const handleAreaClick=(projects,areaName)=>{setSelectedAreaProjects(projects);setSelectedAreaName(areaName);};const displayProjects=selectedAreaProjects||listings;return/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-semibold text-white flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Building2,{className:\"w-6 h-6 text-orange-400\"}),\"Off-Plan Projects\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm mt-1\",children:[totalResults>0?totalResults.toLocaleString()+' progetti':'Cerca progetti',selectedAreaName&&' • '+selectedAreaName]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>setShowStats(!showStats),icon:PieChart,children:showStats?'Nascondi':'Stats'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 bg-zinc-700/50/50 p-1 rounded-xl\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setViewMode('list');setSelectedAreaProjects(null);},className:'p-2 rounded-lg transition-colors '+(viewMode==='list'?'bg-orange-500 text-white':'text-zinc-400 hover:text-white'),title:\"Lista\",children:/*#__PURE__*/_jsx(List,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setViewMode('map'),className:'p-2 rounded-lg transition-colors '+(viewMode==='map'?'bg-orange-500 text-white':'text-zinc-400 hover:text-white'),title:\"Mappa\",children:/*#__PURE__*/_jsx(Map,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setViewMode('saved'),className:'p-2 rounded-lg transition-colors relative '+(viewMode==='saved'?'bg-orange-500 text-white':'text-zinc-400 hover:text-white'),title:\"Salvati\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:viewMode==='saved'?'currentColor':'none',stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\"})}),(savedListings===null||savedListings===void 0?void 0:savedListings.length)>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-1 -right-1 w-4 h-4 bg-orange-500 rounded-full text-[10px] flex items-center justify-center text-white font-bold\",children:savedListings.length})]})]})]})]}),showStats&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(Card,{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-medium mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 text-orange-400\"}),\"Top Zone\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:stats.byZone.slice(0,5).map((z,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400 text-sm truncate flex-1\",children:z.name}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm font-medium ml-2\",children:z.count})]},z.name))})]}),/*#__PURE__*/_jsxs(Card,{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-medium mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Building2,{className:\"w-4 h-4 text-orange-400\"}),\"Top Developer\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:stats.byDeveloper.slice(0,5).map((d,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400 text-sm truncate flex-1\",children:d.name}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm font-medium ml-2\",children:d.count})]},d.name))})]}),/*#__PURE__*/_jsxs(Card,{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-medium mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(DollarSign,{className:\"w-4 h-4 text-orange-400\"}),\"Statistiche\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:\"Totale Progetti\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-xl font-bold\",children:totalResults.toLocaleString()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:\"Prezzo Medio\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-orange-400 text-xl font-bold\",children:[\"AED \",(stats.avgPrice/1000000).toFixed(1),\"M\"]})]})]})]})]}),/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative mb-3\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cerca progetto, zona o developer...\",value:filters.search,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{search:e.target.value})),onKeyDown:e=>e.key==='Enter'&&searchListings(1),className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-3 text-white placeholder:text-zinc-600 focus:border-orange-500 focus:outline-none\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-9 gap-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:filters.emirate,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{emirate:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uD83C\\uDDE6\\uD83C\\uDDEA Emirato\"}),emirates.map(e=>/*#__PURE__*/_jsx(\"option\",{value:e,children:e},e))]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.location,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{location:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutte le zone\"}),availableZones.map(a=>/*#__PURE__*/_jsx(\"option\",{value:a,children:a},a))]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.developer,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{developer:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Developer\"}),topDevelopers.map(d=>/*#__PURE__*/_jsx(\"option\",{value:d,children:d},d))]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.bedrooms,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{bedrooms:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Camere\"}),bedroomOptions.map(b=>/*#__PURE__*/_jsx(\"option\",{value:b,children:b==='Studio'?'Studio':b+' BR'},b))]}),/*#__PURE__*/_jsx(\"select\",{value:filters.status,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{status:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\",children:statusOptions.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s.value,children:s.label},s.value))}),/*#__PURE__*/_jsxs(\"select\",{value:filters.deliveryYear,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{deliveryYear:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Consegna\"}),deliveryYears.map(y=>/*#__PURE__*/_jsx(\"option\",{value:y,children:y},y))]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Min AED\",value:filters.minPrice,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{minPrice:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Max AED\",value:filters.maxPrice,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{maxPrice:e.target.value})),className:\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>{setSelectedAreaProjects(null);searchListings(1);},icon:Search,disabled:loading,children:loading?'...':'Cerca'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-3 pt-3 border-t border-zinc-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 text-sm\",children:\"Ordina:\"}),/*#__PURE__*/_jsx(\"select\",{value:filters.sortBy,onChange:e=>{setFilters(f=>_objectSpread(_objectSpread({},f),{},{sortBy:e.target.value}));searchListings(1);},className:\"bg-transparent border-none text-orange-400 text-sm focus:outline-none cursor-pointer\",children:sortOptions.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s.value,children:s.label},s.value))})]}),listings.length>0&&/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",size:\"sm\",onClick:exportProjectsCSV,children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4 mr-1\"}),\"Export CSV\"]})]}),(filters.emirate||filters.location||filters.developer||filters.status||filters.deliveryYear||filters.minPrice||filters.maxPrice||filters.bedrooms)&&/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>{setFilters({search:'',emirate:'',location:'',minPrice:'',maxPrice:'',bedrooms:'',developer:'',status:'',deliveryYear:'',sortBy:'hotness'});searchListings(1);},children:[/*#__PURE__*/_jsx(X,{className:\"w-4 h-4 mr-1\"}),\"Reset filtri\"]})]})]}),selectedAreaProjects&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400 text-sm\",children:[\"Filtrato: \",/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-400\",children:selectedAreaName})]}),/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>{setSelectedAreaProjects(null);setSelectedAreaName('');},children:[/*#__PURE__*/_jsx(X,{className:\"w-4 h-4 mr-1\"}),\"Rimuovi\"]})]})]}),error&&/*#__PURE__*/_jsx(Card,{className:\"border-red-500/20 bg-red-500/5 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 text-red-400\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:error}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>searchListings(1),children:\"Riprova\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-h-0\",children:[viewMode==='list'&&/*#__PURE__*/_jsx(\"div\",{className:\"h-full overflow-y-auto\",children:loading&&listings.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:[1,2,3,4,5,6].map(i=>/*#__PURE__*/_jsxs(Card,{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-40 bg-zinc-700/50 rounded-xl mb-3\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-zinc-700/50 rounded w-3/4 mb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-3 bg-zinc-700/50 rounded w-1/2\"})]},i))}):displayProjects.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:displayProjects.map(project=>{var _project$images2,_project$images2$,_project$location2,_project$developer2;return/*#__PURE__*/_jsxs(Card,{hover:true,className:\"overflow-hidden group cursor-pointer\",onClick:()=>setSelectedListing(project),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative h-40 -mx-4 -mt-4 mb-3 overflow-hidden\",children:[(_project$images2=project.images)!==null&&_project$images2!==void 0&&(_project$images2$=_project$images2[0])!==null&&_project$images2$!==void 0&&_project$images2$.medium_image_url?/*#__PURE__*/_jsx(\"img\",{src:project.images[0].medium_image_url,alt:project.title,className:\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-zinc-700/50 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-12 h-12 text-zinc-600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-2 left-2 flex gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:'px-2 py-1 text-white text-xs font-medium rounded-lg '+(project.construction_phase_key==='completed'?'bg-green-500/90':project.construction_phase_key==='under_construction'?'bg-orange-500/90':'bg-blue-500/90'),children:project.construction_phase_key==='completed'?'Completato':project.construction_phase_key==='under_construction'?'In Costruzione':'Lancio'}),project.hotness_level>=80&&/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-gradient-to-r from-red-500 to-orange-500 text-white text-xs font-medium rounded-lg\",children:\"\\uD83D\\uDD25\"})]}),formatDelivery(project.delivery_date)&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 right-12 px-2 py-1 bg-zinc-800/70 text-white text-xs rounded-lg\",children:formatDelivery(project.delivery_date)}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();isListingSaved(project.project_id)?onRemoveListing(project.project_id):onSaveListing(project);},className:'absolute top-2 right-2 p-2 rounded-full transition-colors '+(isListingSaved(project.project_id)?'bg-orange-500 text-white':'bg-zinc-800/50 text-white hover:bg-orange-500'),children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:isListingSaved(project.project_id)?'currentColor':'none',stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium line-clamp-1\",children:project.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm line-clamp-1\",children:(_project$location2=project.location)===null||_project$location2===void 0?void 0:_project$location2.full_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 text-xs text-zinc-400\",children:[formatBedrooms(project.bedrooms)&&/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Building2,{className:\"w-3.5 h-3.5\"}),formatBedrooms(project.bedrooms)]}),project.payment_plans&&/*#__PURE__*/_jsx(\"span\",{children:formatPaymentPlan(project.payment_plans)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between pt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-400 font-semibold\",children:project.price_from>0?'da AED '+formatPrice(project.price_from):'Prezzo TBD'}),((_project$developer2=project.developer)===null||_project$developer2===void 0?void 0:_project$developer2.name)&&/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 text-xs truncate max-w-[100px]\",children:project.developer.name})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3 pt-3 border-t border-zinc-800\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",size:\"sm\",className:\"flex-1\",onClick:e=>{e.stopPropagation();setSelectedListing(project);},children:[/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4 mr-1\"}),\"Dettagli\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"secondary\",size:\"sm\",className:\"flex-1\",onClick:e=>{e.stopPropagation();setShowAssignModal(project);},children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4 mr-1\"}),\"Lead\"]})]})]},project.project_id);})}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-2 pt-6 pb-4\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>handlePageChange(page-1),disabled:page===1,children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-4 h-4\"})}),Array.from({length:Math.min(5,totalPages)},(_,i)=>{let pageNum;if(totalPages<=5){pageNum=i+1;}else if(page<=3){pageNum=i+1;}else if(page>=totalPages-2){pageNum=totalPages-4+i;}else{pageNum=page-2+i;}return/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(pageNum),className:\"w-10 h-10 rounded-lg text-sm font-medium transition-colors \".concat(page===pageNum?'bg-orange-500 text-white':'bg-zinc-700/50 text-zinc-400 hover:bg-zinc-700'),children:pageNum},pageNum);}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>handlePageChange(page+1),disabled:page===totalPages,children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-500 text-sm ml-4\",children:[totalResults.toLocaleString(),\" progetti\"]})]})]}):/*#__PURE__*/_jsx(EmptyState,{icon:Building2,title:\"Nessun risultato\",description:\"Modifica i filtri\"})}),viewMode==='map'&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 bg-[#0f172a]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-0 left-0 right-0 z-20 bg-[#0f172a]/95 backdrop-blur border-b border-zinc-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-3 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/logo.png\",alt:\"KeyPrime\",className:\"h-8 lg:h-10\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 hidden sm:inline\",children:\"|\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400 text-sm\",children:[displayProjects.length,\" progetti\"]})]}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>setViewMode('list'),icon:X,children:\"Chiudi\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 pb-3 flex items-center gap-2 overflow-x-auto scrollbar-hide\",children:[/*#__PURE__*/_jsxs(\"select\",{value:filters.emirate,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{emirate:e.target.value})),className:\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[100px] flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uD83C\\uDDE6\\uD83C\\uDDEA Emirato\"}),emirates.map(e=>/*#__PURE__*/_jsx(\"option\",{value:e,children:e},e))]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.location,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{location:e.target.value})),className:\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[120px] flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutte le zone\"}),availableZones.map(a=>/*#__PURE__*/_jsx(\"option\",{value:a,children:a},a))]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.developer,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{developer:e.target.value})),className:\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[130px] flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutti i developer\"}),topDevelopers.map(d=>/*#__PURE__*/_jsx(\"option\",{value:d,children:d},d))]}),/*#__PURE__*/_jsxs(\"select\",{value:filters.bedrooms,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{bedrooms:e.target.value})),className:\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[90px] flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Camere\"}),bedroomOptions.map(b=>/*#__PURE__*/_jsx(\"option\",{value:b,children:b==='Studio'?'Studio':b+' BR'},b))]}),/*#__PURE__*/_jsx(Button,{onClick:()=>searchListings(1),size:\"sm\",className:\"flex-shrink-0\",disabled:loading,children:loading?'...':'Cerca'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 pt-24 lg:pt-28\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"hidden lg:flex h-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-96 h-full bg-[#1e293b] border-r border-zinc-800 flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 border-b border-zinc-800\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cerca progetto...\",value:filters.search,onChange:e=>setFilters(f=>_objectSpread(_objectSpread({},f),{},{search:e.target.value})),onKeyDown:e=>e.key==='Enter'&&searchListings(1),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg pl-10 pr-4 py-2 text-white text-sm placeholder:text-zinc-500 focus:border-orange-500 focus:outline-none\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto\",children:[displayProjects.map(project=>{var _project$images3,_project$images3$,_project$location3;return/*#__PURE__*/_jsx(\"div\",{onClick:()=>setSelectedListing(project),className:'p-3 border-b border-zinc-800/50 cursor-pointer hover:bg-zinc-700/30 transition-colors '+((selectedListing===null||selectedListing===void 0?void 0:selectedListing.project_id)===project.project_id?'bg-orange-500/10 border-l-2 border-l-orange-500':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-16 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700\",children:(_project$images3=project.images)!==null&&_project$images3!==void 0&&(_project$images3$=_project$images3[0])!==null&&_project$images3$!==void 0&&_project$images3$.medium_image_url?/*#__PURE__*/_jsx(\"img\",{src:project.images[0].medium_image_url,alt:\"\",className:\"w-full h-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-6 h-6 text-zinc-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-white text-sm truncate\",children:project.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 truncate\",children:(_project$location3=project.location)===null||_project$location3===void 0?void 0:_project$location3.full_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-400 font-semibold text-sm mt-1\",children:project.price_from>0?'From '+formatPrice(project.price_from):'TBD'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-xs text-zinc-500\",children:[formatBedrooms(project.bedrooms)&&/*#__PURE__*/_jsx(\"span\",{children:formatBedrooms(project.bedrooms)}),formatDelivery(project.delivery_date)&&/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u2022 \",formatDelivery(project.delivery_date)]})]})]})]})},project.project_id);}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 flex items-center justify-center gap-2 border-t border-zinc-800\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>handlePageChange(page-1),disabled:page===1,children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400 text-sm\",children:[\"Pag. \",page,\"/\",totalPages]}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>handlePageChange(page+1),disabled:page===totalPages,children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-4 h-4\"})})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 relative\",children:/*#__PURE__*/_jsx(MapboxMap,{projects:listings,onSelectProject:setSelectedListing,selectedProject:selectedListing,onAreaClick:handleAreaClick})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:hidden h-full flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 relative\",children:/*#__PURE__*/_jsx(MapboxMap,{projects:listings,onSelectProject:setSelectedListing,selectedProject:selectedListing,onAreaClick:handleAreaClick})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-[#0f172a] via-[#0f172a]/95 to-transparent pt-8 pb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-3 overflow-x-auto px-4 pb-2 snap-x snap-mandatory scrollbar-hide\",children:displayProjects.map(project=>{var _project$images4,_project$images4$,_project$location4;return/*#__PURE__*/_jsx(\"div\",{onClick:()=>setSelectedListing(project),className:'flex-shrink-0 w-72 bg-[#1e293b] rounded-xl p-3 border transition-all snap-start '+((selectedListing===null||selectedListing===void 0?void 0:selectedListing.project_id)===project.project_id?'border-orange-500 scale-[1.02]':'border-zinc-800'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700\",children:(_project$images4=project.images)!==null&&_project$images4!==void 0&&(_project$images4$=_project$images4[0])!==null&&_project$images4$!==void 0&&_project$images4$.medium_image_url?/*#__PURE__*/_jsx(\"img\",{src:project.images[0].medium_image_url,alt:\"\",className:\"w-full h-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-8 h-8 text-zinc-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-white text-sm line-clamp-1\",children:project.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 line-clamp-1\",children:(_project$location4=project.location)===null||_project$location4===void 0?void 0:_project$location4.full_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-400 font-bold mt-1\",children:project.price_from>0?'From '+formatPrice(project.price_from):'TBD'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-xs text-zinc-500 mt-0.5\",children:[formatBedrooms(project.bedrooms)&&/*#__PURE__*/_jsx(\"span\",{children:formatBedrooms(project.bedrooms)}),formatDelivery(project.delivery_date)&&/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u2022 \",formatDelivery(project.delivery_date)]})]})]})]})},project.project_id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center gap-2 mt-2\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-500 text-xs\",children:[displayProjects.length,\" progetti \\u2022 Scorri \\u2192\"]})})]})]})]})]}),viewMode==='saved'&&/*#__PURE__*/_jsx(\"div\",{className:\"h-full overflow-y-auto\",children:(savedListings===null||savedListings===void 0?void 0:savedListings.length)>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-400 text-sm\",children:[savedListings.length,\" progetti salvati\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:savedListings.map(saved=>{var _project$images5,_project$images5$,_project$location5,_project$developer3,_project$developer4;// Try to get full project data, fallback to saved fields\nconst project=saved.property_data||{project_id:saved.property_id,title:saved.title,price_from:saved.price,location:{full_name:saved.location_full,name:saved.location_path},developer:{name:saved.agent_name},images:saved.image_url?[{medium_image_url:saved.image_url}]:[],construction_phase_key:saved.completion_status,url:saved.pf_url};const imageUrl=((_project$images5=project.images)===null||_project$images5===void 0?void 0:(_project$images5$=_project$images5[0])===null||_project$images5$===void 0?void 0:_project$images5$.medium_image_url)||saved.image_url;return/*#__PURE__*/_jsxs(Card,{hover:true,className:\"overflow-hidden group cursor-pointer\",onClick:()=>setSelectedListing(project),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative h-40 -mx-4 -mt-4 mb-3 overflow-hidden\",children:[imageUrl?/*#__PURE__*/_jsx(\"img\",{src:imageUrl,alt:project.title,className:\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-zinc-700/50 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-12 h-12 text-zinc-600\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onRemoveListing(saved.property_id);},className:\"absolute top-2 right-2 p-2 rounded-full bg-orange-500 text-white hover:bg-red-500 transition-colors\",title:\"Rimuovi dai salvati\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})}),saved.completion_status&&/*#__PURE__*/_jsx(\"span\",{className:'absolute top-2 left-2 px-2 py-1 text-white text-xs font-medium rounded-lg '+(saved.completion_status==='completed'?'bg-green-500/90':saved.completion_status==='under_construction'?'bg-orange-500/90':'bg-blue-500/90'),children:saved.completion_status==='completed'?'Completato':saved.completion_status==='under_construction'?'In Costruzione':'Lancio'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium line-clamp-1\",children:project.title||saved.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm line-clamp-1\",children:((_project$location5=project.location)===null||_project$location5===void 0?void 0:_project$location5.full_name)||saved.location_full}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between pt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-400 font-semibold\",children:(project.price_from||saved.price)>0?'da AED '+parseFloat(project.price_from||saved.price).toLocaleString():'Prezzo TBD'}),(((_project$developer3=project.developer)===null||_project$developer3===void 0?void 0:_project$developer3.name)||saved.agent_name)&&/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 text-xs truncate max-w-[100px]\",children:((_project$developer4=project.developer)===null||_project$developer4===void 0?void 0:_project$developer4.name)||saved.agent_name})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3 pt-3 border-t border-zinc-800\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",size:\"sm\",className:\"flex-1\",onClick:e=>{e.stopPropagation();setSelectedListing(project);},children:[/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4 mr-1\"}),\"Dettagli\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"secondary\",size:\"sm\",className:\"flex-1\",onClick:e=>{e.stopPropagation();setShowAssignModal(project);},children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4 mr-1\"}),\"Lead\"]})]})]},saved.id);})})]}):/*#__PURE__*/_jsx(EmptyState,{icon:Building2,title:\"Nessun progetto salvato\",description:\"Salva i progetti che ti interessano cliccando sull'icona segnalibro\",actionLabel:\"Cerca Progetti\",onAction:()=>setViewMode('list')})})]}),selectedListing&&/*#__PURE__*/_jsx(ListingDetailModal,{listing:selectedListing,onClose:()=>setSelectedListing(null),onCreateLead:()=>{setShowAssignModal(selectedListing);setSelectedListing(null);},isSaved:isListingSaved(selectedListing.project_id),onToggleSave:()=>isListingSaved(selectedListing.project_id)?onRemoveListing(selectedListing.project_id):onSaveListing(selectedListing)}),showAssignModal&&/*#__PURE__*/_jsx(AssignListingModal,{listing:showAssignModal,clienti:clienti,onClose:()=>setShowAssignModal(null),onCreateLead:onCreateLead,user:user})]});}// Listing Detail Modal (for Off-Plan Projects) - Enhanced with Gallery, Map, Location Insights\nfunction ListingDetailModal(_ref40){var _listing$location5,_listing$location6,_listing$location7,_listing$location8,_images$activeImageIn,_listing$location0,_listing$bedrooms2,_listing$bedrooms2$av,_listing$payment_plan4,_listing$payment_plan5,_listing$payment_plan6,_listing$payment_plan7,_listing$payment_plan8,_listing$payment_plan9;let{listing,onClose,onCreateLead,isSaved,onToggleSave}=_ref40;const[activeImageIndex,setActiveImageIndex]=useState(0);const[showFullGallery,setShowFullGallery]=useState(false);const[generatingPdf,setGeneratingPdf]=useState(false);const[brochureUrl,setBrochureUrl]=useState(null);const[videoUrl,setVideoUrl]=useState(null);const[videoType,setVideoType]=useState(null);const[mediaLoading,setMediaLoading]=useState(false);const[showBrochureViewer,setShowBrochureViewer]=useState(false);const[showVideoPlayer,setShowVideoPlayer]=useState(false);// Fetch brochure and video URLs on mount\nuseEffect(()=>{if(listing!==null&&listing!==void 0&&listing.url){setMediaLoading(true);fetch(\"/api/get-brochure?url=\".concat(encodeURIComponent(listing.url))).then(res=>res.json()).then(data=>{if(data.success){if(data.brochure_url)setBrochureUrl(data.brochure_url);if(data.video_url){setVideoUrl(data.video_url);setVideoType(data.video_type);}}}).catch(()=>{}).finally(()=>setMediaLoading(false));}},[listing===null||listing===void 0?void 0:listing.url]);const formatPrice=price=>{if(!price||price===0)return'Su richiesta';return parseFloat(price).toLocaleString();};const formatBedrooms=bedrooms=>{var _bedrooms$available3;if(!(bedrooms!==null&&bedrooms!==void 0&&(_bedrooms$available3=bedrooms.available)!==null&&_bedrooms$available3!==void 0&&_bedrooms$available3.length))return null;const beds=bedrooms.available;if(beds.length===1)return beds[0]===0?'Studio':\"\".concat(beds[0],\" Camere\");const min=Math.min(...beds);const max=Math.max(...beds);return min===0?\"Studio - \".concat(max,\" Camere\"):\"\".concat(min,\" - \").concat(max,\" Camere\");};const formatDelivery=dateStr=>{if(!dateStr)return null;const date=new Date(dateStr);const quarter=Math.ceil((date.getMonth()+1)/3);return\"Q\".concat(quarter,\" \").concat(date.getFullYear());};const getStatusLabel=status=>{switch(status){case'completed':return{text:'Completato',color:'bg-green-500',icon:'✓'};case'under_construction':return{text:'In Costruzione',color:'bg-orange-500',icon:'🏗️'};case'not_started':return{text:'Nuovo Lancio',color:'bg-blue-500',icon:'🚀'};default:return{text:'Off-Plan',color:'bg-orange-500',icon:'📋'};}};// Generate PDF for WhatsApp sharing\nconst downloadProjectPDF=async()=>{setGeneratingPdf(true);try{var _listing$payment_plan,_listing$payment_plan2,_listing$payment_plan3,_listing$images2,_listing$images2$,_listing$developer2,_listing$location4;const status=getStatusLabel(listing.construction_phase_key);const paymentPlan=(_listing$payment_plan=listing.payment_plans)===null||_listing$payment_plan===void 0?void 0:(_listing$payment_plan2=_listing$payment_plan.plans)===null||_listing$payment_plan2===void 0?void 0:(_listing$payment_plan3=_listing$payment_plan2[0])===null||_listing$payment_plan3===void 0?void 0:_listing$payment_plan3.summary;const imageUrl=((_listing$images2=listing.images)===null||_listing$images2===void 0?void 0:(_listing$images2$=_listing$images2[0])===null||_listing$images2$===void 0?void 0:_listing$images2$.medium_image_url)||'';const htmlContent=\"\\n<!DOCTYPE html>\\n<html>\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <style>\\n    * { margin: 0; padding: 0; box-sizing: border-box; }\\n    body { font-family: 'Helvetica Neue', Arial, sans-serif; background: #111; color: #fff; padding: 40px; }\\n    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #f97316; padding-bottom: 20px; }\\n    .logo { font-size: 28px; font-weight: bold; color: #f97316; }\\n    .date { color: #888; font-size: 12px; }\\n    .hero { position: relative; margin-bottom: 30px; border-radius: 16px; overflow: hidden; }\\n    .hero img { width: 100%; height: 300px; object-fit: cover; }\\n    .badge { position: absolute; top: 16px; left: 16px; background: #f97316; color: white; padding: 8px 16px; border-radius: 8px; font-weight: bold; font-size: 14px; }\\n    .title { font-size: 32px; font-weight: bold; margin-bottom: 8px; }\\n    .location { color: #888; font-size: 16px; margin-bottom: 24px; }\\n    .price { font-size: 36px; font-weight: bold; color: #f97316; margin-bottom: 30px; }\\n    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px; }\\n    .card { background: #1a1a1a; border-radius: 12px; padding: 20px; }\\n    .card-title { color: #888; font-size: 12px; text-transform: uppercase; margin-bottom: 8px; }\\n    .card-value { font-size: 20px; font-weight: bold; }\\n    .section { margin-bottom: 30px; }\\n    .section-title { font-size: 18px; font-weight: bold; margin-bottom: 16px; color: #f97316; }\\n    .payment-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }\\n    .payment-item { background: #1a1a1a; border-radius: 12px; padding: 16px; text-align: center; }\\n    .payment-percent { font-size: 28px; font-weight: bold; color: #f97316; }\\n    .payment-label { font-size: 12px; color: #888; margin-top: 4px; }\\n    .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #333; text-align: center; color: #666; font-size: 12px; }\\n    .cta { background: #f97316; color: white; padding: 16px 32px; border-radius: 12px; font-weight: bold; font-size: 16px; display: inline-block; margin-top: 20px; text-decoration: none; }\\n    .developer { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }\\n    .developer-name { font-size: 16px; color: #ccc; }\\n  </style>\\n</head>\\n<body>\\n  <div class=\\\"header\\\">\\n    <div class=\\\"logo\\\">\\uD83D\\uDD11 KeyPrime</div>\\n    <div class=\\\"date\\\">\".concat(new Date().toLocaleDateString('it-IT',{day:'numeric',month:'long',year:'numeric'}),\"</div>\\n  </div>\\n  \\n  \").concat(imageUrl?\"<div class=\\\"hero\\\"><img src=\\\"\".concat(imageUrl,\"\\\" /><div class=\\\"badge\\\">\").concat(status.icon,\" \").concat(status.text,\"</div></div>\"):'',\"\\n  \\n  <div class=\\\"developer\\\">\\n    <span class=\\\"developer-name\\\">by \").concat(((_listing$developer2=listing.developer)===null||_listing$developer2===void 0?void 0:_listing$developer2.name)||'Developer',\"</span>\\n  </div>\\n  \\n  <h1 class=\\\"title\\\">\").concat(listing.title,\"</h1>\\n  <p class=\\\"location\\\">\\uD83D\\uDCCD \").concat(((_listing$location4=listing.location)===null||_listing$location4===void 0?void 0:_listing$location4.full_name)||'',\"</p>\\n  <p class=\\\"price\\\">A partire da AED \").concat(formatPrice(listing.price_from),\"</p>\\n  \\n  <div class=\\\"grid\\\">\\n    <div class=\\\"card\\\">\\n      <div class=\\\"card-title\\\">Tipologie</div>\\n      <div class=\\\"card-value\\\">\").concat(formatBedrooms(listing.bedrooms)||'Varie',\"</div>\\n    </div>\\n    <div class=\\\"card\\\">\\n      <div class=\\\"card-title\\\">Consegna</div>\\n      <div class=\\\"card-value\\\">\").concat(formatDelivery(listing.delivery_date)||'TBA',\"</div>\\n    </div>\\n    <div class=\\\"card\\\">\\n      <div class=\\\"card-title\\\">Stato</div>\\n      <div class=\\\"card-value\\\">\").concat(status.text,\"</div>\\n    </div>\\n    <div class=\\\"card\\\">\\n      <div class=\\\"card-title\\\">Popolarit\\xE0</div>\\n      <div class=\\\"card-value\\\">\").concat(listing.hotness_level||0,\"/100 \\uD83D\\uDD25</div>\\n    </div>\\n  </div>\\n  \\n  \").concat(paymentPlan?\"\\n  <div class=\\\"section\\\">\\n    <div class=\\\"section-title\\\">Piano di Pagamento</div>\\n    <div class=\\\"payment-grid\\\">\\n      <div class=\\\"payment-item\\\">\\n        <div class=\\\"payment-percent\\\">\".concat(paymentPlan.down_payment||0,\"%</div>\\n        <div class=\\\"payment-label\\\">Anticipo</div>\\n      </div>\\n      <div class=\\\"payment-item\\\">\\n        <div class=\\\"payment-percent\\\">\").concat(paymentPlan.during_construction||0,\"%</div>\\n        <div class=\\\"payment-label\\\">In Costruzione</div>\\n      </div>\\n      <div class=\\\"payment-item\\\">\\n        <div class=\\\"payment-percent\\\">\").concat(paymentPlan.handover||0,\"%</div>\\n        <div class=\\\"payment-label\\\">Alla Consegna</div>\\n      </div>\\n    </div>\\n  </div>\\n  \"):'',\"\\n  \\n  <div style=\\\"text-align: center;\\\">\\n    <a href=\\\"\").concat(listing.url||'#',\"\\\" class=\\\"cta\\\">Scopri di pi\\xF9 \\u2192</a>\\n  </div>\\n  \\n  <div class=\\\"footer\\\">\\n    <p>Documento generato da KeyPrime CRM</p>\\n    <p>Per info: pellegrino@indubai.it | +971 XXX XXX XXXX</p>\\n  </div>\\n</body>\\n</html>\");// Create blob and download\nconst blob=new Blob([htmlContent],{type:'text/html'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=\"\".concat(listing.title.replace(/[^a-zA-Z0-9]/g,'_'),\"_KeyPrime.html\");a.click();URL.revokeObjectURL(url);}catch(err){console.error('PDF error:',err);}setGeneratingPdf(false);};// Location insights based on area name\nconst getLocationInsights=locationName=>{const insights={'Dubai Marina':{rating:'⭐⭐⭐⭐⭐',type:'Premium Waterfront',highlights:['Vista mare','Ristoranti di lusso','Beach access','Metro vicina'],roi:'6-8%'},'Palm Jumeirah':{rating:'⭐⭐⭐⭐⭐',type:'Ultra Luxury',highlights:['Isola iconica','Spiagge private','Hotel 5 stelle','Alta domanda'],roi:'5-7%'},'Downtown Dubai':{rating:'⭐⭐⭐⭐⭐',type:'Iconic Location',highlights:['Burj Khalifa','Dubai Mall','Fountain view','Business hub'],roi:'5-7%'},'Business Bay':{rating:'⭐⭐⭐⭐',type:'Business District',highlights:['Canal view','Corporate hub','In crescita','Buon ROI'],roi:'7-9%'},'JBR':{rating:'⭐⭐⭐⭐⭐',type:'Beachfront Living',highlights:['The Walk','Beach access','Family friendly','Turisti'],roi:'6-8%'},'Dubai Creek Harbour':{rating:'⭐⭐⭐⭐',type:'Future Icon',highlights:['Creek Tower','Waterfront','Nuova area','Alto potenziale'],roi:'8-10%'},'MBR City':{rating:'⭐⭐⭐⭐',type:'Master Community',highlights:['Meydan','Crystal Lagoon','Golf course','Family area'],roi:'7-9%'},'Dubai Hills':{rating:'⭐⭐⭐⭐',type:'Green Community',highlights:['Golf club','Dubai Hills Mall','Parchi','Scuole'],roi:'6-8%'},'JVC':{rating:'⭐⭐⭐',type:'Affordable Living',highlights:['Entry level','Community feel','ROI alto','In sviluppo'],roi:'8-10%'},'Jumeirah Village':{rating:'⭐⭐⭐',type:'Value Investment',highlights:['Prezzi competitivi','Comunità','Buon rental'],roi:'8-10%'},'DIFC':{rating:'⭐⭐⭐⭐⭐',type:'Financial Hub',highlights:['Centro finanziario','Art galleries','Fine dining','Lusso'],roi:'5-6%'},'Yas Island':{rating:'⭐⭐⭐⭐',type:'Entertainment Hub',highlights:['Ferrari World','Yas Marina','Beach','Abu Dhabi'],roi:'6-8%'},'Saadiyat Island':{rating:'⭐⭐⭐⭐⭐',type:'Cultural District',highlights:['Louvre Abu Dhabi','Beaches','Golf','Exclusive'],roi:'5-7%'}};const locationLower=(locationName||'').toLowerCase();for(const[key,value]of Object.entries(insights)){if(locationLower.includes(key.toLowerCase()))return _objectSpread({name:key},value);}return{name:locationName,rating:'⭐⭐⭐',type:'Emerging Area',highlights:['In sviluppo','Potenziale crescita'],roi:'7-10%'};};const status=getStatusLabel(listing.construction_phase_key);const locationInsights=getLocationInsights(((_listing$location5=listing.location)===null||_listing$location5===void 0?void 0:_listing$location5.full_name)||((_listing$location6=listing.location)===null||_listing$location6===void 0?void 0:_listing$location6.name));const images=listing.images||[];const hasCoords=((_listing$location7=listing.location)===null||_listing$location7===void 0?void 0:_listing$location7.lat)&&((_listing$location8=listing.location)===null||_listing$location8===void 0?void 0:_listing$location8.lng);// Estimate coordinates from location name for map (rough Dubai coordinates)\nconst getMapUrl=()=>{var _listing$location9;const locationName=encodeURIComponent(((_listing$location9=listing.location)===null||_listing$location9===void 0?void 0:_listing$location9.full_name)||listing.title+' Dubai');return\"https://www.google.com/maps/search/?api=1&query=\".concat(locationName);};// Fullscreen Gallery\nif(showFullGallery){return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-[60] bg-zinc-800\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFullGallery(false),className:\"absolute top-4 right-4 z-10 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur rounded-full text-white text-sm\",children:[activeImageIndex+1,\" / \",images.length]}),/*#__PURE__*/_jsx(\"div\",{className:\"h-full flex items-center justify-center p-4\",children:images[activeImageIndex]&&/*#__PURE__*/_jsx(\"img\",{src:images[activeImageIndex].medium_image_url||images[activeImageIndex].small_image_url,alt:\"\",className:\"max-h-full max-w-full object-contain\"})}),images.length>1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveImageIndex(i=>i>0?i-1:images.length-1),className:\"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20\",children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-6 h-6\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveImageIndex(i=>i<images.length-1?i+1:0),className:\"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20\",children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-4 left-0 right-0 flex justify-center gap-2 px-4 overflow-x-auto\",children:images.slice(0,10).map((img,idx)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveImageIndex(idx),className:\"flex-shrink-0 w-16 h-12 rounded-lg overflow-hidden border-2 transition-all \".concat(idx===activeImageIndex?'border-orange-500 scale-110':'border-transparent opacity-60 hover:opacity-100'),children:/*#__PURE__*/_jsx(\"img\",{src:img.small_image_url||img.medium_image_url,alt:\"\",className:\"w-full h-full object-cover\"})},idx))})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center p-2 md:p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800/80 backdrop-blur-sm\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden animate-scaleIn\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative h-72 md:h-80\",children:[(_images$activeImageIn=images[activeImageIndex])!==null&&_images$activeImageIn!==void 0&&_images$activeImageIn.medium_image_url?/*#__PURE__*/_jsx(\"img\",{src:images[activeImageIndex].medium_image_url,alt:listing.title,className:\"w-full h-full object-cover cursor-pointer\",onClick:()=>setShowFullGallery(true)}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-zinc-700/50 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-20 h-20 text-zinc-600\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-t from-[#1e293b] via-transparent to-black/30\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-4 left-4 right-4 flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 flex-wrap\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"px-3 py-1.5 \".concat(status.color,\" text-white text-sm font-medium rounded-full flex items-center gap-1.5 shadow-lg\"),children:[/*#__PURE__*/_jsx(\"span\",{children:status.icon}),\" \",status.text]}),listing.hotness_level>=80&&/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1.5 bg-gradient-to-r from-red-500 to-orange-500 text-white text-sm font-medium rounded-full flex items-center gap-1.5 shadow-lg\",children:\"\\uD83D\\uDD25 Popolare\"}),formatDelivery(listing.delivery_date)&&/*#__PURE__*/_jsxs(\"span\",{className:\"px-3 py-1.5 bg-zinc-800/60 backdrop-blur text-white text-sm rounded-full\",children:[\"\\uD83D\\uDCC5 \",formatDelivery(listing.delivery_date)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onToggleSave,className:\"p-2.5 rounded-full shadow-lg transition-all \".concat(isSaved?'bg-orange-500 text-white':'bg-zinc-800/60 backdrop-blur text-white hover:bg-orange-500'),children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:isSaved?'currentColor':'none',stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\"})})}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2.5 bg-zinc-800/60 backdrop-blur rounded-full text-white hover:bg-zinc-800/80 shadow-lg\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]})]}),images.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-20 left-0 right-0 flex justify-center gap-1.5\",children:[images.slice(0,8).map((_,idx)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveImageIndex(idx),className:\"w-2 h-2 rounded-full transition-all \".concat(idx===activeImageIndex?'bg-orange-500 w-6':'bg-white/50 hover:bg-white/80')},idx)),images.length>8&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-white/50 text-xs ml-1\",children:[\"+\",images.length-8]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-4 left-4 right-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl md:text-3xl font-bold text-white drop-shadow-lg\",children:listing.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-2 text-white/80\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:(_listing$location0=listing.location)===null||_listing$location0===void 0?void 0:_listing$location0.full_name})]})]}),images.length>1&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFullGallery(true),className:\"absolute bottom-4 right-4 px-3 py-1.5 bg-zinc-800/60 backdrop-blur text-white text-sm rounded-full hover:bg-zinc-800/80 flex items-center gap-1.5\",children:[/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4\"}),\" \",images.length,\" foto\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 md:p-6 overflow-y-auto max-h-[calc(95vh-20rem)]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6 pb-6 border-b border-zinc-800\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-orange-400\",children:listing.price_from>0?\"AED \".concat(formatPrice(listing.price_from)):'Prezzo su richiesta'}),listing.price_from>0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm mt-1\",children:\"Prezzo iniziale\"})]}),formatBedrooms(listing.bedrooms)&&/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-4 text-zinc-300\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 px-4 py-2 bg-zinc-700/50/50 rounded-xl\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 text-orange-400\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:formatBedrooms(listing.bedrooms)})]})})]}),((_listing$bedrooms2=listing.bedrooms)===null||_listing$bedrooms2===void 0?void 0:(_listing$bedrooms2$av=_listing$bedrooms2.available)===null||_listing$bedrooms2$av===void 0?void 0:_listing$bedrooms2$av.length)>0&&listing.price_from>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-zinc-700/50/30 border border-zinc-700/50 rounded-xl\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-white font-medium mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(DollarSign,{className:\"w-4 h-4 text-orange-400\"}),\"Prezzi per Tipologia\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3\",children:listing.bedrooms.available.sort((a,b)=>a-b).map((bed,idx)=>{const basePrice=listing.price_from;const multiplier=bed===0?1:1+bed*0.35;const estimatedPrice=Math.round(basePrice*multiplier);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-zinc-800/50 border border-zinc-700/30 rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-xs mb-1\",children:bed===0?'Studio':bed+' BR'}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-orange-400 font-semibold\",children:[\"da \",formatPrice(estimatedPrice)]})]},idx);})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-2 text-center\",children:\"* Prezzi indicativi, contattare per quotazione esatta\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-orange-500/10 to-orange-600/5 border border-orange-500/20 rounded-xl p-4 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-orange-400 text-2xl font-bold\",children:status.icon}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium mt-1\",children:status.text}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Stato progetto\"})]}),formatDelivery(listing.delivery_date)&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-zinc-700/50/50 rounded-xl p-4 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-400 text-2xl font-bold\",children:\"\\uD83D\\uDCC5\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium mt-1\",children:formatDelivery(listing.delivery_date)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Consegna prevista\"})]}),((_listing$payment_plan4=listing.payment_plans)===null||_listing$payment_plan4===void 0?void 0:(_listing$payment_plan5=_listing$payment_plan4.plans)===null||_listing$payment_plan5===void 0?void 0:(_listing$payment_plan6=_listing$payment_plan5[0])===null||_listing$payment_plan6===void 0?void 0:(_listing$payment_plan7=_listing$payment_plan6.summary)===null||_listing$payment_plan7===void 0?void 0:_listing$payment_plan7.down_payment)&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-zinc-700/50/50 rounded-xl p-4 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-green-400 text-2xl font-bold\",children:[listing.payment_plans.plans[0].summary.down_payment,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium mt-1\",children:\"Anticipo\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Down payment\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-zinc-700/50/50 rounded-xl p-4 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-purple-400 text-2xl font-bold\",children:locationInsights.roi}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium mt-1\",children:\"ROI Stimato\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Rendimento annuo\"})]})]}),listing.developer&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 p-4 bg-gradient-to-r from-zinc-800/80 to-zinc-800/40 border border-zinc-700/50 rounded-xl mb-6\",children:[listing.developer.logo?/*#__PURE__*/_jsx(\"img\",{src:listing.developer.logo,alt:listing.developer.name,className:\"w-16 h-16 rounded-xl object-contain bg-white p-2\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-xl bg-orange-500/20 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Building2,{className:\"w-8 h-8 text-orange-400\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-xs uppercase tracking-wider\",children:\"Developer\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-semibold text-white\",children:listing.developer.name}),listing.developer.projects_count&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm\",children:[listing.developer.projects_count,\" progetti\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 bg-orange-500/20 text-orange-400 text-xs font-medium rounded-full\",children:\"Verificato \\u2713\"})})]}),listing.construction_phase_key==='under_construction'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-orange-500/10 to-amber-500/5 border border-orange-500/20 rounded-xl p-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Building2,{className:\"w-4 h-4 text-orange-400\"}),\" Stato Avanzamento Lavori\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-orange-500/20 text-orange-400 text-xs font-medium rounded-full\",children:\"In Costruzione\"})]}),(()=>{// Use real completion percentage if available, otherwise estimate\nlet progress=listing.completion_percentage||listing.construction_progress;if(!progress){const deliveryDate=listing.delivery_date?new Date(listing.delivery_date):null;const now=new Date();const startDate=new Date(now.getFullYear()-1,now.getMonth(),1);if(deliveryDate){const totalDuration=deliveryDate-startDate;const elapsed=now-startDate;progress=Math.min(Math.max(Math.round(elapsed/totalDuration*100),5),95);}else{progress=50;}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative h-4 bg-zinc-700/50 rounded-full overflow-hidden mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-0 top-0 h-full bg-gradient-to-r from-orange-500 to-amber-400 rounded-full transition-all duration-500\",style:{width:\"\".concat(progress,\"%\")}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-bold text-white drop-shadow\",children:[progress,\"%\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs text-zinc-500\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Inizio lavori\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Consegna: \",formatDelivery(listing.delivery_date)||'TBD']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 grid grid-cols-4 gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:'p-2 rounded-lg text-center text-xs '+(progress>=25?'bg-orange-500/20 text-orange-400':'bg-zinc-700/50 text-zinc-500'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Fondazioni\"}),/*#__PURE__*/_jsx(\"p\",{children:progress>=25?'✓':'...'})]}),/*#__PURE__*/_jsxs(\"div\",{className:'p-2 rounded-lg text-center text-xs '+(progress>=50?'bg-orange-500/20 text-orange-400':'bg-zinc-700/50 text-zinc-500'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Struttura\"}),/*#__PURE__*/_jsx(\"p\",{children:progress>=50?'✓':'...'})]}),/*#__PURE__*/_jsxs(\"div\",{className:'p-2 rounded-lg text-center text-xs '+(progress>=75?'bg-orange-500/20 text-orange-400':'bg-zinc-700/50 text-zinc-500'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Finiture\"}),/*#__PURE__*/_jsx(\"p\",{children:progress>=75?'✓':'...'})]}),/*#__PURE__*/_jsxs(\"div\",{className:'p-2 rounded-lg text-center text-xs '+(progress>=95?'bg-green-500/20 text-green-400':'bg-zinc-700/50 text-zinc-500'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Consegna\"}),/*#__PURE__*/_jsx(\"p\",{children:progress>=95?'✓':'...'})]})]})]});})()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-blue-500/10 to-purple-500/5 border border-blue-500/20 rounded-xl p-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4 text-blue-400\"}),\" Analisi Location\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm\",children:locationInsights.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:locationInsights.rating}),/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-400 text-xs font-medium\",children:locationInsights.type})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:locationInsights.highlights.map((h,i)=>/*#__PURE__*/_jsxs(\"span\",{className:\"px-2.5 py-1 bg-white/5 text-zinc-300 text-xs rounded-full\",children:[\"\\u2713 \",h]},i))}),/*#__PURE__*/_jsxs(\"a\",{href:getMapUrl(),target:\"_blank\",rel:\"noopener noreferrer\",className:\"mt-4 flex items-center justify-center gap-2 p-3 bg-zinc-700/50/50 hover:bg-zinc-700/50 rounded-xl text-zinc-300 transition-colors\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Apri in Google Maps\"}),/*#__PURE__*/_jsx(ArrowUpRight,{className:\"w-4 h-4\"})]})]}),((_listing$payment_plan8=listing.payment_plans)===null||_listing$payment_plan8===void 0?void 0:(_listing$payment_plan9=_listing$payment_plan8.plans)===null||_listing$payment_plan9===void 0?void 0:_listing$payment_plan9.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(DollarSign,{className:\"w-4 h-4 text-green-400\"}),\" Piano di Pagamento\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:listing.payment_plans.plans.map((plan,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-zinc-700/50/50 rounded-xl\",children:[plan.title&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-300 font-medium mb-3\",children:plan.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 bg-green-500/10 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-green-400\",children:[plan.summary.down_payment,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Anticipo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 bg-orange-500/10 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-orange-400\",children:[plan.summary.during_construction,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Costruzione\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 bg-blue-500/10 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-blue-400\",children:[plan.summary.handover,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Consegna\"})]}),plan.summary.after_handover>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 bg-purple-500/10 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-purple-400\",children:[plan.summary.after_handover,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:\"Post-consegna\"})]})]})]},idx))})]}),images.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-white font-semibold mb-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4 text-orange-400\"}),\" Galleria\",/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-500 text-sm font-normal\",children:[\"(\",images.length,\" immagini)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-4 md:grid-cols-6 gap-2\",children:[images.slice(0,12).map((img,idx)=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setActiveImageIndex(idx);setShowFullGallery(true);},className:\"relative h-20 rounded-lg overflow-hidden group\",children:[/*#__PURE__*/_jsx(\"img\",{src:img.small_image_url||img.medium_image_url,alt:\"\",className:\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800/0 group-hover:bg-zinc-800/30 transition-colors flex items-center justify-center\",children:/*#__PURE__*/_jsx(Eye,{className:\"w-5 h-5 text-white opacity-0 group-hover:opacity-100 transition-opacity\"})})]},idx)),images.length>12&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFullGallery(true),className:\"h-20 rounded-lg bg-zinc-700/50 flex items-center justify-center text-zinc-400 hover:bg-zinc-700 transition-colors\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium\",children:[\"+\",images.length-12]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-3 pt-4 border-t border-zinc-800\",children:[/*#__PURE__*/_jsxs(Button,{className:\"flex-1 py-3 bg-orange-500 hover:bg-orange-600\",onClick:onCreateLead,children:[/*#__PURE__*/_jsx(Plus,{className:\"w-5 h-5 mr-2\"}),\" Crea Lead\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"secondary\",className:\"flex-1 py-3\",onClick:()=>{var _listing$payment_plan0,_listing$payment_plan1,_listing$payment_plan10,_listing$location1,_listing$developer3;const bedsText=formatBedrooms(listing.bedrooms)||'Varie tipologie';const deliveryText=formatDelivery(listing.delivery_date)||'TBD';const paymentText=(_listing$payment_plan0=listing.payment_plans)!==null&&_listing$payment_plan0!==void 0&&(_listing$payment_plan1=_listing$payment_plan0.plans)!==null&&_listing$payment_plan1!==void 0&&(_listing$payment_plan10=_listing$payment_plan1[0])!==null&&_listing$payment_plan10!==void 0&&_listing$payment_plan10.summary?\"\\uD83D\\uDCB3 \".concat(listing.payment_plans.plans[0].summary.down_payment,\"% anticipo\"):'';const text=\"\\uD83C\\uDFD7\\uFE0F *\".concat(listing.title,\"*\\n\\n\\uD83D\\uDCCD \").concat((_listing$location1=listing.location)===null||_listing$location1===void 0?void 0:_listing$location1.full_name,\"\\n\\uD83D\\uDCB0 \").concat(listing.price_from>0?\"da AED \".concat(formatPrice(listing.price_from)):'Prezzo su richiesta',\"\\n\\uD83C\\uDFE0 \").concat(bedsText,\"\\n\\uD83D\\uDCC5 Consegna: \").concat(deliveryText,\"\\n\\uD83C\\uDFE2 Developer: \").concat(((_listing$developer3=listing.developer)===null||_listing$developer3===void 0?void 0:_listing$developer3.name)||'TBD',\"\\n\").concat(paymentText,\"\\n\\n_Progetto Off-Plan Dubai_\\n\\n\\uD83D\\uDD17 Per info: contattami!\");window.open(\"https://wa.me/?text=\".concat(encodeURIComponent(text)),'_blank');},children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"w-5 h-5 mr-2\"}),\" WhatsApp\"]}),mediaLoading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center gap-2 py-3 px-4 bg-purple-500/10 text-purple-400/50 rounded-xl\",children:/*#__PURE__*/_jsx(RefreshCw,{className:\"w-5 h-5 animate-spin\"})}):videoUrl?/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowVideoPlayer(true),className:\"flex items-center justify-center gap-2 py-3 px-4 bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 rounded-xl transition-colors\",title:\"Guarda Video\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 5v14l11-7z\"})}),\" Video\"]}):null,mediaLoading?null:brochureUrl?/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowBrochureViewer(true),className:\"flex items-center justify-center gap-2 py-3 px-4 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-xl transition-colors\",title:\"Visualizza Brochure PDF\",children:[/*#__PURE__*/_jsx(FileText,{className:\"w-5 h-5\"}),\" Brochure\"]}):null,listing.url&&/*#__PURE__*/_jsx(\"a\",{href:listing.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"flex items-center justify-center gap-2 py-3 px-4 bg-zinc-700/50 hover:bg-zinc-700 text-zinc-300 rounded-xl transition-colors\",title:\"Vedi su PropertyFinder\",children:/*#__PURE__*/_jsx(ExternalLink,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",className:\"py-3\",onClick:downloadProjectPDF,disabled:generatingPdf,title:\"Scarica scheda PDF\",children:generatingPdf?/*#__PURE__*/_jsx(RefreshCw,{className:\"w-5 h-5 animate-spin\"}):/*#__PURE__*/_jsx(Download,{className:\"w-5 h-5\"})})]})]})]}),showBrochureViewer&&brochureUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/90\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full h-full max-w-5xl max-h-[90vh] bg-zinc-900 rounded-2xl overflow-hidden flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 border-b border-zinc-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(FileText,{className:\"w-5 h-5 text-blue-400\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white font-medium\",children:[\"Brochure - \",listing.title]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"a\",{href:brochureUrl,download:true,target:\"_blank\",rel:\"noopener noreferrer\",className:\"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),\" Scarica PDF\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowBrochureViewer(false),className:\"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-zinc-800\",children:/*#__PURE__*/_jsx(\"iframe\",{src:brochureUrl+'#toolbar=1&navpanes=0',className:\"w-full h-full\",title:\"Brochure PDF\"})})]})}),showVideoPlayer&&videoUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/95\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full h-full max-w-5xl max-h-[90vh] bg-zinc-900 rounded-2xl overflow-hidden flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 border-b border-zinc-800\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 text-purple-400\",fill:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 5v14l11-7z\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white font-medium\",children:[\"Video - \",listing.title]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowVideoPlayer(false),className:\"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-black flex items-center justify-center\",children:videoType==='youtube'||videoType==='vimeo'?/*#__PURE__*/_jsx(\"iframe\",{src:videoUrl+(videoUrl.includes('?')?'&':'?')+'autoplay=1',className:\"w-full h-full\",title:\"Project Video\",allow:\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\",allowFullScreen:true}):/*#__PURE__*/_jsx(\"video\",{src:videoUrl,controls:true,autoPlay:true,className:\"w-full h-full object-contain\",children:\"Il tuo browser non supporta il video.\"})})]})})]});}function AssignListingModal(_ref41){var _listing$images3,_listing$images3$,_listing$location13;let{listing,clienti,onClose,onCreateLead,user}=_ref41;const[selectedCliente,setSelectedCliente]=useState(null);const[searchQuery,setSearchQuery]=useState('');const[createNew,setCreateNew]=useState(false);const[newCliente,setNewCliente]=useState({nome:'',cognome:'',telefono:'',email:''});const filteredClienti=clienti.filter(c=>\"\".concat(c.nome,\" \").concat(c.cognome,\" \").concat(c.telefono).toLowerCase().includes(searchQuery.toLowerCase()));// Check if we can create lead\nconst canCreate=selectedCliente||createNew&&newCliente.nome.trim();const handleCreate=()=>{var _listing$title,_listing$location10,_listing$location11,_listing$location12,_listing$location12$p,_listing$location12$p2;if(!canCreate)return;const leadData={progetto:((_listing$title=listing.title)===null||_listing$title===void 0?void 0:_listing$title.substring(0,50))||((_listing$location10=listing.location)===null||_listing$location10===void 0?void 0:_listing$location10.name),developer:((_listing$location11=listing.location)===null||_listing$location11===void 0?void 0:_listing$location11.name)||'TBD',zona:((_listing$location12=listing.location)===null||_listing$location12===void 0?void 0:(_listing$location12$p=_listing$location12.path_name)===null||_listing$location12$p===void 0?void 0:(_listing$location12$p2=_listing$location12$p.split(',')[1])===null||_listing$location12$p2===void 0?void 0:_listing$location12$p2.trim())||'Dubai',valore:parseFloat(listing.price)||0,stato:'lead',agente:(user===null||user===void 0?void 0:user.nome)||'',pf_property_id:listing.property_id,pf_url:listing.url,note:\"Off-Plan: \".concat(listing.property_type,\" - \").concat(listing.bedrooms||'N/A',\" BR - \").concat(listing.size||'N/A',\" sqft\")};if(selectedCliente){leadData.cliente_id=selectedCliente.id;leadData.cliente_nome=\"\".concat(selectedCliente.nome,\" \").concat(selectedCliente.cognome);}else if(createNew&&newCliente.nome){leadData.newCliente=newCliente;}onCreateLead(leadData);onClose();};return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-zinc-800/70 backdrop-blur-sm\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-md animate-scaleIn\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 border-b border-zinc-800\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white\",children:\"Crea Lead da Annuncio\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-zinc-400 hover:text-white\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 p-3 bg-zinc-700/50/50 rounded-xl\",children:[((_listing$images3=listing.images)===null||_listing$images3===void 0?void 0:(_listing$images3$=_listing$images3[0])===null||_listing$images3$===void 0?void 0:_listing$images3$.small_image_url)&&/*#__PURE__*/_jsx(\"img\",{src:listing.images[0].small_image_url,alt:\"\",className:\"w-16 h-16 rounded-lg object-cover\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium line-clamp-1\",children:listing.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs line-clamp-1\",children:(_listing$location13=listing.location)===null||_listing$location13===void 0?void 0:_listing$location13.path_name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-orange-400 text-sm font-medium mt-1\",children:[\"AED \",parseFloat(listing.price).toLocaleString()]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"text-sm text-zinc-400 mb-2 block\",children:[\"Associa a Cliente \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-400\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cerca cliente o digita nome per crearne uno nuovo...\",value:searchQuery,onChange:e=>{setSearchQuery(e.target.value);setSelectedCliente(null);setCreateNew(false);},className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"}),searchQuery&&!createNew&&!selectedCliente&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 max-h-40 overflow-y-auto space-y-1\",children:[filteredClienti.slice(0,5).map(c=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setSelectedCliente(c);setSearchQuery(\"\".concat(c.nome,\" \").concat(c.cognome));},className:\"w-full text-left p-2 rounded-lg flex items-center gap-2 \".concat((selectedCliente===null||selectedCliente===void 0?void 0:selectedCliente.id)===c.id?'bg-orange-500/20 text-orange-400':'hover:bg-zinc-700/50 text-zinc-300'),children:[/*#__PURE__*/_jsx(Avatar,{nome:c.nome,cognome:c.cognome,size:\"xs\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[c.nome,\" \",c.cognome]})]},c.id)),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setCreateNew(true);setNewCliente(n=>_objectSpread(_objectSpread({},n),{},{nome:searchQuery.split(' ')[0],cognome:searchQuery.split(' ')[1]||''}));},className:\"w-full text-left p-2 rounded-lg text-orange-400 hover:bg-zinc-700/50 text-sm\",children:[\"+ Crea nuovo cliente \\\"\",searchQuery,\"\\\"\"]})]}),selectedCliente&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 flex items-center gap-2 p-2 bg-emerald-500/20 rounded-lg\",children:[/*#__PURE__*/_jsx(Avatar,{nome:selectedCliente.nome,cognome:selectedCliente.cognome,size:\"xs\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-emerald-400\",children:[selectedCliente.nome,\" \",selectedCliente.cognome]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedCliente(null);setSearchQuery('');},className:\"ml-auto text-zinc-400 hover:text-white\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})]}),createNew&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 p-3 bg-zinc-700/30 rounded-xl border border-orange-500/30\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-orange-400 font-medium\",children:\"Nuovo Cliente\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nome *\",value:newCliente.nome,onChange:e=>setNewCliente(n=>_objectSpread(_objectSpread({},n),{},{nome:e.target.value})),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cognome\",value:newCliente.cognome,onChange:e=>setNewCliente(n=>_objectSpread(_objectSpread({},n),{},{cognome:e.target.value})),className:\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",placeholder:\"Telefono\",value:newCliente.telefono,onChange:e=>setNewCliente(n=>_objectSpread(_objectSpread({},n),{},{telefono:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:newCliente.email,onChange:e=>setNewCliente(n=>_objectSpread(_objectSpread({},n),{},{email:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\"})]}),!canCreate&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 text-center\",children:\"Seleziona un cliente esistente o creane uno nuovo per continuare\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 p-4 border-t border-zinc-800\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",className:\"flex-1\",onClick:onClose,children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{className:\"flex-1\",onClick:handleCreate,disabled:!canCreate,style:{opacity:canCreate?1:0.5},children:\"Crea Lead\"})]})]})]});}// Login Form\nfunction LoginForm(_ref42){let{onLogin,loading}=_ref42;const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[showPwd,setShowPwd]=useState(false);return/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>{e.preventDefault();onLogin(username,password);},className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:\"Username\",type:\"text\",value:username,onChange:e=>setUsername(e.target.value),placeholder:\"Inserisci username\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:\"Password\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:showPwd?'text':'password',value:password,onChange:e=>setPassword(e.target.value),placeholder:\"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\",className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 pr-12 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] transition-all\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPwd(!showPwd),className:\"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-500 hover:text-white transition-colors\",children:showPwd?/*#__PURE__*/_jsx(EyeOff,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(Eye,{className:\"w-5 h-5\"})})]})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:loading||!username||!password,className:\"w-full py-3\",children:loading?'Accesso...':'Accedi'})]});}// Lead Detail Sheet\nfunction LeadDetailSheet(_ref43){let{sale,cliente,rate,onClose,onUpdateSale,onConvert,isAdmin,activities=[],followUps=[],onAddActivity,onCreateFollowUp,onCompleteFollowUp,onDeleteActivity,onDeleteFollowUp,userName}=_ref43;const mc=(sale===null||sale===void 0?void 0:sale.stato)==='venduto'||(sale===null||sale===void 0?void 0:sale.stato)==='incassato'?Number(sale.valore)*(sale.commission_pct||5)/100*rate:0;const[editing,setEditing]=useState(false);const[saving,setSaving]=useState(false);const[activeDetailTab,setActiveDetailTab]=useState('info');// 'info', 'activities', 'followups'\nconst[showActivityForm,setShowActivityForm]=useState(false);const[showFollowUpForm,setShowFollowUpForm]=useState(false);const[activityForm,setActivityForm]=useState({tipo:'call',contenuto:''});const[followUpForm,setFollowUpForm]=useState({tipo:'call',data_reminder:'',ora_reminder:'',nota:''});const[editForm,setEditForm]=useState({progetto:(sale===null||sale===void 0?void 0:sale.progetto)||'',developer:(sale===null||sale===void 0?void 0:sale.developer)||'',zona:(sale===null||sale===void 0?void 0:sale.zona)||'',valore:(sale===null||sale===void 0?void 0:sale.valore)||''});const activityTypes=[{id:'call',label:'Chiamata',icon:'📞',color:'blue'},{id:'email',label:'Email',icon:'📧',color:'purple'},{id:'whatsapp',label:'WhatsApp',icon:'💬',color:'green'},{id:'meeting',label:'Incontro',icon:'🤝',color:'orange'},{id:'viewing',label:'Visita',icon:'🏠',color:'pink'},{id:'note',label:'Nota',icon:'📝',color:'zinc'}];const handleAddActivity=async()=>{if(!activityForm.contenuto.trim())return;await onAddActivity(sale.id,activityForm.tipo,activityForm.contenuto);setActivityForm({tipo:'call',contenuto:''});setShowActivityForm(false);};const handleAddFollowUp=async()=>{if(!followUpForm.data_reminder)return;await onCreateFollowUp(_objectSpread({sale_id:sale.id,cliente_id:cliente===null||cliente===void 0?void 0:cliente.id},followUpForm));setFollowUpForm({tipo:'call',data_reminder:'',ora_reminder:'',nota:''});setShowFollowUpForm(false);};useEffect(()=>{if(sale){setEditForm({progetto:sale.progetto||'',developer:sale.developer||'',zona:sale.zona||'',valore:sale.valore||''});}},[sale]);const handleSave=async()=>{console.log('handleSave called, sale:',sale);console.log('sale.id:',sale===null||sale===void 0?void 0:sale.id);if(!(sale!==null&&sale!==void 0&&sale.id)){console.error('No sale.id!');return;}setSaving(true);await onUpdateSale(sale.id,{progetto:editForm.progetto,developer:editForm.developer,zona:editForm.zona,valore:editForm.valore?parseFloat(editForm.valore):0});setSaving(false);setEditing(false);onClose();// Chiudi il modal per mostrare i dati aggiornati\n};return/*#__PURE__*/_jsx(BottomSheet,{isOpen:!!sale,onClose:onClose,title:(sale===null||sale===void 0?void 0:sale.progetto)||'Lead',children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(StatusBadge,{status:(sale===null||sale===void 0?void 0:sale.stato)||'lead'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 text-sm\",children:fmtDate(sale===null||sale===void 0?void 0:sale.data)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditing(!editing),className:\"p-1.5 rounded-lg bg-zinc-700/50 text-zinc-400 hover:text-white\",children:/*#__PURE__*/_jsx(Edit2,{className:\"w-4 h-4\"})})]})]}),editing?/*#__PURE__*//* Edit Mode */_jsx(\"div\",{className:\"space-y-3\",children:/*#__PURE__*/_jsxs(Card,{className:\"border-blue-500/20 bg-blue-500/5\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-400 text-xs font-medium mb-3\",children:\"Modifica Lead\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs\",children:\"Progetto/Immobile\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editForm.progetto,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{progetto:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs\",children:\"Developer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editForm.developer,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{developer:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs\",children:\"Zona\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editForm.zona,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{zona:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs\",children:\"Valore (AED)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:editForm.valore,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{valore:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-4\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>setEditing(false),className:\"flex-1\",disabled:saving,children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:handleSave,className:\"flex-1\",disabled:saving,children:saving?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"w-4 h-4 animate-spin mr-2\"}),\"Salvataggio...\"]}):'Salva'})]})]})}):/*#__PURE__*//* View Mode */_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{className:\"border-amber-500/20 bg-amber-500/5\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-sm\",children:\"Valore\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-white mt-1\",children:(sale===null||sale===void 0?void 0:sale.valore)>0?\"\".concat(fmt(sale.valore),\" AED\"):'TBD'}),mc>0&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-emerald-400 text-sm mt-1\",children:[\"Commissione: \",fmt(mc),\" AED \",sale!==null&&sale!==void 0&&sale.pagato?'✓':'']})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-2\",children:\"Immobile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium text-lg\",children:(sale===null||sale===void 0?void 0:sale.progetto)||'N/A'}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3 mt-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:\"Developer\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm\",children:(sale===null||sale===void 0?void 0:sale.developer)||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:\"Zona\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm\",children:(sale===null||sale===void 0?void 0:sale.zona)||'N/A'})]})]}),(sale===null||sale===void 0?void 0:sale.pf_url)&&/*#__PURE__*/_jsxs(\"a\",{href:sale.pf_url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"inline-flex items-center gap-1 mt-3 text-blue-400 text-sm hover:underline\",children:[/*#__PURE__*/_jsx(Building2,{className:\"w-3 h-3\"}),\" Vedi su PropertyFinder\"]})]})]}),cliente&&!editing&&/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-2\",children:\"Cliente\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-3\",children:[/*#__PURE__*/_jsx(Avatar,{nome:cliente.nome,cognome:cliente.cognome}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-medium\",children:[cliente.nome,\" \",cliente.cognome]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm\",children:cliente.telefono})]})]}),/*#__PURE__*/_jsx(QuickActions,{phone:cliente.telefono,whatsapp:cliente.whatsapp||cliente.telefono,email:cliente.email,clienteName:cliente.nome})]}),!editing&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-zinc-800 pt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mb-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveDetailTab('activities'),className:\"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 \".concat(activeDetailTab==='activities'?'bg-blue-500/20 text-blue-400':'bg-zinc-700/50 text-zinc-400 hover:text-white'),children:[\"\\uD83D\\uDCDD Attivit\\xE0 (\",activities.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveDetailTab('followups'),className:\"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 \".concat(activeDetailTab==='followups'?'bg-purple-500/20 text-purple-400':'bg-zinc-700/50 text-zinc-400 hover:text-white'),children:[\"\\u23F0 Follow-up (\",followUps.filter(f=>!f.completato).length,\")\"]})]}),activeDetailTab==='activities'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[!showActivityForm?/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowActivityForm(true),className:\"w-full py-2 border-2 border-dashed border-zinc-700 rounded-xl text-zinc-400 hover:text-white hover:border-zinc-600 transition-colors flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\" Registra attivit\\xE0\"]}):/*#__PURE__*/_jsxs(Card,{className:\"border-blue-500/20 bg-blue-500/5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 mb-3 overflow-x-auto pb-1\",children:activityTypes.map(t=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActivityForm(_objectSpread(_objectSpread({},activityForm),{},{tipo:t.id})),className:\"px-3 py-1.5 rounded-lg text-xs whitespace-nowrap transition-all \".concat(activityForm.tipo===t.id?'bg-blue-500 text-white':'bg-zinc-700/50 text-zinc-400 hover:text-white'),children:[t.icon,\" \",t.label]},t.id))}),/*#__PURE__*/_jsx(\"textarea\",{value:activityForm.contenuto,onChange:e=>setActivityForm(_objectSpread(_objectSpread({},activityForm),{},{contenuto:e.target.value})),placeholder:\"Descrivi l'attivit\\xE0...\",className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm resize-none\",rows:3}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>setShowActivityForm(false),className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:handleAddActivity,className:\"flex-1\",disabled:!activityForm.contenuto.trim(),children:\"Salva\"})]})]}),activities.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-60 overflow-y-auto\",children:activities.map(a=>{const aType=activityTypes.find(t=>t.id===a.tipo)||activityTypes[5];return/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-zinc-800/50 rounded-xl group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:aType.icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm\",children:a.contenuto}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-xs mt-1\",children:[a.created_by,\" \\u2022 \",new Date(a.created_at).toLocaleDateString('it-IT',{day:'numeric',month:'short',hour:'2-digit',minute:'2-digit'})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDeleteActivity(a.id),className:\"opacity-0 group-hover:opacity-100 p-1 text-zinc-500 hover:text-red-400 transition-all\",children:/*#__PURE__*/_jsx(X,{className:\"w-3 h-3\"})})]})},a.id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm text-center py-4\",children:\"Nessuna attivit\\xE0 registrata\"})]}),activeDetailTab==='followups'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[!showFollowUpForm?/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFollowUpForm(true),className:\"w-full py-2 border-2 border-dashed border-zinc-700 rounded-xl text-zinc-400 hover:text-white hover:border-zinc-600 transition-colors flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\" Programma follow-up\"]}):/*#__PURE__*/_jsxs(Card,{className:\"border-purple-500/20 bg-purple-500/5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 mb-3 overflow-x-auto pb-1\",children:activityTypes.slice(0,5).map(t=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setFollowUpForm(_objectSpread(_objectSpread({},followUpForm),{},{tipo:t.id})),className:\"px-3 py-1.5 rounded-lg text-xs whitespace-nowrap transition-all \".concat(followUpForm.tipo===t.id?'bg-purple-500 text-white':'bg-zinc-700/50 text-zinc-400 hover:text-white'),children:[t.icon,\" \",t.label]},t.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs\",children:\"Data\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:followUpForm.data_reminder,onChange:e=>setFollowUpForm(_objectSpread(_objectSpread({},followUpForm),{},{data_reminder:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs\",children:\"Ora (opz.)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:followUpForm.ora_reminder,onChange:e=>setFollowUpForm(_objectSpread(_objectSpread({},followUpForm),{},{ora_reminder:e.target.value})),className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\"})]})]}),/*#__PURE__*/_jsx(\"textarea\",{value:followUpForm.nota,onChange:e=>setFollowUpForm(_objectSpread(_objectSpread({},followUpForm),{},{nota:e.target.value})),placeholder:\"Note (opzionale)...\",className:\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm resize-none\",rows:2}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>setShowFollowUpForm(false),className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:handleAddFollowUp,className:\"flex-1 bg-purple-500 hover:bg-purple-600\",disabled:!followUpForm.data_reminder,children:\"Salva\"})]})]}),followUps.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-60 overflow-y-auto\",children:followUps.map(f=>{const fType=activityTypes.find(t=>t.id===f.tipo)||activityTypes[0];const isOverdue=new Date(f.data_reminder)<new Date()&&!f.completato;const isToday=new Date(f.data_reminder).toDateString()===new Date().toDateString();return/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-xl border transition-all \".concat(f.completato?'bg-zinc-800/30 border-zinc-800 opacity-60':isOverdue?'bg-red-500/10 border-red-500/30':isToday?'bg-purple-500/10 border-purple-500/30':'bg-zinc-800/50 border-zinc-800'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:fType.icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm font-medium \".concat(f.completato?'text-zinc-500 line-through':isOverdue?'text-red-400':'text-white'),children:[new Date(f.data_reminder).toLocaleDateString('it-IT',{day:'numeric',month:'short'}),f.ora_reminder&&\" alle \".concat(f.ora_reminder.slice(0,5))]}),isToday&&!f.completato&&/*#__PURE__*/_jsx(\"span\",{className:\"px-1.5 py-0.5 bg-purple-500 text-white text-[10px] font-bold rounded\",children:\"OGGI\"}),isOverdue&&!f.completato&&/*#__PURE__*/_jsx(\"span\",{className:\"px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded\",children:\"SCADUTO\"})]}),f.nota&&/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-xs mt-1\",children:f.nota})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[!f.completato&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>onCompleteFollowUp(f.id),className:\"p-1.5 text-zinc-500 hover:text-green-400 transition-colors\",title:\"Completato\",children:/*#__PURE__*/_jsx(Check,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onDeleteFollowUp(f.id),className:\"p-1.5 text-zinc-500 hover:text-red-400 transition-colors\",title:\"Elimina\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})]})},f.id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-sm text-center py-4\",children:\"Nessun follow-up programmato\"})]})]}),!editing&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs mb-2\",children:\"Cambia stato\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 overflow-x-auto pb-2\",children:pipelineStati.slice(0,-1).map(st=>{var _theme$status$st10,_theme$status$st11;return/*#__PURE__*/_jsx(\"button\",{onClick:()=>{onUpdateSale(sale.id,{stato:st});if(st!==sale.stato)onClose();},className:\"px-4 py-2 rounded-xl text-sm whitespace-nowrap transition-all \".concat((sale===null||sale===void 0?void 0:sale.stato)===st?'text-white':'text-zinc-500 hover:text-white'),style:(sale===null||sale===void 0?void 0:sale.stato)===st?{background:(_theme$status$st10=theme.status[st])===null||_theme$status$st10===void 0?void 0:_theme$status$st10.bg,color:(_theme$status$st11=theme.status[st])===null||_theme$status$st11===void 0?void 0:_theme$status$st11.color}:{background:'#334155'},children:pipelineLabels[st]||st},st);})})]}),!editing&&['prenotato','trattativa'].includes(sale===null||sale===void 0?void 0:sale.stato)&&/*#__PURE__*/_jsx(Button,{onClick:onConvert,icon:DollarSign,className:\"w-full py-3 bg-emerald-500 hover:bg-emerald-600 text-white\",children:\"Registra Vendita\"}),isAdmin&&!editing&&/*#__PURE__*/_jsx(Button,{variant:\"danger\",icon:Trash2,className:\"w-full\",children:\"Elimina Lead\"})]})});}// Convert Modal\nfunction ConvertModal(_ref44){let{sale,onConvert,onCancel}=_ref44;const[value,setValue]=useState((sale===null||sale===void 0?void 0:sale.valore)||'');return/*#__PURE__*/_jsx(Modal,{isOpen:!!sale,onClose:onCancel,title:\"\\uD83C\\uDF89 Registra Vendita\",size:\"sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(Card,{padding:\"p-3\",className:\"bg-zinc-700/50/50\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:sale===null||sale===void 0?void 0:sale.progetto}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-sm\",children:[sale===null||sale===void 0?void 0:sale.developer,\" \\u2022 \",sale===null||sale===void 0?void 0:sale.zona]})]}),/*#__PURE__*/_jsx(Input,{label:\"Valore finale (AED)\",type:\"number\",value:value,onChange:e=>setValue(e.target.value),placeholder:\"es. 1500000\",autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onCancel,className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>value&&onConvert(sale.id,parseFloat(value)),disabled:!value,className:\"flex-1 bg-emerald-500 hover:bg-emerald-600\",children:\"Conferma\"})]})]})});}// Notifications Panel\nfunction NotificationsPanel(_ref45){let{tasks,unreadIds,onClose,onGoToTask,recentSales=[],onMarkAsRead,userId}=_ref45;const allNotifications=[...recentSales.map(s=>({type:'sale',id:'sale_'+s.id,data:s})),...tasks.map(t=>({type:'task',id:\"task_\".concat(t.id,\"_\").concat(userId),data:t}))];return/*#__PURE__*/_jsx(BottomSheet,{isOpen:true,onClose:onClose,title:\"Notifiche\",children:allNotifications.length===0?/*#__PURE__*/_jsx(EmptyState,{icon:Bell,title:\"Nessuna notifica\",description:\"Sei in pari con tutto!\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[recentSales.map(s=>/*#__PURE__*/_jsx(Card,{padding:\"p-3\",className:unreadIds.includes('sale_'+s.id)?'border-l-2 border-l-emerald-500':'',children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full bg-emerald-500/20 flex items-center justify-center\",children:/*#__PURE__*/_jsx(DollarSign,{className:\"w-4 h-4 text-emerald-400\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-white text-sm font-medium\",children:[\"Nuova \",s.stato==='venduto'?'Vendita':'Lead']}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-400 text-xs\",children:[s.progetto,\" \\u2022 \",s.agente||s.segnalatore]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-emerald-400 text-xs font-medium mt-1\",children:[fmt(s.valore),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-end gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-500 text-xs\",children:fmtShort(s.created_at)}),unreadIds.includes('sale_'+s.id)&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onMarkAsRead('sale_'+s.id);},className:\"text-xs text-zinc-500 hover:text-white\",children:/*#__PURE__*/_jsx(Check,{className:\"w-4 h-4\"})})]})]})},'sale_'+s.id)),tasks.map(t=>{const taskNotifId=\"task_\".concat(t.id,\"_\").concat(userId);const isUnread=unreadIds.includes(taskNotifId);return/*#__PURE__*/_jsx(Card,{padding:\"p-3\",className:isUnread?'border-l-2 border-l-pink-500':'',children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full mt-1.5 \".concat(isOverdue(t.scadenza)?'bg-red-500':'bg-amber-500')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 cursor-pointer\",onClick:onGoToTask,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm font-medium\",children:t.titolo}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs \".concat(isOverdue(t.scadenza)?'text-red-400':'text-zinc-500'),children:[t.scadenza?fmtDateTime(t.scadenza):'Senza scadenza',isOverdue(t.scadenza)&&' • Scaduto!']}),t.created_by&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-600 text-xs mt-1\",children:[\"Da: \",t.created_by]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(StatusBadge,{status:t.priorita,type:\"priority\"}),isUnread&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onMarkAsRead(taskNotifId);},className:\"p-1 text-zinc-500 hover:text-white hover:bg-zinc-700 rounded transition-colors\",title:\"Segna come letta\",children:/*#__PURE__*/_jsx(Check,{className:\"w-4 h-4\"})})]})]})},t.id);})]})});}// Password Modal\nfunction PasswordModal(_ref46){let{currentPassword,onSave,onClose}=_ref46;const[oldPwd,setOldPwd]=useState('');const[newPwd,setNewPwd]=useState('');const[confirmPwd,setConfirmPwd]=useState('');const[error,setError]=useState('');const save=()=>{if(oldPwd!==currentPassword){setError('Password attuale errata');return;}if(newPwd.length<6){setError('Minimo 6 caratteri');return;}if(newPwd!==confirmPwd){setError('Le password non coincidono');return;}onSave(newPwd);};return/*#__PURE__*/_jsx(Modal,{isOpen:true,onClose:onClose,title:\"Cambia Password\",size:\"sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500/10 border border-red-500/20 text-red-400 rounded-xl px-4 py-3 text-sm\",children:error}),/*#__PURE__*/_jsx(Input,{label:\"Password attuale\",type:\"password\",value:oldPwd,onChange:e=>setOldPwd(e.target.value)}),/*#__PURE__*/_jsx(Input,{label:\"Nuova password\",type:\"password\",value:newPwd,onChange:e=>setNewPwd(e.target.value)}),/*#__PURE__*/_jsx(Input,{label:\"Conferma password\",type:\"password\",value:confirmPwd,onChange:e=>setConfirmPwd(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onClose,className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:save,className:\"flex-1\",children:\"Salva\"})]})]})});}// Note Modal\nfunction NoteModal(_ref47){let{task,onSave,onClose}=_ref47;const[note,setNote]=useState((task===null||task===void 0?void 0:task.note)||'');return/*#__PURE__*/_jsx(Modal,{isOpen:true,onClose:onClose,title:\"Aggiungi Nota\",size:\"sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Card,{padding:\"p-3\",className:\"bg-zinc-700/50/50\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:task===null||task===void 0?void 0:task.titolo})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:\"Nota\"}),/*#__PURE__*/_jsx(\"textarea\",{value:note,onChange:e=>setNote(e.target.value),placeholder:\"Scrivi una nota...\",className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] h-24 resize-none\",autoFocus:true})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-600 text-xs\",children:\"L'admin ricever\\xE0 una notifica email\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onClose,className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>onSave(task.id,note),icon:Send,className:\"flex-1\",children:\"Invia\"})]})]})});}// Cliente Modal\nfunction ClienteModal(_ref48){let{cliente,onSave,onClose}=_ref48;const[form,setForm]=useState(cliente||{nome:'',cognome:'',email:'',telefono:'',whatsapp:'',nazionalita:'',budget_min:'',budget_max:'',stato:'nuovo',fonte:'',note:''});const save=async()=>{if(!form.nome){alert('Nome obbligatorio');return;}await onSave(form);};return/*#__PURE__*/_jsx(Modal,{isOpen:true,onClose:onClose,title:cliente?'Modifica Cliente':'Nuovo Cliente',children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{label:\"Nome *\",value:form.nome,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{nome:e.target.value}))}),/*#__PURE__*/_jsx(Input,{label:\"Cognome\",value:form.cognome||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cognome:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{label:\"Telefono\",type:\"tel\",value:form.telefono||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{telefono:e.target.value}))}),/*#__PURE__*/_jsx(Input,{label:\"WhatsApp\",type:\"tel\",value:form.whatsapp||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{whatsapp:e.target.value}))})]}),/*#__PURE__*/_jsx(Input,{label:\"Email\",type:\"email\",value:form.email||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value}))}),/*#__PURE__*/_jsx(Input,{label:\"Nazionalit\\xE0\",value:form.nazionalita||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{nazionalita:e.target.value}))}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{label:\"Budget Min\",type:\"number\",value:form.budget_min||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{budget_min:e.target.value}))}),/*#__PURE__*/_jsx(Input,{label:\"Budget Max\",type:\"number\",value:form.budget_max||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{budget_max:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Select,{label:\"Stato\",value:form.stato||'nuovo',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{stato:e.target.value})),children:clienteStati.map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))}),/*#__PURE__*/_jsx(Input,{label:\"Fonte\",value:form.fonte||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{fonte:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:\"Note\"}),/*#__PURE__*/_jsx(\"textarea\",{value:form.note||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{note:e.target.value})),className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm h-20 resize-none focus:outline-none focus:border-[#3F3F46]\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onClose,className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:save,className:\"flex-1\",children:\"Salva\"})]})]})});}// Task Modal\nfunction TaskModal(_ref49){let{task,clienti,users,onSave,onClose}=_ref49;const[form,setForm]=useState(task||{titolo:'',descrizione:'',scadenza:'',priorita:'normale',cliente_id:'',assegnato_a:''});const save=async()=>{if(!form.titolo){alert('Titolo obbligatorio');return;}await onSave(_objectSpread(_objectSpread({},form),{},{cliente_id:form.cliente_id||null,scadenza:form.scadenza||null}));};return/*#__PURE__*/_jsx(Modal,{isOpen:true,onClose:onClose,title:task!==null&&task!==void 0&&task.id?'Modifica Task':'Nuovo Task',children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:\"Titolo *\",value:form.titolo,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{titolo:e.target.value})),autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:\"Descrizione\"}),/*#__PURE__*/_jsx(\"textarea\",{value:form.descrizione||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{descrizione:e.target.value})),className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm h-20 resize-none focus:outline-none focus:border-[#3F3F46]\"})]}),/*#__PURE__*/_jsx(Input,{label:\"Scadenza\",type:\"datetime-local\",value:form.scadenza?form.scadenza.slice(0,16):'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{scadenza:e.target.value?new Date(e.target.value).toISOString():''}))}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:\"Priorit\\xE0\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:taskPriorita.map(p=>{var _theme$priority$p,_theme$priority$p2;return/*#__PURE__*/_jsx(\"button\",{onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{priorita:p})),className:\"flex-1 px-3 py-2 rounded-xl text-sm transition-all \".concat(form.priorita===p?'text-white':'text-zinc-500'),style:form.priorita===p?{background:(_theme$priority$p=theme.priority[p])===null||_theme$priority$p===void 0?void 0:_theme$priority$p.bg,color:(_theme$priority$p2=theme.priority[p])===null||_theme$priority$p2===void 0?void 0:_theme$priority$p2.color}:{background:'#334155'},children:p},p);})})]}),/*#__PURE__*/_jsxs(Select,{label:\"Cliente\",value:form.cliente_id||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cliente_id:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Nessun cliente\"}),clienti.map(c=>/*#__PURE__*/_jsxs(\"option\",{value:c.id,children:[c.nome,\" \",c.cognome]},c.id))]}),/*#__PURE__*/_jsxs(Select,{label:\"Assegna a\",value:form.assegnato_a||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{assegnato_a:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Non assegnato\"}),users.filter(u=>u.ruolo!=='admin').map(u=>/*#__PURE__*/_jsxs(\"option\",{value:u.nome,children:[u.nome,\" (\",u.ruolo,\")\"]},u.id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onClose,className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:save,className:\"flex-1\",children:\"Salva\"})]})]})});}// User Modal\nfunction UserModal(_ref50){let{user,onSave,onClose}=_ref50;const[form,setForm]=useState(user||{nome:'',username:'',password:'',email:'',ruolo:'agente',referente:'Pellegrino',attivo:true});const[saving,setSaving]=useState(false);const save=async()=>{if(!form.nome||!form.username||!form.password){alert('Compila i campi obbligatori');return;}setSaving(true);await onSave(form);setSaving(false);};return/*#__PURE__*/_jsx(Modal,{isOpen:true,onClose:onClose,title:user?'Modifica Utente':'Nuovo Utente',children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:\"Nome *\",value:form.nome,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{nome:e.target.value}))}),/*#__PURE__*/_jsx(Input,{label:\"Email\",type:\"email\",value:form.email||'',onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value})),placeholder:\"Per notifiche\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{label:\"Username *\",value:form.username,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{username:e.target.value}))}),/*#__PURE__*/_jsx(Input,{label:\"Password *\",value:form.password,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{password:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(Select,{label:\"Ruolo\",value:form.ruolo,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{ruolo:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"agente\",children:\"Agente\"}),/*#__PURE__*/_jsx(\"option\",{value:\"agente_admin\",children:\"Agente Admin (70/30)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"segnalatore\",children:\"Segnalatore\"})]}),/*#__PURE__*/_jsxs(Select,{label:\"Referente\",value:form.referente,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{referente:e.target.value})),disabled:form.ruolo==='agente_admin',children:[/*#__PURE__*/_jsx(\"option\",{value:\"Pellegrino\",children:\"Pellegrino\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Giovanni\",children:\"Giovanni\"})]})]}),form.ruolo==='agente_admin'&&/*#__PURE__*/_jsx(Card,{padding:\"p-3\",className:\"bg-violet-500/10 border-violet-500/20\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-violet-400 text-sm\",children:[\"\\uD83D\\uDCA1 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Agente Admin:\"}),\" 70% commissione all'agente, 30% a Pellegrino\"]})}),user&&/*#__PURE__*/_jsxs(Card,{padding:\"p-3\",className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"attivo\",checked:form.attivo,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{attivo:e.target.checked})),className:\"w-4 h-4 rounded\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"attivo\",className:\"text-zinc-300 text-sm\",children:\"Utente attivo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 pt-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onClose,className:\"flex-1\",children:\"Annulla\"}),/*#__PURE__*/_jsx(Button,{onClick:save,className:\"flex-1\",disabled:saving,children:saving?'Salvataggio...':'Salva'})]})]})});}// ==================== LEAD & SALE FORMS ====================\n// Client Search Component\nfunction ClientSearch(_ref51){let{clienti,onSelect,onCreateNew,selectedClient}=_ref51;const[search,setSearch]=useState('');const[show,setShow]=useState(false);const filtered=search.length>=2?clienti.filter(c=>\"\".concat(c.nome,\" \").concat(c.cognome,\" \").concat(c.telefono).toLowerCase().includes(search.toLowerCase())).slice(0,5):[];if(selectedClient){return/*#__PURE__*/_jsx(Card,{padding:\"p-3\",className:\"border-emerald-500/20 bg-emerald-500/5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Avatar,{nome:selectedClient.nome,cognome:selectedClient.cognome,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-medium\",children:[selectedClient.nome,\" \",selectedClient.cognome]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-emerald-400 text-sm\",children:selectedClient.telefono})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onSelect(null),className:\"text-zinc-500 hover:text-white\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Cerca cliente...\",value:search,onChange:e=>{setSearch(e.target.value);setShow(true);},onFocus:()=>setShow(true),className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46]\"})]}),show&&search.length>=2&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute z-10 w-full mt-2 bg-[#1e293b] border border-[#334155] rounded-xl overflow-hidden shadow-xl\",children:[filtered.map(c=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onSelect(c);setSearch('');setShow(false);},className:\"w-full text-left px-4 py-3 hover:bg-white/5 border-b border-[#334155] last:border-0 flex items-center gap-3 transition-colors\",children:[/*#__PURE__*/_jsx(Avatar,{nome:c.nome,cognome:c.cognome,size:\"sm\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-white text-sm\",children:[c.nome,\" \",c.cognome]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-500 text-xs\",children:c.telefono})]})]},c.id)),filtered.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 text-zinc-500 text-sm\",children:\"Nessun risultato\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onCreateNew();setShow(false);},className:\"w-full text-left px-4 py-3 bg-blue-500/10 text-blue-400 flex items-center gap-2 hover:bg-blue-500/20 transition-colors\",children:[/*#__PURE__*/_jsx(UserPlus,{className:\"w-4 h-4\"}),\" Nuovo cliente\"]})]}),!search&&/*#__PURE__*/_jsxs(\"button\",{onClick:onCreateNew,className:\"w-full mt-3 border border-dashed border-[#3F3F46] rounded-xl py-3 text-zinc-500 text-sm flex items-center justify-center gap-2 hover:border-amber-500 hover:text-amber-400 transition-colors\",children:[/*#__PURE__*/_jsx(UserPlus,{className:\"w-4 h-4\"}),\" Crea nuovo cliente\"]})]});}// Select with Other Option\nfunction SelectWithOther(_ref52){let{value,onChange,options,placeholder,label}=_ref52;const[showCustom,setShowCustom]=useState(false);const[customValue,setCustomValue]=useState('');useEffect(()=>{if(value&&!options.includes(value)&&value!=='Altro'){setShowCustom(true);setCustomValue(value);}},[value,options]);return/*#__PURE__*/_jsxs(\"div\",{children:[label&&/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-zinc-400 mb-2\",children:label}),/*#__PURE__*/_jsxs(\"select\",{value:showCustom?'Altro':value,onChange:e=>{if(e.target.value==='Altro'){setShowCustom(true);setCustomValue('');onChange('');}else{setShowCustom(false);onChange(e.target.value);}},className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-[#3F3F46] appearance-none\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:placeholder}),options.map(o=>/*#__PURE__*/_jsx(\"option\",{value:o,children:o},o))]}),showCustom&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:customValue,onChange:e=>{setCustomValue(e.target.value);onChange(e.target.value);},placeholder:\"Specifica...\",className:\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm mt-2 focus:outline-none focus:border-[#3F3F46]\",autoFocus:true})]});}// Lead Form\nfunction LeadForm(_ref53){let{type,userName,clienti,onSubmit}=_ref53;const[selectedClient,setSelectedClient]=useState(null);const[showNewClient,setShowNewClient]=useState(false);const[form,setForm]=useState({data:new Date().toISOString().split('T')[0],developer:'',progetto:'',zona:'',valore:'',stato:'lead',cliente_nome:'',cliente_cognome:'',cliente_email:'',cliente_telefono:'',cliente_whatsapp:'',cliente_nazionalita:'',cliente_budget_min:'',cliente_budget_max:'',cliente_note:''});const submit=e=>{e===null||e===void 0?void 0:e.preventDefault();if(!selectedClient&&!form.cliente_nome){alert('Seleziona o crea un cliente');return;}onSubmit(_objectSpread(_objectSpread({},form),{},{cliente_id:selectedClient===null||selectedClient===void 0?void 0:selectedClient.id,cliente_nome:(selectedClient===null||selectedClient===void 0?void 0:selectedClient.nome)||form.cliente_nome,developer:form.developer||'TBD',progetto:form.progetto||'TBD',zona:form.zona||'TBD',valore:form.valore?parseFloat(form.valore):0,agente:type==='agente'?userName:null,segnalatore:type==='segnalatore'?userName:null}));};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:submit,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-white font-medium mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 text-amber-400\"}),\" Cliente\"]}),/*#__PURE__*/_jsx(ClientSearch,{clienti:clienti,selectedClient:selectedClient,onSelect:c=>{setSelectedClient(c);setShowNewClient(false);},onCreateNew:()=>{setSelectedClient(null);setShowNewClient(true);}}),showNewClient&&!selectedClient&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-[#334155] space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{placeholder:\"Nome *\",value:form.cliente_nome,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cliente_nome:e.target.value}))}),/*#__PURE__*/_jsx(Input,{placeholder:\"Cognome\",value:form.cliente_cognome,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cliente_cognome:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{type:\"tel\",placeholder:\"Telefono\",value:form.cliente_telefono,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cliente_telefono:e.target.value}))}),/*#__PURE__*/_jsx(Input,{type:\"email\",placeholder:\"Email\",value:form.cliente_email,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cliente_email:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{type:\"number\",placeholder:\"Budget Min\",value:form.cliente_budget_min,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cliente_budget_min:e.target.value}))}),/*#__PURE__*/_jsx(Input,{type:\"number\",placeholder:\"Budget Max\",value:form.cliente_budget_max,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{cliente_budget_max:e.target.value}))})]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-white font-medium mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Building2,{className:\"w-4 h-4 text-blue-400\"}),\" Immobile\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(SelectWithOther,{value:form.developer,onChange:v=>setForm(_objectSpread(_objectSpread({},form),{},{developer:v})),options:developers,placeholder:\"Developer\"}),/*#__PURE__*/_jsx(SelectWithOther,{value:form.zona,onChange:v=>setForm(_objectSpread(_objectSpread({},form),{},{zona:v})),options:zones,placeholder:\"Zona\"})]}),/*#__PURE__*/_jsx(Input,{placeholder:\"Progetto\",value:form.progetto,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{progetto:e.target.value}))}),/*#__PURE__*/_jsx(Input,{type:\"number\",placeholder:\"Valore (AED)\",value:form.valore,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{valore:e.target.value}))})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-white font-medium mb-4\",children:\"Stato iniziale\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:pipelineStati.slice(0,4).map(st=>{var _theme$status$st12,_theme$status$st13;return/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setForm(_objectSpread(_objectSpread({},form),{},{stato:st})),className:\"px-4 py-2 rounded-xl text-sm transition-all \".concat(form.stato===st?'text-white':'text-zinc-500'),style:form.stato===st?{background:(_theme$status$st12=theme.status[st])===null||_theme$status$st12===void 0?void 0:_theme$status$st12.bg,color:(_theme$status$st13=theme.status[st])===null||_theme$status$st13===void 0?void 0:_theme$status$st13.color}:{background:'#334155'},children:pipelineLabels[st]||st},st);})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",id:\"submitBtn\",className:\"hidden\",children:\"Submit\"})]});}// Sale Form\nfunction SaleForm(_ref54){let{type,userName,clienti,onSubmit}=_ref54;const[selectedClient,setSelectedClient]=useState(null);const[showNewClient,setShowNewClient]=useState(false);const[form,setForm]=useState({data:new Date().toISOString().split('T')[0],developer:'',progetto:'',zona:'',valore:'',nuovo_cliente_nome:'',nuovo_cliente_cognome:'',nuovo_cliente_telefono:'',nuovo_cliente_email:''});const submit=e=>{e===null||e===void 0?void 0:e.preventDefault();if(!selectedClient&&!form.nuovo_cliente_nome){alert('Seleziona o inserisci il cliente');return;}if(!form.developer||!form.progetto||!form.zona||!form.valore){alert('Compila tutti i campi dell\\'immobile');return;}onSubmit({data:form.data,developer:form.developer,progetto:form.progetto,zona:form.zona,valore:parseFloat(form.valore),agente:type==='agente'?userName:null,segnalatore:type==='segnalatore'?userName:null,cliente_id:selectedClient===null||selectedClient===void 0?void 0:selectedClient.id,cliente_nome:(selectedClient===null||selectedClient===void 0?void 0:selectedClient.nome)||form.nuovo_cliente_nome,nuovo_cliente_nome:form.nuovo_cliente_nome,nuovo_cliente_cognome:form.nuovo_cliente_cognome,nuovo_cliente_telefono:form.nuovo_cliente_telefono,nuovo_cliente_email:form.nuovo_cliente_email});};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:submit,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-white font-medium mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 text-amber-400\"}),\" Cliente Acquirente\"]}),/*#__PURE__*/_jsx(ClientSearch,{clienti:clienti,selectedClient:selectedClient,onSelect:c=>{setSelectedClient(c);setShowNewClient(false);},onCreateNew:()=>{setSelectedClient(null);setShowNewClient(true);}}),showNewClient&&!selectedClient&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-[#334155] space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{placeholder:\"Nome *\",value:form.nuovo_cliente_nome,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{nuovo_cliente_nome:e.target.value}))}),/*#__PURE__*/_jsx(Input,{placeholder:\"Cognome\",value:form.nuovo_cliente_cognome,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{nuovo_cliente_cognome:e.target.value}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(Input,{type:\"tel\",placeholder:\"Telefono\",value:form.nuovo_cliente_telefono,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{nuovo_cliente_telefono:e.target.value}))}),/*#__PURE__*/_jsx(Input,{type:\"email\",placeholder:\"Email\",value:form.nuovo_cliente_email,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{nuovo_cliente_email:e.target.value}))})]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-white font-medium mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(DollarSign,{className:\"w-4 h-4 text-emerald-400\"}),\" Dettagli Vendita\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(Input,{label:\"Data\",type:\"date\",value:form.data,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{data:e.target.value}))}),/*#__PURE__*/_jsx(SelectWithOther,{label:\"Developer *\",value:form.developer,onChange:v=>setForm(_objectSpread(_objectSpread({},form),{},{developer:v})),options:developers,placeholder:\"Seleziona developer\"}),/*#__PURE__*/_jsx(Input,{label:\"Progetto *\",value:form.progetto,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{progetto:e.target.value})),placeholder:\"Nome progetto\"}),/*#__PURE__*/_jsx(SelectWithOther,{label:\"Zona *\",value:form.zona,onChange:v=>setForm(_objectSpread(_objectSpread({},form),{},{zona:v})),options:zones,placeholder:\"Seleziona zona\"}),/*#__PURE__*/_jsx(Input,{label:\"Valore (AED) *\",type:\"number\",value:form.valore,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{valore:e.target.value})),placeholder:\"es. 1500000\"})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",id:\"submitBtn\",className:\"hidden\",children:\"Submit\"})]});}// ==================== ROI CALCULATOR ====================\nconst roiZones={// DUBAI\n'Palm Jumeirah':{emirate:'Dubai',cat:'Ultra Premium',e:'🌴',lt:5.5,rent:180000,sqft:2800,occ:78,night:1200,opAppr:15,opDisc:10,opHand:30,secAppr:8,scNew:22,scOld:30,dewa:8000,ageNew:'2020+',ageMid:'2010-19',ageOld:'2005-09'},'Emirates Hills':{emirate:'Dubai',cat:'Ultra Premium',e:'⛳',lt:4.0,rent:250000,sqft:3500,occ:50,night:2500,opAppr:8,opDisc:5,opHand:36,secAppr:5,scNew:5,scOld:7,dewa:15000,ageNew:'2020+',ageMid:'2008-19',ageOld:'2003-07'},'Bluewaters Island':{emirate:'Dubai',cat:'Ultra Premium',e:'🎡',lt:5.2,rent:160000,sqft:3000,occ:75,night:1100,opAppr:12,opDisc:8,opHand:24,secAppr:7,scNew:25,scOld:32,dewa:7500,ageNew:'2020+',ageMid:'2018-19',ageOld:null},'Downtown Dubai':{emirate:'Dubai',cat:'Premium',e:'🏙️',lt:5.8,rent:130000,sqft:2400,occ:82,night:900,opAppr:18,opDisc:12,opHand:30,secAppr:8,scNew:18,scOld:28,dewa:7500,ageNew:'2020+',ageMid:'2010-19',ageOld:'2006-09'},'Dubai Marina':{emirate:'Dubai',cat:'Premium',e:'⛵',lt:6.2,rent:105000,sqft:1700,occ:82,night:700,opAppr:12,opDisc:10,opHand:24,secAppr:6,scNew:15,scOld:22,dewa:6500,ageNew:'2018+',ageMid:'2008-17',ageOld:'2003-07'},'DIFC':{emirate:'Dubai',cat:'Premium',e:'🏦',lt:5.0,rent:150000,sqft:3200,occ:65,night:950,opAppr:10,opDisc:8,opHand:30,secAppr:6,scNew:28,scOld:38,dewa:8000,ageNew:'2020+',ageMid:'2010-19',ageOld:'2005-09'},'Jumeirah':{emirate:'Dubai',cat:'Premium',e:'🏖️',lt:4.8,rent:140000,sqft:2600,occ:60,night:1000,opAppr:8,opDisc:5,opHand:30,secAppr:5,scNew:8,scOld:12,dewa:9000,ageNew:'2015+',ageMid:'2000-14',ageOld:'1990-99'},'Al Wasl':{emirate:'Dubai',cat:'Premium',e:'🌇',lt:5.0,rent:135000,sqft:2500,occ:55,night:900,opAppr:7,opDisc:5,opHand:28,secAppr:5,scNew:8,scOld:12,dewa:8500,ageNew:'2018+',ageMid:'2005-17',ageOld:'1995-04'},'JBR':{emirate:'Dubai',cat:'High-End',e:'🏖️',lt:6.0,rent:110000,sqft:1900,occ:85,night:800,opAppr:10,opDisc:8,opHand:24,secAppr:5,scNew:14,scOld:18,dewa:6000,ageNew:'2018+',ageMid:'2008-17',ageOld:'2005-07'},'Dubai Creek Harbour':{emirate:'Dubai',cat:'High-End',e:'🌊',lt:6.5,rent:95000,sqft:1600,occ:70,night:600,opAppr:25,opDisc:15,opHand:30,secAppr:12,scNew:14,scOld:18,dewa:6000,ageNew:'2020+',ageMid:'2018-19',ageOld:null},'Dubai Hills Estate':{emirate:'Dubai',cat:'High-End',e:'🌳',lt:6.5,rent:100000,sqft:1700,occ:60,night:650,opAppr:20,opDisc:12,opHand:28,secAppr:10,scNew:12,scOld:16,dewa:6500,ageNew:'2020+',ageMid:'2017-19',ageOld:null},'MBR City':{emirate:'Dubai',cat:'High-End',e:'👑',lt:6.8,rent:90000,sqft:1500,occ:65,night:550,opAppr:22,opDisc:15,opHand:30,secAppr:12,scNew:11,scOld:15,dewa:6000,ageNew:'2020+',ageMid:'2016-19',ageOld:null},'City Walk':{emirate:'Dubai',cat:'High-End',e:'🛍️',lt:5.5,rent:120000,sqft:2200,occ:72,night:750,opAppr:12,opDisc:8,opHand:24,secAppr:7,scNew:18,scOld:24,dewa:7000,ageNew:'2020+',ageMid:'2015-19',ageOld:null},'Sobha Hartland':{emirate:'Dubai',cat:'High-End',e:'🌿',lt:6.2,rent:95000,sqft:1650,occ:62,night:580,opAppr:18,opDisc:12,opHand:28,secAppr:10,scNew:13,scOld:17,dewa:6200,ageNew:'2020+',ageMid:'2018-19',ageOld:null},'Arabian Ranches':{emirate:'Dubai',cat:'High-End',e:'🐎',lt:5.5,rent:120000,sqft:1800,occ:50,night:700,opAppr:10,opDisc:8,opHand:28,secAppr:6,scNew:4,scOld:6,dewa:8000,ageNew:'2020+',ageMid:'2008-19',ageOld:'2004-07'},'Wasl Gate':{emirate:'Dubai',cat:'High-End',e:'🚪',lt:6.5,rent:85000,sqft:1400,occ:68,night:520,opAppr:15,opDisc:10,opHand:26,secAppr:8,scNew:12,scOld:16,dewa:5800,ageNew:'2020+',ageMid:'2016-19',ageOld:null},'Business Bay':{emirate:'Dubai',cat:'Mid-Market',e:'💼',lt:7.2,rent:78000,sqft:1350,occ:75,night:500,opAppr:15,opDisc:12,opHand:24,secAppr:8,scNew:14,scOld:20,dewa:5500,ageNew:'2020+',ageMid:'2012-19',ageOld:'2008-11'},'JLT':{emirate:'Dubai',cat:'Mid-Market',e:'🏢',lt:7.5,rent:68000,sqft:1050,occ:70,night:420,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:11,scOld:16,dewa:5000,ageNew:'2018+',ageMid:'2008-17',ageOld:'2006-07'},'JVC':{emirate:'Dubai',cat:'Mid-Market',e:'🏘️',lt:8.0,rent:55000,sqft:850,occ:78,night:350,opAppr:18,opDisc:15,opHand:22,secAppr:10,scNew:9,scOld:14,dewa:4500,ageNew:'2020+',ageMid:'2015-19',ageOld:'2010-14'},'JVT':{emirate:'Dubai',cat:'Mid-Market',e:'📐',lt:7.8,rent:52000,sqft:820,occ:72,night:330,opAppr:16,opDisc:14,opHand:22,secAppr:9,scNew:9,scOld:13,dewa:4400,ageNew:'2020+',ageMid:'2015-19',ageOld:'2010-14'},'Al Barsha':{emirate:'Dubai',cat:'Mid-Market',e:'🏬',lt:7.0,rent:65000,sqft:1100,occ:68,night:400,opAppr:8,opDisc:6,opHand:24,secAppr:4,scNew:10,scOld:15,dewa:5000,ageNew:'2018+',ageMid:'2008-17',ageOld:'2000-07'},'Tecom':{emirate:'Dubai',cat:'Mid-Market',e:'💻',lt:7.3,rent:62000,sqft:1000,occ:68,night:400,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:10,scOld:15,dewa:4800,ageNew:'2018+',ageMid:'2005-17',ageOld:'2002-04'},'Sports City':{emirate:'Dubai',cat:'Value',e:'⚽',lt:8.5,rent:48000,sqft:700,occ:72,night:320,opAppr:12,opDisc:12,opHand:20,secAppr:7,scNew:8,scOld:12,dewa:4200,ageNew:'2020+',ageMid:'2012-19',ageOld:'2008-11'},'Arjan':{emirate:'Dubai',cat:'Value',e:'🦋',lt:7.8,rent:50000,sqft:800,occ:65,night:300,opAppr:18,opDisc:15,opHand:20,secAppr:10,scNew:8,scOld:12,dewa:4300,ageNew:'2020+',ageMid:'2016-19',ageOld:null},'Al Furjan':{emirate:'Dubai',cat:'Value',e:'🏡',lt:7.3,rent:58000,sqft:950,occ:62,night:350,opAppr:14,opDisc:12,opHand:22,secAppr:8,scNew:8,scOld:11,dewa:4800,ageNew:'2020+',ageMid:'2015-19',ageOld:'2012-14'},'Motor City':{emirate:'Dubai',cat:'Value',e:'🏎️',lt:7.5,rent:52000,sqft:850,occ:58,night:320,opAppr:10,opDisc:10,opHand:22,secAppr:6,scNew:9,scOld:13,dewa:4600,ageNew:'2018+',ageMid:'2008-17',ageOld:'2005-07'},'Mudon':{emirate:'Dubai',cat:'Value',e:'🏠',lt:7.2,rent:60000,sqft:1000,occ:55,night:380,opAppr:12,opDisc:10,opHand:24,secAppr:7,scNew:5,scOld:7,dewa:5000,ageNew:'2020+',ageMid:'2015-19',ageOld:null},'Mirdif':{emirate:'Dubai',cat:'Value',e:'🌺',lt:6.8,rent:55000,sqft:950,occ:55,night:350,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:7,scOld:10,dewa:5000,ageNew:'2018+',ageMid:'2008-17',ageOld:'2000-07'},'Silicon Oasis':{emirate:'Dubai',cat:'Affordable',e:'💻',lt:9.0,rent:45000,sqft:650,occ:68,night:280,opAppr:15,opDisc:12,opHand:22,secAppr:8,scNew:7,scOld:11,dewa:4000,ageNew:'2020+',ageMid:'2012-19',ageOld:'2008-11'},'International City':{emirate:'Dubai',cat:'Affordable',e:'🌍',lt:9.5,rent:35000,sqft:480,occ:65,night:220,opAppr:8,opDisc:8,opHand:20,secAppr:5,scNew:5,scOld:8,dewa:3500,ageNew:'2018+',ageMid:'2008-17',ageOld:'2005-07'},'Discovery Gardens':{emirate:'Dubai',cat:'Affordable',e:'🌻',lt:9.2,rent:38000,sqft:520,occ:60,night:240,opAppr:5,opDisc:5,opHand:20,secAppr:3,scNew:6,scOld:10,dewa:3800,ageNew:'2015+',ageMid:'2008-14',ageOld:'2005-07'},'DIP':{emirate:'Dubai',cat:'Affordable',e:'🏭',lt:9.8,rent:32000,sqft:420,occ:55,night:200,opAppr:8,opDisc:8,opHand:22,secAppr:4,scNew:5,scOld:8,dewa:3200,ageNew:'2018+',ageMid:'2008-17',ageOld:'2005-07'},'Al Nahda Dubai':{emirate:'Dubai',cat:'Affordable',e:'🏠',lt:8.5,rent:40000,sqft:580,occ:62,night:250,opAppr:6,opDisc:6,opHand:22,secAppr:4,scNew:6,scOld:10,dewa:3600,ageNew:'2015+',ageMid:'2005-14',ageOld:'1998-04'},'Deira':{emirate:'Dubai',cat:'Affordable',e:'🕌',lt:8.2,rent:42000,sqft:620,occ:65,night:280,opAppr:6,opDisc:5,opHand:24,secAppr:3,scNew:7,scOld:12,dewa:3800,ageNew:'2015+',ageMid:'2000-14',ageOld:'1990-99'},'Bur Dubai':{emirate:'Dubai',cat:'Affordable',e:'🛶',lt:7.8,rent:45000,sqft:700,occ:70,night:320,opAppr:5,opDisc:5,opHand:24,secAppr:3,scNew:8,scOld:14,dewa:4000,ageNew:'2015+',ageMid:'2000-14',ageOld:'1985-99'},'Jebel Ali':{emirate:'Dubai',cat:'Affordable',e:'🚢',lt:8.8,rent:38000,sqft:550,occ:58,night:240,opAppr:10,opDisc:10,opHand:24,secAppr:6,scNew:6,scOld:10,dewa:3600,ageNew:'2018+',ageMid:'2008-17',ageOld:'2000-07'},'Dubai South':{emirate:'Dubai',cat:'Emerging',e:'✈️',lt:8.5,rent:40000,sqft:600,occ:55,night:250,opAppr:25,opDisc:20,opHand:28,secAppr:15,scNew:7,scOld:10,dewa:3800,ageNew:'2022+',ageMid:'2018-21',ageOld:null},'Expo City':{emirate:'Dubai',cat:'Emerging',e:'🎪',lt:7.5,rent:55000,sqft:900,occ:60,night:350,opAppr:30,opDisc:18,opHand:30,secAppr:18,scNew:10,scOld:14,dewa:4500,ageNew:'2022+',ageMid:null,ageOld:null},'Damac Hills':{emirate:'Dubai',cat:'Emerging',e:'🏌️',lt:7.8,rent:52000,sqft:820,occ:62,night:320,opAppr:18,opDisc:15,opHand:24,secAppr:10,scNew:8,scOld:12,dewa:4300,ageNew:'2020+',ageMid:'2017-19',ageOld:null},'Damac Hills 2':{emirate:'Dubai',cat:'Emerging',e:'🏡',lt:8.5,rent:42000,sqft:620,occ:55,night:280,opAppr:20,opDisc:18,opHand:22,secAppr:12,scNew:6,scOld:9,dewa:4000,ageNew:'2021+',ageMid:'2019-20',ageOld:null},'Town Square':{emirate:'Dubai',cat:'Emerging',e:'🏪',lt:8.2,rent:48000,sqft:720,occ:58,night:290,opAppr:15,opDisc:12,opHand:22,secAppr:9,scNew:7,scOld:10,dewa:4100,ageNew:'2020+',ageMid:'2017-19',ageOld:null},'Tilal Al Ghaf':{emirate:'Dubai',cat:'Emerging',e:'🌴',lt:6.5,rent:85000,sqft:1400,occ:50,night:500,opAppr:25,opDisc:15,opHand:30,secAppr:15,scNew:5,scOld:7,dewa:6000,ageNew:'2022+',ageMid:null,ageOld:null},'The Valley':{emirate:'Dubai',cat:'Emerging',e:'🏞️',lt:7.0,rent:55000,sqft:900,occ:48,night:350,opAppr:28,opDisc:20,opHand:32,secAppr:15,scNew:6,scOld:8,dewa:4500,ageNew:'2024+',ageMid:null,ageOld:null},// RAK\n'Al Marjan Island':{emirate:'RAK',cat:'Premium',e:'🏝️',lt:7.5,rent:70000,sqft:1200,occ:72,night:550,opAppr:25,opDisc:15,opHand:28,secAppr:15,scNew:14,scOld:18,dewa:4500,ageNew:'2022+',ageMid:'2018-21',ageOld:null},'Mina Al Arab':{emirate:'RAK',cat:'High-End',e:'🌊',lt:7.0,rent:65000,sqft:1000,occ:68,night:480,opAppr:20,opDisc:12,opHand:26,secAppr:12,scNew:12,scOld:16,dewa:4200,ageNew:'2020+',ageMid:'2016-19',ageOld:null},'Al Hamra Village':{emirate:'RAK',cat:'Mid-Market',e:'⛳',lt:7.8,rent:55000,sqft:850,occ:65,night:380,opAppr:15,opDisc:10,opHand:24,secAppr:10,scNew:10,scOld:14,dewa:3800,ageNew:'2018+',ageMid:'2008-17',ageOld:'2005-07'},'Yasmin Village RAK':{emirate:'RAK',cat:'Affordable',e:'🌸',lt:11.0,rent:35000,sqft:450,occ:70,night:250,opAppr:10,opDisc:8,opHand:20,secAppr:6,scNew:6,scOld:9,dewa:3000,ageNew:'2015+',ageMid:'2008-14',ageOld:'2005-07'},'Hayat Island':{emirate:'RAK',cat:'Emerging',e:'🏖️',lt:7.2,rent:60000,sqft:950,occ:62,night:420,opAppr:22,opDisc:15,opHand:28,secAppr:14,scNew:11,scOld:15,dewa:4000,ageNew:'2023+',ageMid:null,ageOld:null},// ABU DHABI\n'Saadiyat Island':{emirate:'Abu Dhabi',cat:'Ultra Premium',e:'🏛️',lt:5.0,rent:180000,sqft:2800,occ:60,night:1100,opAppr:12,opDisc:8,opHand:30,secAppr:7,scNew:20,scOld:28,dewa:8000,ageNew:'2020+',ageMid:'2015-19',ageOld:null},'Yas Island':{emirate:'Abu Dhabi',cat:'Premium',e:'🎢',lt:6.0,rent:95000,sqft:1500,occ:70,night:650,opAppr:15,opDisc:10,opHand:28,secAppr:8,scNew:14,scOld:18,dewa:5500,ageNew:'2020+',ageMid:'2012-19',ageOld:null},'Al Reem Island':{emirate:'Abu Dhabi',cat:'High-End',e:'🌆',lt:7.0,rent:75000,sqft:1200,occ:72,night:500,opAppr:12,opDisc:10,opHand:26,secAppr:7,scNew:12,scOld:16,dewa:5000,ageNew:'2018+',ageMid:'2010-17',ageOld:'2008-09'},'Al Raha Beach':{emirate:'Abu Dhabi',cat:'High-End',e:'🏖️',lt:6.5,rent:85000,sqft:1350,occ:65,night:550,opAppr:10,opDisc:8,opHand:26,secAppr:6,scNew:13,scOld:17,dewa:5200,ageNew:'2018+',ageMid:'2008-17',ageOld:null},'Khalifa City':{emirate:'Abu Dhabi',cat:'Mid-Market',e:'🏘️',lt:7.5,rent:55000,sqft:850,occ:68,night:380,opAppr:8,opDisc:8,opHand:24,secAppr:5,scNew:8,scOld:12,dewa:4200,ageNew:'2018+',ageMid:'2008-17',ageOld:'2000-07'},'Masdar City':{emirate:'Abu Dhabi',cat:'Emerging',e:'🌱',lt:7.8,rent:58000,sqft:900,occ:65,night:400,opAppr:18,opDisc:15,opHand:28,secAppr:10,scNew:10,scOld:14,dewa:4500,ageNew:'2020+',ageMid:'2015-19',ageOld:null},// SHARJAH\n'Al Mamzar SHJ':{emirate:'Sharjah',cat:'Mid-Market',e:'🏖️',lt:8.0,rent:42000,sqft:650,occ:65,night:300,opAppr:8,opDisc:6,opHand:24,secAppr:5,scNew:6,scOld:10,dewa:3500,ageNew:'2015+',ageMid:'2005-14',ageOld:'1995-04'},'Al Nahda SHJ':{emirate:'Sharjah',cat:'Affordable',e:'🏢',lt:9.0,rent:35000,sqft:500,occ:75,night:250,opAppr:5,opDisc:5,opHand:22,secAppr:3,scNew:5,scOld:8,dewa:3000,ageNew:'2015+',ageMid:'2000-14',ageOld:'1990-99'},'Aljada':{emirate:'Sharjah',cat:'Emerging',e:'🏗️',lt:7.8,rent:52000,sqft:800,occ:60,night:350,opAppr:18,opDisc:15,opHand:26,secAppr:10,scNew:9,scOld:12,dewa:4000,ageNew:'2022+',ageMid:null,ageOld:null},// AJMAN\n'Ajman Downtown':{emirate:'Ajman',cat:'Affordable',e:'🏙️',lt:10.5,rent:28000,sqft:380,occ:70,night:200,opAppr:8,opDisc:8,opHand:20,secAppr:5,scNew:4,scOld:7,dewa:2500,ageNew:'2018+',ageMid:'2008-17',ageOld:'2000-07'},'Ajman Corniche':{emirate:'Ajman',cat:'Mid-Market',e:'🌅',lt:9.0,rent:35000,sqft:500,occ:65,night:250,opAppr:10,opDisc:8,opHand:22,secAppr:6,scNew:5,scOld:9,dewa:3000,ageNew:'2018+',ageMid:'2008-17',ageOld:'2000-07'},// UAQ\n'UAQ Marina':{emirate:'UAQ',cat:'Affordable',e:'⛵',lt:9.5,rent:30000,sqft:420,occ:55,night:220,opAppr:12,opDisc:10,opHand:24,secAppr:7,scNew:5,scOld:8,dewa:2800,ageNew:'2020+',ageMid:'2015-19',ageOld:null}};const roiBrMult={rent:[0.55,1,1.55,2.1,2.8],night:[0.65,1,1.45,1.9,2.5],dewa:[0.6,1,1.4,1.8,2.3]};const roiAgeMult={new:{sc:1,maint:0,rent:1.05,appr:1.2},mid:{sc:1.2,maint:5000,rent:1,appr:1},old:{sc:1.5,maint:12000,rent:0.92,appr:0.7}};function ROICalculator(){const[emirate,setEmirate]=useState('all');const[z,setZ]=useState('Business Bay');const[price,setPrice]=useState(1200000);const[sqft,setSqft]=useState(850);const[br,setBr]=useState(1);const[mkt,setMkt]=useState('offplan');const[age,setAge]=useState('new');const[tab,setTab]=useState('overview');const d=roiZones[z];const a=roiAgeMult[age];const sc=mkt==='offplan'?d.scNew:age==='old'?d.scOld:d.scNew;const costs=sc*sqft*a.sc+d.dewa*roiBrMult.dewa[br]+1000+a.maint;const rent=d.rent*roiBrMult.rent[br]*a.rent;const ltNet=rent-costs;const ltYield=(ltNet/price*100).toFixed(1);const stGross=d.night*roiBrMult.night[br]*365*d.occ/100;const stNet=stGross-costs-2500-stGross*0.28;const stYield=(stNet/price*100).toFixed(1);const appr=(mkt==='offplan'?d.opAppr:d.secAppr)*a.appr;const disc=mkt==='offplan'?d.opDisc:0;const effPrice=price*(1-disc/100);const futVal=effPrice*(1+appr/100);const profit=futVal-effPrice;const fmt=n=>new Intl.NumberFormat('it-IT').format(Math.round(n));// Group zones by emirate\nconst grouped={};Object.entries(roiZones).forEach(_ref55=>{let[name,data]=_ref55;const em=data.emirate;if(!grouped[em])grouped[em]={};if(!grouped[em][data.cat])grouped[em][data.cat]=[];grouped[em][data.cat].push(_objectSpread({name},data));});const filteredZones=emirate==='all'?grouped:{[emirate]:grouped[emirate]};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 overflow-x-auto pb-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEmirate('all'),className:\"py-1.5 px-4 rounded-full text-sm font-medium whitespace-nowrap transition-all \".concat(emirate==='all'?'bg-emerald-500 text-white':'bg-[#334155] text-zinc-400 hover:bg-[#475569]'),children:\"\\uD83C\\uDDE6\\uD83C\\uDDEA Tutti\"}),['Dubai','Abu Dhabi','RAK','Sharjah','Ajman','UAQ'].map(em=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setEmirate(em),className:\"py-1.5 px-4 rounded-full text-sm font-medium whitespace-nowrap transition-all \".concat(emirate===em?'bg-emerald-500 text-white':'bg-[#334155] text-zinc-400 hover:bg-[#475569]'),children:[em==='RAK'?'🏝️':em==='Dubai'?'🌆':em==='Abu Dhabi'?'🏛️':em==='Sharjah'?'📚':em==='Ajman'?'🏠':'⛵',\" \",em]},em))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#1e293b] rounded-xl p-4 border border-[#334155]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-6 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs block mb-1\",children:\"Zona\"}),/*#__PURE__*/_jsx(\"select\",{value:z,onChange:e=>setZ(e.target.value),className:\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\",children:Object.entries(filteredZones).map(_ref56=>{let[em,cats]=_ref56;return/*#__PURE__*/_jsx(\"optgroup\",{label:\"\\u2501\\u2501 \".concat(em,\" \\u2501\\u2501\"),children:Object.entries(cats||{}).map(_ref57=>{let[cat,list]=_ref57;return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(\"option\",{disabled:true,className:\"text-zinc-500\",children:[\"\\u2500\\u2500 \",cat,\" \\u2500\\u2500\"]}),(list||[]).map(item=>/*#__PURE__*/_jsxs(\"option\",{value:item.name,children:[item.e,\" \",item.name]},item.name))]},cat);})},em);})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs block mb-1\",children:\"Prezzo (AED)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:price,onChange:e=>setPrice(+e.target.value),className:\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs block mb-1\",children:\"Sqft\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:sqft,onChange:e=>setSqft(+e.target.value),className:\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs block mb-1\",children:\"Camere\"}),/*#__PURE__*/_jsx(\"select\",{value:br,onChange:e=>setBr(+e.target.value),className:\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\",children:['Studio','1BR','2BR','3BR','4+BR'].map((l,i)=>/*#__PURE__*/_jsx(\"option\",{value:i,children:l},i))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs block mb-1\",children:\"Mercato\"}),/*#__PURE__*/_jsxs(\"select\",{value:mkt,onChange:e=>setMkt(e.target.value),className:\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"offplan\",children:\"\\uD83C\\uDFD7\\uFE0F Off-Plan\"}),/*#__PURE__*/_jsx(\"option\",{value:\"secondary\",children:\"\\uD83C\\uDFE2 Secondary\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-5 gap-3 mt-3\",children:[mkt==='secondary'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-zinc-500 text-xs block mb-1\",children:\"Et\\xE0 Edificio\"}),/*#__PURE__*/_jsxs(\"select\",{value:age,onChange:e=>setAge(e.target.value),className:\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\",children:[/*#__PURE__*/_jsxs(\"option\",{value:\"new\",children:[\"\\uD83C\\uDD95 \",d.ageNew]}),d.ageMid&&/*#__PURE__*/_jsxs(\"option\",{value:\"mid\",children:[\"\\uD83D\\uDCC5 \",d.ageMid]}),d.ageOld&&/*#__PURE__*/_jsxs(\"option\",{value:\"old\",children:[\"\\uD83C\\uDFDA\\uFE0F \",d.ageOld]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#334155]/50 rounded-lg p-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-zinc-500 text-xs\",children:[d.emirate,\" \\u2022 \",d.cat]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-medium text-sm\",children:[d.e,\" \",z]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-amber-500/10 rounded-lg p-2 text-center border border-amber-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-amber-400 text-xs\",children:\"SC/sqft\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-bold\",children:[sc,\" AED\"]})]}),mkt==='offplan'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-emerald-500/10 rounded-lg p-2 text-center border border-emerald-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-emerald-400 text-xs\",children:\"Discount\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-bold\",children:[\"-\",disc,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-500/10 rounded-lg p-2 text-center border border-purple-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-purple-400 text-xs\",children:\"Apprezzamento\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-bold\",children:[\"+\",d.opAppr,\"%\"]})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-500/10 rounded-lg p-2 text-center border border-red-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400 text-xs\",children:\"Manutenzione\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white font-bold\",children:[fmt(a.maint),\"/y\"]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2 overflow-x-auto\",children:['overview','rental','capital','costs'].map(t=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTab(t),className:\"py-2 px-4 rounded-lg text-sm font-medium transition-all \".concat(tab===t?'bg-emerald-500 text-white':'bg-[#334155] text-zinc-400 hover:bg-[#475569]'),children:t==='overview'?'📊 Overview':t==='rental'?'🏠 Rental':t==='capital'?'📈 Capital':'💰 Costi'},t))}),tab==='overview'&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-500/10 rounded-xl p-4 text-center border border-blue-500/20\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-blue-400\",children:[ltYield,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 mt-1\",children:\"Yield LT Netto\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-500/10 rounded-xl p-4 text-center border border-purple-500/20\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-purple-400\",children:[stYield,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 mt-1\",children:\"Yield ST Netto\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-emerald-500/10 rounded-xl p-4 text-center border border-emerald-500/20\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold text-emerald-400\",children:[\"+\",appr.toFixed(0),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 mt-1\",children:\"Apprezzamento\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-amber-500/10 rounded-xl p-4 text-center border border-amber-500/20\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold text-amber-400\",children:fmt(costs)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500 mt-1\",children:\"Costi/Anno\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2 bg-[#1e293b] rounded-xl p-4 border border-[#334155]\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-xs mb-3\",children:\"Revenue Annuo Netto\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"\\uD83C\\uDFE0 Long Term\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-400 font-bold text-lg\",children:[fmt(ltNet),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"\\uD83C\\uDFD6\\uFE0F Short Term\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-purple-400 font-bold text-lg\",children:[fmt(stNet),\" AED\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2 bg-[#1e293b] rounded-xl p-4 border border-[#334155]\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-xs mb-3\",children:\"Capital Gain\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Valore Futuro\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400 font-bold text-lg\",children:[fmt(futVal),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Profitto\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400 font-bold text-lg\",children:[\"+\",fmt(profit),\" AED\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-full bg-[#1e293b] rounded-xl p-4 border border-[#334155]\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-400 text-xs mb-3\",children:\"ROI Totale 3 anni (rent + appreciation)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-[#334155] rounded-full h-4 overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-emerald-500 transition-all\",style:{width:\"\".concat(Math.min((ltNet*3+profit)/price*100,100),\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white font-bold text-xl\",children:[((ltNet*3+profit)/price*100).toFixed(0),\"%\"]})]})]})]}),tab==='rental'&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#1e293b] rounded-xl p-4 border border-blue-500/30\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-white mb-4\",children:\"\\uD83C\\uDFE0 Long Term Rental\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-500/10 rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-blue-400\",children:[(rent/price*100).toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Yield Lordo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-emerald-500/10 rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-emerald-400\",children:[ltYield,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Yield Netto\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Affitto Annuo\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[fmt(rent),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Mensile\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[fmt(rent/12),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"(-) Costi Annui\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-400\",children:[\"-\",fmt(costs),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 font-medium\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"= Netto Annuo\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400\",children:[fmt(ltNet),\" AED\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#1e293b] rounded-xl p-4 border border-purple-500/30\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-white mb-4\",children:\"\\uD83C\\uDFD6\\uFE0F Short Term / Airbnb\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-500/10 rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-purple-400\",children:[(stGross/price*100).toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Yield Lordo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-emerald-500/10 rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-emerald-400\",children:[stYield,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Yield Netto\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Tariffa/Notte\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[fmt(d.night*roiBrMult.night[br]),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Occupancy Media\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[d.occ,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Revenue Lordo\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[fmt(stGross),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 font-medium\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"= Netto Annuo\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400\",children:[fmt(stNet),\" AED\"]})]})]})]})]}),tab==='capital'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#1e293b] rounded-xl p-4 border border-emerald-500/30\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-semibold text-white mb-4\",children:[\"\\uD83D\\uDCC8 Capital Appreciation - \",mkt==='offplan'?'Off-Plan':'Secondary']}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-emerald-500/10 rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-emerald-400\",children:[\"+\",appr.toFixed(0),\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Apprezzamento\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#334155] rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-white\",children:fmt(profit)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Profitto (AED)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#334155] rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xl font-bold text-white\",children:fmt(futVal)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Valore Futuro\"})]}),mkt==='offplan'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-orange-500/10 rounded-lg p-3 text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl font-bold text-orange-400\",children:[d.opHand,\"m\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-zinc-500\",children:\"Handover\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Prezzo Acquisto\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[fmt(price),\" AED\"]})]}),mkt==='offplan'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400\",children:[\"(-) Launch Discount \",disc,\"%\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400\",children:[\"-\",fmt(price-effPrice),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Prezzo Effettivo\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-white\",children:[fmt(effPrice),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 border-b border-[#334155]\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400\",children:[\"(+) Apprezzamento \",appr.toFixed(0),\"%\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400\",children:[\"+\",fmt(profit),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 font-medium text-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"= Valore Futuro\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-emerald-400\",children:[fmt(futVal),\" AED\"]})]})]})]}),tab==='costs'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#1e293b] rounded-xl p-4 border border-red-500/30\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-white mb-4\",children:\"\\uD83D\\uDCB0 Breakdown Costi Annuali\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-3 border-b border-[#334155]\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400\",children:[\"Service Charge (\",sc,\" \\xD7 \",sqft,\" sqft)\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-amber-400 font-bold\",children:[fmt(sc*sqft*a.sc),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-3 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"DEWA (Utilities)\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-400 font-bold\",children:[fmt(d.dewa*roiBrMult.dewa[br]),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-3 border-b border-[#334155]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-zinc-400\",children:\"Assicurazione\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-green-400 font-bold\",children:\"~1,000 AED\"})]}),a.maint>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-3 border-b border-[#334155]\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-zinc-400\",children:[\"Manutenzione (edificio \",age,\")\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-400 font-bold\",children:[fmt(a.maint),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-3 font-bold text-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"TOTALE ANNUO\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-400\",children:[fmt(costs),\" AED\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between py-2 text-zinc-500\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Mensile\"}),/*#__PURE__*/_jsxs(\"span\",{children:[fmt(costs/12),\" AED/mese\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-3 bg-amber-500/10 rounded-lg border border-amber-500/20\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-amber-400 text-xs\",children:[\"\\uD83D\\uDCCC Service Charge \",z,\": \",sc,\" AED/sqft \\u2022 \",sc>20?'Premium (alto)':sc>12?'Nella media':'Budget (basso)']})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-zinc-600 text-xs text-center\",children:\"\\u26A0\\uFE0F Stime basate su dati 2024-2025 (RERA, Bayut, DLD). Consulta un professionista prima di investire.\"})]});}// ==================== CSS ANIMATIONS ====================\nconst style=document.createElement('style');style.textContent=\"\\n  @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }\\n  @keyframes slideRight { from { transform: translateX(-100%); } to { transform: translateX(0); } }\\n  @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }\\n  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\\n  .animate-slideUp { animation: slideUp 0.3s ease-out; }\\n  .animate-slideRight { animation: slideRight 0.3s ease-out; }\\n  .animate-scaleIn { animation: scaleIn 0.2s ease-out; }\\n  .animate-fadeIn { animation: fadeIn 0.2s ease-out; }\\n  * { -webkit-tap-highlight-color: transparent; }\\n  input, select, textarea { font-size: 16px !important; }\\n  .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }\\n  .scrollbar-hide::-webkit-scrollbar { display: none; }\\n\";if(typeof document!=='undefined')document.head.appendChild(style);","map":{"version":3,"names":["React","useState","useEffect","useRef","createClient","Download","Trash2","Check","RefreshCw","AlertCircle","LogOut","Eye","EyeOff","Copy","UserPlus","Search","Phone","Mail","X","Edit2","TrendingUp","DollarSign","Target","Users","Menu","Key","Bell","MapPin","Award","User","MessageCircle","ChevronLeft","ChevronRight","Clock","FileText","Plus","Send","LayoutDashboard","PieChart","ListTodo","Settings","Building2","ArrowUpRight","ArrowDownRight","Sparkles","Command","Printer","Map","List","ExternalLink","Calculator","Capacitor","StatusBar","Style","Keyboard","Haptics","ImpactStyle","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","initNativePlugins","isNativePlatform","setStyle","style","Dark","setBackgroundColor","color","addListener","document","body","classList","add","remove","e","console","log","hapticFeedback","arguments","length","undefined","impact","Heavy","Light","supabase","sendPushNotification","title","message","url","ADMIN_EMAIL","LEAFLET_TILE_URL","LEAFLET_ATTRIBUTION","DUBAI_AREAS_COORDS","lat","lng","zoom","DUBAI_CENTER","DEFAULT_ZOOM","getLocationCoords","locationName","locLower","toLowerCase","area","coords","Object","entries","includes","areaWords","split","some","word","zones","developers","commissions","pipelineStati","pipelineLabels","clienteStati","taskPriorita","theme","bg","primary","secondary","tertiary","elevated","border","subtle","default","strong","text","muted","sections","dashboard","accent","vendite","pipeline","crm","tasks","utenti","offplan","calculator","status","lead","trattativa","EOI","prenotato","venduto","incassato","priority","bassa","normale","alta","urgente","fmt","n","toLocaleString","minimumFractionDigits","maximumFractionDigits","fmtDate","d","Date","toLocaleDateString","day","month","year","fmtDateTime","hour","minute","fmtShort","getWhatsAppLink","phone","msg","concat","replace","encodeURIComponent","getBaseUrl","window","location","origin","isOverdue","isToday","toDateString","getInitials","nome","cognome","toUpperCase","sendEmail","to","subject","html","response","fetch","method","headers","JSON","stringify","data","json","success","notifyTaskCompleted","task","agentName","titolo","notifyTaskNote","note","notifyNewTaskToAgent","agentEmail","priorita","scadenza","descrizione","notifyNewSaleToAdmin","sale","progetto","valore","developer","notifyNewLeadToAdmin","zona","generateClientePDF","cliente","sales","tv","filter","s","stato","reduce","sum","Number","telefono","email","budget_max","agente_riferimento","map","join","w","open","write","close","setTimeout","print","Toast","_ref","type","onClose","t","clearTimeout","colors","error","info","className","children","Avatar","_ref2","size","sizes","sm","md","lg","xl","bgColor","Math","abs","charCodeAt","StatusBadge","_ref3","config","label","background","Card","_ref4","hover","onClick","padding","SectionHeader","_ref5","icon","Icon","action","actionLabel","onAction","MetricCard","_ref6","value","subValue","trend","ProgressBar","_ref7","max","height","showLabel","pct","min","width","toFixed","EmptyState","_ref8","description","Input","_ref9","props","_objectWithoutProperties","_excluded","_objectSpread","Select","_ref0","_excluded2","Button","_ref1","variant","_excluded3","variants","ghost","danger","Modal","_ref10","isOpen","BottomSheet","_ref11","NavItem","_ref12","active","badge","isNew","QuickActions","_ref13","whatsapp","clienteName","href","target","rel","GlobalSearch","_ref14","clienti","onSelectSale","onSelectCliente","onSelectTask","setActiveTab","query","setQuery","inputRef","current","focus","q","filteredSales","cliente_nome","agente","slice","filteredClienti","c","filteredTasks","hasResults","ref","onChange","placeholder","_theme$status","id","assegnato_a","generateDashboardPDF","totals","byAgente","byZona","today","topAgenti","sort","a","b","topZone","conversionRate","comm","ag","pell","giov","_ref15","i","name","_ref16","zone","App","view","setView","user","setUser","setSales","users","setUsers","setClienti","setTasks","activities","setActivities","followUps","setFollowUps","loading","setLoading","setError","toast","setToast","activeTab","mobileMenuOpen","setMobileMenuOpen","submitting","setSubmitting","showForm","setShowForm","showLeadDetail","setShowLeadDetail","showClienteDetail","setShowClienteDetail","showClienteModal","setShowClienteModal","showTaskModal","setShowTaskModal","showUserModal","setShowUserModal","showNoteModal","setShowNoteModal","showPasswordModal","setShowPasswordModal","showNotifications","setShowNotifications","convertingSale","setConvertingSale","filters","setFilters","search","clienteFilters","setClienteFilters","periodFilter","setPeriodFilter","showAgentDetail","setShowAgentDetail","savedListings","setSavedListings","showGlobalSearch","setShowGlobalSearch","handleKeyDown","metaKey","ctrlKey","key","preventDefault","addEventListener","removeEventListener","readNotificationIds","setReadNotificationIds","saved","localStorage","getItem","parse","showToast","u","ruolo","viewRole","loadSales","from","select","order","ascending","loadUsers","loadClienti","loadTasks","loadActivities","loadFollowUps","loadSavedListings","eq","refreshAllData","Promise","all","resolve","handleLogin","username","password","single","setItem","handleLogout","removeItem","changePassword","np","update","saveListing","listing","_listing$location","_listing$location2","_listing$location3","_listing$bedrooms","_listing$bedrooms$ava","_listing$images","_listing$images$","_listing$developer","insert","property_id","project_id","price","parseFloat","price_from","location_full","full_name","location_path","path_name","property_type","bedrooms","available","bathrooms","furnished","image_url","images","medium_image_url","pf_url","completion_status","construction_phase_key","agent_name","agent_email","created_by","user_id","property_data","removeListing","propertyId","delete","createLeadFromListing","leadData","cliente_id","newCliente","cd","fonte","referente","toISOString","inserted_by","inserted_as","addLead","ld","clienteError","cliente_cognome","cliente_email","cliente_telefono","cliente_whatsapp","nazionalita","cliente_nazionalita","budget_min","cliente_budget_min","cliente_budget_max","cliente_note","segnalatore","commission_pct","pagato","err","addSale","sd","nuovo_cliente_nome","nuovo_cliente_cognome","nuovo_cliente_telefono","nuovo_cliente_email","convertLeadToSale","v","find","updateSale","x","tn","tu","ca","details","deleteSale","confirm","createCliente","updateCliente","prev","deleteCliente","skipConfirm","createTask","agentData","updateTask","completeTask","completed_at","addTaskNote","deleteTask","addActivity","saleId","tipo","contenuto","sale_id","deleteActivity","createFollowUp","completeFollowUp","completato","deleteFollowUp","createUser","updateUser","deleteUser","myPendingTasks","overdueTasks","todayTasks","myFollowUps","f","todayFollowUps","data_reminder","overdueFollowUps","notificationTasks","recentSalesNotifications","created","created_at","now","hoursDiff","unreadNotificationIds","isRead","notificationCount","markNotificationsAsRead","taskIds","saleIds","allIds","Set","markSingleNotificationAsRead","notifId","src","alt","LoginForm","onLogin","_tabs$find","isAgenteAdmin","mySales","myTasks","myClienti","rate","myVendite","totalComm","pagate","byStato","acc","st","tabs","LeadForm","userName","onSubmit","SaleForm","_document$getElementB","getElementById","click","disabled","_theme$status$st","_theme$status$st2","_byStato$st","_theme$status2","LeadsTableView","leads","onSelectLead","onUpdateStatus","onDelete","isAdmin","_theme$status$st3","_byStato$st2","_theme$status$st4","_byStato$st3","_theme$status$st5","borderLeftColor","AgentTasksTab","allTasks","onComplete","onAddNote","OffPlanTab","onCreateLead","onSaveListing","onRemoveListing","ROICalculator","LeadDetailSheet","onUpdateSale","onConvert","onAddActivity","onCreateFollowUp","onCompleteFollowUp","onDeleteActivity","onDeleteFollowUp","ConvertModal","onCancel","NotificationsPanel","unreadIds","recentSales","onGoToTask","onMarkAsRead","userId","PasswordModal","currentPassword","onSave","NoteModal","getFilteredByPeriod","salesData","days","parseInt","cutoff","setDate","getDate","periodSales","agentUser","sg","p","g","netto","byMonth","_s$data","m","substring","pendingTasks","_ref17","_theme$status$st6","_theme$status$st7","items","_ref18","values","keys","_ref19","localeCompare","_ref20","AgentDetailView","agent","onBack","VenditeTab","PipelineTab","onUpdateSaleStatus","ClienteDetailView","onEdit","onAddTask","onCompleteTask","onDeleteTask","onExportPDF","CRMTab","onSelect","onCreate","onUpdateCliente","AdminTasksTab","week","isOverdueF","isTodayF","nota","ora_reminder","venduteSales","maturate","daPagare","percentPaid","totale","count","_ref21","TeamTab","ClienteModal","TaskModal","UserModal","_ref22","_theme$status3","_theme$status4","_ref23","onAssign","selectedIds","setSelectedIds","sortField","setSortField","sortDir","setSortDir","filterStato","setFilterStato","searchQuery","setSearchQuery","showBulkActions","setShowBulkActions","bulkAction","setBulkAction","Intl","NumberFormat","currency","format","getCliente","filteredLeads","l","_l$progetto","_l$zona","_l$developer","_cliente$nome","_cliente$cognome","aVal","bVal","_getCliente","_getCliente2","toggleSelect","toggleSelectAll","handleBulkAction","forEach","SortHeader","_ref24","field","checked","isSelected","stopPropagation","_ref25","draggedItem","setDraggedItem","dragOverColumn","setDragOverColumn","handleDragStart","dataTransfer","effectAllowed","opacity","handleDragEnd","handleDragOver","dropEffect","handleDragLeave","handleDrop","newStato","_theme$status$st8","_byStato$st4","_byStato$st5","_byStato$st6","onDragOver","onDragLeave","onDrop","_theme$status$st9","draggable","onDragStart","onDragEnd","_ref26","getClientStats","cs","sortedClienti","_ref27","stats","azienda","_ref28","tab","setTab","totalValue","_ref29","setFilter","filtered","counts","pending","overdue","_ref30","completedTasks","displayTasks","_ref31","copiedId","setCopiedId","copy","navigator","clipboard","writeText","attivo","_ref32","agentSales","totalVolume","totalVendite","commPagate","_s$data2","_theme$status$st0","_theme$status$st1","_ref33","_ref34","_theme$status5","_theme$status6","MapboxMap","_ref35","_popupProject$images","_popupProject$images$","_popupProject$locatio","_popupProject$locatio2","projects","onSelectProject","selectedProject","onAreaClick","mapContainer","markersLayer","markersMap","mapLoaded","setMapLoaded","mapError","setMapError","popupProject","setPopupProject","projectsByLocation","useMemo","grouped","_p$coordinates","_p$coordinates2","coordinates","lon","_p$location","_p$location2","locName","offsetLat","random","offsetLng","link","createElement","head","appendChild","L","script","async","onload","initMap","onerror","center","zoomControl","control","position","addTo","tileLayer","attribution","maxZoom","layerGroup","clearLayers","project","priceText","round","iconHtml","customIcon","divIcon","iconSize","iconAnchor","marker","on","DomEvent","setJustOpened","flyTo","duration","justOpened","handleMapClick","formatPrice","ProjectCardCompact","_ref36","_project$images","_project$images$","_project$location","_project$developer","onHover","num","formatBedrooms","_bedrooms$available","beds","formatDelivery","date","ceil","getMonth","getFullYear","onMouseEnter","onMouseLeave","delivery_date","_ref37","viewMode","setViewMode","listings","setListings","allMapProjects","setAllMapProjects","emirate","minPrice","maxPrice","deliveryYear","sortBy","selectedListing","setSelectedListing","showAssignModal","setShowAssignModal","page","setPage","totalPages","setTotalPages","totalResults","setTotalResults","selectedAreaProjects","setSelectedAreaProjects","selectedAreaName","setSelectedAreaName","setStats","byZone","byDeveloper","avgPrice","showStats","setShowStats","ITEMS_PER_PAGE","emirates","zonesByEmirate","availableZones","flat","topDevelopers","bedroomOptions","statusOptions","deliveryYears","sortOptions","loadStats","loadAllMapProjects","zoneData","neq","zoneMap","totalPrice","priceCount","location_name","_ref38","devData","not","devMap","dev","developer_name","_ref39","limit","mapProjects","_p$raw_data","_p$raw_data2","_p$raw_data2$location","construction_phase","raw_data","_p$coordinates3","_p$coordinates4","searchListings","newPage","or","ilike","gte","lte","startDate","endDate","contains","nullsFirst","range","queryError","transformedData","_p$raw_data3","_p$raw_data3$develope","_p$raw_data4","_p$raw_data4$brochure","_p$raw_data5","logo","hotness_level","payment_plans","brochure_url","brochure","finalData","_p$bedrooms","_p$bedrooms$available","handlePageChange","scrollTo","top","behavior","exportProjectsCSV","rows","csv","r","toString","blob","Blob","URL","createObjectURL","download","revokeObjectURL","isListingSaved","projectId","_bedrooms$available2","dateStr","quarter","formatPaymentPlan","plans","_plans$plans","plan","summary","down_payment","during_construction","handover","handleAreaClick","areaName","displayProjects","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","z","onKeyDown","y","_project$images2","_project$images2$","_project$location2","_project$developer2","Array","_","pageNum","_project$images3","_project$images3$","_project$location3","_project$images4","_project$images4$","_project$location4","_project$images5","_project$images5$","_project$location5","_project$developer3","_project$developer4","imageUrl","ListingDetailModal","isSaved","onToggleSave","AssignListingModal","_ref40","_listing$location5","_listing$location6","_listing$location7","_listing$location8","_images$activeImageIn","_listing$location0","_listing$bedrooms2","_listing$bedrooms2$av","_listing$payment_plan4","_listing$payment_plan5","_listing$payment_plan6","_listing$payment_plan7","_listing$payment_plan8","_listing$payment_plan9","activeImageIndex","setActiveImageIndex","showFullGallery","setShowFullGallery","generatingPdf","setGeneratingPdf","brochureUrl","setBrochureUrl","videoUrl","setVideoUrl","videoType","setVideoType","mediaLoading","setMediaLoading","showBrochureViewer","setShowBrochureViewer","showVideoPlayer","setShowVideoPlayer","then","res","video_url","video_type","catch","finally","_bedrooms$available3","getStatusLabel","downloadProjectPDF","_listing$payment_plan","_listing$payment_plan2","_listing$payment_plan3","_listing$images2","_listing$images2$","_listing$developer2","_listing$location4","paymentPlan","htmlContent","getLocationInsights","insights","rating","highlights","roi","locationLower","locationInsights","hasCoords","getMapUrl","_listing$location9","small_image_url","img","idx","bed","basePrice","multiplier","estimatedPrice","projects_count","progress","completion_percentage","construction_progress","deliveryDate","totalDuration","elapsed","h","after_handover","_listing$payment_plan0","_listing$payment_plan1","_listing$payment_plan10","_listing$location1","_listing$developer3","bedsText","deliveryText","paymentText","allow","allowFullScreen","controls","autoPlay","_ref41","_listing$images3","_listing$images3$","_listing$location13","selectedCliente","setSelectedCliente","createNew","setCreateNew","setNewCliente","canCreate","trim","handleCreate","_listing$title","_listing$location10","_listing$location11","_listing$location12","_listing$location12$p","_listing$location12$p2","pf_property_id","_ref42","setUsername","setPassword","showPwd","setShowPwd","_ref43","mc","editing","setEditing","saving","setSaving","activeDetailTab","setActiveDetailTab","showActivityForm","setShowActivityForm","showFollowUpForm","setShowFollowUpForm","activityForm","setActivityForm","followUpForm","setFollowUpForm","editForm","setEditForm","activityTypes","handleAddActivity","handleAddFollowUp","handleSave","aType","fType","_theme$status$st10","_theme$status$st11","_ref44","setValue","autoFocus","_ref45","allNotifications","taskNotifId","isUnread","_ref46","oldPwd","setOldPwd","newPwd","setNewPwd","confirmPwd","setConfirmPwd","save","_ref47","setNote","_ref48","form","setForm","alert","_ref49","_theme$priority$p","_theme$priority$p2","_ref50","htmlFor","ClientSearch","_ref51","onCreateNew","selectedClient","setSearch","show","setShow","onFocus","SelectWithOther","_ref52","options","showCustom","setShowCustom","customValue","setCustomValue","o","_ref53","setSelectedClient","showNewClient","setShowNewClient","submit","_theme$status$st12","_theme$status$st13","_ref54","roiZones","cat","lt","rent","sqft","occ","night","opAppr","opDisc","opHand","secAppr","scNew","scOld","dewa","ageNew","ageMid","ageOld","roiBrMult","roiAgeMult","new","sc","maint","appr","mid","old","setEmirate","setZ","setPrice","setSqft","br","setBr","mkt","setMkt","age","setAge","costs","ltNet","ltYield","stGross","stNet","stYield","disc","effPrice","futVal","profit","_ref55","em","push","filteredZones","_ref56","cats","_ref57","list","item","textContent"],"sources":["/home/claude/keyprime-sales/src/App.js"],"sourcesContent":["/* eslint-disable */\nimport React, { useState, useEffect, useRef } from 'react';\nimport { createClient } from '@supabase/supabase-js';\nimport { Download, Trash2, Check, RefreshCw, AlertCircle, LogOut, Eye, EyeOff, Copy, UserPlus, Search, Phone, Mail, X, Edit2, TrendingUp, DollarSign, Target, Users, Menu, Key, Bell, MapPin, Award, User, MessageCircle, ChevronLeft, ChevronRight, Clock, FileText, Plus, Send, LayoutDashboard, PieChart, ListTodo, Settings, Building2, ArrowUpRight, ArrowDownRight, Sparkles, Command, Printer, Map, List, ExternalLink, Calculator } from 'lucide-react';\nimport { Capacitor } from '@capacitor/core';\nimport { StatusBar, Style } from '@capacitor/status-bar';\nimport { Keyboard } from '@capacitor/keyboard';\nimport { Haptics, ImpactStyle } from '@capacitor/haptics';\n\n// Initialize native plugins\nconst initNativePlugins = async () => {\n  if (Capacitor.isNativePlatform()) {\n    try {\n      // Status bar dark with app background\n      await StatusBar.setStyle({ style: Style.Dark });\n      await StatusBar.setBackgroundColor({ color: '#0f172a' });\n      \n      // Keyboard listeners for better UX\n      Keyboard.addListener('keyboardWillShow', () => {\n        document.body.classList.add('keyboard-open');\n      });\n      Keyboard.addListener('keyboardWillHide', () => {\n        document.body.classList.remove('keyboard-open');\n      });\n    } catch (e) {\n      console.log('Native plugin init error:', e);\n    }\n  }\n};\n\n// Haptic feedback helper\nconst hapticFeedback = async (style = 'light') => {\n  if (Capacitor.isNativePlatform()) {\n    try {\n      await Haptics.impact({ style: style === 'heavy' ? ImpactStyle.Heavy : ImpactStyle.Light });\n    } catch (e) {}\n  }\n};\n\ninitNativePlugins();\n\nconst supabase = createClient('https://wqtylxrrerhbxagdzftn.supabase.co','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndxdHlseHJyZXJoYnhhZ2R6ZnRuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2NjkyNjAsImV4cCI6MjA4NzI0NTI2MH0.oXUs9ITNi6lEFat_5FH0x-Exw5MDgRhwx6T0yL3xiWQ');\n\n// Send Push Notification - disabled (OneSignal API requires paid plan)\nconst sendPushNotification = async (title, message, url = null) => {\n  // Push notifications disabled - using email notifications instead\n  console.log('Push disabled:', title, message);\n};\n\n// Config\nconst ADMIN_EMAIL = 'bozzellapellegrino@gmail.com';\n\n// Leaflet Config (no token needed - free!)\nconst LEAFLET_TILE_URL = 'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png';\nconst LEAFLET_ATTRIBUTION = '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> &copy; <a href=\"https://carto.com/attributions\">CARTO</a>';\n\n// Dubai Areas with coordinates for map\nconst DUBAI_AREAS_COORDS = {\n  'Dubai Marina': { lat: 25.0805, lng: 55.1403, zoom: 14 },\n  'Palm Jumeirah': { lat: 25.1124, lng: 55.1390, zoom: 13 },\n  'Downtown Dubai': { lat: 25.1972, lng: 55.2744, zoom: 14 },\n  'Business Bay': { lat: 25.1851, lng: 55.2628, zoom: 14 },\n  'JBR': { lat: 25.0780, lng: 55.1340, zoom: 15 },\n  'Dubai Hills Estate': { lat: 25.1026, lng: 55.2427, zoom: 13 },\n  'Dubai Hills': { lat: 25.1026, lng: 55.2427, zoom: 13 },\n  'Mohammed Bin Rashid City': { lat: 25.1695, lng: 55.3147, zoom: 13 },\n  'MBR City': { lat: 25.1695, lng: 55.3147, zoom: 13 },\n  'Dubai Creek Harbour': { lat: 25.2048, lng: 55.3461, zoom: 14 },\n  'Dubai Creek': { lat: 25.2048, lng: 55.3461, zoom: 14 },\n  'Jumeirah Village Circle': { lat: 25.0655, lng: 55.2094, zoom: 14 },\n  'JVC': { lat: 25.0655, lng: 55.2094, zoom: 14 },\n  'JLT': { lat: 25.0750, lng: 55.1550, zoom: 14 },\n  'Dubai South': { lat: 24.8966, lng: 55.1581, zoom: 12 },\n  'DAMAC Hills': { lat: 25.0285, lng: 55.2430, zoom: 13 },\n  'DAMAC Hills 2': { lat: 25.0050, lng: 55.2750, zoom: 13 },\n  'Arabian Ranches': { lat: 25.0597, lng: 55.2671, zoom: 13 },\n  'Meydan': { lat: 25.1606, lng: 55.2958, zoom: 13 },\n  'DIFC': { lat: 25.2104, lng: 55.2796, zoom: 15 },\n  'Al Marjan Island': { lat: 25.7955, lng: 55.7283, zoom: 13 },\n  'Dubai Islands': { lat: 25.2750, lng: 55.3150, zoom: 12 },\n  'Expo City': { lat: 24.9600, lng: 55.1580, zoom: 13 },\n  'Yas Island': { lat: 24.4957, lng: 54.6030, zoom: 13 },\n  'Saadiyat Island': { lat: 24.5465, lng: 54.4330, zoom: 13 },\n  'Al Reem Island': { lat: 24.4950, lng: 54.4050, zoom: 13 },\n  'Sobha Hartland': { lat: 25.1850, lng: 55.3250, zoom: 14 },\n  'Tilal Al Ghaf': { lat: 25.0350, lng: 55.2100, zoom: 13 },\n  'Emaar Beachfront': { lat: 25.0850, lng: 55.1350, zoom: 14 },\n  'Bluewaters Island': { lat: 25.0800, lng: 55.1200, zoom: 14 },\n  'City Walk': { lat: 25.2050, lng: 55.2600, zoom: 14 },\n  'Abu Dhabi': { lat: 24.4539, lng: 54.3773, zoom: 11 },\n  'Sharjah': { lat: 25.3463, lng: 55.4209, zoom: 11 },\n  'Ajman': { lat: 25.4052, lng: 55.5136, zoom: 11 },\n  'Ras Al Khaimah': { lat: 25.7895, lng: 55.9432, zoom: 11 },\n};\n\nconst DUBAI_CENTER = { lat: 25.1972, lng: 55.2744 };\nconst DEFAULT_ZOOM = 10;\n\n// Get coordinates for location name\nconst getLocationCoords = (locationName) => {\n  if (!locationName) return null;\n  const locLower = locationName.toLowerCase();\n  for (const [area, coords] of Object.entries(DUBAI_AREAS_COORDS)) {\n    if (locLower.includes(area.toLowerCase())) return coords;\n  }\n  for (const [area, coords] of Object.entries(DUBAI_AREAS_COORDS)) {\n    const areaWords = area.toLowerCase().split(' ');\n    if (areaWords.some(word => word.length > 3 && locLower.includes(word))) return coords;\n  }\n  return null;\n};\n\n// Data\nconst zones = ['Palm Jumeirah', 'Dubai Marina', 'Downtown', 'Dubai Creek', 'JBR', 'Business Bay', 'JLT', 'DIFC', 'MBR City', 'Dubai Hills', 'Altro'];\nconst developers = ['Emaar', 'Damac', 'Sobha', 'Meraas', 'Nakheel', 'Dubai Properties', 'Azizi', 'Danube', 'Binghatti', 'Altro'];\nconst commissions = [2, 4, 5, 6];\nconst pipelineStati = ['lead', 'trattativa', 'EOI', 'venduto', 'incassato'];\nconst pipelineLabels = { 'lead': 'Lead', 'trattativa': 'Trattativa', 'EOI': 'EOI', 'venduto': 'Venduto (SPA)', 'incassato': 'Incassato' };\nconst clienteStati = ['nuovo', 'contattato', 'interessato', 'trattativa', 'acquistato', 'perso'];\nconst taskPriorita = ['bassa', 'normale', 'alta', 'urgente'];\n\n// Theme Colors - Section Based\nconst theme = {\n  bg: { primary: '#0f172a', secondary: '#1e293b', tertiary: '#1e293b', elevated: '#1F1F23' },\n  border: { subtle: '#334155', default: '#3F3F46', strong: '#52525B' },\n  text: { primary: '#FAFAFA', secondary: '#A1A1AA', tertiary: '#71717A', muted: '#52525B' },\n  sections: {\n    dashboard: { accent: '#A78BFA', bg: 'rgba(167,139,250,0.08)', border: 'rgba(167,139,250,0.2)' },\n    vendite: { accent: '#34D399', bg: 'rgba(52,211,153,0.08)', border: 'rgba(52,211,153,0.2)' },\n    pipeline: { accent: '#60A5FA', bg: 'rgba(96,165,250,0.08)', border: 'rgba(96,165,250,0.2)' },\n    crm: { accent: '#FBBF24', bg: 'rgba(251,191,36,0.08)', border: 'rgba(251,191,36,0.2)' },\n    tasks: { accent: '#F472B6', bg: 'rgba(244,114,182,0.08)', border: 'rgba(244,114,182,0.2)' },\n    utenti: { accent: '#22D3EE', bg: 'rgba(34,211,238,0.08)', border: 'rgba(34,211,238,0.2)' },\n    offplan: { accent: '#F97316', bg: 'rgba(249,115,22,0.08)', border: 'rgba(249,115,22,0.2)' },\n    calculator: { accent: '#10B981', bg: 'rgba(16,185,129,0.08)', border: 'rgba(16,185,129,0.2)' }\n  },\n  status: {\n    lead: { color: '#71717A', bg: 'rgba(113,113,122,0.15)' },\n    trattativa: { color: '#60A5FA', bg: 'rgba(96,165,250,0.15)' },\n    EOI: { color: '#FBBF24', bg: 'rgba(251,191,36,0.15)' },\n    prenotato: { color: '#FBBF24', bg: 'rgba(251,191,36,0.15)' }, // legacy\n    venduto: { color: '#34D399', bg: 'rgba(52,211,153,0.15)' },\n    incassato: { color: '#22C55E', bg: 'rgba(34,197,94,0.15)' }\n  },\n  priority: {\n    bassa: { color: '#71717A', bg: 'rgba(113,113,122,0.15)' },\n    normale: { color: '#60A5FA', bg: 'rgba(96,165,250,0.15)' },\n    alta: { color: '#FBBF24', bg: 'rgba(251,191,36,0.15)' },\n    urgente: { color: '#EF4444', bg: 'rgba(239,68,68,0.15)' }\n  }\n};\n\n// Utilities\nconst fmt = (n) => (n || 0).toLocaleString('en-AE', { minimumFractionDigits: 0, maximumFractionDigits: 0 });\nconst fmtDate = (d) => d ? new Date(d).toLocaleDateString('it-IT', { day: '2-digit', month: 'short', year: 'numeric' }) : '-';\nconst fmtDateTime = (d) => d ? new Date(d).toLocaleString('it-IT', { day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' }) : '-';\nconst fmtShort = (d) => d ? new Date(d).toLocaleDateString('it-IT', { day: '2-digit', month: 'short' }) : '-';\nconst getWhatsAppLink = (phone, msg = '') => `https://wa.me/${(phone || '').replace(/\\D/g, '')}${msg ? `?text=${encodeURIComponent(msg)}` : ''}`;\nconst getBaseUrl = () => typeof window !== 'undefined' ? window.location.origin : '';\nconst isOverdue = (d) => d && new Date(d) < new Date();\nconst isToday = (d) => d && new Date(d).toDateString() === new Date().toDateString();\nconst getInitials = (nome, cognome) => `${(nome || '')[0] || ''}${(cognome || '')[0] || ''}`.toUpperCase() || '?';\n\n// Email Functions - via serverless to avoid CORS\nconst sendEmail = async (to, subject, html) => { \n  try { \n    const response = await fetch('/api/send-email', { \n      method: 'POST', \n      headers: { 'Content-Type': 'application/json' }, \n      body: JSON.stringify({ to, subject, html }) \n    }); \n    const data = await response.json();\n    return data.success || false; \n  } catch (e) { \n    console.log('Email error:', e);\n    return false; \n  } \n};\nconst notifyTaskCompleted = async (task, agentName) => { await sendEmail(ADMIN_EMAIL, `✅ Task completato: ${task.titolo}`, `<div style=\"font-family:-apple-system,sans-serif;padding:20px\"><h2>Task Completato</h2><p><strong>${task.titolo}</strong></p><p>Completato da: ${agentName}</p></div>`); };\nconst notifyTaskNote = async (task, agentName, note) => { await sendEmail(ADMIN_EMAIL, `💬 Nota: ${task.titolo}`, `<div style=\"font-family:-apple-system,sans-serif;padding:20px\"><h2>Nuova Nota</h2><p><strong>${task.titolo}</strong></p><p>Da: ${agentName}</p><p>Nota: ${note}</p></div>`); };\nconst notifyNewTaskToAgent = async (task, agentEmail) => { if (!agentEmail) return; await sendEmail(agentEmail, `📋 Nuovo Task: ${task.titolo}`, `<div style=\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\"><h2 style=\"color:#a78bfa\">📋 Nuovo Task Assegnato</h2><p style=\"font-size:18px;margin:16px 0\"><strong>${task.titolo}</strong></p><p style=\"color:#94a3b8\">Priorità: ${task.priorita || 'normale'}</p><p style=\"color:#94a3b8\">Scadenza: ${task.scadenza ? new Date(task.scadenza).toLocaleDateString('it-IT') : 'Nessuna'}</p>${task.descrizione ? `<p style=\"margin-top:16px;padding:12px;background:#1e293b;border-radius:8px\">${task.descrizione}</p>` : ''}<a href=\"https://keyprime-sales-1npw.vercel.app\" style=\"display:inline-block;margin-top:20px;padding:12px 24px;background:#8b5cf6;color:white;text-decoration:none;border-radius:8px\">Apri KeyPrime</a></div>`); };\nconst notifyNewSaleToAdmin = async (sale, agentName) => { await sendEmail(ADMIN_EMAIL, `🎉 Nuova Vendita: ${sale.progetto}`, `<div style=\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\"><h2 style=\"color:#10b981\">🎉 Nuova Vendita Chiusa!</h2><p style=\"font-size:24px;margin:16px 0\"><strong>${sale.progetto}</strong></p><p style=\"font-size:20px;color:#10b981\">${sale.valore ? sale.valore.toLocaleString() : 0} AED</p><p style=\"color:#94a3b8\">Agente: ${agentName}</p><p style=\"color:#94a3b8\">Developer: ${sale.developer || 'N/A'}</p><a href=\"https://keyprime-sales-1npw.vercel.app\" style=\"display:inline-block;margin-top:20px;padding:12px 24px;background:#10b981;color:white;text-decoration:none;border-radius:8px\">Apri KeyPrime</a></div>`); };\nconst notifyNewLeadToAdmin = async (lead, agentName) => { await sendEmail(ADMIN_EMAIL, `🎯 Nuovo Lead: ${lead.progetto}`, `<div style=\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\"><h2 style=\"color:#3b82f6\">🎯 Nuovo Lead</h2><p style=\"font-size:18px;margin:16px 0\"><strong>${lead.progetto}</strong></p><p style=\"color:#94a3b8\">Zona: ${lead.zona || 'N/A'}</p><p style=\"color:#94a3b8\">Agente: ${agentName}</p><a href=\"https://keyprime-sales-1npw.vercel.app\" style=\"display:inline-block;margin-top:20px;padding:12px 24px;background:#3b82f6;color:white;text-decoration:none;border-radius:8px\">Apri KeyPrime</a></div>`); };\n\n// PDF Generator\nconst generateClientePDF = (cliente, sales, tasks) => { const tv = sales.filter(s => s.stato === 'venduto' || s.stato === 'incassato').reduce((sum, s) => sum + Number(s.valore || 0), 0); const html = `<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><title>${cliente.nome}</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;padding:40px;max-width:800px;margin:0 auto;color:#1a1a1a}h1{font-size:28px;font-weight:600;margin-bottom:8px}h2{font-size:14px;font-weight:600;color:#666;margin:24px 0 12px;text-transform:uppercase;letter-spacing:0.5px}.stats{display:flex;gap:16px;margin:24px 0}.stat{flex:1;background:#f5f5f7;padding:16px;border-radius:12px;text-align:center}.stat-val{font-size:24px;font-weight:600}.stat-label{font-size:12px;color:#666;margin-top:4px}.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}.item{background:#f5f5f7;padding:12px 16px;border-radius:8px}.item-label{font-size:11px;color:#666;margin-bottom:2px}.item-value{font-size:14px;font-weight:500}table{width:100%;border-collapse:collapse;margin-top:8px}th,td{padding:10px 12px;text-align:left;font-size:13px}th{background:#f5f5f7;font-weight:500}tr:not(:last-child) td{border-bottom:1px solid #e5e5e5}</style></head><body><h1>${cliente.nome} ${cliente.cognome||''}</h1><p style=\"color:#666\">${cliente.telefono||''} ${cliente.email?'• '+cliente.email:''}</p><div class=\"stats\"><div class=\"stat\"><div class=\"stat-val\">${sales.length}</div><div class=\"stat-label\">Lead</div></div><div class=\"stat\"><div class=\"stat-val\">${fmt(tv)}</div><div class=\"stat-label\">Valore AED</div></div><div class=\"stat\"><div class=\"stat-val\">${cliente.stato}</div><div class=\"stat-label\">Stato</div></div></div><h2>Informazioni</h2><div class=\"grid\"><div class=\"item\"><div class=\"item-label\">Budget</div><div class=\"item-value\">${cliente.budget_max?fmt(cliente.budget_max)+' AED':'N/A'}</div></div><div class=\"item\"><div class=\"item-label\">Agente</div><div class=\"item-value\">${cliente.agente_riferimento||'N/A'}</div></div></div>${sales.length>0?'<h2>Storico Lead</h2><table><tr><th>Data</th><th>Progetto</th><th>Valore</th><th>Stato</th></tr>'+sales.map(s=>'<tr><td>'+fmtShort(s.data)+'</td><td>'+s.progetto+'</td><td>'+(s.valore>0?fmt(s.valore):'TBD')+'</td><td>'+s.stato+'</td></tr>').join('')+'</table>':''}</body></html>`; const w = window.open('','_blank'); w.document.write(html); w.document.close(); setTimeout(()=>w.print(),500); };\n\n// ==================== UI COMPONENTS ====================\n\n// Toast\nconst Toast = ({ message, type = 'success', onClose }) => {\n  useEffect(() => { const t = setTimeout(onClose, 2500); return () => clearTimeout(t); }, [onClose]);\n  const colors = { success: 'bg-emerald-500', error: 'bg-red-500', info: 'bg-blue-500' };\n  return (\n    <div className={`fixed bottom-6 left-1/2 -translate-x-1/2 z-50 ${colors[type]} text-white px-5 py-3 rounded-full shadow-2xl flex items-center gap-2 animate-slideUp`}>\n      <Check className=\"w-4 h-4\" /><span className=\"text-sm font-medium\">{message}</span>\n    </div>\n  );\n};\n\n// Avatar\nconst Avatar = ({ nome, cognome, size = 'md', color }) => {\n  const sizes = { sm: 'w-8 h-8 text-xs', md: 'w-10 h-10 text-sm', lg: 'w-12 h-12 text-base', xl: 'w-14 h-14 text-lg' };\n  const colors = ['bg-violet-500', 'bg-blue-500', 'bg-emerald-500', 'bg-amber-500', 'bg-pink-500', 'bg-cyan-500'];\n  const bgColor = color || colors[Math.abs((nome || '').charCodeAt(0) || 0) % colors.length];\n  return <div className={`${sizes[size]} ${bgColor} rounded-full flex items-center justify-center font-semibold text-white shrink-0`}>{getInitials(nome, cognome)}</div>;\n};\n\n// Status Badge\nconst StatusBadge = ({ status, type = 'pipeline' }) => {\n  const config = type === 'pipeline' ? theme.status[status] : type === 'priority' ? theme.priority[status] : theme.status[status];\n  if (!config) return null;\n  const label = pipelineLabels[status] || status;\n  return <span className=\"px-2.5 py-1 rounded-full text-xs font-medium\" style={{ background: config.bg, color: config.color }}>{label}</span>;\n};\n\n// Card Component\nconst Card = ({ children, className = '', hover = false, onClick, padding = 'p-5' }) => (\n  <div onClick={onClick} className={`bg-[#1e293b] border border-[#334155] rounded-2xl ${padding} ${hover ? 'hover:border-[#3F3F46] hover:bg-[#1F1F23] cursor-pointer transition-all duration-200' : ''} ${className}`}>\n    {children}\n  </div>\n);\n\n// Section Header\nconst SectionHeader = ({ icon: Icon, title, accent, action, actionLabel, onAction }) => (\n  <div className=\"flex items-center justify-between mb-5\">\n    <div className=\"flex items-center gap-3\">\n      <div className=\"w-10 h-10 rounded-xl flex items-center justify-center\" style={{ background: `rgba(${accent}, 0.15)` }}>\n        <Icon className=\"w-5 h-5\" style={{ color: `rgb(${accent})` }} />\n      </div>\n      <h2 className=\"text-lg font-semibold text-white\">{title}</h2>\n    </div>\n    {action && (\n      <button onClick={onAction} className=\"flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all hover:bg-white/5\" style={{ color: `rgb(${accent})` }}>\n        {actionLabel} <ChevronRight className=\"w-4 h-4\" />\n      </button>\n    )}\n  </div>\n);\n\n// Metric Card\nconst MetricCard = ({ label, value, subValue, icon: Icon, color, trend, onClick }) => (\n  <Card hover={!!onClick} onClick={onClick} className=\"relative overflow-hidden\">\n    <div className=\"flex items-start justify-between\">\n      <div>\n        <p className=\"text-sm text-zinc-500 mb-1\">{label}</p>\n        <p className=\"text-2xl font-semibold text-white\">{typeof value === 'number' ? fmt(value) : value}</p>\n        {subValue && <p className=\"text-sm text-zinc-500 mt-1\">{subValue}</p>}\n      </div>\n      <div className=\"w-11 h-11 rounded-xl flex items-center justify-center\" style={{ background: `${color}15` }}>\n        <Icon className=\"w-5 h-5\" style={{ color }} />\n      </div>\n    </div>\n    {trend !== undefined && (\n      <div className={`flex items-center gap-1 mt-3 text-sm ${trend >= 0 ? 'text-emerald-400' : 'text-red-400'}`}>\n        {trend >= 0 ? <ArrowUpRight className=\"w-4 h-4\" /> : <ArrowDownRight className=\"w-4 h-4\" />}\n        {Math.abs(trend)}% vs last month\n      </div>\n    )}\n    <div className=\"absolute -right-8 -bottom-8 w-32 h-32 rounded-full opacity-5\" style={{ background: color }} />\n  </Card>\n);\n\n// Progress Bar\nconst ProgressBar = ({ value, max, color = '#A78BFA', height = 'h-2', showLabel = false }) => {\n  const pct = max > 0 ? Math.min((value / max) * 100, 100) : 0;\n  return (\n    <div className=\"relative\">\n      <div className={`${height} bg-zinc-700/50 rounded-full overflow-hidden`}>\n        <div className=\"h-full rounded-full transition-all duration-700 ease-out\" style={{ width: `${pct}%`, background: color }} />\n      </div>\n      {showLabel && <span className=\"absolute right-0 -top-6 text-xs text-zinc-500\">{pct.toFixed(0)}%</span>}\n    </div>\n  );\n};\n\n// Empty State\nconst EmptyState = ({ icon: Icon, title, description, action, onAction }) => (\n  <Card className=\"text-center py-12\">\n    <div className=\"w-16 h-16 rounded-2xl bg-zinc-700/50 flex items-center justify-center mx-auto mb-4\">\n      <Icon className=\"w-8 h-8 text-zinc-600\" />\n    </div>\n    <h3 className=\"text-lg font-medium text-white mb-2\">{title}</h3>\n    <p className=\"text-zinc-500 text-sm mb-6 max-w-sm mx-auto\">{description}</p>\n    {action && <button onClick={onAction} className=\"px-5 py-2.5 bg-white text-zinc-900 rounded-xl font-medium text-sm hover:bg-zinc-100 transition-colors\">{action}</button>}\n  </Card>\n);\n\n// Input\nconst Input = ({ label, ...props }) => (\n  <div>\n    {label && <label className=\"block text-sm text-zinc-400 mb-2\">{label}</label>}\n    <input {...props} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] focus:ring-1 focus:ring-[#3F3F46] transition-all\" />\n  </div>\n);\n\n// Select\nconst Select = ({ label, children, ...props }) => (\n  <div>\n    {label && <label className=\"block text-sm text-zinc-400 mb-2\">{label}</label>}\n    <select {...props} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-[#3F3F46] transition-all appearance-none cursor-pointer\">\n      {children}\n    </select>\n  </div>\n);\n\n// Button\nconst Button = ({ children, variant = 'primary', size = 'md', icon: Icon, className = '', ...props }) => {\n  const variants = {\n    primary: 'bg-white text-zinc-900 hover:bg-zinc-100',\n    secondary: 'bg-zinc-700/50 text-white hover:bg-zinc-700',\n    ghost: 'bg-transparent text-zinc-400 hover:text-white hover:bg-white/5',\n    danger: 'bg-red-500/10 text-red-400 hover:bg-red-500/20'\n  };\n  const sizes = { sm: 'px-3 py-1.5 text-xs', md: 'px-4 py-2.5 text-sm', lg: 'px-6 py-3 text-base' };\n  return (\n    <button {...props} className={`${variants[variant]} ${sizes[size]} rounded-xl font-medium flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed ${className}`}>\n      {Icon && <Icon className=\"w-4 h-4\" />}{children}\n    </button>\n  );\n};\n\n// Modal\nconst Modal = ({ isOpen, onClose, title, children, size = 'md' }) => {\n  if (!isOpen) return null;\n  const sizes = { sm: 'max-w-sm', md: 'max-w-md', lg: 'max-w-lg', xl: 'max-w-xl' };\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n      <div className=\"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm\" onClick={onClose} />\n      <div className={`relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full ${sizes[size]} max-h-[85vh] overflow-hidden animate-scaleIn`}>\n        <div className=\"flex items-center justify-between p-5 border-b border-[#334155]\">\n          <h3 className=\"text-lg font-semibold text-white\">{title}</h3>\n          <button onClick={onClose} className=\"text-zinc-500 hover:text-white transition-colors\"><X className=\"w-5 h-5\" /></button>\n        </div>\n        <div className=\"p-5 overflow-y-auto max-h-[calc(85vh-80px)]\">{children}</div>\n      </div>\n    </div>\n  );\n};\n\n// Bottom Sheet\nconst BottomSheet = ({ isOpen, onClose, title, children }) => {\n  if (!isOpen) return null;\n  return (\n    <div className=\"fixed inset-0 z-50 md:flex md:items-center md:justify-center md:p-4\">\n      <div className=\"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm\" onClick={onClose} />\n      <div className=\"absolute bottom-0 left-0 right-0 md:relative md:max-w-lg md:w-full bg-[#1e293b] border-t md:border border-[#334155] rounded-t-3xl md:rounded-2xl max-h-[90vh] overflow-hidden animate-slideUp\">\n        <div className=\"flex items-center justify-between p-5 border-b border-[#334155]\">\n          <h3 className=\"text-lg font-semibold text-white\">{title}</h3>\n          <button onClick={onClose} className=\"text-zinc-500 hover:text-white transition-colors\"><X className=\"w-5 h-5\" /></button>\n        </div>\n        <div className=\"p-5 overflow-y-auto max-h-[calc(90vh-80px)]\">{children}</div>\n      </div>\n    </div>\n  );\n};\n\n// Sidebar Nav Item\nconst NavItem = ({ icon: Icon, label, active, onClick, accent, badge, isNew }) => (\n  <button onClick={onClick} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all relative ${active ? 'bg-white/10 text-white' : 'text-zinc-400 hover:text-white hover:bg-white/5'}`}>\n    <Icon className=\"w-5 h-5\" style={active ? { color: accent } : {}} />\n    <span className=\"font-medium flex-1\">{label}</span>\n    {badge > 0 && <span className=\"px-2 py-0.5 bg-red-500 text-white text-xs rounded-full\">{badge}</span>}\n    {isNew && <span className=\"px-1.5 py-0.5 bg-emerald-500 text-white text-[10px] font-bold rounded animate-pulse\">LIVE</span>}\n  </button>\n);\n\n// Quick Actions Row\nconst QuickActions = ({ phone, whatsapp, email, clienteName }) => (\n  <div className=\"flex gap-2\">\n    {phone && <a href={`tel:${phone}`} className=\"flex-1 bg-zinc-700/50 hover:bg-zinc-700 text-white rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors\"><Phone className=\"w-4 h-4\" />Chiama</a>}\n    {(whatsapp || phone) && <a href={getWhatsAppLink(whatsapp || phone, clienteName ? `Ciao ${clienteName}, ` : '')} target=\"_blank\" rel=\"noopener noreferrer\" className=\"flex-1 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors\"><MessageCircle className=\"w-4 h-4\" />WhatsApp</a>}\n    {email && <a href={`mailto:${email}`} className=\"flex-1 bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 rounded-xl py-3 flex items-center justify-center gap-2 text-sm transition-colors\"><Mail className=\"w-4 h-4\" />Email</a>}\n  </div>\n);\n\n// Global Search Modal (CMD+K)\nconst GlobalSearch = ({ isOpen, onClose, sales, clienti, tasks, onSelectSale, onSelectCliente, onSelectTask, setActiveTab }) => {\n  const [query, setQuery] = useState('');\n  const inputRef = useRef(null);\n  \n  useEffect(() => {\n    if (isOpen && inputRef.current) {\n      inputRef.current.focus();\n    }\n    if (!isOpen) setQuery('');\n  }, [isOpen]);\n  \n  if (!isOpen) return null;\n  \n  const q = query.toLowerCase();\n  const filteredSales = q.length >= 2 ? sales.filter(s => \n    `${s.progetto} ${s.developer} ${s.zona} ${s.cliente_nome} ${s.agente}`.toLowerCase().includes(q)\n  ).slice(0, 5) : [];\n  const filteredClienti = q.length >= 2 ? clienti.filter(c => \n    `${c.nome} ${c.cognome} ${c.telefono} ${c.email}`.toLowerCase().includes(q)\n  ).slice(0, 5) : [];\n  const filteredTasks = q.length >= 2 ? tasks.filter(t => \n    `${t.titolo} ${t.descrizione}`.toLowerCase().includes(q)\n  ).slice(0, 3) : [];\n  \n  const hasResults = filteredSales.length > 0 || filteredClienti.length > 0 || filteredTasks.length > 0;\n  \n  return (\n    <div className=\"fixed inset-0 z-50 flex items-start justify-center pt-[15vh]\">\n      <div className=\"absolute inset-0 bg-zinc-800/60 backdrop-blur-sm\" onClick={onClose} />\n      <div className=\"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-xl shadow-2xl overflow-hidden animate-scaleIn\">\n        {/* Search Input */}\n        <div className=\"flex items-center gap-3 px-4 py-4 border-b border-[#334155]\">\n          <Search className=\"w-5 h-5 text-zinc-500\" />\n          <input ref={inputRef} type=\"text\" value={query} onChange={(e) => setQuery(e.target.value)} placeholder=\"Cerca lead, clienti, task...\" className=\"flex-1 bg-transparent text-white text-lg placeholder:text-zinc-600 focus:outline-none\" />\n          <kbd className=\"hidden sm:flex items-center gap-1 px-2 py-1 bg-zinc-700/50 rounded text-xs text-zinc-500\">ESC</kbd>\n        </div>\n        \n        {/* Results */}\n        <div className=\"max-h-[50vh] overflow-y-auto\">\n          {query.length < 2 ? (\n            <div className=\"p-8 text-center\">\n              <Command className=\"w-12 h-12 text-zinc-700 mx-auto mb-3\" />\n              <p className=\"text-zinc-500\">Digita almeno 2 caratteri per cercare</p>\n              <p className=\"text-zinc-600 text-sm mt-2\">Premi <kbd className=\"px-1.5 py-0.5 bg-zinc-700/50 rounded text-xs\">⌘K</kbd> ovunque per aprire</p>\n            </div>\n          ) : !hasResults ? (\n            <div className=\"p-8 text-center text-zinc-500\">Nessun risultato per \"{query}\"</div>\n          ) : (\n            <div className=\"p-2\">\n              {/* Sales Results */}\n              {filteredSales.length > 0 && (\n                <div className=\"mb-2\">\n                  <div className=\"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider\">Lead / Vendite</div>\n                  {filteredSales.map(s => (\n                    <button key={s.id} onClick={() => { onSelectSale(s); onClose(); }} className=\"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors\">\n                      <div className=\"w-2 h-8 rounded-full\" style={{ background: theme.status[s.stato || 'lead']?.color }} />\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-white text-sm font-medium truncate\">{s.progetto || 'TBD'}</p>\n                        <p className=\"text-zinc-500 text-xs truncate\">{s.developer} • {s.cliente_nome || 'No cliente'}</p>\n                      </div>\n                      <StatusBadge status={s.stato || 'lead'} />\n                    </button>\n                  ))}\n                </div>\n              )}\n              \n              {/* Clienti Results */}\n              {filteredClienti.length > 0 && (\n                <div className=\"mb-2\">\n                  <div className=\"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider\">Clienti</div>\n                  {filteredClienti.map(c => (\n                    <button key={c.id} onClick={() => { onSelectCliente(c); setActiveTab('crm'); onClose(); }} className=\"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors\">\n                      <Avatar nome={c.nome} cognome={c.cognome} size=\"sm\" />\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-white text-sm font-medium truncate\">{c.nome} {c.cognome}</p>\n                        <p className=\"text-zinc-500 text-xs truncate\">{c.telefono || c.email || 'No contatto'}</p>\n                      </div>\n                      <span className=\"text-amber-400 text-xs\">{c.stato}</span>\n                    </button>\n                  ))}\n                </div>\n              )}\n              \n              {/* Tasks Results */}\n              {filteredTasks.length > 0 && (\n                <div>\n                  <div className=\"px-3 py-2 text-xs font-medium text-zinc-500 uppercase tracking-wider\">Task</div>\n                  {filteredTasks.map(t => (\n                    <button key={t.id} onClick={() => { setActiveTab('tasks'); onClose(); }} className=\"w-full text-left px-3 py-2 rounded-lg hover:bg-white/5 flex items-center gap-3 transition-colors\">\n                      <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${t.stato === 'completato' ? 'bg-emerald-500/20' : 'bg-pink-500/20'}`}>\n                        <ListTodo className={`w-4 h-4 ${t.stato === 'completato' ? 'text-emerald-400' : 'text-pink-400'}`} />\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className={`text-white text-sm font-medium truncate ${t.stato === 'completato' ? 'line-through opacity-50' : ''}`}>{t.titolo}</p>\n                        <p className=\"text-zinc-500 text-xs truncate\">{t.assegnato_a || 'Non assegnato'}</p>\n                      </div>\n                      <StatusBadge status={t.priorita} type=\"priority\" />\n                    </button>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n        \n        {/* Footer */}\n        <div className=\"px-4 py-3 border-t border-[#334155] flex items-center justify-between text-xs text-zinc-600\">\n          <span>KeyPrime Search</span>\n          <div className=\"flex items-center gap-2\">\n            <span>Naviga con</span>\n            <kbd className=\"px-1.5 py-0.5 bg-zinc-700/50 rounded\">↑↓</kbd>\n            <span>Seleziona con</span>\n            <kbd className=\"px-1.5 py-0.5 bg-zinc-700/50 rounded\">↵</kbd>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Dashboard PDF Export\nconst generateDashboardPDF = (totals, sales, vendite, byAgente, byZona) => {\n  const today = new Date().toLocaleDateString('it-IT', { day: '2-digit', month: 'long', year: 'numeric' });\n  const topAgenti = Object.entries(byAgente).sort((a, b) => b[1] - a[1]).slice(0, 5);\n  const topZone = Object.entries(byZona).sort((a, b) => b[1] - a[1]).slice(0, 5);\n  const conversionRate = sales.length > 0 ? ((vendite.length / sales.length) * 100).toFixed(1) : 0;\n  \n  const html = `<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>KeyPrime Report - ${today}</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; padding: 40px; max-width: 900px; margin: 0 auto; color: #1a1a1a; }\n    .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 2px solid #f0f0f0; }\n    .logo { font-size: 28px; font-weight: 700; color: #1e293b; }\n    .logo span { color: #A78BFA; }\n    .date { color: #666; font-size: 14px; }\n    h1 { font-size: 24px; font-weight: 600; margin-bottom: 8px; }\n    h2 { font-size: 16px; font-weight: 600; color: #666; margin: 32px 0 16px; text-transform: uppercase; letter-spacing: 0.5px; }\n    .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 32px; }\n    .stat { background: linear-gradient(135deg, #f8f8f8 0%, #f0f0f0 100%); padding: 20px; border-radius: 12px; text-align: center; }\n    .stat-value { font-size: 28px; font-weight: 700; color: #1e293b; }\n    .stat-value.purple { color: #A78BFA; }\n    .stat-value.green { color: #34D399; }\n    .stat-value.blue { color: #60A5FA; }\n    .stat-value.amber { color: #FBBF24; }\n    .stat-label { font-size: 12px; color: #666; margin-top: 4px; text-transform: uppercase; }\n    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }\n    .card { background: #f8f8f8; border-radius: 12px; padding: 20px; }\n    .card-title { font-size: 14px; font-weight: 600; margin-bottom: 16px; color: #333; }\n    .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e5e5e5; }\n    .row:last-child { border-bottom: none; }\n    .row-label { color: #666; }\n    .row-value { font-weight: 600; }\n    .commission-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 16px; }\n    .commission-item { background: white; padding: 12px; border-radius: 8px; text-align: center; }\n    .commission-value { font-size: 18px; font-weight: 700; }\n    .commission-label { font-size: 11px; color: #666; margin-top: 2px; }\n    .footer { margin-top: 48px; padding-top: 20px; border-top: 1px solid #e5e5e5; text-align: center; color: #999; font-size: 12px; }\n    @media print { body { padding: 20px; } }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <div>\n      <div class=\"logo\">Key<span>Prime</span></div>\n      <h1>Report Dashboard</h1>\n    </div>\n    <div class=\"date\">${today}</div>\n  </div>\n  \n  <div class=\"stats\">\n    <div class=\"stat\">\n      <div class=\"stat-value purple\">${fmt(totals.valore)}</div>\n      <div class=\"stat-label\">Volume Totale AED</div>\n    </div>\n    <div class=\"stat\">\n      <div class=\"stat-value blue\">${sales.length}</div>\n      <div class=\"stat-label\">Lead Totali</div>\n    </div>\n    <div class=\"stat\">\n      <div class=\"stat-value green\">${vendite.length}</div>\n      <div class=\"stat-label\">Vendite Chiuse</div>\n    </div>\n    <div class=\"stat\">\n      <div class=\"stat-value amber\">${conversionRate}%</div>\n      <div class=\"stat-label\">Tasso Conversione</div>\n    </div>\n  </div>\n  \n  <h2>Commissioni</h2>\n  <div class=\"commission-grid\">\n    <div class=\"commission-item\">\n      <div class=\"commission-value\" style=\"color: #34D399\">${fmt(totals.comm)}</div>\n      <div class=\"commission-label\">Totali</div>\n    </div>\n    <div class=\"commission-item\">\n      <div class=\"commission-value\" style=\"color: #60A5FA\">${fmt(totals.ag)}</div>\n      <div class=\"commission-label\">Agenti 70%</div>\n    </div>\n    <div class=\"commission-item\">\n      <div class=\"commission-value\" style=\"color: #22C55E\">${fmt(totals.pell)}</div>\n      <div class=\"commission-label\">Pellegrino</div>\n    </div>\n    <div class=\"commission-item\">\n      <div class=\"commission-value\" style=\"color: #F97316\">${fmt(totals.giov)}</div>\n      <div class=\"commission-label\">Giovanni</div>\n    </div>\n  </div>\n  \n  <div class=\"grid\">\n    <div>\n      <h2>Top Agenti</h2>\n      <div class=\"card\">\n        ${topAgenti.length > 0 ? topAgenti.map(([name, value], i) => `\n          <div class=\"row\">\n            <span class=\"row-label\">${i + 1}. ${name}</span>\n            <span class=\"row-value\">${fmt(value)} AED</span>\n          </div>\n        `).join('') : '<p style=\"color: #999; text-align: center; padding: 20px;\">Nessun dato</p>'}\n      </div>\n    </div>\n    <div>\n      <h2>Top Zone</h2>\n      <div class=\"card\">\n        ${topZone.length > 0 ? topZone.map(([zone, value], i) => `\n          <div class=\"row\">\n            <span class=\"row-label\">${i + 1}. ${zone}</span>\n            <span class=\"row-value\">${fmt(value)} AED</span>\n          </div>\n        `).join('') : '<p style=\"color: #999; text-align: center; padding: 20px;\">Nessun dato</p>'}\n      </div>\n    </div>\n  </div>\n  \n  <div class=\"footer\">\n    KeyPrime Real Estate CRM • Report generato automaticamente • ${today}\n  </div>\n</body>\n</html>`;\n  \n  const w = window.open('', '_blank');\n  w.document.write(html);\n  w.document.close();\n  setTimeout(() => w.print(), 500);\n};\n\n// ==================== MAIN APP ====================\nexport default function App() {\n  const [view, setView] = useState('login');\n  const [user, setUser] = useState(null);\n  const [sales, setSales] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [clienti, setClienti] = useState([]);\n  const [tasks, setTasks] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [followUps, setFollowUps] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [toast, setToast] = useState(null);\n  const [activeTab, setActiveTab] = useState('dashboard');\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  \n  // Modals\n  const [showForm, setShowForm] = useState(null);\n  const [showLeadDetail, setShowLeadDetail] = useState(null);\n  const [showClienteDetail, setShowClienteDetail] = useState(null);\n  const [showClienteModal, setShowClienteModal] = useState(null);\n  const [showTaskModal, setShowTaskModal] = useState(null);\n  const [showUserModal, setShowUserModal] = useState(null);\n  const [showNoteModal, setShowNoteModal] = useState(null);\n  const [showPasswordModal, setShowPasswordModal] = useState(false);\n  const [showNotifications, setShowNotifications] = useState(false);\n  const [convertingSale, setConvertingSale] = useState(null);\n  \n  // Filters\n  const [filters, setFilters] = useState({ search: '', stato: '' });\n  const [clienteFilters, setClienteFilters] = useState({ search: '', stato: '' });\n  const [periodFilter, setPeriodFilter] = useState('all'); // all, 30, 60, 90\n  const [showAgentDetail, setShowAgentDetail] = useState(null);\n  \n  // Saved Listings (PropertyFinder)\n  const [savedListings, setSavedListings] = useState([]);\n  \n  // Global Search\n  const [showGlobalSearch, setShowGlobalSearch] = useState(false);\n  \n  // Keyboard shortcut for global search\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault();\n        setShowGlobalSearch(true);\n      }\n      if (e.key === 'Escape') {\n        setShowGlobalSearch(false);\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, []);\n  \n  // Notifications\n  const [readNotificationIds, setReadNotificationIds] = useState(() => {\n    const saved = localStorage.getItem('keyprime_read_notifications');\n    return saved ? JSON.parse(saved) : [];\n  });\n\n  const showToast = (message, type = 'success') => setToast({ message, type });\n\n  // Auth\n  useEffect(() => {\n    const s = localStorage.getItem('keyprime_user');\n    if (s) { \n      const u = JSON.parse(s); \n      setUser(u); \n      setActiveTab(u.ruolo === 'admin' ? 'dashboard' : 'home'); \n      // agente_admin usa la stessa view di agente\n      const viewRole = u.ruolo === 'admin' ? 'admin' : (u.ruolo === 'agente_admin' ? 'agente' : u.ruolo);\n      setView(viewRole); \n    }\n  }, []);\n  \n  // Data Loading\n  const loadSales = async () => { setLoading(true); const { data } = await supabase.from('sales_with_commissions').select('*').order('created_at', { ascending: false }); setSales(data || []); setLoading(false); };\n  const loadUsers = async () => { const { data } = await supabase.from('user_credentials').select('*').order('created_at', { ascending: false }); setUsers(data || []); };\n  const loadClienti = async () => { const { data } = await supabase.from('clienti').select('*').order('created_at', { ascending: false }); setClienti(data || []); };\n  const loadTasks = async () => { const { data } = await supabase.from('tasks').select('*').order('scadenza', { ascending: true }); setTasks(data || []); };\n  const loadActivities = async () => { const { data } = await supabase.from('lead_activities').select('*').order('created_at', { ascending: false }); setActivities(data || []); };\n  const loadFollowUps = async () => { const { data } = await supabase.from('follow_ups').select('*').order('data_reminder', { ascending: true }); setFollowUps(data || []); };\n  const loadSavedListings = async () => { \n    const { data } = await supabase.from('saved_listings').select('*')\n      .eq('user_id', user?.id)\n      .order('created_at', { ascending: false }); \n    setSavedListings(data || []); \n  };\n  \n  useEffect(() => { if (user) { loadSales(); loadClienti(); loadTasks(); loadActivities(); loadFollowUps(); loadSavedListings(); if (user.ruolo === 'admin') loadUsers(); }}, [user]);\n\n  // Global refresh function\n  const refreshAllData = async () => {\n    setLoading(true);\n    showToast('Aggiornamento...');\n    await Promise.all([\n      loadSales(),\n      loadClienti(),\n      loadTasks(),\n      loadActivities(),\n      loadFollowUps(),\n      loadSavedListings(),\n      user?.ruolo === 'admin' ? loadUsers() : Promise.resolve()\n    ]);\n    setLoading(false);\n    showToast('Dati aggiornati ✓');\n  };\n\n  // Auth Handlers\n  const handleLogin = async (username, password) => {\n    setLoading(true); setError(null);\n    const { data } = await supabase.from('user_credentials').select('*').eq('username', username).eq('password', password).eq('attivo', true).single();\n    if (!data) { setError('Credenziali non valide'); setLoading(false); return; }\n    setUser(data); localStorage.setItem('keyprime_user', JSON.stringify(data));\n    setActiveTab(data.ruolo === 'admin' ? 'dashboard' : 'home');\n    // agente_admin usa la stessa view di agente\n    const viewRole = data.ruolo === 'admin' ? 'admin' : (data.ruolo === 'agente_admin' ? 'agente' : data.ruolo);\n    setView(viewRole); setLoading(false);\n  };\n  \n  const handleLogout = () => { setUser(null); localStorage.removeItem('keyprime_user'); setView('login'); setMobileMenuOpen(false); };\n  \n  const changePassword = async (np) => {\n    await supabase.from('user_credentials').update({ password: np }).eq('id', user.id);\n    const u = { ...user, password: np }; setUser(u); localStorage.setItem('keyprime_user', JSON.stringify(u));\n    setShowPasswordModal(false); showToast('Password aggiornata');\n  };\n\n  // Saved Listings Handlers\n  const saveListing = async (listing) => {\n    const { error } = await supabase.from('saved_listings').insert([{\n      property_id: listing.project_id,\n      title: listing.title,\n      price: parseFloat(listing.price_from) || 0,\n      location_full: listing.location?.full_name,\n      location_path: listing.location?.path_name || listing.location?.name,\n      property_type: 'off-plan',\n      size: null,\n      bedrooms: listing.bedrooms?.available?.join(',') || null,\n      bathrooms: null,\n      furnished: null,\n      image_url: listing.images?.[0]?.medium_image_url,\n      pf_url: listing.url,\n      completion_status: listing.construction_phase_key,\n      agent_name: listing.developer?.name,\n      agent_email: null,\n      description: listing.title,\n      created_by: user?.nome,\n      user_id: user?.id, // Track which user saved this\n      property_data: listing\n    }]);\n    if (error) {\n      console.error('Save error:', error);\n      showToast('Errore nel salvataggio');\n    } else {\n      loadSavedListings();\n      showToast('Progetto salvato ✓');\n    }\n  };\n  \n  const removeListing = async (propertyId) => {\n    await supabase.from('saved_listings').delete().eq('property_id', propertyId);\n    loadSavedListings(); showToast('Annuncio rimosso');\n  };\n  \n  const createLeadFromListing = async (leadData) => {\n    // If creating new cliente first\n    let cliente_id = leadData.cliente_id;\n    if (leadData.newCliente && leadData.newCliente.nome) {\n      const { data: cd } = await supabase.from('clienti').insert([{\n        nome: leadData.newCliente.nome,\n        cognome: leadData.newCliente.cognome || '',\n        telefono: leadData.newCliente.telefono || '',\n        email: leadData.newCliente.email || '',\n        stato: 'nuovo',\n        fonte: 'Off-Plan',\n        agente_riferimento: user?.nome,\n        created_by: user?.nome,\n        referente: user?.referente\n      }]).select().single();\n      if (cd) {\n        cliente_id = cd.id;\n        leadData.cliente_nome = `${cd.nome} ${cd.cognome}`;\n        loadClienti();\n      }\n    }\n    \n    // Create lead\n    await supabase.from('sales').insert([{\n      data: new Date().toISOString().split('T')[0],\n      developer: leadData.developer,\n      progetto: leadData.progetto,\n      zona: leadData.zona,\n      valore: leadData.valore || 0,\n      stato: 'lead',\n      agente: user?.nome,\n      referente: user?.referente,\n      cliente_id: cliente_id,\n      inserted_by: user?.nome,\n      inserted_as: user?.ruolo\n    }]);\n    \n    // Notifica email per nuovo lead (solo se non è admin a creare)\n    if (user?.ruolo !== 'admin') {\n      await notifyNewLeadToAdmin({ progetto: leadData.progetto, zona: leadData.zona }, user?.nome);\n    }\n    \n    loadSales();\n    showToast('Lead creato da Off-Plan');\n  };\n\n  // Sales Handlers\n  const addLead = async (ld) => {\n    if (submitting) return;\n    setSubmitting(true);\n    try {\n      let cliente_id = ld.cliente_id;\n      if (!cliente_id && ld.cliente_nome) {\n        const { data: cd, error: clienteError } = await supabase.from('clienti').insert([{\n          nome: ld.cliente_nome, cognome: ld.cliente_cognome, email: ld.cliente_email, telefono: ld.cliente_telefono,\n          whatsapp: ld.cliente_whatsapp, nazionalita: ld.cliente_nazionalita, budget_min: ld.cliente_budget_min ? parseFloat(ld.cliente_budget_min) : null,\n          budget_max: ld.cliente_budget_max ? parseFloat(ld.cliente_budget_max) : null, note: ld.cliente_note,\n          stato: 'nuovo', fonte: 'Agente', agente_riferimento: user?.nome, created_by: user?.nome, referente: user?.referente\n        }]).select().single();\n        if (clienteError) { console.error('Cliente error:', clienteError); }\n        if (cd) cliente_id = cd.id;\n      }\n      const { error } = await supabase.from('sales').insert([{\n        data: ld.data, developer: ld.developer, progetto: ld.progetto, zona: ld.zona, valore: ld.valore || 0,\n        agente: ld.agente, segnalatore: ld.segnalatore, referente: user?.referente, commission_pct: 5,\n        inserted_by: user?.nome, inserted_as: user?.ruolo, pagato: false, stato: ld.stato || 'lead', cliente_id\n      }]);\n      if (error) { console.error('Insert error:', error); showToast('Errore: ' + error.message); setSubmitting(false); return; }\n      showToast('Lead aggiunto'); setShowForm(null); loadSales(); loadClienti();\n    } catch (err) { console.error('addLead error:', err); showToast('Errore salvataggio'); }\n    setSubmitting(false);\n  };\n\n  const addSale = async (sd) => {\n    if (submitting) return;\n    setSubmitting(true);\n    try {\n      let cliente_id = sd.cliente_id;\n      if (!cliente_id && sd.nuovo_cliente_nome) {\n        const { data: cd, error: clienteError } = await supabase.from('clienti').insert([{\n          nome: sd.nuovo_cliente_nome, cognome: sd.nuovo_cliente_cognome || '', telefono: sd.nuovo_cliente_telefono || '',\n          email: sd.nuovo_cliente_email || '', stato: 'acquistato', fonte: 'Vendita',\n          agente_riferimento: user?.nome, created_by: user?.nome, referente: user?.referente\n        }]).select().single();\n        if (clienteError) { console.error('Cliente error:', clienteError); }\n        if (cd) cliente_id = cd.id;\n      }\n      if (sd.cliente_id) await supabase.from('clienti').update({ stato: 'acquistato' }).eq('id', sd.cliente_id);\n      const { error } = await supabase.from('sales').insert([{\n        data: sd.data, developer: sd.developer, progetto: sd.progetto, zona: sd.zona, valore: sd.valore,\n        agente: sd.agente, segnalatore: sd.segnalatore, cliente_id,\n        referente: user?.referente, commission_pct: 5, inserted_by: user?.nome, inserted_as: user?.ruolo, pagato: false, stato: 'venduto'\n      }]);\n      if (error) { console.error('Insert error:', error); showToast('Errore: ' + error.message); setSubmitting(false); return; }\n      showToast('Vendita registrata'); setShowForm(null); loadSales(); loadClienti();\n    } catch (err) { console.error('addSale error:', err); showToast('Errore salvataggio'); }\n    setSubmitting(false);\n  };\n\n  const convertLeadToSale = async (id, v) => {\n    const sale = sales.find(s => s.id === id);\n    if (sale?.cliente_id) await supabase.from('clienti').update({ stato: 'acquistato' }).eq('id', sale.cliente_id);\n    await supabase.from('sales').update({ stato: 'venduto', valore: v }).eq('id', id);\n    setConvertingSale(null); setShowLeadDetail(null); showToast('Vendita confermata!'); loadSales(); loadClienti();\n  };\n\n  const updateSale = async (id, u) => {\n    const s = sales.find(x => x.id === id);\n    \n    // Notifica email per vendita chiusa\n    if (u.stato === 'vinto' && s?.stato !== 'vinto') {\n      await notifyNewSaleToAdmin(s, s.agente || s.segnalatore || 'N/A');\n    }\n    \n    // Notifica email per lead incassato\n    if (u.stato === 'incassato' && s?.stato !== 'incassato') {\n      await sendEmail(ADMIN_EMAIL, `💰 Incasso: ${s.progetto}`, `<div style=\"font-family:-apple-system,sans-serif;padding:20px;background:#0f172a;color:white;border-radius:12px\"><h2 style=\"color:#10b981\">💰 Incasso Registrato!</h2><p style=\"font-size:24px;margin:16px 0\"><strong>${s.progetto}</strong></p><p style=\"font-size:20px;color:#10b981\">${fmt(s.valore)} AED</p></div>`);\n    }\n    \n    if (u.pagato === true && !s?.pagato) {\n      const tn = s.agente || s.segnalatore;\n      if (tn) {\n        const { data: tu } = await supabase.from('user_credentials').select('*').eq('nome', tn).single();\n        if (tu?.email) {\n          const ca = Number(s.valore) * (s.commission_pct || 5) / 100 * (s.agente ? 0.7 : 0.3);\n          await sendEmail(tu.email, '💰 Commissione', `<div style=\"font-family:-apple-system,sans-serif;padding:20px\"><h2>Commissione Pagata!</h2><p>${s.progetto}: ${fmt(ca)} AED</p></div>`);\n        }\n      }\n    }\n    \n    console.log('Updating sale:', id, u);\n    const { error } = await supabase.from('sales').update(u).eq('id', id);\n    if (error) {\n      console.error('Update error:', error);\n      console.error('Error details:', JSON.stringify(error, null, 2));\n      showToast('Errore: ' + (error.message || error.details || 'Sconosciuto'));\n      return;\n    }\n    console.log('Update success, reloading...');\n    await loadSales();\n    showToast('Salvato');\n  };\n\n  const deleteSale = async (id) => { if (!window.confirm('Eliminare questo lead?')) return; await supabase.from('sales').delete().eq('id', id); showToast('Eliminato'); loadSales(); };\n\n  // Cliente Handlers\n  const createCliente = async (d) => { await supabase.from('clienti').insert([{ ...d, created_by: user?.nome, referente: user?.referente }]); loadClienti(); setShowClienteModal(null); showToast('Cliente creato'); };\n  const updateCliente = async (id, d) => { \n    await supabase.from('clienti').update(d).eq('id', id); \n    \n    // Se cambio l'agente assegnato, aggiorno anche tutti i lead di questo cliente\n    if (d.assegnato_a) {\n      await supabase.from('sales').update({ assegnato_a: d.assegnato_a }).eq('cliente_id', id);\n      await loadSales(); // Refresh sales per aggiornare dashboard\n    }\n    \n    await loadClienti(); \n    setShowClienteModal(null); \n    if (showClienteDetail?.id === id) setShowClienteDetail(prev => ({ ...prev, ...d })); \n    showToast('Salvato'); \n  };\n  const deleteCliente = async (id, skipConfirm = false) => { \n    if (!skipConfirm && !window.confirm('Eliminare?')) return; \n    await supabase.from('clienti').delete().eq('id', id); \n    await loadClienti(); \n    setShowClienteDetail(null); \n    showToast('Eliminato');\n  };\n\n  // Task Handlers\n  const createTask = async (d) => { \n    await supabase.from('tasks').insert([{ ...d, created_by: user?.nome }]); \n    // Notifica email per nuovo task assegnato\n    if (d.assegnato_a) {\n      const { data: agentData } = await supabase.from('user_credentials').select('email').eq('nome', d.assegnato_a).single();\n      if (agentData?.email) {\n        await notifyNewTaskToAgent(d, agentData.email);\n      }\n    }\n    loadTasks(); setShowTaskModal(null); showToast('Task creato'); \n  };\n  const updateTask = async (id, d) => { await supabase.from('tasks').update(d).eq('id', id); loadTasks(); setShowTaskModal(null); showToast('Salvato'); };\n  const completeTask = async (id) => { \n    const task = tasks.find(t => t.id === id); \n    await supabase.from('tasks').update({ stato: 'completato', completed_at: new Date().toISOString() }).eq('id', id); \n    // Notifica email per task completato (per admin)\n    if (task && user?.ruolo !== 'admin') {\n      await notifyTaskCompleted(task, user?.nome); \n    }\n    showToast('Completato!'); loadTasks(); \n  };\n  const addTaskNote = async (id, note) => { const task = tasks.find(t => t.id === id); await supabase.from('tasks').update({ note }).eq('id', id); if (task && user?.ruolo !== 'admin') await notifyTaskNote(task, user?.nome, note); loadTasks(); setShowNoteModal(null); showToast('Nota inviata'); };\n  const deleteTask = async (id) => { if (!window.confirm('Eliminare?')) return; await supabase.from('tasks').delete().eq('id', id); loadTasks(); };\n\n  // Activity Handlers (Lead Notes/Activities)\n  const addActivity = async (saleId, tipo, contenuto) => {\n    await supabase.from('lead_activities').insert([{ \n      sale_id: saleId, \n      tipo, \n      contenuto, \n      created_by: user?.nome \n    }]);\n    loadActivities();\n    showToast('Attività registrata');\n  };\n  const deleteActivity = async (id) => { \n    await supabase.from('lead_activities').delete().eq('id', id); \n    loadActivities(); \n  };\n\n  // Follow-up Handlers\n  const createFollowUp = async (data) => {\n    await supabase.from('follow_ups').insert([{ \n      ...data, \n      assegnato_a: data.assegnato_a || user?.nome \n    }]);\n    loadFollowUps();\n    showToast('Follow-up programmato');\n  };\n  const completeFollowUp = async (id) => {\n    await supabase.from('follow_ups').update({ completato: true }).eq('id', id);\n    loadFollowUps();\n    showToast('Follow-up completato');\n  };\n  const deleteFollowUp = async (id) => { \n    await supabase.from('follow_ups').delete().eq('id', id); \n    loadFollowUps(); \n  };\n\n  // User Handlers\n  const createUser = async (d) => { await supabase.from('user_credentials').insert([d]); loadUsers(); setShowUserModal(null); showToast('Utente creato'); };\n  const updateUser = async (id, d) => { await supabase.from('user_credentials').update(d).eq('id', id); loadUsers(); setShowUserModal(null); showToast('Salvato'); };\n  const deleteUser = async (id) => { if (!window.confirm('Eliminare?')) return; await supabase.from('user_credentials').delete().eq('id', id); loadUsers(); };\n\n  // Computed Data\n  const filteredSales = sales.filter(s => {\n    if (filters.search && !`${s.progetto} ${s.developer} ${s.agente} ${s.cliente_nome}`.toLowerCase().includes(filters.search.toLowerCase())) return false;\n    if (filters.stato && s.stato !== filters.stato) return false;\n    return true;\n  });\n  \n  const filteredClienti = clienti.filter(c => {\n    if (clienteFilters.search && !`${c.nome} ${c.cognome} ${c.email} ${c.telefono}`.toLowerCase().includes(clienteFilters.search.toLowerCase())) return false;\n    if (clienteFilters.stato && c.stato !== clienteFilters.stato) return false;\n    return true;\n  });\n\n  const myPendingTasks = tasks.filter(t => t.stato === 'pending' && (user?.ruolo === 'admin' || t.assegnato_a === user?.nome));\n  const overdueTasks = myPendingTasks.filter(t => isOverdue(t.scadenza));\n  const todayTasks = myPendingTasks.filter(t => isToday(t.scadenza));\n  \n  // Follow-up reminders\n  const myFollowUps = followUps.filter(f => !f.completato && (user?.ruolo === 'admin' || f.assegnato_a === user?.nome));\n  const todayFollowUps = myFollowUps.filter(f => isToday(f.data_reminder));\n  const overdueFollowUps = myFollowUps.filter(f => isOverdue(f.data_reminder));\n  \n  // For agents: show all their assigned tasks as notifications (not just overdue/today)\n  // For admin: show overdue/today tasks + recent sales\n  const notificationTasks = user?.ruolo === 'admin' \n    ? myPendingTasks.filter(t => isOverdue(t.scadenza) || isToday(t.scadenza))\n    : myPendingTasks; // Agents see ALL their pending tasks\n  \n  // Recent sales notifications (last 24 hours for admin)\n  const recentSalesNotifications = user?.ruolo === 'admin' ? sales.filter(s => {\n    const created = new Date(s.created_at);\n    const now = new Date();\n    const hoursDiff = (now - created) / (1000 * 60 * 60);\n    return hoursDiff <= 24 && !readNotificationIds.includes('sale_' + s.id);\n  }) : [];\n  \n  // Unread = not in readNotificationIds AND (for agents: created_by !== user, for admin: all)\n  const unreadNotificationIds = [\n    ...notificationTasks.filter(t => {\n      const isRead = readNotificationIds.includes(`task_${t.id}_${user?.id}`);\n      // For agents: only unread if someone else created it OR it's overdue\n      if (user?.ruolo !== 'admin') {\n        return !isRead && (t.created_by !== user?.nome || isOverdue(t.scadenza));\n      }\n      return !isRead;\n    }).map(t => `task_${t.id}_${user?.id}`),\n    ...recentSalesNotifications.map(s => 'sale_' + s.id)\n  ];\n  const notificationCount = unreadNotificationIds.length;\n\n  const markNotificationsAsRead = () => {\n    const taskIds = notificationTasks.map(t => `task_${t.id}_${user?.id}`);\n    const saleIds = recentSalesNotifications.map(s => 'sale_' + s.id);\n    const allIds = [...new Set([...readNotificationIds, ...taskIds, ...saleIds])];\n    setReadNotificationIds(allIds);\n    localStorage.setItem('keyprime_read_notifications', JSON.stringify(allIds));\n  };\n\n  const markSingleNotificationAsRead = (notifId) => {\n    const allIds = [...new Set([...readNotificationIds, notifId])];\n    setReadNotificationIds(allIds);\n    localStorage.setItem('keyprime_read_notifications', JSON.stringify(allIds));\n  };\n\n  // ==================== LOGIN VIEW ====================\n  if (view === 'login') {\n    return (\n      <div className=\"min-h-screen bg-[#0f172a] flex items-center justify-center p-6\">\n        <div className=\"w-full max-w-sm\">\n          <div className=\"text-center mb-10\">\n            <img src=\"/logo.png\" alt=\"KeyPrime\" className=\"h-20 mx-auto mb-4\" />\n            <p className=\"text-zinc-500 text-sm\">Real Estate CRM</p>\n          </div>\n          \n          {error && <div className=\"bg-red-500/10 border border-red-500/20 text-red-400 rounded-xl px-4 py-3 mb-6 text-sm\">{error}</div>}\n          \n          <LoginForm onLogin={handleLogin} loading={loading} />\n        </div>\n      </div>\n    );\n  }\n\n  // ==================== AGENT/SEGNALATORE VIEW ====================\n  if (view === 'agente' || view === 'segnalatore') {\n    // Per agente_admin, usa la view agente ma con ruolo originale per calcoli\n    const type = user?.ruolo === 'agente_admin' ? 'agente' : view;\n    const isAgenteAdmin = user?.ruolo === 'agente_admin';\n    const mySales = sales.filter(s => type === 'agente' ? s.agente === user?.nome : s.segnalatore === user?.nome);\n    const myTasks = tasks.filter(t => t.assegnato_a === user?.nome && t.stato === 'pending');\n    const myClienti = clienti.filter(c => c.created_by === user?.nome || c.agente_riferimento === user?.nome);\n    // agente_admin prende 70% come agente normale, il 30% va a Pellegrino\n    const rate = (type === 'agente' || isAgenteAdmin) ? 0.7 : 0.3;\n    const myVendite = mySales.filter(s => s.stato === 'venduto' || s.stato === 'incassato');\n    const totalComm = myVendite.reduce((sum, s) => sum + (Number(s.valore) * (s.commission_pct || 5) / 100 * rate), 0);\n    const pagate = myVendite.filter(s => s.pagato).reduce((sum, s) => sum + (Number(s.valore) * (s.commission_pct || 5) / 100 * rate), 0);\n    const byStato = pipelineStati.reduce((acc, st) => { acc[st] = mySales.filter(s => (s.stato || 'lead') === st); return acc; }, {});\n\n    const tabs = [\n      { id: 'home', icon: LayoutDashboard, label: 'Home', accent: theme.sections.dashboard.accent },\n      { id: 'leads', icon: Target, label: 'Lead', accent: theme.sections.pipeline.accent },\n      { id: 'pipeline', icon: PieChart, label: 'Pipeline', accent: theme.sections.vendite.accent },\n      { id: 'offplan', icon: Building2, label: 'Off-Plan', accent: theme.sections.offplan.accent, isNew: true },\n      { id: 'calculator', icon: Calculator, label: 'Calcolatore ROI', accent: theme.sections.calculator.accent, isNew: true },\n      { id: 'tasks', icon: ListTodo, label: 'Task', accent: theme.sections.tasks.accent, badge: myTasks.length },\n      { id: 'settings', icon: Settings, label: 'Account', accent: theme.sections.utenti.accent }\n    ];\n\n    // Form View (same for mobile/desktop)\n    if (showForm) {\n      return (\n        <div className=\"min-h-screen bg-[#0f172a]\">\n          <div className=\"sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155] px-4 py-4\">\n            <div className=\"flex items-center justify-between max-w-lg mx-auto\">\n              <button onClick={() => setShowForm(null)} className=\"text-zinc-400 hover:text-white flex items-center gap-2 transition-colors\">\n                <ChevronLeft className=\"w-5 h-5\" />Indietro\n              </button>\n              <span className=\"text-white font-semibold\">{showForm === 'lead' ? 'Nuovo Lead' : 'Nuova Vendita'}</span>\n              <div className=\"w-20\" />\n            </div>\n          </div>\n          <div className=\"p-4 pb-32 max-w-lg mx-auto\">\n            {showForm === 'lead' && <LeadForm type={type} userName={user?.nome} clienti={myClienti} onSubmit={addLead} />}\n            {showForm === 'vendita' && <SaleForm type={type} userName={user?.nome} clienti={myClienti} onSubmit={addSale} />}\n          </div>\n          <div className=\"fixed bottom-0 left-0 right-0 p-4 bg-[#0f172a]/95 backdrop-blur-xl border-t border-[#334155]\">\n            <Button onClick={() => document.getElementById('submitBtn')?.click()} className=\"w-full py-4\" disabled={submitting}>\n              {submitting ? (\n                <span className=\"flex items-center justify-center gap-2\">\n                  <RefreshCw className=\"w-4 h-4 animate-spin\" /> Salvataggio...\n                </span>\n              ) : (\n                showForm === 'lead' ? 'Salva Lead' : 'Registra Vendita'\n              )}\n            </Button>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"min-h-screen bg-[#0f172a] lg:flex\">\n        {/* Desktop Sidebar */}\n        <aside className=\"hidden lg:flex flex-col w-64 border-r border-[#334155] bg-[#1e293b] p-4 fixed h-full\">\n          <div className=\"mb-8\">\n            <img src=\"/logo.png\" alt=\"KeyPrime\" className=\"h-16\" />\n          </div>\n          <nav className=\"space-y-1 flex-1\">\n            {tabs.map(t => (\n              <NavItem key={t.id} icon={t.icon} label={t.label} active={activeTab === t.id} onClick={() => setActiveTab(t.id)} accent={t.accent} badge={t.badge} isNew={t.isNew} />\n            ))}\n          </nav>\n          <div className=\"pt-4 border-t border-[#334155]\">\n            <div className=\"flex items-center gap-3 px-2 py-2\">\n              <Avatar nome={user?.nome} size=\"sm\" />\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-white text-sm font-medium truncate\">{user?.nome}</p>\n                <p className=\"text-zinc-500 text-xs capitalize\">{type}</p>\n              </div>\n              <button onClick={handleLogout} className=\"text-zinc-500 hover:text-white\"><LogOut className=\"w-4 h-4\" /></button>\n            </div>\n          </div>\n        </aside>\n\n        {/* Main Content */}\n        <div className=\"flex-1 lg:ml-64 pb-24 lg:pb-0\">\n          {/* Mobile Header */}\n          <div className=\"lg:hidden sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]\">\n            <div className=\"flex items-center justify-between px-4 py-4\">\n              <img src=\"/logo.png\" alt=\"KeyPrime\" className=\"h-12\" />\n              <div className=\"flex items-center gap-3\">\n                <button onClick={refreshAllData} className=\"p-2 text-zinc-400 hover:text-white\" title=\"Aggiorna\">\n                  <RefreshCw className={`w-5 h-5 ${loading ? 'animate-spin' : ''}`} />\n                </button>\n                <button onClick={() => setShowNotifications(true)} className=\"relative p-2 text-zinc-400 hover:text-white\">\n                  <Bell className=\"w-5 h-5\" />\n                  {notificationCount > 0 && <span className=\"absolute -top-0.5 -right-0.5 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\">{notificationCount}</span>}\n                </button>\n                <Avatar nome={user?.nome} size=\"sm\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Desktop Header */}\n          <div className=\"hidden lg:block sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]\">\n            <div className=\"flex items-center justify-between px-6 py-4\">\n              <div>\n                <h1 className=\"text-xl font-semibold text-white capitalize\">{activeTab === 'home' ? `Ciao, ${user?.nome}` : tabs.find(t => t.id === activeTab)?.label}</h1>\n                <p className=\"text-zinc-500 text-sm\">\n                  {activeTab === 'home' && 'Il tuo riepilogo'}\n                  {activeTab === 'leads' && `${mySales.length} lead totali`}\n                  {activeTab === 'pipeline' && 'Stato dei tuoi lead'}\n                  {activeTab === 'offplan' && 'Progetti Off-Plan'}\n                  {activeTab === 'calculator' && 'Calcola rendimenti immobiliari UAE'}\n                  {activeTab === 'tasks' && `${myTasks.length} task pendenti`}\n                </p>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <button onClick={() => setShowNotifications(true)} className=\"relative p-2 text-zinc-400 hover:text-white bg-[#334155] rounded-xl\">\n                  <Bell className=\"w-5 h-5\" />\n                  {notificationCount > 0 && <span className=\"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\">{notificationCount}</span>}\n                </button>\n                <button onClick={refreshAllData} className=\"p-2 text-zinc-400 hover:text-white bg-[#334155] rounded-xl\" title=\"Aggiorna\">\n                  <RefreshCw className=\"w-5 h-5\" />\n                </button>\n                <Button onClick={() => setShowForm('lead')} icon={Plus}>Nuovo Lead</Button>\n                <Button onClick={() => setShowForm('vendita')} variant=\"secondary\" icon={DollarSign}>Vendita</Button>\n              </div>\n            </div>\n          </div>\n\n          {/* Content */}\n          <div className=\"p-4 lg:p-6 space-y-6\">\n            {/* HOME TAB */}\n            {activeTab === 'home' && (\n              <>\n                <div className=\"lg:hidden grid grid-cols-2 gap-3\">\n                  <button onClick={() => setShowForm('lead')} className=\"bg-gradient-to-br from-blue-500/20 to-blue-600/10 border border-blue-500/20 rounded-2xl p-5 text-left\">\n                    <Target className=\"w-6 h-6 text-blue-400 mb-3\" />\n                    <span className=\"text-white font-medium block\">Nuovo Lead</span>\n                  </button>\n                  <button onClick={() => setShowForm('vendita')} className=\"bg-gradient-to-br from-emerald-500/20 to-emerald-600/10 border border-emerald-500/20 rounded-2xl p-5 text-left\">\n                    <DollarSign className=\"w-6 h-6 text-emerald-400 mb-3\" />\n                    <span className=\"text-white font-medium block\">Vendita</span>\n                  </button>\n                </div>\n\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3\">\n                  <MetricCard label=\"Lead Attivi\" value={mySales.filter(s => s.stato !== 'venduto' && s.stato !== 'incassato').length} icon={Target} color=\"#60A5FA\" onClick={() => setActiveTab('leads')} />\n                  <MetricCard label=\"Vendite (SPA)\" value={myVendite.length} icon={TrendingUp} color=\"#34D399\" />\n                  <MetricCard label=\"Comm. Maturate\" value={fmt(totalComm)} icon={DollarSign} color=\"#FBBF24\" />\n                  <MetricCard label=\"Comm. Pagate\" value={fmt(pagate)} icon={Check} color=\"#34D399\" />\n                </div>\n\n                {/* Pipeline */}\n                <Card>\n                  <h3 className=\"text-white font-medium mb-4\">Pipeline</h3>\n                  <div className=\"grid grid-cols-5 gap-2\">\n                    {pipelineStati.map(st => (\n                      <div key={st} className=\"text-center\">\n                        <div className=\"rounded-xl py-3 px-2\" style={{ background: theme.status[st]?.bg || '#334155' }}>\n                          <p className=\"text-2xl font-bold\" style={{ color: theme.status[st]?.color || '#fff' }}>{byStato[st]?.length || 0}</p>\n                        </div>\n                        <p className=\"text-xs text-zinc-500 mt-2\">{pipelineLabels[st] || st}</p>\n                      </div>\n                    ))}\n                  </div>\n                </Card>\n\n                <Card>\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <span className=\"text-white font-medium\">Commissioni</span>\n                    <span className=\"text-zinc-400 text-sm\">{fmt(totalComm)} AED maturate</span>\n                  </div>\n                  <ProgressBar value={pagate} max={totalComm || 1} color=\"#34D399\" />\n                  <div className=\"flex justify-between mt-3 text-sm\">\n                    <span className=\"text-emerald-400\">✓ Pagate: {fmt(pagate)} AED</span>\n                    <span className=\"text-amber-400\">⏳ Pending: {fmt(totalComm - pagate)} AED</span>\n                  </div>\n                </Card>\n\n                {myTasks.length > 0 && (\n                  <Card hover onClick={() => setActiveTab('tasks')} className=\"border-pink-500/20 bg-pink-500/5\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-12 h-12 rounded-xl bg-pink-500/20 flex items-center justify-center\">\n                        <ListTodo className=\"w-6 h-6 text-pink-400\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-white font-medium\">{myTasks.length} task da completare</p>\n                      </div>\n                      <ChevronRight className=\"w-5 h-5 text-zinc-500\" />\n                    </div>\n                  </Card>\n                )}\n\n                <div>\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h2 className=\"text-lg font-semibold text-white\">Lead Aperti</h2>\n                    <button onClick={() => setActiveTab('leads')} className=\"text-sm text-violet-400\">Tutti →</button>\n                  </div>\n                  {mySales.filter(s => s.stato === 'lead' || s.stato === 'trattativa' || s.stato === 'EOI').length === 0 ? (\n                    <Card padding=\"p-6\" className=\"text-center\">\n                      <p className=\"text-zinc-500\">Nessun lead aperto</p>\n                    </Card>\n                  ) : (\n                    <div className=\"grid gap-3 lg:grid-cols-2\">\n                      {mySales.filter(s => s.stato === 'lead' || s.stato === 'trattativa' || s.stato === 'EOI').slice(0, 4).map(s => (\n                        <Card key={s.id} hover onClick={() => setShowLeadDetail(s)} padding=\"p-4\">\n                          <div className=\"flex items-center gap-4\">\n                            <div className=\"w-1 h-12 rounded-full\" style={{ background: theme.status[s.stato || 'lead']?.color }} />\n                            <div className=\"flex-1 min-w-0\">\n                              <p className=\"text-white font-medium truncate\">{s.progetto}</p>\n                              <p className=\"text-zinc-500 text-sm\">{s.developer}</p>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className=\"text-emerald-400 font-medium\">{s.valore > 0 ? fmt(s.valore) : 'TBD'}</p>\n                              <StatusBadge status={s.stato || 'lead'} />\n                            </div>\n                          </div>\n                        </Card>\n                      ))}\n                    </div>\n                  )}\n                </div>\n\n                {/* Vendite Confermate Recenti */}\n                {myVendite.length > 0 && (\n                  <div className=\"mt-6\">\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <h2 className=\"text-lg font-semibold text-white\">🎉 Vendite Confermate</h2>\n                    </div>\n                    <div className=\"grid gap-3 lg:grid-cols-2\">\n                      {myVendite.slice(0, 4).map(s => (\n                        <Card key={s.id} hover onClick={() => setShowLeadDetail(s)} padding=\"p-4\" className=\"border-emerald-500/20\">\n                          <div className=\"flex items-center gap-4\">\n                            <div className=\"w-1 h-12 rounded-full bg-emerald-500\" />\n                            <div className=\"flex-1 min-w-0\">\n                              <p className=\"text-white font-medium truncate\">{s.progetto}</p>\n                              <p className=\"text-zinc-500 text-sm\">{s.developer}</p>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className=\"text-emerald-400 font-medium\">{fmt(s.valore)}</p>\n                              <StatusBadge status={s.stato} />\n                            </div>\n                          </div>\n                        </Card>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n\n            {/* LEADS TAB */}\n            {activeTab === 'leads' && (\n              <LeadsTableView \n                leads={mySales} \n                clienti={clienti} \n                onSelectLead={setShowLeadDetail}\n                onUpdateStatus={(id, stato) => updateSale(id, { stato })}\n                onDelete={deleteSale}\n                theme={theme}\n                users={[]}\n                isAdmin={false}\n              />\n            )}\n\n            {activeTab === 'pipeline' && (\n              <div className=\"space-y-6\">\n                {/* Pipeline Overview */}\n                <div className=\"grid grid-cols-5 gap-3\">\n                  {pipelineStati.map(st => (\n                    <Card key={st} padding=\"p-4\" className=\"text-center\">\n                      <p className=\"text-3xl font-bold\" style={{ color: theme.status[st]?.color }}>{byStato[st]?.length || 0}</p>\n                      <p className=\"text-xs text-zinc-500 mt-1\">{pipelineLabels[st] || st}</p>\n                    </Card>\n                  ))}\n                </div>\n                \n                {/* Kanban style */}\n                <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4\">\n                  {pipelineStati.map(st => (\n                    <div key={st}>\n                      <div className=\"flex items-center gap-2 mb-3\">\n                        <div className=\"w-3 h-3 rounded-full\" style={{ background: theme.status[st]?.color }} />\n                        <span className=\"text-white font-medium text-sm\">{pipelineLabels[st] || st}</span>\n                        <span className=\"text-zinc-500 text-xs\">({byStato[st]?.length || 0})</span>\n                      </div>\n                      <div className=\"space-y-2\">\n                        {(byStato[st] || []).map(s => (\n                          <Card key={s.id} hover onClick={() => setShowLeadDetail(s)} padding=\"p-3\" className=\"border-l-2\" style={{ borderLeftColor: theme.status[st]?.color }}>\n                            <p className=\"text-white text-sm font-medium truncate\">{s.progetto}</p>\n                            <p className=\"text-zinc-500 text-xs\">{s.developer}</p>\n                            {s.valore > 0 && <p className=\"text-emerald-400 text-sm mt-1\">{fmt(s.valore)}</p>}\n                          </Card>\n                        ))}\n                        {(!byStato[st] || byStato[st].length === 0) && (\n                          <div className=\"text-center py-4 text-zinc-600 text-xs\">Nessun lead</div>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'tasks' && <AgentTasksTab tasks={myTasks} allTasks={tasks.filter(t => t.assegnato_a === user?.nome)} clienti={clienti} onComplete={completeTask} onAddNote={(t) => setShowNoteModal(t)} />}\n            {activeTab === 'offplan' && <OffPlanTab clienti={myClienti} onCreateLead={createLeadFromListing} savedListings={savedListings} onSaveListing={saveListing} onRemoveListing={removeListing} user={user} />}\n            {activeTab === 'calculator' && <ROICalculator />}\n            \n            {activeTab === 'settings' && (\n              <Card className=\"max-w-lg\">\n                <div className=\"flex items-center gap-4 mb-6\">\n                  <Avatar nome={user?.nome} size=\"lg\" />\n                  <div>\n                    <p className=\"text-xl font-semibold text-white\">{user?.nome}</p>\n                    <p className=\"text-zinc-500\">{type}</p>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Button variant=\"secondary\" icon={Key} onClick={() => setShowPasswordModal(true)} className=\"w-full justify-start\">Cambia Password</Button>\n                  <Button variant=\"danger\" icon={LogOut} onClick={handleLogout} className=\"w-full justify-start\">Esci</Button>\n                </div>\n              </Card>\n            )}\n          </div>\n\n          {/* Mobile Bottom Nav */}\n          <div className=\"lg:hidden fixed bottom-0 left-0 right-0 bg-[#0f172a]/95 backdrop-blur-xl border-t border-[#334155] px-4 py-2 z-30\">\n            <div className=\"flex justify-around\">\n              {tabs.map(t => (\n                <button key={t.id} onClick={() => setActiveTab(t.id)} className={`flex flex-col items-center py-2 px-3 ${activeTab === t.id ? 'text-white' : 'text-zinc-500'}`}>\n                  <t.icon className=\"w-6 h-6\" style={activeTab === t.id ? { color: t.accent } : {}} />\n                  <span className=\"text-xs mt-1\">{t.label}</span>\n                </button>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        {showLeadDetail && <LeadDetailSheet sale={showLeadDetail} cliente={clienti.find(c => c.id === showLeadDetail?.cliente_id)} rate={rate} onClose={() => setShowLeadDetail(null)} onUpdateSale={updateSale} onConvert={() => setConvertingSale(showLeadDetail)} activities={activities.filter(a => a.sale_id === showLeadDetail?.id)} followUps={followUps.filter(f => f.sale_id === showLeadDetail?.id)} onAddActivity={addActivity} onCreateFollowUp={createFollowUp} onCompleteFollowUp={completeFollowUp} onDeleteActivity={deleteActivity} onDeleteFollowUp={deleteFollowUp} userName={user?.nome} />}\n        {convertingSale && <ConvertModal sale={convertingSale} onConvert={convertLeadToSale} onCancel={() => setConvertingSale(null)} />}\n        {showNotifications && <NotificationsPanel tasks={notificationTasks} unreadIds={unreadNotificationIds} recentSales={recentSalesNotifications} onClose={() => { setShowNotifications(false); }} onGoToTask={() => { setShowNotifications(false); setActiveTab('tasks'); }} onMarkAsRead={markSingleNotificationAsRead} userId={user?.id} />}\n        {showPasswordModal && <PasswordModal currentPassword={user?.password} onSave={changePassword} onClose={() => setShowPasswordModal(false)} />}\n        {showNoteModal && <NoteModal task={showNoteModal} onSave={addTaskNote} onClose={() => setShowNoteModal(null)} />}\n        {toast && <Toast message={toast.message} type={toast.type} onClose={() => setToast(null)} />}\n      </div>\n    );\n  }\n\n  // ==================== ADMIN VIEW ====================\n  if (view === 'admin') {\n    // Period filter logic\n    const getFilteredByPeriod = (salesData) => {\n      if (periodFilter === 'all') return salesData;\n      const days = parseInt(periodFilter);\n      const cutoff = new Date();\n      cutoff.setDate(cutoff.getDate() - days);\n      return salesData.filter(s => s.data && new Date(s.data) >= cutoff);\n    };\n    \n    const periodSales = getFilteredByPeriod(sales);\n    const vendite = periodSales.filter(s => s.stato === 'venduto' || s.stato === 'incassato');\n    const totals = periodSales.reduce((a, s) => {\n      const c = Number(s.valore) * (s.commission_pct || 5) / 100;\n      // Check if agent is agente_admin\n      const agentUser = users.find(u => u.nome === s.agente && (u.ruolo === 'agente' || u.ruolo === 'agente_admin'));\n      const isAgenteAdmin = agentUser?.ruolo === 'agente_admin';\n      \n      let ag, sg, p, g;\n      \n      if (isAgenteAdmin) {\n        if (s.referente === 'Giovanni') {\n          // REF = G → Giovanni 70%, Pellegrino 30%\n          ag = c * 0.7;\n          sg = 0;\n          g = 0; // Giovanni già prende come agente\n          p = c * 0.3;\n        } else {\n          // REF = P → Giovanni diventa segnalatore (30%), Pellegrino 70%\n          ag = c * 0.3; // Giovanni prende solo 30%\n          sg = 0;\n          g = 0;\n          p = c * 0.7; // Pellegrino prende 70%\n        }\n      } else {\n        // Agenti normali - logica originale\n        ag = s.agente ? c * 0.7 : 0;\n        sg = s.segnalatore ? c * 0.3 : 0;\n        const n = c - ag - sg;\n        p = s.referente === 'Pellegrino' ? n * 0.7 : (s.referente === 'Giovanni' ? n * 0.3 : 0);\n        g = s.referente === 'Giovanni' ? n * 0.7 : (s.referente === 'Pellegrino' ? n * 0.3 : 0);\n      }\n      \n      const n = isAgenteAdmin ? 0 : (c - ag - (s.segnalatore ? c * 0.3 : 0));\n      \n      return { valore: a.valore + Number(s.valore), comm: a.comm + c, ag: a.ag + ag, sg: a.sg + (s.segnalatore && !isAgenteAdmin ? c * 0.3 : 0), netto: a.netto + n, pell: a.pell + p, giov: a.giov + g };\n    }, { valore: 0, comm: 0, ag: 0, sg: 0, netto: 0, pell: 0, giov: 0 });\n    \n    const byStato = pipelineStati.reduce((a, st) => { a[st] = periodSales.filter(s => (s.stato || 'lead') === st); return a; }, {});\n    const byMonth = periodSales.reduce((a, s) => { const m = s.data?.substring(0, 7) || 'N/A'; a[m] = (a[m] || 0) + Number(s.valore); return a; }, {});\n    const byAgente = periodSales.reduce((a, s) => { if (s.agente) a[s.agente] = (a[s.agente] || 0) + Number(s.valore); return a; }, {});\n    const byZona = periodSales.reduce((a, s) => { if (s.zona) a[s.zona] = (a[s.zona] || 0) + Number(s.valore); return a; }, {});\n    const pendingTasks = tasks.filter(t => t.stato === 'pending');\n\n    const tabs = [\n      { id: 'dashboard', icon: LayoutDashboard, label: 'Dashboard', accent: theme.sections.dashboard.accent },\n      { id: 'commissioni', icon: Award, label: 'Commissioni', accent: '#10B981' },\n      { id: 'vendite', icon: DollarSign, label: 'Vendite', accent: theme.sections.vendite.accent },\n      { id: 'pipeline', icon: PieChart, label: 'Pipeline', accent: theme.sections.pipeline.accent },\n      { id: 'crm', icon: Users, label: 'CRM', accent: theme.sections.crm.accent },\n      { id: 'offplan', icon: Building2, label: 'Off-Plan', accent: theme.sections.offplan.accent, isNew: true },\n      { id: 'calculator', icon: Calculator, label: 'Calcolatore ROI', accent: theme.sections.calculator.accent, isNew: true },\n      { id: 'tasks', icon: ListTodo, label: 'Task', accent: theme.sections.tasks.accent, badge: pendingTasks.length },\n      { id: 'followups', icon: Clock, label: 'Follow-up', accent: '#A855F7', badge: todayFollowUps.length + overdueFollowUps.length },\n      { id: 'utenti', icon: Settings, label: 'Team', accent: theme.sections.utenti.accent }\n    ];\n\n    return (\n      <div className=\"min-h-screen bg-[#0f172a] flex\">\n        {/* Sidebar - Desktop */}\n        <aside className=\"hidden lg:flex flex-col w-64 border-r border-[#334155] bg-[#1e293b] p-4\">\n          <div className=\"mb-8\">\n            <img src=\"/logo.png\" alt=\"KeyPrime\" className=\"h-20\" />\n          </div>\n          \n          <nav className=\"space-y-1 flex-1\">\n            {tabs.map(t => (\n              <NavItem key={t.id} icon={t.icon} label={t.label} active={activeTab === t.id} onClick={() => { setActiveTab(t.id); setShowClienteDetail(null); }} accent={t.accent} badge={t.badge} isNew={t.isNew} />\n            ))}\n          </nav>\n          \n          <div className=\"border-t border-[#334155] pt-4 mt-4\">\n            <div className=\"flex items-center gap-3 px-4 py-3\">\n              <Avatar nome={user?.nome} size=\"sm\" />\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium text-white truncate\">{user?.nome}</p>\n                <p className=\"text-xs text-zinc-500\">Admin</p>\n              </div>\n              <button onClick={handleLogout} className=\"text-zinc-500 hover:text-white transition-colors\"><LogOut className=\"w-4 h-4\" /></button>\n            </div>\n          </div>\n        </aside>\n\n        {/* Main Content */}\n        <main className=\"flex-1 overflow-auto\">\n          {/* Mobile Header */}\n          <div className=\"lg:hidden sticky top-0 z-40 bg-[#0f172a]/95 backdrop-blur-xl border-b border-[#334155]\">\n            <div className=\"flex items-center justify-between px-4 py-4\">\n              <button onClick={() => setMobileMenuOpen(true)} className=\"text-zinc-400\"><Menu className=\"w-6 h-6\" /></button>\n              <img src=\"/logo.png\" alt=\"KeyPrime\" className=\"h-16\" />\n              <div className=\"flex items-center gap-2\">\n                <button onClick={refreshAllData} className=\"text-zinc-400 hover:text-white\" title=\"Aggiorna\">\n                  <RefreshCw className={`w-5 h-5 ${loading ? 'animate-spin' : ''}`} />\n                </button>\n                <button onClick={() => setShowNotifications(true)} className=\"relative text-zinc-400\">\n                  <Bell className=\"w-5 h-5\" />\n                  {notificationCount > 0 && <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center\">{notificationCount}</span>}\n                </button>\n              </div>\n            </div>\n            {/* Mobile Tabs */}\n            <div className=\"flex gap-1 px-4 pb-3 overflow-x-auto\">\n              {tabs.map(t => (\n                <button key={t.id} onClick={() => { setActiveTab(t.id); setShowClienteDetail(null); }} className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all ${activeTab === t.id ? 'text-white' : 'text-zinc-500 hover:text-white'}`} style={activeTab === t.id ? { background: `${t.accent}20`, color: t.accent } : {}}>\n                  <t.icon className=\"w-4 h-4\" />\n                  {t.label}\n                  {t.badge > 0 && <span className=\"px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full\">{t.badge}</span>}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Content Area */}\n          <div className=\"p-6 max-w-7xl mx-auto\">\n            {/* Desktop Header */}\n            <div className=\"hidden lg:flex items-center justify-between mb-8\">\n              <div>\n                <h1 className=\"text-2xl font-semibold text-white capitalize\">{activeTab}</h1>\n                <p className=\"text-zinc-500 text-sm mt-1\">\n                  {activeTab === 'dashboard' && 'Panoramica generale'}\n                  {activeTab === 'vendite' && `${sales.length} transazioni totali`}\n                  {activeTab === 'pipeline' && 'Gestisci il flusso di vendita'}\n                  {activeTab === 'crm' && `${clienti.length} clienti in database`}\n                  {activeTab === 'offplan' && `Progetti Off-Plan • ${savedListings.length} salvati`}\n                  {activeTab === 'calculator' && 'Calcola rendimenti immobiliari UAE'}\n                  {activeTab === 'tasks' && `${pendingTasks.length} task da completare`}\n                  {activeTab === 'followups' && `${todayFollowUps.length + overdueFollowUps.length} follow-up da gestire`}\n                  {activeTab === 'commissioni' && `${fmt(totals.comm)} AED commissioni totali`}\n                  {activeTab === 'utenti' && `${users.length} membri del team`}\n                </p>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <button onClick={() => setShowGlobalSearch(true)} className=\"hidden lg:flex items-center gap-2 px-4 py-2 bg-zinc-700/50 hover:bg-zinc-700 rounded-xl text-zinc-400 text-sm transition-colors\">\n                  <Search className=\"w-4 h-4\" />\n                  <span>Cerca...</span>\n                  <kbd className=\"ml-2 px-1.5 py-0.5 bg-zinc-700 rounded text-xs\">⌘K</kbd>\n                </button>\n                <button onClick={() => setShowNotifications(true)} className=\"relative p-2 text-zinc-400 hover:text-white transition-colors\">\n                  <Bell className=\"w-5 h-5\" />\n                  {notificationCount > 0 && <span className=\"absolute -top-0.5 -right-0.5 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\">{notificationCount}</span>}\n                </button>\n                <Button variant=\"secondary\" icon={RefreshCw} onClick={refreshAllData}>Aggiorna</Button>\n              </div>\n            </div>\n\n            {/* DASHBOARD */}\n            {activeTab === 'dashboard' && (\n              <div className=\"space-y-6\">\n                {/* Period Filter + Export */}\n                <div className=\"flex flex-wrap items-center justify-between gap-3\">\n                  <div className=\"flex gap-2\">\n                    {[\n                      { id: 'all', label: 'Tutto' },\n                      { id: '30', label: '30 giorni' },\n                      { id: '60', label: '60 giorni' },\n                      { id: '90', label: '90 giorni' }\n                    ].map(p => (\n                      <button key={p.id} onClick={() => setPeriodFilter(p.id)} className={`px-4 py-2 rounded-xl text-sm font-medium transition-all ${periodFilter === p.id ? 'bg-violet-500/20 text-violet-400' : 'bg-zinc-700/50 text-zinc-400 hover:text-white'}`}>\n                        {p.label}\n                      </button>\n                    ))}\n                  </div>\n                  <Button variant=\"secondary\" icon={Printer} onClick={() => generateDashboardPDF(totals, periodSales, vendite, byAgente, byZona)}>\n                    Esporta Report\n                  </Button>\n                </div>\n                \n                {/* Alerts */}\n                {(todayTasks.length > 0 || overdueTasks.length > 0) && (\n                  <Card hover onClick={() => setActiveTab('tasks')} className=\"border-pink-500/20\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-12 h-12 rounded-xl bg-pink-500/20 flex items-center justify-center\">\n                        <Bell className=\"w-6 h-6 text-pink-400\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-white font-medium\">Task in scadenza</p>\n                        <p className=\"text-zinc-500 text-sm\">\n                          {overdueTasks.length > 0 && <span className=\"text-red-400\">{overdueTasks.length} scaduti</span>}\n                          {overdueTasks.length > 0 && todayTasks.length > 0 && ' • '}\n                          {todayTasks.length > 0 && <span>{todayTasks.length} oggi</span>}\n                        </p>\n                      </div>\n                      <ChevronRight className=\"w-5 h-5 text-zinc-500\" />\n                    </div>\n                  </Card>\n                )}\n\n                {/* Main Stats */}\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n                  <MetricCard label=\"Volume Totale\" value={totals.valore} subValue=\"AED\" icon={DollarSign} color=\"#A78BFA\" onClick={() => setActiveTab('vendite')} />\n                  <MetricCard label=\"Lead Totali\" value={sales.length} icon={Target} color=\"#60A5FA\" onClick={() => setActiveTab('pipeline')} />\n                  <MetricCard label=\"Vendite Chiuse\" value={vendite.length} icon={TrendingUp} color=\"#34D399\" onClick={() => setActiveTab('vendite')} />\n                  <MetricCard label=\"Netto KeyPrime\" value={totals.netto} subValue=\"AED\" icon={Sparkles} color=\"#FBBF24\" />\n                </div>\n\n                {/* Commission Split */}\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n                  <Card><p className=\"text-zinc-500 text-sm\">Commissioni Tot</p><p className=\"text-xl font-semibold text-emerald-400 mt-1\">{fmt(totals.comm)}</p></Card>\n                  <Card><p className=\"text-zinc-500 text-sm\">Agenti 70%</p><p className=\"text-xl font-semibold text-blue-400 mt-1\">{fmt(totals.ag)}</p></Card>\n                  <Card className=\"border-green-500/20\"><p className=\"text-zinc-500 text-sm\">Pellegrino</p><p className=\"text-xl font-semibold text-green-400 mt-1\">{fmt(totals.pell)}</p></Card>\n                  <Card className=\"border-orange-500/20\"><p className=\"text-zinc-500 text-sm\">Giovanni</p><p className=\"text-xl font-semibold text-orange-400 mt-1\">{fmt(totals.giov)}</p></Card>\n                </div>\n\n                {/* Pipeline Overview */}\n                <Card hover onClick={() => setActiveTab('pipeline')}>\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <h3 className=\"text-white font-semibold\">Pipeline</h3>\n                    <ChevronRight className=\"w-5 h-5 text-zinc-500\" />\n                  </div>\n                  <div className=\"grid grid-cols-5 gap-2\">\n                    {Object.entries(byStato).map(([st, items]) => (\n                      <div key={st} className=\"text-center p-3 rounded-xl\" style={{ background: theme.status[st]?.bg }}>\n                        <div className=\"text-xl font-semibold text-white\">{items.length}</div>\n                        <div className=\"text-xs\" style={{ color: theme.status[st]?.color }}>{pipelineLabels[st] || st}</div>\n                      </div>\n                    ))}\n                  </div>\n                </Card>\n\n                {/* Top Performers */}\n                <div className=\"grid lg:grid-cols-3 gap-4\">\n                  {/* Top Agenti - Clickable */}\n                  <Card>\n                    <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\"><Award className=\"w-5 h-5 text-amber-400\" />Top Agenti</h3>\n                    <div className=\"space-y-3\">\n                      {Object.entries(byAgente).sort((a, b) => b[1] - a[1]).slice(0, 5).map(([name, value], i) => (\n                        <div key={name} onClick={() => setShowAgentDetail({ name, type: 'agente' })} className=\"flex items-center gap-3 p-2 -mx-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors\">\n                          <div className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${i === 0 ? 'bg-amber-500 text-black' : 'bg-zinc-700/50 text-zinc-400'}`}>{i + 1}</div>\n                          <Avatar nome={name} size=\"sm\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-white text-sm\">{name}</p>\n                            <ProgressBar value={value} max={Object.values(byAgente).sort((a,b) => b-a)[0] || 1} color={i === 0 ? '#FBBF24' : '#52525B'} height=\"h-1\" />\n                          </div>\n                          <span className=\"text-zinc-400 text-sm\">{fmt(value)}</span>\n                          <ChevronRight className=\"w-4 h-4 text-zinc-600\" />\n                        </div>\n                      ))}\n                      {Object.keys(byAgente).length === 0 && <p className=\"text-zinc-500 text-sm text-center py-4\">Nessun dato</p>}\n                    </div>\n                  </Card>\n                  \n                  {/* Top Zone */}\n                  <Card>\n                    <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\"><MapPin className=\"w-5 h-5 text-emerald-400\" />Top Zone</h3>\n                    <div className=\"space-y-3\">\n                      {Object.entries(byZona).sort((a, b) => b[1] - a[1]).slice(0, 5).map(([zona, value], i) => (\n                        <div key={zona} className=\"flex items-center gap-3\">\n                          <div className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${i === 0 ? 'bg-emerald-500 text-black' : 'bg-zinc-700/50 text-zinc-400'}`}>{i + 1}</div>\n                          <div className=\"flex-1\">\n                            <p className=\"text-white text-sm\">{zona}</p>\n                            <ProgressBar value={value} max={Object.values(byZona).sort((a,b) => b-a)[0] || 1} color={i === 0 ? '#34D399' : '#52525B'} height=\"h-1\" />\n                          </div>\n                          <span className=\"text-zinc-400 text-sm\">{fmt(value)}</span>\n                        </div>\n                      ))}\n                      {Object.keys(byZona).length === 0 && <p className=\"text-zinc-500 text-sm text-center py-4\">Nessun dato</p>}\n                    </div>\n                  </Card>\n                  \n                  {/* Trend Mensile */}\n                  <Card>\n                    <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\"><TrendingUp className=\"w-5 h-5 text-violet-400\" />Trend Mensile</h3>\n                    <div className=\"space-y-3\">\n                      {Object.entries(byMonth).sort((a, b) => a[0].localeCompare(b[0])).slice(-5).map(([month, value]) => (\n                        <div key={month} className=\"flex items-center gap-3\">\n                          <span className=\"text-zinc-500 text-sm w-16\">{month}</span>\n                          <div className=\"flex-1\"><ProgressBar value={value} max={Math.max(...Object.values(byMonth)) || 1} color=\"#A78BFA\" /></div>\n                          <span className=\"text-white text-sm w-20 text-right\">{fmt(value)}</span>\n                        </div>\n                      ))}\n                      {Object.keys(byMonth).length === 0 && <p className=\"text-zinc-500 text-sm text-center py-4\">Nessun dato</p>}\n                    </div>\n                  </Card>\n                </div>\n              </div>\n            )}\n            \n            {/* AGENT DETAIL VIEW */}\n            {activeTab === 'dashboard' && showAgentDetail && (\n              <AgentDetailView \n                agent={showAgentDetail} \n                sales={periodSales} \n                onBack={() => setShowAgentDetail(null)} \n              />\n            )}\n\n            {/* VENDITE */}\n            {activeTab === 'vendite' && <VenditeTab sales={filteredSales} filters={filters} setFilters={setFilters} updateSale={updateSale} deleteSale={deleteSale} loading={loading} />}\n\n            {/* PIPELINE */}\n            {activeTab === 'pipeline' && <PipelineTab byStato={byStato} onSelectLead={setShowLeadDetail} onUpdateSaleStatus={(id, stato) => updateSale(id, { stato })} />}\n\n            {/* CRM */}\n            {activeTab === 'crm' && (showClienteDetail ? <ClienteDetailView cliente={showClienteDetail} sales={sales.filter(s => s.cliente_id === showClienteDetail.id)} tasks={tasks.filter(t => t.cliente_id === showClienteDetail.id)} onBack={() => setShowClienteDetail(null)} onEdit={() => setShowClienteModal(showClienteDetail)} onDelete={() => deleteCliente(showClienteDetail.id)} updateCliente={updateCliente} onAddTask={() => setShowTaskModal({ cliente_id: showClienteDetail.id })} onCompleteTask={completeTask} onDeleteTask={deleteTask} onExportPDF={() => generateClientePDF(showClienteDetail, sales.filter(s => s.cliente_id === showClienteDetail.id), tasks.filter(t => t.cliente_id === showClienteDetail.id))} /> : <CRMTab clienti={filteredClienti} filters={clienteFilters} setFilters={setClienteFilters} sales={sales} onSelect={setShowClienteDetail} onCreate={() => setShowClienteModal({})} onDelete={deleteCliente} onUpdateCliente={updateCliente} users={users} />)}\n\n            {/* OFF-PLAN */}\n            {activeTab === 'offplan' && <OffPlanTab clienti={clienti} onCreateLead={createLeadFromListing} savedListings={savedListings} onSaveListing={saveListing} onRemoveListing={removeListing} user={user} />}\n\n            {/* CALCULATOR */}\n            {activeTab === 'calculator' && <ROICalculator />}\n\n            {/* TASKS */}\n            {activeTab === 'tasks' && <AdminTasksTab tasks={tasks} clienti={clienti} users={users} onComplete={completeTask} onDelete={deleteTask} onEdit={setShowTaskModal} onCreate={() => setShowTaskModal({})} />}\n\n            {/* FOLLOW-UPS */}\n            {activeTab === 'followups' && (\n              <div className=\"space-y-6\">\n                {/* Stats */}\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n                  <Card className=\"border-red-500/20\">\n                    <p className=\"text-zinc-500 text-sm\">Scaduti</p>\n                    <p className=\"text-2xl font-semibold text-red-400 mt-1\">{overdueFollowUps.length}</p>\n                  </Card>\n                  <Card className=\"border-purple-500/20\">\n                    <p className=\"text-zinc-500 text-sm\">Oggi</p>\n                    <p className=\"text-2xl font-semibold text-purple-400 mt-1\">{todayFollowUps.length}</p>\n                  </Card>\n                  <Card>\n                    <p className=\"text-zinc-500 text-sm\">Prossimi 7 giorni</p>\n                    <p className=\"text-2xl font-semibold text-white mt-1\">{myFollowUps.filter(f => { const d = new Date(f.data_reminder); const today = new Date(); const week = new Date(); week.setDate(today.getDate() + 7); return d >= today && d <= week; }).length}</p>\n                  </Card>\n                  <Card>\n                    <p className=\"text-zinc-500 text-sm\">Totale Attivi</p>\n                    <p className=\"text-2xl font-semibold text-white mt-1\">{myFollowUps.length}</p>\n                  </Card>\n                </div>\n\n                {/* Follow-ups List */}\n                <Card>\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <h3 className=\"text-white font-semibold\">Follow-up Programmati</h3>\n                  </div>\n                  {myFollowUps.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {myFollowUps.map(f => {\n                        const sale = sales.find(s => s.id === f.sale_id);\n                        const cliente = clienti.find(c => c.id === f.cliente_id);\n                        const isOverdueF = new Date(f.data_reminder) < new Date();\n                        const isTodayF = new Date(f.data_reminder).toDateString() === new Date().toDateString();\n                        return (\n                          <div key={f.id} className={`p-4 rounded-xl border ${isOverdueF ? 'bg-red-500/10 border-red-500/30' : isTodayF ? 'bg-purple-500/10 border-purple-500/30' : 'bg-zinc-800/50 border-zinc-800'}`}>\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex items-center gap-3\">\n                                <div className={`w-10 h-10 rounded-full flex items-center justify-center ${isOverdueF ? 'bg-red-500/20' : isTodayF ? 'bg-purple-500/20' : 'bg-zinc-700'}`}>\n                                  {f.tipo === 'call' && '📞'}\n                                  {f.tipo === 'email' && '📧'}\n                                  {f.tipo === 'whatsapp' && '💬'}\n                                  {f.tipo === 'meeting' && '🤝'}\n                                  {f.tipo === 'viewing' && '🏠'}\n                                  {!f.tipo && '⏰'}\n                                </div>\n                                <div>\n                                  <p className=\"text-white font-medium\">{cliente ? `${cliente.nome} ${cliente.cognome}` : 'Cliente'}</p>\n                                  <p className=\"text-zinc-400 text-sm\">{sale?.progetto || 'Lead'}</p>\n                                  {f.nota && <p className=\"text-zinc-500 text-xs mt-1\">{f.nota}</p>}\n                                </div>\n                              </div>\n                              <div className=\"text-right flex items-center gap-3\">\n                                <div>\n                                  <p className={`font-medium ${isOverdueF ? 'text-red-400' : isTodayF ? 'text-purple-400' : 'text-white'}`}>\n                                    {new Date(f.data_reminder).toLocaleDateString('it-IT', { day: 'numeric', month: 'short' })}\n                                  </p>\n                                  {f.ora_reminder && <p className=\"text-zinc-500 text-xs\">{f.ora_reminder.slice(0,5)}</p>}\n                                  {isOverdueF && <span className=\"text-red-400 text-xs font-medium\">SCADUTO</span>}\n                                  {isTodayF && !isOverdueF && <span className=\"text-purple-400 text-xs font-medium\">OGGI</span>}\n                                </div>\n                                <div className=\"flex items-center gap-1\">\n                                  <button onClick={() => completeFollowUp(f.id)} className=\"p-2 text-zinc-500 hover:text-green-400 transition-colors\" title=\"Completa\">\n                                    <Check className=\"w-4 h-4\" />\n                                  </button>\n                                  <button onClick={() => deleteFollowUp(f.id)} className=\"p-2 text-zinc-500 hover:text-red-400 transition-colors\" title=\"Elimina\">\n                                    <Trash2 className=\"w-4 h-4\" />\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  ) : (\n                    <p className=\"text-zinc-500 text-center py-8\">Nessun follow-up programmato</p>\n                  )}\n                </Card>\n              </div>\n            )}\n\n            {/* COMMISSIONI */}\n            {activeTab === 'commissioni' && (\n              <div className=\"space-y-6\">\n                {/* Period Filter */}\n                <div className=\"flex gap-2\">\n                  {[\n                    { id: 'all', label: 'Tutto' },\n                    { id: '30', label: '30 giorni' },\n                    { id: '90', label: '90 giorni' },\n                    { id: '365', label: 'Anno' }\n                  ].map(p => (\n                    <button key={p.id} onClick={() => setPeriodFilter(p.id)} className={`px-4 py-2 rounded-xl text-sm font-medium transition-all ${periodFilter === p.id ? 'bg-emerald-500/20 text-emerald-400' : 'bg-zinc-700/50 text-zinc-400 hover:text-white'}`}>\n                      {p.label}\n                    </button>\n                  ))}\n                </div>\n\n                {/* Main Stats */}\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n                  <Card className=\"border-emerald-500/20 bg-emerald-500/5\">\n                    <p className=\"text-zinc-400 text-sm\">Commissioni Totali</p>\n                    <p className=\"text-3xl font-bold text-emerald-400 mt-2\">{fmt(totals.comm)}</p>\n                    <p className=\"text-zinc-500 text-xs mt-1\">AED</p>\n                  </Card>\n                  <Card className=\"border-green-500/20\">\n                    <p className=\"text-zinc-400 text-sm\">💰 Pellegrino</p>\n                    <p className=\"text-2xl font-bold text-green-400 mt-2\">{fmt(totals.pell)}</p>\n                    <p className=\"text-zinc-500 text-xs mt-1\">Quota netta</p>\n                  </Card>\n                  <Card className=\"border-orange-500/20\">\n                    <p className=\"text-zinc-400 text-sm\">💰 Giovanni</p>\n                    <p className=\"text-2xl font-bold text-orange-400 mt-2\">{fmt(totals.giov)}</p>\n                    <p className=\"text-zinc-500 text-xs mt-1\">Quota netta</p>\n                  </Card>\n                  <Card>\n                    <p className=\"text-zinc-400 text-sm\">Agenti (70%)</p>\n                    <p className=\"text-2xl font-bold text-blue-400 mt-2\">{fmt(totals.ag)}</p>\n                    <p className=\"text-zinc-500 text-xs mt-1\">Da pagare</p>\n                  </Card>\n                </div>\n\n                {/* Maturate vs Pagate */}\n                {(() => {\n                  const venduteSales = periodSales.filter(s => s.stato === 'venduto' || s.stato === 'incassato');\n                  const maturate = venduteSales.reduce((sum, s) => sum + (Number(s.valore) * (s.commission_pct || 5) / 100), 0);\n                  const pagate = venduteSales.filter(s => s.pagato).reduce((sum, s) => sum + (Number(s.valore) * (s.commission_pct || 5) / 100), 0);\n                  const daPagare = maturate - pagate;\n                  const percentPaid = maturate > 0 ? (pagate / maturate * 100) : 0;\n                  \n                  return (\n                    <Card>\n                      <h3 className=\"text-white font-semibold mb-4\">Stato Pagamenti</h3>\n                      <div className=\"grid grid-cols-3 gap-4 mb-4\">\n                        <div className=\"text-center p-4 bg-emerald-500/10 rounded-xl\">\n                          <p className=\"text-emerald-400 text-2xl font-bold\">{fmt(maturate)}</p>\n                          <p className=\"text-zinc-500 text-xs mt-1\">Maturate</p>\n                        </div>\n                        <div className=\"text-center p-4 bg-green-500/10 rounded-xl\">\n                          <p className=\"text-green-400 text-2xl font-bold\">{fmt(pagate)}</p>\n                          <p className=\"text-zinc-500 text-xs mt-1\">Pagate ✓</p>\n                        </div>\n                        <div className=\"text-center p-4 bg-amber-500/10 rounded-xl\">\n                          <p className=\"text-amber-400 text-2xl font-bold\">{fmt(daPagare)}</p>\n                          <p className=\"text-zinc-500 text-xs mt-1\">Da Pagare</p>\n                        </div>\n                      </div>\n                      {/* Progress bar */}\n                      <div className=\"relative h-4 bg-zinc-700/50 rounded-full overflow-hidden\">\n                        <div className=\"absolute left-0 top-0 h-full bg-gradient-to-r from-green-500 to-emerald-400 rounded-full transition-all duration-500\" style={{ width: `${percentPaid}%` }} />\n                        <div className=\"absolute inset-0 flex items-center justify-center\">\n                          <span className=\"text-xs font-medium text-white drop-shadow\">{percentPaid.toFixed(0)}% pagato</span>\n                        </div>\n                      </div>\n                    </Card>\n                  );\n                })()}\n\n                {/* Per Agente */}\n                <Card>\n                  <h3 className=\"text-white font-semibold mb-4\">Commissioni per Agente</h3>\n                  <div className=\"space-y-3\">\n                    {Object.entries(\n                      periodSales.filter(s => s.stato === 'venduto' || s.stato === 'incassato').reduce((acc, s) => {\n                        const agente = s.agente || 'Non assegnato';\n                        if (!acc[agente]) acc[agente] = { totale: 0, pagate: 0, count: 0 };\n                        const comm = Number(s.valore) * (s.commission_pct || 5) / 100 * 0.7;\n                        acc[agente].totale += comm;\n                        if (s.pagato) acc[agente].pagate += comm;\n                        acc[agente].count++;\n                        return acc;\n                      }, {})\n                    ).sort((a, b) => b[1].totale - a[1].totale).map(([agente, data]) => (\n                      <div key={agente} className=\"flex items-center justify-between p-3 bg-zinc-800/50 rounded-xl\">\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar nome={agente} size=\"sm\" />\n                          <div>\n                            <p className=\"text-white font-medium\">{agente}</p>\n                            <p className=\"text-zinc-500 text-xs\">{data.count} vendite</p>\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <p className=\"text-blue-400 font-semibold\">{fmt(data.totale)} AED</p>\n                          <p className=\"text-zinc-500 text-xs\">\n                            {data.pagate > 0 && <span className=\"text-green-400\">{fmt(data.pagate)} pagati</span>}\n                            {data.totale - data.pagate > 0 && <span className=\"text-amber-400 ml-2\">{fmt(data.totale - data.pagate)} pending</span>}\n                          </p>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </Card>\n\n                {/* Vendite con Commissioni */}\n                <Card>\n                  <h3 className=\"text-white font-semibold mb-4\">Dettaglio Vendite</h3>\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"w-full\">\n                      <thead>\n                        <tr className=\"text-left text-zinc-500 text-xs border-b border-zinc-800\">\n                          <th className=\"pb-3\">Progetto</th>\n                          <th className=\"pb-3\">Agente</th>\n                          <th className=\"pb-3 text-right\">Valore</th>\n                          <th className=\"pb-3 text-right\">Comm.</th>\n                          <th className=\"pb-3 text-center\">Stato</th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"divide-y divide-zinc-800\">\n                        {periodSales.filter(s => s.stato === 'venduto' || s.stato === 'incassato').slice(0, 20).map(s => {\n                          const comm = Number(s.valore) * (s.commission_pct || 5) / 100;\n                          return (\n                            <tr key={s.id} className=\"text-sm\">\n                              <td className=\"py-3\">\n                                <p className=\"text-white\">{s.progetto}</p>\n                                <p className=\"text-zinc-500 text-xs\">{s.zona}</p>\n                              </td>\n                              <td className=\"py-3 text-zinc-300\">{s.agente || '-'}</td>\n                              <td className=\"py-3 text-right text-white\">{fmt(s.valore)}</td>\n                              <td className=\"py-3 text-right text-emerald-400\">{fmt(comm)}</td>\n                              <td className=\"py-3 text-center\">\n                                {s.pagato ? (\n                                  <span className=\"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full\">Pagata ✓</span>\n                                ) : (\n                                  <span className=\"px-2 py-1 bg-amber-500/20 text-amber-400 text-xs rounded-full\">Pending</span>\n                                )}\n                              </td>\n                            </tr>\n                          );\n                        })}\n                      </tbody>\n                    </table>\n                  </div>\n                </Card>\n              </div>\n            )}\n\n            {/* TEAM */}\n            {activeTab === 'utenti' && <TeamTab users={users} onCreate={() => setShowUserModal({})} onEdit={setShowUserModal} onDelete={deleteUser} />}\n          </div>\n        </main>\n\n        {/* Mobile Menu */}\n        {mobileMenuOpen && (\n          <div className=\"fixed inset-0 z-50 lg:hidden\">\n            <div className=\"absolute inset-0 bg-zinc-800/60\" onClick={() => setMobileMenuOpen(false)} />\n            <aside className=\"absolute left-0 top-0 bottom-0 w-72 bg-[#1e293b] p-4 animate-slideRight\">\n              <div className=\"flex items-center justify-between mb-8\">\n                <img src=\"/logo.png\" alt=\"KeyPrime\" className=\"h-16\" />\n                <button onClick={() => setMobileMenuOpen(false)} className=\"text-zinc-400\"><X className=\"w-5 h-5\" /></button>\n              </div>\n              <nav className=\"space-y-1\">\n                {tabs.map(t => (\n                  <NavItem key={t.id} icon={t.icon} label={t.label} active={activeTab === t.id} onClick={() => { setActiveTab(t.id); setMobileMenuOpen(false); setShowClienteDetail(null); }} accent={t.accent} badge={t.badge} isNew={t.isNew} />\n                ))}\n              </nav>\n              <div className=\"absolute bottom-4 left-4 right-4\">\n                <Button variant=\"danger\" icon={LogOut} onClick={handleLogout} className=\"w-full\">Esci</Button>\n              </div>\n            </aside>\n          </div>\n        )}\n\n        {/* Modals */}\n        {showLeadDetail && <LeadDetailSheet sale={showLeadDetail} cliente={clienti.find(c => c.id === showLeadDetail?.cliente_id)} rate={0.7} onClose={() => setShowLeadDetail(null)} onUpdateSale={updateSale} onConvert={() => setConvertingSale(showLeadDetail)} isAdmin activities={activities.filter(a => a.sale_id === showLeadDetail?.id)} followUps={followUps.filter(f => f.sale_id === showLeadDetail?.id)} onAddActivity={addActivity} onCreateFollowUp={createFollowUp} onCompleteFollowUp={completeFollowUp} onDeleteActivity={deleteActivity} onDeleteFollowUp={deleteFollowUp} userName={user?.nome} />}\n        {convertingSale && <ConvertModal sale={convertingSale} onConvert={convertLeadToSale} onCancel={() => setConvertingSale(null)} />}\n        {showClienteModal && <ClienteModal cliente={showClienteModal.id ? showClienteModal : null} onSave={showClienteModal.id ? (d) => updateCliente(showClienteModal.id, d) : createCliente} onClose={() => setShowClienteModal(null)} />}\n        {showTaskModal && <TaskModal task={showTaskModal.id ? showTaskModal : null} clienti={clienti} users={users} onSave={showTaskModal.id ? (d) => updateTask(showTaskModal.id, d) : createTask} onClose={() => setShowTaskModal(null)} />}\n        {showUserModal && <UserModal user={showUserModal.id ? showUserModal : null} onSave={showUserModal.id ? (d) => updateUser(showUserModal.id, d) : createUser} onClose={() => setShowUserModal(null)} />}\n        {showNotifications && <NotificationsPanel tasks={notificationTasks} unreadIds={unreadNotificationIds} recentSales={recentSalesNotifications} onClose={() => { setShowNotifications(false); }} onGoToTask={() => { setShowNotifications(false); setActiveTab('tasks'); }} onMarkAsRead={markSingleNotificationAsRead} userId={user?.id} />}\n        {showGlobalSearch && <GlobalSearch isOpen={showGlobalSearch} onClose={() => setShowGlobalSearch(false)} sales={sales} clienti={clienti} tasks={tasks} onSelectSale={setShowLeadDetail} onSelectCliente={setShowClienteDetail} onSelectTask={() => setActiveTab('tasks')} setActiveTab={setActiveTab} />}\n        {toast && <Toast message={toast.message} type={toast.type} onClose={() => setToast(null)} />}\n      </div>\n    );\n  }\n\n  return null;\n}\n\n// ==================== TAB COMPONENTS ====================\n\n// Vendite Tab\nfunction VenditeTab({ sales, filters, setFilters, updateSale, deleteSale, loading }) {\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-wrap gap-3 items-center\">\n        <div className=\"relative flex-1 min-w-[200px]\">\n          <Search className=\"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500\" />\n          <input type=\"text\" placeholder=\"Cerca progetto, cliente, agente...\" value={filters.search} onChange={(e) => setFilters({ ...filters, search: e.target.value })} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-2.5 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-emerald-500/50\" />\n        </div>\n        <select value={filters.stato} onChange={(e) => setFilters({ ...filters, stato: e.target.value })} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-emerald-500/50\">\n          <option value=\"\">Tutti gli stati</option>\n          {pipelineStati.map(s => <option key={s} value={s}>{pipelineLabels[s] || s}</option>)}\n        </select>\n      </div>\n\n      <Card padding=\"p-0\" className=\"overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            <thead>\n              <tr className=\"border-b border-[#334155]\">\n                <th className=\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Data</th>\n                <th className=\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Progetto</th>\n                <th className=\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Zona</th>\n                <th className=\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Cliente</th>\n                <th className=\"text-left text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Agente</th>\n                <th className=\"text-right text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Valore</th>\n                <th className=\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">%</th>\n                <th className=\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Stato</th>\n                <th className=\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Ref</th>\n                <th className=\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\">Pag</th>\n                <th className=\"text-center text-xs font-medium text-zinc-500 uppercase tracking-wider px-4 py-3\"></th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-[#334155]\">\n              {sales.map(s => (\n                <tr key={s.id} className=\"hover:bg-white/5 transition-colors\">\n                  <td className=\"px-4 py-3 text-sm text-zinc-400\">{fmtShort(s.data)}</td>\n                  <td className=\"px-4 py-3\">\n                    <div className=\"flex items-center gap-2\">\n                      <div>\n                        <span className=\"text-white text-sm font-medium\">{s.progetto}</span>\n                        <br /><span className=\"text-xs text-zinc-500\">{s.developer}</span>\n                      </div>\n                      {s.note && (\n                        <span title={s.note} className=\"text-amber-400 cursor-help\">\n                          <FileText className=\"w-3.5 h-3.5\" />\n                        </span>\n                      )}\n                      {s.pf_url && (\n                        <a href={s.pf_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-400 hover:text-blue-300\">\n                          <ExternalLink className=\"w-3.5 h-3.5\" />\n                        </a>\n                      )}\n                    </div>\n                  </td>\n                  <td className=\"px-4 py-3 text-sm text-zinc-400\">{s.zona || '-'}</td>\n                  <td className=\"px-4 py-3 text-sm text-blue-400\">{s.cliente_nome || '-'}</td>\n                  <td className=\"px-4 py-3 text-sm text-zinc-400\">{s.agente || s.segnalatore || '-'}</td>\n                  <td className=\"px-4 py-3 text-right text-sm font-medium text-white\">{s.valore > 0 ? fmt(s.valore) : '-'}</td>\n                  <td className=\"px-4 py-3 text-center\">\n                    <select value={s.commission_pct || 5} onChange={(e) => updateSale(s.id, { commission_pct: parseInt(e.target.value) })} className=\"bg-zinc-700/50 rounded px-2 py-1 text-xs text-white w-14 focus:outline-none\">\n                      {commissions.map(c => <option key={c} value={c}>{c}%</option>)}\n                    </select>\n                  </td>\n                  <td className=\"px-4 py-3 text-center\">\n                    <select value={s.stato || 'lead'} onChange={(e) => updateSale(s.id, { stato: e.target.value })} className=\"rounded px-2 py-1 text-xs text-white w-20 focus:outline-none\" style={{ background: theme.status[s.stato || 'lead']?.bg, color: theme.status[s.stato || 'lead']?.color }}>\n                      {pipelineStati.map(st => <option key={st} value={st} className=\"bg-zinc-800\">{pipelineLabels[st] || st}</option>)}\n                    </select>\n                  </td>\n                  <td className=\"px-4 py-3 text-center\">\n                    <select value={s.referente || ''} onChange={(e) => updateSale(s.id, { referente: e.target.value || null })} className={`rounded px-2 py-1 text-xs font-medium w-12 focus:outline-none ${s.referente === 'Pellegrino' ? 'bg-green-500/20 text-green-400' : s.referente === 'Giovanni' ? 'bg-orange-500/20 text-orange-400' : 'bg-zinc-700/50 text-zinc-500'}`}>\n                      <option value=\"\">-</option>\n                      <option value=\"Pellegrino\">P</option>\n                      <option value=\"Giovanni\">G</option>\n                    </select>\n                  </td>\n                  <td className=\"px-4 py-3 text-center\">\n                    <button onClick={() => updateSale(s.id, { pagato: !s.pagato })} className={`px-2.5 py-1 rounded-lg text-xs font-medium transition-colors ${s.pagato ? 'bg-emerald-500/20 text-emerald-400' : 'bg-zinc-700/50 text-zinc-500 hover:text-zinc-300'}`}>\n                      {s.pagato ? '✓' : '○'}\n                    </button>\n                  </td>\n                  <td className=\"px-4 py-3 text-center\">\n                    <button onClick={() => deleteSale(s.id)} className=\"text-zinc-600 hover:text-red-400 transition-colors\"><Trash2 className=\"w-4 h-4\" /></button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n        {sales.length === 0 && <div className=\"text-center py-12 text-zinc-500\">Nessuna vendita trovata</div>}\n      </Card>\n    </div>\n  );\n}\n\n// Leads Table View with Multi-Select\nfunction LeadsTableView({ leads, clienti, onSelectLead, onUpdateStatus, onDelete, onAssign, theme, users, isAdmin }) {\n  const [selectedIds, setSelectedIds] = useState([]);\n  const [sortField, setSortField] = useState('created_at');\n  const [sortDir, setSortDir] = useState('desc');\n  const [filterStato, setFilterStato] = useState('');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [showBulkActions, setShowBulkActions] = useState(false);\n  const [bulkAction, setBulkAction] = useState(null);\n\n  // Usa pipelineStati globale (già definito sopra)\n  const fmt = (n) => new Intl.NumberFormat('it-IT', { style: 'currency', currency: 'AED', maximumFractionDigits: 0 }).format(n);\n  \n  const getCliente = (id) => clienti.find(c => c.id === id);\n  \n  // Filter and sort leads\n  const filteredLeads = leads\n    .filter(l => {\n      if (filterStato && l.stato !== filterStato) return false;\n      if (searchQuery) {\n        const q = searchQuery.toLowerCase();\n        const cliente = getCliente(l.cliente_id);\n        return l.progetto?.toLowerCase().includes(q) || \n               l.zona?.toLowerCase().includes(q) ||\n               l.developer?.toLowerCase().includes(q) ||\n               cliente?.nome?.toLowerCase().includes(q) ||\n               cliente?.cognome?.toLowerCase().includes(q);\n      }\n      return true;\n    })\n    .sort((a, b) => {\n      let aVal = a[sortField];\n      let bVal = b[sortField];\n      if (sortField === 'cliente') {\n        aVal = getCliente(a.cliente_id)?.nome || '';\n        bVal = getCliente(b.cliente_id)?.nome || '';\n      }\n      if (sortDir === 'asc') return aVal > bVal ? 1 : -1;\n      return aVal < bVal ? 1 : -1;\n    });\n\n  const toggleSelect = (id) => {\n    setSelectedIds(prev => prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]);\n  };\n\n  const toggleSelectAll = () => {\n    if (selectedIds.length === filteredLeads.length) {\n      setSelectedIds([]);\n    } else {\n      setSelectedIds(filteredLeads.map(l => l.id));\n    }\n  };\n\n  const handleBulkAction = (action, value) => {\n    if (action === 'delete') {\n      if (window.confirm(`Eliminare ${selectedIds.length} lead?`)) {\n        selectedIds.forEach(id => onDelete(id));\n        setSelectedIds([]);\n      }\n    } else if (action === 'status') {\n      selectedIds.forEach(id => onUpdateStatus(id, value));\n      setSelectedIds([]);\n    } else if (action === 'assign' && onAssign) {\n      onAssign(selectedIds, value);\n      setSelectedIds([]);\n    }\n    setBulkAction(null);\n  };\n\n  const SortHeader = ({ field, children }) => (\n    <th \n      className=\"text-left py-3 px-4 text-zinc-400 font-medium text-sm cursor-pointer hover:text-white transition-colors\"\n      onClick={() => {\n        if (sortField === field) {\n          setSortDir(d => d === 'asc' ? 'desc' : 'asc');\n        } else {\n          setSortField(field);\n          setSortDir('asc');\n        }\n      }}\n    >\n      <span className=\"flex items-center gap-1\">\n        {children}\n        {sortField === field && (\n          <span className=\"text-orange-400\">{sortDir === 'asc' ? '↑' : '↓'}</span>\n        )}\n      </span>\n    </th>\n  );\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Header with Search and Filters */}\n      <div className=\"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between\">\n        <div className=\"flex items-center gap-3 flex-wrap\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500\" />\n            <input\n              type=\"text\"\n              placeholder=\"Cerca lead...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg pl-9 pr-4 py-2 text-white text-sm w-64 focus:border-orange-500 focus:outline-none\"\n            />\n          </div>\n          <select\n            value={filterStato}\n            onChange={(e) => setFilterStato(e.target.value)}\n            className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"\n          >\n            <option value=\"\">Tutti gli stati</option>\n            {pipelineStati.map(s => (\n              <option key={s} value={s}>{pipelineLabels[s] || s}</option>\n            ))}\n          </select>\n        </div>\n        <p className=\"text-zinc-500 text-sm\">{filteredLeads.length} lead</p>\n      </div>\n\n      {/* Bulk Actions Bar */}\n      {selectedIds.length > 0 && (\n        <Card className=\"bg-orange-500/10 border-orange-500/30\">\n          <div className=\"flex items-center justify-between\">\n            <p className=\"text-orange-400 font-medium\">\n              {selectedIds.length} lead selezionati\n            </p>\n            <div className=\"flex items-center gap-2\">\n              <select\n                value=\"\"\n                onChange={(e) => handleBulkAction('status', e.target.value)}\n                className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\"\n              >\n                <option value=\"\">Cambia stato...</option>\n                {pipelineStati.map(s => (\n                  <option key={s} value={s}>{s}</option>\n                ))}\n              </select>\n              {isAdmin && users?.length > 0 && (\n                <select\n                  value=\"\"\n                  onChange={(e) => handleBulkAction('assign', e.target.value)}\n                  className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\"\n                >\n                  <option value=\"\">Assegna a...</option>\n                  {users.map(u => (\n                    <option key={u.id} value={u.nome}>{u.nome}</option>\n                  ))}\n                </select>\n              )}\n              <Button variant=\"danger\" size=\"sm\" onClick={() => handleBulkAction('delete')}>\n                <Trash2 className=\"w-4 h-4 mr-1\" /> Elimina\n              </Button>\n              <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedIds([])}>\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n        </Card>\n      )}\n\n      {/* Table */}\n      <Card padding=\"p-0\" className=\"overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            <thead className=\"bg-zinc-700/50/50 border-b border-zinc-700\">\n              <tr>\n                <th className=\"w-12 py-3 px-4\">\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedIds.length === filteredLeads.length && filteredLeads.length > 0}\n                    onChange={toggleSelectAll}\n                    className=\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-orange-500 focus:ring-orange-500\"\n                  />\n                </th>\n                <SortHeader field=\"cliente\">Cliente</SortHeader>\n                <SortHeader field=\"progetto\">Progetto</SortHeader>\n                <SortHeader field=\"zona\">Zona</SortHeader>\n                <SortHeader field=\"valore\">Valore</SortHeader>\n                <SortHeader field=\"stato\">Stato</SortHeader>\n                <SortHeader field=\"created_at\">Data</SortHeader>\n                {isAdmin && <SortHeader field=\"assegnato_a\">Agente</SortHeader>}\n                <th className=\"w-20 py-3 px-4\"></th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-zinc-800\">\n              {filteredLeads.map(lead => {\n                const cliente = getCliente(lead.cliente_id);\n                const isSelected = selectedIds.includes(lead.id);\n                return (\n                  <tr \n                    key={lead.id} \n                    className={`hover:bg-zinc-700/50/50 cursor-pointer transition-colors ${isSelected ? 'bg-orange-500/10' : ''}`}\n                  >\n                    <td className=\"py-3 px-4\" onClick={(e) => e.stopPropagation()}>\n                      <input\n                        type=\"checkbox\"\n                        checked={isSelected}\n                        onChange={() => toggleSelect(lead.id)}\n                        className=\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-orange-500 focus:ring-orange-500\"\n                      />\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelectLead(lead)}>\n                      <div className=\"flex items-center gap-3\">\n                        {cliente && <Avatar nome={cliente.nome} size=\"sm\" />}\n                        <div>\n                          <p className=\"text-white font-medium\">{cliente ? `${cliente.nome} ${cliente.cognome || ''}` : 'N/A'}</p>\n                          {cliente?.telefono && <p className=\"text-zinc-500 text-xs\">{cliente.telefono}</p>}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelectLead(lead)}>\n                      <p className=\"text-white\">{lead.progetto || '-'}</p>\n                      <p className=\"text-zinc-500 text-xs\">{lead.developer || ''}</p>\n                    </td>\n                    <td className=\"py-3 px-4 text-zinc-300\" onClick={() => onSelectLead(lead)}>{lead.zona || '-'}</td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelectLead(lead)}>\n                      <span className=\"text-emerald-400 font-semibold\">{lead.valore > 0 ? fmt(lead.valore) : 'TBD'}</span>\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelectLead(lead)}>\n                      <StatusBadge status={lead.stato || 'lead'} />\n                    </td>\n                    <td className=\"py-3 px-4 text-zinc-500 text-sm\" onClick={() => onSelectLead(lead)}>\n                      {lead.created_at ? new Date(lead.created_at).toLocaleDateString('it-IT') : '-'}\n                    </td>\n                    {isAdmin && (\n                      <td className=\"py-3 px-4\" onClick={() => onSelectLead(lead)}>\n                        {lead.assegnato_a ? (\n                          <span className=\"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full\">{lead.assegnato_a}</span>\n                        ) : (\n                          <span className=\"text-zinc-600 text-sm\">-</span>\n                        )}\n                      </td>\n                    )}\n                    <td className=\"py-3 px-4\">\n                      <div className=\"flex items-center gap-1\">\n                        <button\n                          onClick={(e) => { e.stopPropagation(); onSelectLead(lead); }}\n                          className=\"p-1.5 text-zinc-400 hover:text-white hover:bg-zinc-700 rounded-lg transition-colors\"\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                        </button>\n                        <button\n                          onClick={(e) => { e.stopPropagation(); if(window.confirm('Eliminare?')) onDelete(lead.id); }}\n                          className=\"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors\"\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n          {filteredLeads.length === 0 && (\n            <div className=\"py-12 text-center\">\n              <Target className=\"w-12 h-12 text-zinc-600 mx-auto mb-3\" />\n              <p className=\"text-zinc-500\">Nessun lead trovato</p>\n            </div>\n          )}\n        </div>\n      </Card>\n    </div>\n  );\n}\n\n// Pipeline Tab\nfunction PipelineTab({ byStato, onSelectLead, onUpdateSaleStatus }) {\n  const [draggedItem, setDraggedItem] = useState(null);\n  const [dragOverColumn, setDragOverColumn] = useState(null);\n  \n  const handleDragStart = (e, sale) => {\n    setDraggedItem(sale);\n    e.dataTransfer.effectAllowed = 'move';\n    e.target.style.opacity = '0.5';\n  };\n  \n  const handleDragEnd = (e) => {\n    e.target.style.opacity = '1';\n    setDraggedItem(null);\n    setDragOverColumn(null);\n  };\n  \n  const handleDragOver = (e, stato) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n    setDragOverColumn(stato);\n  };\n  \n  const handleDragLeave = () => {\n    setDragOverColumn(null);\n  };\n  \n  const handleDrop = (e, newStato) => {\n    e.preventDefault();\n    if (draggedItem && draggedItem.stato !== newStato) {\n      onUpdateSaleStatus(draggedItem.id, newStato);\n    }\n    setDraggedItem(null);\n    setDragOverColumn(null);\n  };\n  \n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between\">\n        <p className=\"text-zinc-500 text-sm\">Trascina le card per cambiare stato</p>\n      </div>\n      <div className=\"grid grid-cols-2 lg:grid-cols-5 gap-4\">\n        {pipelineStati.map(st => (\n          <div key={st} className=\"space-y-3\" onDragOver={(e) => handleDragOver(e, st)} onDragLeave={handleDragLeave} onDrop={(e) => handleDrop(e, st)}>\n            <div className=\"flex items-center justify-between px-1\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 rounded-full\" style={{ background: theme.status[st]?.color }} />\n                <span className=\"text-sm font-medium text-white\">{pipelineLabels[st] || st}</span>\n              </div>\n              <span className=\"text-xs text-zinc-500 bg-zinc-700/50 px-2 py-0.5 rounded-full\">{byStato[st]?.length || 0}</span>\n            </div>\n            <div className={`space-y-2 min-h-[200px] rounded-xl p-2 transition-all ${dragOverColumn === st ? 'bg-white/5 ring-2 ring-violet-500/50' : ''}`}>\n              {byStato[st]?.map(s => (\n                <div key={s.id} draggable onDragStart={(e) => handleDragStart(e, s)} onDragEnd={handleDragEnd} className={`cursor-grab active:cursor-grabbing ${draggedItem?.id === s.id ? 'opacity-50' : ''}`}>\n                  <Card hover onClick={() => onSelectLead(s)} padding=\"p-3\" className=\"border-l-2\" style={{ borderLeftColor: theme.status[st]?.color }}>\n                    <p className=\"text-white text-sm font-medium truncate\">{s.progetto || 'TBD'}</p>\n                    <p className=\"text-zinc-500 text-xs truncate\">{s.developer}</p>\n                    {s.cliente_nome && <p className=\"text-blue-400 text-xs mt-1\">{s.cliente_nome}</p>}\n                    {s.valore > 0 && <p className=\"text-emerald-400 text-sm font-medium mt-2\">{fmt(s.valore)} AED</p>}\n                  </Card>\n                </div>\n              ))}\n              {!byStato[st]?.length && <div className=\"text-center py-8 text-zinc-600 text-sm border-2 border-dashed border-zinc-800 rounded-xl\">Trascina qui</div>}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\n// CRM Tab\nfunction CRMTab({ clienti, filters, setFilters, sales, onSelect, onCreate, onDelete, onUpdateCliente, users }) {\n  const [selectedIds, setSelectedIds] = useState([]);\n  const [sortField, setSortField] = useState('created_at');\n  const [sortDir, setSortDir] = useState('desc');\n\n  const getClientStats = (id) => {\n    const cs = sales.filter(s => s.cliente_id === id);\n    const vendite = cs.filter(s => s.stato === 'venduto' || s.stato === 'incassato');\n    return { leads: cs.length, value: vendite.reduce((sum, s) => sum + Number(s.valore || 0), 0) };\n  };\n\n  // Sort clients\n  const sortedClienti = [...clienti].sort((a, b) => {\n    let aVal = a[sortField];\n    let bVal = b[sortField];\n    if (sortField === 'leads') {\n      aVal = getClientStats(a.id).leads;\n      bVal = getClientStats(b.id).leads;\n    } else if (sortField === 'value') {\n      aVal = getClientStats(a.id).value;\n      bVal = getClientStats(b.id).value;\n    }\n    if (sortDir === 'asc') return aVal > bVal ? 1 : -1;\n    return aVal < bVal ? 1 : -1;\n  });\n\n  const toggleSelect = (id) => {\n    setSelectedIds(prev => prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]);\n  };\n\n  const toggleSelectAll = () => {\n    if (selectedIds.length === sortedClienti.length) {\n      setSelectedIds([]);\n    } else {\n      setSelectedIds(sortedClienti.map(c => c.id));\n    }\n  };\n\n  const handleBulkAction = async (action, value) => {\n    console.log('Bulk action:', action, value, 'IDs:', selectedIds);\n    \n    if (action === 'delete') {\n      if (window.confirm(`Eliminare ${selectedIds.length} clienti?`)) {\n        for (const id of selectedIds) {\n          await onDelete(id, true);\n        }\n        setSelectedIds([]);\n      }\n    } else if (action === 'stato') {\n      if (!onUpdateCliente) { console.error('onUpdateCliente not provided'); return; }\n      for (const id of selectedIds) {\n        console.log('Updating stato for', id, 'to', value);\n        await onUpdateCliente(id, { stato: value });\n      }\n      setSelectedIds([]);\n    } else if (action === 'assegnato') {\n      if (!onUpdateCliente) { console.error('onUpdateCliente not provided'); return; }\n      for (const id of selectedIds) {\n        console.log('Assigning', id, 'to', value);\n        await onUpdateCliente(id, { assegnato_a: value });\n      }\n      setSelectedIds([]);\n    }\n  };\n\n  const SortHeader = ({ field, children, className = '' }) => (\n    <th \n      className={`text-left py-3 px-4 text-zinc-400 font-medium text-sm cursor-pointer hover:text-white transition-colors ${className}`}\n      onClick={() => {\n        if (sortField === field) {\n          setSortDir(d => d === 'asc' ? 'desc' : 'asc');\n        } else {\n          setSortField(field);\n          setSortDir('asc');\n        }\n      }}\n    >\n      <span className=\"flex items-center gap-1\">\n        {children}\n        {sortField === field && (\n          <span className=\"text-amber-400\">{sortDir === 'asc' ? '↑' : '↓'}</span>\n        )}\n      </span>\n    </th>\n  );\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Header with Search and Filters */}\n      <div className=\"flex flex-wrap gap-3 items-center justify-between\">\n        <div className=\"flex items-center gap-3 flex-wrap flex-1\">\n          <div className=\"relative min-w-[250px]\">\n            <Search className=\"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500\" />\n            <input type=\"text\" placeholder=\"Cerca cliente...\" value={filters.search} onChange={(e) => setFilters({ ...filters, search: e.target.value })} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-2.5 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-amber-500/50\" />\n          </div>\n          <select value={filters.stato} onChange={(e) => setFilters({ ...filters, stato: e.target.value })} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none\">\n            <option value=\"\">Tutti gli stati</option>\n            {clienteStati.map(s => <option key={s} value={s}>{s}</option>)}\n          </select>\n        </div>\n        <Button icon={UserPlus} onClick={onCreate}>Nuovo Cliente</Button>\n      </div>\n\n      {/* Bulk Actions Bar */}\n      {selectedIds.length > 0 && (\n        <Card className=\"bg-amber-500/10 border-amber-500/30\">\n          <div className=\"flex items-center justify-between flex-wrap gap-3\">\n            <p className=\"text-amber-400 font-medium\">\n              {selectedIds.length} clienti selezionati\n            </p>\n            <div className=\"flex items-center gap-2 flex-wrap\">\n              <select\n                value=\"\"\n                onChange={(e) => handleBulkAction('stato', e.target.value)}\n                className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\"\n              >\n                <option value=\"\">Cambia stato...</option>\n                {clienteStati.map(s => (\n                  <option key={s} value={s}>{s}</option>\n                ))}\n              </select>\n              {users?.length > 0 && (\n                <select\n                  value=\"\"\n                  onChange={(e) => handleBulkAction('assegnato', e.target.value)}\n                  className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-1.5 text-white text-sm\"\n                >\n                  <option value=\"\">Assegna a...</option>\n                  {users.map(u => (\n                    <option key={u.id} value={u.nome}>{u.nome}</option>\n                  ))}\n                </select>\n              )}\n              <Button variant=\"danger\" size=\"sm\" onClick={() => handleBulkAction('delete')}>\n                <Trash2 className=\"w-4 h-4 mr-1\" /> Elimina\n              </Button>\n              <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedIds([])}>\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n        </Card>\n      )}\n\n      {/* Table */}\n      <Card padding=\"p-0\" className=\"overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            <thead className=\"bg-zinc-700/50/50 border-b border-zinc-700\">\n              <tr>\n                <th className=\"w-12 py-3 px-4\">\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedIds.length === sortedClienti.length && sortedClienti.length > 0}\n                    onChange={toggleSelectAll}\n                    className=\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-amber-500 focus:ring-amber-500\"\n                  />\n                </th>\n                <SortHeader field=\"nome\">Cliente</SortHeader>\n                <SortHeader field=\"telefono\">Telefono</SortHeader>\n                <SortHeader field=\"email\">Email</SortHeader>\n                <SortHeader field=\"stato\">Stato</SortHeader>\n                <SortHeader field=\"assegnato_a\">Agente</SortHeader>\n                <SortHeader field=\"leads\">Lead</SortHeader>\n                <SortHeader field=\"value\">Valore</SortHeader>\n                <SortHeader field=\"budget_max\">Budget</SortHeader>\n                <SortHeader field=\"created_at\">Data</SortHeader>\n                <th className=\"w-20 py-3 px-4\"></th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-zinc-800\">\n              {sortedClienti.map(cliente => {\n                const stats = getClientStats(cliente.id);\n                const isSelected = selectedIds.includes(cliente.id);\n                return (\n                  <tr \n                    key={cliente.id} \n                    className={`hover:bg-zinc-700/50/50 cursor-pointer transition-colors ${isSelected ? 'bg-amber-500/10' : ''}`}\n                  >\n                    <td className=\"py-3 px-4\" onClick={(e) => e.stopPropagation()}>\n                      <input\n                        type=\"checkbox\"\n                        checked={isSelected}\n                        onChange={() => toggleSelect(cliente.id)}\n                        className=\"w-4 h-4 rounded border-zinc-600 bg-zinc-700 text-amber-500 focus:ring-amber-500\"\n                      />\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelect(cliente)}>\n                      <div className=\"flex items-center gap-3\">\n                        <Avatar nome={cliente.nome} cognome={cliente.cognome} size=\"sm\" />\n                        <div>\n                          <p className=\"text-white font-medium\">{cliente.nome} {cliente.cognome || ''}</p>\n                          {cliente.azienda && <p className=\"text-zinc-500 text-xs\">{cliente.azienda}</p>}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"py-3 px-4 text-zinc-300\" onClick={() => onSelect(cliente)}>\n                      {cliente.telefono || '-'}\n                    </td>\n                    <td className=\"py-3 px-4 text-zinc-300 text-sm\" onClick={() => onSelect(cliente)}>\n                      {cliente.email || '-'}\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelect(cliente)}>\n                      <StatusBadge status={cliente.stato} type=\"cliente\" />\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelect(cliente)}>\n                      {cliente.assegnato_a ? (\n                        <span className=\"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full\">{cliente.assegnato_a}</span>\n                      ) : (\n                        <span className=\"text-zinc-600\">-</span>\n                      )}\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelect(cliente)}>\n                      {stats.leads > 0 ? (\n                        <span className=\"text-blue-400 font-medium\">{stats.leads}</span>\n                      ) : (\n                        <span className=\"text-zinc-600\">0</span>\n                      )}\n                    </td>\n                    <td className=\"py-3 px-4\" onClick={() => onSelect(cliente)}>\n                      {stats.value > 0 ? (\n                        <span className=\"text-emerald-400 font-semibold\">{fmt(stats.value)}</span>\n                      ) : (\n                        <span className=\"text-zinc-600\">-</span>\n                      )}\n                    </td>\n                    <td className=\"py-3 px-4 text-zinc-300\" onClick={() => onSelect(cliente)}>\n                      {cliente.budget_max ? fmt(cliente.budget_max) : '-'}\n                    </td>\n                    <td className=\"py-3 px-4 text-zinc-500 text-sm\" onClick={() => onSelect(cliente)}>\n                      {cliente.created_at ? new Date(cliente.created_at).toLocaleDateString('it-IT') : '-'}\n                    </td>\n                    <td className=\"py-3 px-4\">\n                      <div className=\"flex items-center gap-1\">\n                        <button\n                          onClick={(e) => { e.stopPropagation(); onSelect(cliente); }}\n                          className=\"p-1.5 text-zinc-400 hover:text-white hover:bg-zinc-700 rounded-lg transition-colors\"\n                          title=\"Dettagli\"\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                        </button>\n                        <button\n                          onClick={(e) => { e.stopPropagation(); if(window.confirm('Eliminare questo cliente?')) onDelete(cliente.id); }}\n                          className=\"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors\"\n                          title=\"Elimina\"\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n          {sortedClienti.length === 0 && (\n            <div className=\"py-12 text-center\">\n              <Users className=\"w-12 h-12 text-zinc-600 mx-auto mb-3\" />\n              <p className=\"text-zinc-500\">Nessun cliente trovato</p>\n              <Button className=\"mt-4\" icon={UserPlus} onClick={onCreate}>Aggiungi Cliente</Button>\n            </div>\n          )}\n        </div>\n      </Card>\n    </div>\n  );\n}\n\n// Cliente Detail View\nfunction ClienteDetailView({ cliente, sales, tasks, onBack, onEdit, onDelete, updateCliente, onAddTask, onCompleteTask, onDeleteTask, onExportPDF }) {\n  const [tab, setTab] = useState('info');\n  const totalValue = sales.filter(s => s.stato === 'venduto' || s.stato === 'incassato').reduce((sum, s) => sum + Number(s.valore || 0), 0);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center gap-4\">\n        <Button variant=\"ghost\" icon={ChevronLeft} onClick={onBack}>Indietro</Button>\n        <div className=\"flex-1\" />\n        <Button variant=\"ghost\" icon={FileText} onClick={onExportPDF}>PDF</Button>\n        <Button variant=\"ghost\" icon={Edit2} onClick={onEdit}>Modifica</Button>\n        <Button variant=\"danger\" icon={Trash2} onClick={onDelete} />\n      </div>\n\n      {/* Profile */}\n      <Card>\n        <div className=\"flex items-center gap-4 mb-6\">\n          <Avatar nome={cliente.nome} cognome={cliente.cognome} size=\"xl\" />\n          <div className=\"flex-1\">\n            <h1 className=\"text-2xl font-semibold text-white\">{cliente.nome} {cliente.cognome}</h1>\n            <div className=\"flex items-center gap-2 mt-1 flex-wrap\">\n              <StatusBadge status={cliente.stato} type=\"cliente\" />\n              {cliente.nazionalita && <span className=\"text-zinc-500 text-sm\">{cliente.nazionalita}</span>}\n              {cliente.assegnato_a && (\n                <span className=\"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full flex items-center gap-1\">\n                  <User className=\"w-3 h-3\" /> {cliente.assegnato_a}\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n        <QuickActions phone={cliente.telefono} whatsapp={cliente.whatsapp || cliente.telefono} email={cliente.email} clienteName={cliente.nome} />\n      </Card>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-3 gap-3\">\n        <Card padding=\"p-4\" className=\"text-center border-amber-500/20\">\n          <p className=\"text-2xl font-semibold text-amber-400\">{sales.length}</p>\n          <p className=\"text-zinc-500 text-sm\">Lead</p>\n        </Card>\n        <Card padding=\"p-4\" className=\"text-center border-emerald-500/20\">\n          <p className=\"text-2xl font-semibold text-emerald-400\">{fmt(totalValue)}</p>\n          <p className=\"text-zinc-500 text-sm\">Valore</p>\n        </Card>\n        <Card padding=\"p-4\" className=\"text-center border-pink-500/20\">\n          <p className=\"text-2xl font-semibold text-pink-400\">{tasks.filter(t => t.stato === 'pending').length}</p>\n          <p className=\"text-zinc-500 text-sm\">Task</p>\n        </Card>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-2 border-b border-[#334155]\">\n        {['info', 'lead', 'task'].map(t => (\n          <button key={t} onClick={() => setTab(t)} className={`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${tab === t ? 'text-white border-amber-500' : 'text-zinc-500 border-transparent hover:text-white'}`}>\n            {t === 'info' ? 'Informazioni' : t === 'lead' ? `Lead (${sales.length})` : `Task (${tasks.length})`}\n          </button>\n        ))}\n      </div>\n\n      {/* Tab Content */}\n      {tab === 'info' && (\n        <Card>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div><p className=\"text-zinc-500 text-xs mb-1\">Telefono</p><p className=\"text-white\">{cliente.telefono || '-'}</p></div>\n            <div><p className=\"text-zinc-500 text-xs mb-1\">Email</p><p className=\"text-white truncate\">{cliente.email || '-'}</p></div>\n            <div><p className=\"text-zinc-500 text-xs mb-1\">Budget Min</p><p className=\"text-amber-400\">{cliente.budget_min ? fmt(cliente.budget_min) : '-'}</p></div>\n            <div><p className=\"text-zinc-500 text-xs mb-1\">Budget Max</p><p className=\"text-amber-400\">{cliente.budget_max ? fmt(cliente.budget_max) : '-'}</p></div>\n            <div><p className=\"text-zinc-500 text-xs mb-1\">Assegnato a</p><p className=\"text-blue-400\">{cliente.assegnato_a || '-'}</p></div>\n            <div><p className=\"text-zinc-500 text-xs mb-1\">Agente Rif.</p><p className=\"text-white\">{cliente.agente_riferimento || '-'}</p></div>\n            <div><p className=\"text-zinc-500 text-xs mb-1\">Fonte</p><p className=\"text-white\">{cliente.fonte || '-'}</p></div>\n          </div>\n          {cliente.note && <div className=\"mt-4 pt-4 border-t border-[#334155]\"><p className=\"text-zinc-500 text-xs mb-1\">Note</p><p className=\"text-white text-sm\">{cliente.note}</p></div>}\n          <div className=\"mt-4 pt-4 border-t border-[#334155]\">\n            <p className=\"text-zinc-500 text-xs mb-2\">Stato</p>\n            <div className=\"flex flex-wrap gap-2\">\n              {clienteStati.map(s => (\n                <button key={s} onClick={() => updateCliente(cliente.id, { stato: s })} className={`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${cliente.stato === s ? 'bg-amber-500 text-black' : 'bg-zinc-700/50 text-zinc-400 hover:text-white'}`}>{s}</button>\n              ))}\n            </div>\n          </div>\n        </Card>\n      )}\n\n      {tab === 'lead' && (\n        <div className=\"space-y-2\">\n          {sales.length === 0 ? <EmptyState icon={Target} title=\"Nessun lead\" description=\"Non ci sono lead per questo cliente\" /> : sales.map(s => (\n            <Card key={s.id} padding=\"p-4\">\n              <div className=\"flex justify-between items-start\">\n                <div>\n                  <div className=\"flex items-center gap-2\"><p className=\"text-white font-medium\">{s.progetto}</p><StatusBadge status={s.stato || 'lead'} /></div>\n                  <p className=\"text-zinc-500 text-sm\">{s.developer} • {s.zona}</p>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-white font-medium\">{s.valore > 0 ? fmt(s.valore) : 'TBD'}</p>\n                  <p className=\"text-zinc-500 text-xs\">{fmtShort(s.data)}</p>\n                </div>\n              </div>\n            </Card>\n          ))}\n        </div>\n      )}\n\n      {tab === 'task' && (\n        <div className=\"space-y-3\">\n          <Button icon={Plus} onClick={onAddTask} className=\"w-full\" variant=\"secondary\">Nuovo Task</Button>\n          {tasks.length === 0 ? <EmptyState icon={ListTodo} title=\"Nessun task\" description=\"Non ci sono task per questo cliente\" /> : tasks.map(t => (\n            <Card key={t.id} padding=\"p-4\" className={t.stato === 'completato' ? 'opacity-50' : isOverdue(t.scadenza) ? 'border-red-500/30' : ''}>\n              <div className=\"flex justify-between items-start\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2\">\n                    <p className={`text-white font-medium ${t.stato === 'completato' ? 'line-through' : ''}`}>{t.titolo}</p>\n                    <StatusBadge status={t.priorita} type=\"priority\" />\n                  </div>\n                  {t.scadenza && <p className={`text-sm mt-1 ${isOverdue(t.scadenza) && t.stato !== 'completato' ? 'text-red-400' : 'text-zinc-500'}`}>{fmtDateTime(t.scadenza)}</p>}\n                </div>\n                <div className=\"flex gap-1\">\n                  {t.stato !== 'completato' && <Button variant=\"ghost\" size=\"sm\" icon={Check} onClick={() => onCompleteTask(t.id)} />}\n                  <Button variant=\"ghost\" size=\"sm\" icon={Trash2} onClick={() => onDeleteTask(t.id)} />\n                </div>\n              </div>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Admin Tasks Tab\nfunction AdminTasksTab({ tasks, clienti, users, onComplete, onDelete, onEdit, onCreate }) {\n  const [filter, setFilter] = useState('pending');\n  const filtered = tasks.filter(t => {\n    if (filter === 'pending') return t.stato === 'pending';\n    if (filter === 'overdue') return t.stato === 'pending' && isOverdue(t.scadenza);\n    if (filter === 'today') return t.stato === 'pending' && isToday(t.scadenza);\n    if (filter === 'completed') return t.stato === 'completato';\n    return true;\n  });\n  const getCliente = (id) => clienti.find(c => c.id === id);\n  const counts = {\n    pending: tasks.filter(t => t.stato === 'pending').length,\n    overdue: tasks.filter(t => t.stato === 'pending' && isOverdue(t.scadenza)).length,\n    today: tasks.filter(t => t.stato === 'pending' && isToday(t.scadenza)).length\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-wrap gap-3 items-center\">\n        <Button icon={Plus} onClick={onCreate}>Nuovo Task</Button>\n        <div className=\"flex-1\" />\n        <div className=\"flex gap-2\">\n          {[\n            { id: 'pending', label: 'Pending', count: counts.pending, color: '#60A5FA' },\n            { id: 'overdue', label: 'Scaduti', count: counts.overdue, color: '#EF4444' },\n            { id: 'today', label: 'Oggi', count: counts.today, color: '#FBBF24' },\n            { id: 'completed', label: 'Fatto', color: '#34D399' }\n          ].map(f => (\n            <button key={f.id} onClick={() => setFilter(f.id)} className={`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${filter === f.id ? 'text-white' : 'text-zinc-500 hover:text-white'}`} style={filter === f.id ? { background: `${f.color}20`, color: f.color } : {}}>\n              {f.label} {f.count !== undefined && `(${f.count})`}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"space-y-2\">\n        {filtered.length === 0 ? (\n          <EmptyState icon={ListTodo} title=\"Nessun task\" description={filter === 'pending' ? 'Tutti i task sono completati!' : 'Nessun task in questa categoria'} />\n        ) : filtered.map(t => {\n          const cliente = getCliente(t.cliente_id);\n          return (\n            <Card key={t.id} padding=\"p-4\" className={`${t.stato === 'completato' ? 'opacity-50' : ''} ${isOverdue(t.scadenza) && t.stato !== 'completato' ? 'border-red-500/30 bg-red-500/5' : ''}`}>\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 flex-wrap mb-1\">\n                    <p className={`text-white font-medium ${t.stato === 'completato' ? 'line-through' : ''}`}>{t.titolo}</p>\n                    <StatusBadge status={t.priorita} type=\"priority\" />\n                    {isOverdue(t.scadenza) && t.stato !== 'completato' && <span className=\"px-2 py-0.5 rounded text-xs bg-red-500/20 text-red-400 animate-pulse\">Scaduto</span>}\n                  </div>\n                  {t.descrizione && <p className=\"text-zinc-500 text-sm\">{t.descrizione}</p>}\n                  {t.note && <p className=\"text-blue-400 text-sm mt-1 bg-blue-500/10 px-2 py-1 rounded\">📝 {t.note}</p>}\n                  <div className=\"flex items-center gap-4 mt-2 text-xs\">\n                    {t.scadenza && <span className={`flex items-center gap-1 ${isOverdue(t.scadenza) && t.stato !== 'completato' ? 'text-red-400' : 'text-zinc-500'}`}><Clock className=\"w-3 h-3\" />{fmtDateTime(t.scadenza)}</span>}\n                    {t.assegnato_a && <span className=\"text-blue-400 flex items-center gap-1\"><User className=\"w-3 h-3\" />{t.assegnato_a}</span>}\n                    {cliente && <span className=\"text-amber-400\">{cliente.nome}</span>}\n                  </div>\n                </div>\n                <div className=\"flex gap-1\">\n                  {t.stato !== 'completato' && (\n                    <>\n                      <Button variant=\"ghost\" size=\"sm\" icon={Edit2} onClick={() => onEdit(t)} />\n                      <Button variant=\"ghost\" size=\"sm\" icon={Check} onClick={() => onComplete(t.id)} />\n                    </>\n                  )}\n                  <Button variant=\"ghost\" size=\"sm\" icon={Trash2} onClick={() => onDelete(t.id)} />\n                </div>\n              </div>\n            </Card>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\n// Agent Tasks Tab\nfunction AgentTasksTab({ tasks, allTasks, clienti, onComplete, onAddNote }) {\n  const [filter, setFilter] = useState('pending');\n  const completedTasks = allTasks.filter(t => t.stato === 'completato');\n  const displayTasks = filter === 'completed' ? completedTasks : tasks.filter(t => filter === 'overdue' ? isOverdue(t.scadenza) : true);\n  const getCliente = (id) => clienti.find(c => c.id === id);\n\n  return (\n    <>\n      <SectionHeader icon={ListTodo} title=\"I tuoi Task\" accent=\"244,114,182\" />\n      \n      <div className=\"flex gap-2 mb-4\">\n        {[\n          { id: 'pending', label: 'Da fare', count: tasks.length },\n          { id: 'overdue', label: 'Scaduti', count: tasks.filter(t => isOverdue(t.scadenza)).length },\n          { id: 'completed', label: 'Completati', count: completedTasks.length }\n        ].map(f => (\n          <button key={f.id} onClick={() => setFilter(f.id)} className={`px-4 py-2 rounded-xl text-sm font-medium transition-all ${filter === f.id ? 'bg-pink-500/20 text-pink-400' : 'text-zinc-500 hover:text-white'}`}>\n            {f.label} ({f.count})\n          </button>\n        ))}\n      </div>\n\n      <div className=\"space-y-2\">\n        {displayTasks.length === 0 ? (\n          <EmptyState icon={Check} title={filter === 'pending' ? 'Tutto fatto!' : 'Nessun task'} description=\"Non ci sono task in questa categoria\" />\n        ) : displayTasks.map(t => {\n          const cliente = getCliente(t.cliente_id);\n          return (\n            <Card key={t.id} padding=\"p-4\" className={t.stato === 'completato' ? 'opacity-50' : isOverdue(t.scadenza) ? 'border-red-500/30' : ''}>\n              <div className=\"flex items-start gap-4\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-1\">\n                    <p className={`text-white font-medium ${t.stato === 'completato' ? 'line-through' : ''}`}>{t.titolo}</p>\n                    <StatusBadge status={t.priorita} type=\"priority\" />\n                    {isOverdue(t.scadenza) && t.stato !== 'completato' && <span className=\"px-2 py-0.5 rounded text-xs bg-red-500/20 text-red-400\">Scaduto</span>}\n                  </div>\n                  {t.descrizione && <p className=\"text-zinc-500 text-sm\">{t.descrizione}</p>}\n                  {t.note && <p className=\"text-blue-400 text-sm mt-2 bg-blue-500/10 px-3 py-2 rounded-lg\">📝 {t.note}</p>}\n                  <div className=\"flex items-center gap-4 mt-2 text-xs\">\n                    {t.scadenza && <span className={`flex items-center gap-1 ${isOverdue(t.scadenza) && t.stato !== 'completato' ? 'text-red-400' : 'text-zinc-500'}`}><Clock className=\"w-3 h-3\" />{fmtDateTime(t.scadenza)}</span>}\n                    {cliente && <span className=\"text-amber-400\">{cliente.nome}</span>}\n                  </div>\n                </div>\n                {t.stato !== 'completato' && (\n                  <div className=\"flex flex-col gap-2\">\n                    <button onClick={() => onAddNote(t)} className=\"w-10 h-10 rounded-xl bg-blue-500/10 text-blue-400 flex items-center justify-center hover:bg-blue-500/20 transition-colors\"><MessageCircle className=\"w-5 h-5\" /></button>\n                    <button onClick={() => onComplete(t.id)} className=\"w-10 h-10 rounded-xl bg-emerald-500/10 text-emerald-400 flex items-center justify-center hover:bg-emerald-500/20 transition-colors\"><Check className=\"w-5 h-5\" /></button>\n                  </div>\n                )}\n              </div>\n            </Card>\n          );\n        })}\n      </div>\n    </>\n  );\n}\n\n// Team Tab\nfunction TeamTab({ users, onCreate, onEdit, onDelete }) {\n  const [copiedId, setCopiedId] = useState(null);\n  const copy = (u) => {\n    navigator.clipboard.writeText(`KeyPrime\\n${getBaseUrl()}\\n${u.username} / ${u.password}`);\n    setCopiedId(u.id);\n    setTimeout(() => setCopiedId(null), 2000);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex justify-between items-center\">\n        <p className=\"text-zinc-500\">{users.length} membri</p>\n        <Button icon={UserPlus} onClick={onCreate}>Nuovo Utente</Button>\n      </div>\n\n      <div className=\"space-y-2\">\n        {users.map(u => (\n          <Card key={u.id} padding=\"p-4\">\n            <div className=\"flex items-center gap-4\">\n              <Avatar nome={u.nome} size=\"lg\" />\n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-2\">\n                  <p className=\"text-white font-medium\">{u.nome}</p>\n                  <span className={`px-2 py-0.5 rounded-full text-xs ${u.ruolo === 'admin' ? 'bg-violet-500/20 text-violet-400' : u.ruolo === 'agente_admin' ? 'bg-purple-500/20 text-purple-400' : u.ruolo === 'agente' ? 'bg-blue-500/20 text-blue-400' : 'bg-emerald-500/20 text-emerald-400'}`}>{u.ruolo === 'agente_admin' ? 'Ag. Admin' : u.ruolo}</span>\n                  {!u.attivo && <span className=\"px-2 py-0.5 rounded-full text-xs bg-red-500/20 text-red-400\">Disattivo</span>}\n                </div>\n                <p className=\"text-zinc-500 text-sm mt-1\">{u.username} / {u.password}{u.email && ` • ${u.email}`}</p>\n              </div>\n              <div className=\"flex gap-2\">\n                <Button variant=\"ghost\" size=\"sm\" icon={copiedId === u.id ? Check : Copy} onClick={() => copy(u)} />\n                <Button variant=\"ghost\" size=\"sm\" icon={Edit2} onClick={() => onEdit(u)} />\n                {u.ruolo !== 'admin' && <Button variant=\"ghost\" size=\"sm\" icon={Trash2} onClick={() => onDelete(u.id)} />}\n              </div>\n            </div>\n          </Card>\n        ))}\n      </div>\n    </div>\n  );\n}\n\n// Agent Detail View\nfunction AgentDetailView({ agent, sales, onBack }) {\n  const agentSales = sales.filter(s => \n    agent.type === 'agente' ? s.agente === agent.name : s.segnalatore === agent.name\n  );\n  const vendite = agentSales.filter(s => s.stato === 'venduto' || s.stato === 'incassato');\n  const totalVolume = agentSales.reduce((sum, s) => sum + Number(s.valore || 0), 0);\n  const totalVendite = vendite.reduce((sum, s) => sum + Number(s.valore || 0), 0);\n  const rate = agent.type === 'agente' ? 0.7 : 0.3;\n  const totalComm = vendite.reduce((sum, s) => sum + (Number(s.valore || 0) * (s.commission_pct || 5) / 100 * rate), 0);\n  const commPagate = vendite.filter(s => s.pagato).reduce((sum, s) => sum + (Number(s.valore || 0) * (s.commission_pct || 5) / 100 * rate), 0);\n  \n  const byStato = pipelineStati.reduce((a, st) => { \n    a[st] = agentSales.filter(s => (s.stato || 'lead') === st).length; \n    return a; \n  }, {});\n  \n  const byZona = agentSales.reduce((a, s) => { \n    if (s.zona) a[s.zona] = (a[s.zona] || 0) + Number(s.valore || 0); \n    return a; \n  }, {});\n  \n  const byMonth = agentSales.reduce((a, s) => { \n    const m = s.data?.substring(0, 7) || 'N/A'; \n    a[m] = (a[m] || 0) + Number(s.valore || 0); \n    return a; \n  }, {});\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-[#0f172a] overflow-auto\">\n      <div className=\"max-w-4xl mx-auto p-6\">\n        {/* Header */}\n        <div className=\"flex items-center gap-4 mb-8\">\n          <Button variant=\"ghost\" icon={ChevronLeft} onClick={onBack}>Indietro</Button>\n          <div className=\"flex-1\" />\n        </div>\n        \n        {/* Profile */}\n        <div className=\"flex items-center gap-4 mb-8\">\n          <Avatar nome={agent.name} size=\"xl\" />\n          <div>\n            <h1 className=\"text-2xl font-semibold text-white\">{agent.name}</h1>\n            <p className=\"text-zinc-500 capitalize\">{agent.type}</p>\n          </div>\n        </div>\n        \n        {/* Stats */}\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n          <Card>\n            <p className=\"text-zinc-500 text-sm\">Volume Totale</p>\n            <p className=\"text-2xl font-semibold text-white mt-1\">{fmt(totalVolume)}</p>\n            <p className=\"text-zinc-600 text-xs\">AED</p>\n          </Card>\n          <Card>\n            <p className=\"text-zinc-500 text-sm\">Lead</p>\n            <p className=\"text-2xl font-semibold text-blue-400 mt-1\">{agentSales.length}</p>\n          </Card>\n          <Card>\n            <p className=\"text-zinc-500 text-sm\">Vendite Chiuse</p>\n            <p className=\"text-2xl font-semibold text-emerald-400 mt-1\">{vendite.length}</p>\n            <p className=\"text-zinc-600 text-xs\">{fmt(totalVendite)} AED</p>\n          </Card>\n          <Card>\n            <p className=\"text-zinc-500 text-sm\">Commissioni</p>\n            <p className=\"text-2xl font-semibold text-amber-400 mt-1\">{fmt(totalComm)}</p>\n            <p className=\"text-emerald-400 text-xs\">Pagate: {fmt(commPagate)}</p>\n          </Card>\n        </div>\n        \n        {/* Pipeline */}\n        <Card className=\"mb-6\">\n          <h3 className=\"text-white font-semibold mb-4\">Pipeline</h3>\n          <div className=\"grid grid-cols-5 gap-2\">\n            {pipelineStati.map(st => (\n              <div key={st} className=\"text-center p-3 rounded-xl\" style={{ background: theme.status[st]?.bg }}>\n                <div className=\"text-xl font-semibold text-white\">{byStato[st] || 0}</div>\n                <div className=\"text-xs\" style={{ color: theme.status[st]?.color }}>{pipelineLabels[st] || st}</div>\n              </div>\n            ))}\n          </div>\n        </Card>\n        \n        {/* Charts */}\n        <div className=\"grid lg:grid-cols-2 gap-4 mb-6\">\n          <Card>\n            <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\">\n              <MapPin className=\"w-4 h-4 text-emerald-400\" />Zone\n            </h3>\n            <div className=\"space-y-2\">\n              {Object.entries(byZona).sort((a, b) => b[1] - a[1]).slice(0, 5).map(([zona, value]) => (\n                <div key={zona} className=\"flex items-center gap-3\">\n                  <span className=\"text-zinc-400 text-sm w-24 truncate\">{zona}</span>\n                  <div className=\"flex-1\"><ProgressBar value={value} max={Object.values(byZona).sort((a,b)=>b-a)[0] || 1} color=\"#34D399\" /></div>\n                  <span className=\"text-white text-sm w-20 text-right\">{fmt(value)}</span>\n                </div>\n              ))}\n              {Object.keys(byZona).length === 0 && <p className=\"text-zinc-500 text-sm\">Nessun dato</p>}\n            </div>\n          </Card>\n          \n          <Card>\n            <h3 className=\"text-white font-semibold mb-4 flex items-center gap-2\">\n              <TrendingUp className=\"w-4 h-4 text-violet-400\" />Trend\n            </h3>\n            <div className=\"space-y-2\">\n              {Object.entries(byMonth).sort((a, b) => a[0].localeCompare(b[0])).slice(-5).map(([month, value]) => (\n                <div key={month} className=\"flex items-center gap-3\">\n                  <span className=\"text-zinc-400 text-sm w-16\">{month}</span>\n                  <div className=\"flex-1\"><ProgressBar value={value} max={Math.max(...Object.values(byMonth)) || 1} color=\"#A78BFA\" /></div>\n                  <span className=\"text-white text-sm w-20 text-right\">{fmt(value)}</span>\n                </div>\n              ))}\n              {Object.keys(byMonth).length === 0 && <p className=\"text-zinc-500 text-sm\">Nessun dato</p>}\n            </div>\n          </Card>\n        </div>\n        \n        {/* Recent Sales */}\n        <Card>\n          <h3 className=\"text-white font-semibold mb-4\">Ultimi Lead</h3>\n          <div className=\"space-y-2\">\n            {agentSales.slice(0, 10).map(s => (\n              <div key={s.id} className=\"flex items-center gap-3 p-3 bg-zinc-700/50/50 rounded-xl\">\n                <div className=\"w-1 h-10 rounded-full\" style={{ background: theme.status[s.stato || 'lead']?.color }} />\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"text-white text-sm font-medium truncate\">{s.progetto || 'TBD'}</p>\n                  <p className=\"text-zinc-500 text-xs\">{s.developer} • {s.zona}</p>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-white text-sm font-medium\">{s.valore > 0 ? fmt(s.valore) : 'TBD'}</p>\n                  <p className=\"text-xs\" style={{ color: theme.status[s.stato || 'lead']?.color }}>{s.stato || 'lead'}</p>\n                </div>\n              </div>\n            ))}\n            {agentSales.length === 0 && <p className=\"text-zinc-500 text-sm text-center py-4\">Nessun lead</p>}\n          </div>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\n// ==================== MODALS & FORMS ====================\n\n\n// Leaflet Map Component - Airbnb Style\nfunction MapboxMap({ projects, onSelectProject, selectedProject, onAreaClick }) {\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n  const markersLayer = useRef(null);\n  const markersMap = useRef({});\n  const [mapLoaded, setMapLoaded] = useState(false);\n  const [mapError, setMapError] = useState(null);\n  const [popupProject, setPopupProject] = useState(null);\n\n  const projectsByLocation = React.useMemo(() => {\n    const grouped = {};\n    projects.forEach(p => {\n      // Try to use real coordinates first (from allMapProjects)\n      let coords = null;\n      if (p.coordinates?.lat && p.coordinates?.lon) {\n        coords = { lat: p.coordinates.lat, lng: p.coordinates.lon, zoom: 14 };\n      } else {\n        // Fallback to location name lookup\n        const locName = p.location?.full_name || p.location?.name || 'Unknown';\n        coords = getLocationCoords(locName);\n      }\n      \n      if (coords) {\n        // Add small random offset to prevent overlap\n        const offsetLat = (Math.random() - 0.5) * 0.008;\n        const offsetLng = (Math.random() - 0.5) * 0.008;\n        grouped[p.project_id] = { \n          ...p, \n          coords: { \n            lat: coords.lat + offsetLat, \n            lng: coords.lng + offsetLng,\n            zoom: coords.zoom \n          } \n        };\n      }\n    });\n    return grouped;\n  }, [projects]);\n\n  // Load Leaflet\n  useEffect(() => {\n    if (!mapContainer.current || map.current) return;\n    \n    if (!document.getElementById('leaflet-css')) {\n      const link = document.createElement('link');\n      link.id = 'leaflet-css';\n      link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n      link.rel = 'stylesheet';\n      document.head.appendChild(link);\n    }\n\n    if (!window.L) {\n      const script = document.createElement('script');\n      script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\n      script.async = true;\n      script.onload = () => setTimeout(initMap, 100);\n      script.onerror = () => setMapError('Errore caricamento Leaflet');\n      document.head.appendChild(script);\n    } else {\n      setTimeout(initMap, 100);\n    }\n\n    function initMap() {\n      if (!mapContainer.current || map.current) return;\n      try {\n        map.current = window.L.map(mapContainer.current, {\n          center: [DUBAI_CENTER.lat, DUBAI_CENTER.lng],\n          zoom: DEFAULT_ZOOM,\n          zoomControl: false\n        });\n\n        window.L.control.zoom({ position: 'bottomright' }).addTo(map.current);\n\n        window.L.tileLayer(LEAFLET_TILE_URL, {\n          attribution: LEAFLET_ATTRIBUTION,\n          maxZoom: 19\n        }).addTo(map.current);\n\n        markersLayer.current = window.L.layerGroup().addTo(map.current);\n        setMapLoaded(true);\n      } catch (err) {\n        console.error('Map init error:', err);\n        setMapError('Errore inizializzazione mappa');\n      }\n    }\n\n    return () => {\n      if (map.current) {\n        map.current.remove();\n        map.current = null;\n      }\n    };\n  }, []);\n\n  // Add markers - PropertyFinder style red price pills\n  useEffect(() => {\n    if (!map.current || !mapLoaded || !window.L || !markersLayer.current) return;\n\n    markersLayer.current.clearLayers();\n    markersMap.current = {};\n\n    Object.values(projectsByLocation).forEach(project => {\n      const { coords } = project;\n      const price = project.price_from;\n      const priceText = price > 0 ? 'From ' + (price >= 1000000 ? (price/1000000).toFixed(1) + 'M' : Math.round(price/1000) + 'K') : 'Price TBD';\n      const isSelected = selectedProject?.project_id === project.project_id;\n      \n      const iconHtml = `\n        <div class=\"pf-marker ${isSelected ? 'selected' : ''}\">\n          <span>${priceText}</span>\n        </div>\n      `;\n\n      const customIcon = window.L.divIcon({\n        html: iconHtml,\n        className: 'pf-marker-container',\n        iconSize: [90, 28],\n        iconAnchor: [45, 28]\n      });\n\n      const marker = window.L.marker([coords.lat, coords.lng], { icon: customIcon })\n        .addTo(markersLayer.current);\n\n      marker.on('click', (e) => {\n        // Stop event propagation to prevent map click handler\n        window.L.DomEvent.stopPropagation(e);\n        setJustOpened(true);\n        setPopupProject(project);\n        // Reset after a tick\n        setTimeout(() => setJustOpened(false), 100);\n      });\n\n      markersMap.current[project.project_id] = marker;\n    });\n  }, [mapLoaded, projectsByLocation, selectedProject, onSelectProject]);\n\n  // Fly to selected project\n  useEffect(() => {\n    if (!map.current || !mapLoaded || !selectedProject) return;\n    const project = projectsByLocation[selectedProject.project_id];\n    if (project?.coords) {\n      map.current.flyTo([project.coords.lat, project.coords.lng], 14, { duration: 0.5 });\n    }\n  }, [selectedProject, mapLoaded, projectsByLocation]);\n\n  // Close popup when clicking elsewhere\n  // Close popup when clicking elsewhere, but not immediately after opening\n  const [justOpened, setJustOpened] = useState(false);\n  const handleMapClick = () => {\n    if (!justOpened) {\n      setPopupProject(null);\n    }\n    setJustOpened(false);\n  };\n\n  const formatPrice = (price) => {\n    if (!price || price === 0) return 'TBD';\n    return parseFloat(price).toLocaleString();\n  };\n\n  if (mapError) {\n    return (\n      <div className=\"w-full h-full bg-zinc-800 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <AlertCircle className=\"w-12 h-12 text-red-400 mx-auto mb-3\" />\n          <p className=\"text-red-400\">{mapError}</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative w-full h-full\" onClick={handleMapClick}>\n      <div ref={mapContainer} className=\"absolute inset-0\" style={{ background: '#1a1a1a' }} />\n      \n      {!mapLoaded && (\n        <div className=\"absolute inset-0 bg-zinc-800 flex items-center justify-center z-[1000]\">\n          <RefreshCw className=\"w-8 h-8 text-orange-400 animate-spin\" />\n        </div>\n      )}\n\n      {/* Project Popup Card - Airbnb style */}\n      {popupProject && (\n        <div className=\"absolute top-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-[1000] animate-fadeIn\">\n          <div className=\"bg-zinc-800 border border-zinc-700 rounded-2xl overflow-hidden shadow-2xl\">\n            <div className=\"relative h-40\">\n              {popupProject.images?.[0]?.medium_image_url ? (\n                <img src={popupProject.images[0].medium_image_url} alt=\"\" className=\"w-full h-full object-cover\" />\n              ) : (\n                <div className=\"w-full h-full bg-zinc-700/50 flex items-center justify-center\">\n                  <Building2 className=\"w-12 h-12 text-zinc-600\" />\n                </div>\n              )}\n              <button onClick={(e) => { e.stopPropagation(); setPopupProject(null); }} className=\"absolute top-2 right-2 p-1.5 bg-zinc-800/50 rounded-full text-white hover:bg-zinc-800/70\">\n                <X className=\"w-4 h-4\" />\n              </button>\n              <div className=\"absolute bottom-2 left-2 px-2 py-1 bg-orange-500 text-white text-xs font-medium rounded-lg\">\n                {popupProject.construction_phase_key === 'completed' ? '✓ Completato' : popupProject.construction_phase_key === 'under_construction' ? '🏗️ In Costruzione' : '🚀 Lancio'}\n              </div>\n            </div>\n            <div className=\"p-4\">\n              <h3 className=\"text-white font-semibold truncate\">{popupProject.title}</h3>\n              <p className=\"text-zinc-400 text-sm truncate\">{popupProject.location?.full_name || popupProject.location?.name}</p>\n              <div className=\"flex items-center justify-between mt-3\">\n                <p className=\"text-orange-400 font-bold\">{popupProject.price_from > 0 ? 'AED ' + formatPrice(popupProject.price_from) : 'TBD'}</p>\n                {popupProject.url ? (\n                  <a href={popupProject.url} target=\"_blank\" rel=\"noopener noreferrer\" onClick={(e) => e.stopPropagation()} className=\"px-3 py-1.5 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium rounded-lg flex items-center gap-1\">\n                    <ExternalLink className=\"w-3.5 h-3.5\" /> PropertyFinder\n                  </a>\n                ) : (\n                  <Button size=\"sm\" onClick={(e) => { e.stopPropagation(); setPopupProject(null); }}>\n                    Chiudi\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Map Stats */}\n      <div className=\"absolute bottom-4 left-4 z-[1000]\">\n        <div className=\"bg-zinc-800/90 backdrop-blur border border-zinc-700 rounded-xl px-3 py-2\">\n          <p className=\"text-white text-sm font-medium\">{Object.keys(projectsByLocation).length} progetti sulla mappa</p>\n        </div>\n      </div>\n\n      <style>{`\n        .pf-marker-container { background: transparent !important; border: none !important; }\n        .pf-marker {\n          background: #DC2626;\n          color: white;\n          padding: 5px 10px;\n          border-radius: 4px;\n          font-size: 11px;\n          font-weight: 600;\n          box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n          cursor: pointer;\n          transition: all 0.15s ease;\n          white-space: nowrap;\n          text-align: center;\n        }\n        .pf-marker:hover {\n          background: #B91C1C;\n          transform: scale(1.05);\n          z-index: 1000 !important;\n        }\n        .pf-marker.selected {\n          background: #1D4ED8;\n          transform: scale(1.1);\n          z-index: 1001 !important;\n        }\n        .leaflet-control-zoom { border: none !important; border-radius: 8px !important; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.2); }\n        .leaflet-control-zoom a { \n          background: white !important; \n          color: #333 !important; \n          border: none !important;\n          border-bottom: 1px solid #eee !important;\n          width: 32px !important;\n          height: 32px !important;\n          line-height: 32px !important;\n        }\n        .leaflet-control-zoom a:hover { background: #f5f5f5 !important; }\n        .leaflet-control-zoom-in { border-radius: 8px 8px 0 0 !important; }\n        .leaflet-control-zoom-out { border-radius: 0 0 8px 8px !important; border-bottom: none !important; }\n      `}</style>\n    </div>\n  );\n}\n\n// Project Card Compact for Split View - with hover sync\nfunction ProjectCardCompact({ project, isSelected, onClick, onHover }) {\n  const formatPrice = (price) => { if (!price || price === 0) return 'TBD'; const num = parseFloat(price); if (num >= 1000000) return (num/1000000).toFixed(1) + 'M'; return num.toLocaleString(); };\n  const formatBedrooms = (bedrooms) => { if (!bedrooms?.available?.length) return null; const beds = bedrooms.available; if (beds.length === 1) return beds[0] === 0 ? 'Studio' : beds[0] + 'BR'; const min = Math.min(...beds); const max = Math.max(...beds); return min === 0 ? 'Studio-' + max + 'BR' : min + '-' + max + 'BR'; };\n  const formatDelivery = (d) => { if (!d) return null; const date = new Date(d); return 'Q' + Math.ceil((date.getMonth()+1)/3) + ' ' + date.getFullYear(); };\n  return (\n    <div \n      onClick={onClick} \n      onMouseEnter={() => onHover && onHover(project.project_id)}\n      onMouseLeave={() => onHover && onHover(null)}\n      className={'p-3 rounded-xl cursor-pointer transition-all ' + (isSelected ? 'bg-orange-500/20 border-2 border-orange-500' : 'bg-zinc-700/50/50 border border-transparent hover:bg-zinc-700/50 hover:border-zinc-600')}\n    >\n      <div className=\"flex gap-3\">\n        <div className=\"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700\">\n          {project.images?.[0]?.medium_image_url ? (\n            <img src={project.images[0].medium_image_url} alt=\"\" className=\"w-full h-full object-cover\" />\n          ) : (\n            <div className=\"w-full h-full flex items-center justify-center\"><Building2 className=\"w-8 h-8 text-zinc-600\" /></div>\n          )}\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <p className=\"text-white font-medium text-sm truncate\">{project.title}</p>\n          <p className=\"text-zinc-500 text-xs truncate\">{project.location?.full_name}</p>\n          <div className=\"flex items-center gap-2 mt-1.5\">\n            <p className=\"text-orange-400 font-bold text-sm\">{project.price_from > 0 ? 'AED ' + formatPrice(project.price_from) : 'TBD'}</p>\n            {formatBedrooms(project.bedrooms) && <span className=\"text-zinc-500 text-xs\">• {formatBedrooms(project.bedrooms)}</span>}\n          </div>\n          <div className=\"flex items-center gap-2 mt-1\">\n            {formatDelivery(project.delivery_date) && <span className=\"text-xs text-blue-400\">📅 {formatDelivery(project.delivery_date)}</span>}\n            {project.developer?.name && <span className=\"text-xs text-zinc-500 truncate\">• {project.developer.name}</span>}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Off-Plan Tab with Map Integration - NOW USES SUPABASE\nfunction OffPlanTab({ clienti, onCreateLead, savedListings, onSaveListing, onRemoveListing, user }) {\n  const [viewMode, setViewMode] = useState('list');\n  const [listings, setListings] = useState([]);\n  const [allMapProjects, setAllMapProjects] = useState([]); // All projects for map\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [filters, setFilters] = useState({ \n    search: '', \n    location: '', \n    emirate: '', // NEW: emirate filter\n    minPrice: '', \n    maxPrice: '', \n    bedrooms: '', \n    developer: '',\n    status: '', // completed, under_construction, launch\n    deliveryYear: '',\n    sortBy: 'hotness' // hotness, price_asc, price_desc, delivery\n  });\n  const [selectedListing, setSelectedListing] = useState(null);\n  const [showAssignModal, setShowAssignModal] = useState(null);\n  const [page, setPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [totalResults, setTotalResults] = useState(0);\n  const [selectedAreaProjects, setSelectedAreaProjects] = useState(null);\n  const [selectedAreaName, setSelectedAreaName] = useState('');\n  const [stats, setStats] = useState({ byZone: [], byDeveloper: [], avgPrice: 0 });\n  const [showStats, setShowStats] = useState(false);\n  \n  const ITEMS_PER_PAGE = 24;\n\n  const emirates = ['Dubai', 'Abu Dhabi', 'Ras Al Khaimah', 'Sharjah', 'Ajman', 'Umm Al Quwain'];\n  \n  const zonesByEmirate = {\n    'Dubai': ['Dubai Marina', 'Downtown Dubai', 'Business Bay', 'Palm Jumeirah', 'JBR', 'Dubai Hills Estate', \n      'Mohammed Bin Rashid City', 'Dubai Creek Harbour', 'Jumeirah Village Circle', 'JVC', 'JLT',\n      'Dubai South', 'DAMAC Hills', 'DAMAC Hills 2', 'Arabian Ranches', 'Meydan', 'DIFC', \n      'Dubai Islands', 'Expo City', 'City Walk', 'Sobha Hartland', 'Tilal Al Ghaf', 'The Valley',\n      'Motor City', 'Sports City', 'Al Furjan', 'Discovery Gardens', 'International City',\n      'Dubai Silicon Oasis', 'Arjan', 'Al Barsha', 'Jumeirah', 'Umm Suqeim', 'Al Quoz', 'Deira', 'Bur Dubai'],\n    'Abu Dhabi': ['Yas Island', 'Saadiyat Island', 'Al Reem Island', 'Al Raha Beach', 'Khalifa City', 'Masdar City', 'Al Ghadeer', 'Al Shamkha', 'Corniche'],\n    'Ras Al Khaimah': ['Al Marjan Island', 'Mina Al Arab', 'Al Hamra Village', 'Hayat Island', 'RAK Central', 'Yasmin Village'],\n    'Sharjah': ['Aljada', 'Al Mamzar Sharjah', 'Al Nahda Sharjah', 'Al Majaz', 'Muwaileh', 'Al Khan'],\n    'Ajman': ['Ajman Downtown', 'Ajman Corniche', 'Al Rashidiya', 'Al Nuaimiya', 'Emirates City'],\n    'Umm Al Quwain': ['UAQ Marina', 'UAQ Corniche', 'Al Salamah']\n  };\n  \n  // Get zones based on selected emirate or all\n  const availableZones = filters.emirate ? zonesByEmirate[filters.emirate] || [] : Object.values(zonesByEmirate).flat();\n  \n  const topDevelopers = ['Emaar Properties', 'Damac Properties', 'Sobha Realty', 'Nakheel', 'Meraas', 'Aldar Properties', 'Azizi Developments', 'Binghatti', 'Ellington', 'Omniyat Group', 'Danube Properties', 'Select Group', 'Deyaar', 'MAG', 'Reportage Properties'];\n  const bedroomOptions = ['Studio', '1', '2', '3', '4', '5+'];\n  const statusOptions = [\n    { value: '', label: 'Tutti gli stati' },\n    { value: 'completed', label: 'Completato' },\n    { value: 'under_construction', label: 'In Costruzione' },\n    { value: 'launch', label: 'Lancio' }\n  ];\n  const deliveryYears = ['2024', '2025', '2026', '2027', '2028', '2029', '2030'];\n  const sortOptions = [\n    { value: 'hotness', label: 'Più popolari' },\n    { value: 'price_asc', label: 'Prezzo ↑' },\n    { value: 'price_desc', label: 'Prezzo ↓' },\n    { value: 'delivery', label: 'Consegna più vicina' }\n  ];\n\n  // Load stats on mount\n  useEffect(() => {\n    loadStats();\n    loadAllMapProjects();\n  }, []);\n\n  const loadStats = async () => {\n    try {\n      // Get projects by zone (excluding completed)\n      const { data: zoneData } = await supabase\n        .from('pf_projects')\n        .select('location_name, price_from')\n        .neq('construction_phase', 'completed');\n      \n      if (zoneData) {\n        // Group by zone\n        const zoneMap = {};\n        let totalPrice = 0;\n        let priceCount = 0;\n        \n        zoneData.forEach(p => {\n          const zone = p.location_name || 'Altro';\n          if (!zoneMap[zone]) zoneMap[zone] = { count: 0, totalPrice: 0 };\n          zoneMap[zone].count++;\n          if (p.price_from > 0) {\n            zoneMap[zone].totalPrice += p.price_from;\n            totalPrice += p.price_from;\n            priceCount++;\n          }\n        });\n        \n        const byZone = Object.entries(zoneMap)\n          .map(([name, data]) => ({ name, count: data.count, avgPrice: data.totalPrice / data.count || 0 }))\n          .sort((a, b) => b.count - a.count)\n          .slice(0, 10);\n        \n        setStats(s => ({ ...s, byZone, avgPrice: totalPrice / priceCount || 0 }));\n      }\n      \n      // Get projects by developer (excluding completed)\n      const { data: devData } = await supabase\n        .from('pf_projects')\n        .select('developer_name')\n        .not('developer_name', 'is', null)\n        .neq('construction_phase', 'completed');\n      \n      if (devData) {\n        const devMap = {};\n        devData.forEach(p => {\n          const dev = p.developer_name;\n          devMap[dev] = (devMap[dev] || 0) + 1;\n        });\n        \n        const byDeveloper = Object.entries(devMap)\n          .map(([name, count]) => ({ name, count }))\n          .sort((a, b) => b.count - a.count)\n          .slice(0, 10);\n        \n        setStats(s => ({ ...s, byDeveloper }));\n      }\n    } catch (err) {\n      console.error('Stats error:', err);\n    }\n  };\n\n  // Load all projects with coordinates for map (excluding completed)\n  const loadAllMapProjects = async () => {\n    try {\n      const { data } = await supabase\n        .from('pf_projects')\n        .select('project_id, title, location_name, location_full, price_from, construction_phase, url, raw_data')\n        .neq('construction_phase', 'completed')\n        .not('raw_data->location->coordinates', 'is', null)\n        .limit(2000);\n      \n      if (data) {\n        const mapProjects = data.map(p => ({\n          project_id: p.project_id,\n          title: p.title,\n          location: { name: p.location_name, full_name: p.location_full },\n          price_from: p.price_from,\n          construction_phase_key: p.construction_phase,\n          url: p.url,\n          images: p.raw_data?.images,\n          coordinates: p.raw_data?.location?.coordinates\n        })).filter(p => p.coordinates?.lat && p.coordinates?.lon);\n        \n        setAllMapProjects(mapProjects);\n      }\n    } catch (err) {\n      console.error('Map projects error:', err);\n    }\n  };\n\n  // Search from Supabase with real SQL filters\n  const searchListings = async (newPage = 1) => {\n    setLoading(true); \n    setError(null);\n    setPage(newPage);\n    \n    try {\n      // Build query with filters\n      let query = supabase\n        .from('pf_projects')\n        .select('*', { count: 'exact' });\n      \n      // EXCLUDE completed projects by default (they're not off-plan anymore)\n      // Only show completed if explicitly filtered\n      if (filters.status) {\n        query = query.eq('construction_phase', filters.status);\n      } else {\n        query = query.neq('construction_phase', 'completed');\n      }\n      \n      // Exclude projects with past delivery dates (before 2024)\n      query = query.or('delivery_date.is.null,delivery_date.gte.2024-01-01');\n      \n      // Apply filters\n      if (filters.search) {\n        query = query.or(`title.ilike.%${filters.search}%,location_full.ilike.%${filters.search}%,developer_name.ilike.%${filters.search}%`);\n      }\n      if (filters.emirate) {\n        query = query.ilike('location_full', `%${filters.emirate}%`);\n      }\n      if (filters.location) {\n        query = query.or(`location_name.ilike.%${filters.location}%,location_full.ilike.%${filters.location}%`);\n      }\n      if (filters.developer) {\n        query = query.ilike('developer_name', `%${filters.developer}%`);\n      }\n      if (filters.minPrice) {\n        query = query.gte('price_from', parseInt(filters.minPrice));\n      }\n      if (filters.maxPrice) {\n        query = query.lte('price_from', parseInt(filters.maxPrice));\n      }\n      if (filters.deliveryYear) {\n        const startDate = `${filters.deliveryYear}-01-01`;\n        const endDate = `${filters.deliveryYear}-12-31`;\n        query = query.gte('delivery_date', startDate).lte('delivery_date', endDate);\n      }\n      if (filters.bedrooms) {\n        if (filters.bedrooms === 'Studio') {\n          query = query.contains('bedrooms', { available: [0] });\n        } else if (filters.bedrooms !== '5+') {\n          query = query.contains('bedrooms', { available: [parseInt(filters.bedrooms)] });\n        }\n      }\n      \n      // Apply sorting\n      switch (filters.sortBy) {\n        case 'price_asc':\n          query = query.order('price_from', { ascending: true, nullsFirst: false });\n          break;\n        case 'price_desc':\n          query = query.order('price_from', { ascending: false, nullsFirst: false });\n          break;\n        case 'delivery':\n          query = query.order('delivery_date', { ascending: true, nullsFirst: false });\n          break;\n        default:\n          query = query.order('hotness_level', { ascending: false, nullsFirst: false });\n      }\n      \n      // Paginate\n      query = query.range((newPage - 1) * ITEMS_PER_PAGE, newPage * ITEMS_PER_PAGE - 1);\n      \n      const { data, error: queryError, count } = await query;\n      \n      if (queryError) throw queryError;\n      \n      // Transform data to match expected format\n      const transformedData = (data || []).map(p => ({\n        project_id: p.project_id,\n        title: p.title,\n        location: { \n          name: p.location_name, \n          full_name: p.location_full \n        },\n        developer: { \n          name: p.developer_name,\n          logo: p.raw_data?.developer?.logo\n        },\n        price_from: p.price_from,\n        bedrooms: p.bedrooms,\n        delivery_date: p.delivery_date,\n        construction_phase_key: p.construction_phase,\n        hotness_level: p.hotness_level,\n        images: p.images || [],\n        payment_plans: p.payment_plans,\n        url: p.url,\n        // Try to get brochure from data, or construct from project_id if it's a UUID\n        brochure_url: p.brochure_url || p.raw_data?.brochure?.url || p.raw_data?.brochure || \n          (p.project_id && p.project_id.includes('-') ? `https://new-projects-media.propertyfinder.com/project/${p.project_id}/brochure/application/original.pdf` : null)\n      }));\n      \n      // Additional client-side filter for 5+ bedrooms\n      let finalData = transformedData;\n      if (filters.bedrooms === '5+') {\n        finalData = transformedData.filter(p => \n          p.bedrooms?.available?.some(b => b >= 5)\n        );\n      }\n      \n      setListings(finalData);\n      setTotalResults(count || 0);\n      setTotalPages(Math.ceil((count || 0) / ITEMS_PER_PAGE));\n      \n    } catch (err) { \n      console.error('Supabase Error:', err); \n      setError('Errore nel caricamento progetti.'); \n    }\n    finally { \n      setLoading(false); \n    }\n  };\n\n  const handlePageChange = (newPage) => {\n    if (newPage >= 1 && newPage <= totalPages) {\n      searchListings(newPage);\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n  };\n\n  // Export filtered projects to CSV\n  const exportProjectsCSV = async () => {\n    try {\n      // Build same query as search but get all results\n      let query = supabase\n        .from('pf_projects')\n        .select('title, location_full, developer_name, price_from, construction_phase, delivery_date, url');\n      \n      if (filters.search) query = query.or(`title.ilike.%${filters.search}%,location_full.ilike.%${filters.search}%,developer_name.ilike.%${filters.search}%`);\n      if (filters.location) query = query.or(`location_name.ilike.%${filters.location}%,location_full.ilike.%${filters.location}%`);\n      if (filters.developer) query = query.ilike('developer_name', `%${filters.developer}%`);\n      if (filters.minPrice) query = query.gte('price_from', parseInt(filters.minPrice));\n      if (filters.maxPrice) query = query.lte('price_from', parseInt(filters.maxPrice));\n      if (filters.status) query = query.eq('construction_phase', filters.status);\n      if (filters.deliveryYear) {\n        query = query.gte('delivery_date', `${filters.deliveryYear}-01-01`).lte('delivery_date', `${filters.deliveryYear}-12-31`);\n      }\n      \n      query = query.order('hotness_level', { ascending: false }).limit(1000);\n      \n      const { data } = await query;\n      \n      if (!data?.length) return;\n      \n      const headers = ['Progetto', 'Location', 'Developer', 'Prezzo Da (AED)', 'Stato', 'Consegna', 'URL'];\n      const rows = data.map(p => [\n        p.title,\n        p.location_full,\n        p.developer_name,\n        p.price_from,\n        p.construction_phase === 'completed' ? 'Completato' : p.construction_phase === 'under_construction' ? 'In Costruzione' : 'Lancio',\n        p.delivery_date,\n        p.url\n      ]);\n      \n      const csv = [headers.join(','), ...rows.map(r => r.map(c => `\"${(c || '').toString().replace(/\"/g, '\"\"')}\"`).join(','))].join('\\n');\n      const blob = new Blob([csv], { type: 'text/csv' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `offplan-projects-${new Date().toISOString().split('T')[0]}.csv`;\n      a.click();\n      URL.revokeObjectURL(url);\n    } catch (err) {\n      console.error('Export error:', err);\n    }\n  };\n\n  useEffect(() => { searchListings(1); }, []);\n\n  const isListingSaved = (projectId) => savedListings?.some(s => s.property_id === projectId);\n  const formatPrice = (price) => { if (!price || price === 0) return 'TBD'; const num = parseFloat(price); if (num >= 1000000) return (num/1000000).toFixed(1) + 'M'; if (num >= 1000) return (num/1000).toFixed(0) + 'K'; return num.toLocaleString(); };\n  const formatBedrooms = (bedrooms) => { if (!bedrooms?.available?.length) return null; const beds = bedrooms.available; if (beds.length === 1) return beds[0] === 0 ? 'Studio' : beds[0] + ' BR'; const min = Math.min(...beds); const max = Math.max(...beds); return min === 0 ? 'Studio - ' + max + ' BR' : min + ' - ' + max + ' BR'; };\n  const formatDelivery = (dateStr) => { if (!dateStr) return null; const date = new Date(dateStr); const quarter = Math.ceil((date.getMonth() + 1) / 3); return 'Q' + quarter + ' ' + date.getFullYear(); };\n  const formatPaymentPlan = (plans) => { if (!plans?.plans?.[0]) return null; const plan = plans.plans[0].summary; return plan.down_payment + '/' + plan.during_construction + '/' + plan.handover; };\n  const handleAreaClick = (projects, areaName) => { setSelectedAreaProjects(projects); setSelectedAreaName(areaName); };\n  const displayProjects = selectedAreaProjects || listings;\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      <div className=\"flex-shrink-0 mb-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h2 className=\"text-xl font-semibold text-white flex items-center gap-2\"><Building2 className=\"w-6 h-6 text-orange-400\" />Off-Plan Projects</h2>\n            <p className=\"text-zinc-500 text-sm mt-1\">{totalResults > 0 ? totalResults.toLocaleString() + ' progetti' : 'Cerca progetti'}{selectedAreaName && ' • ' + selectedAreaName}</p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowStats(!showStats)} icon={PieChart}>\n              {showStats ? 'Nascondi' : 'Stats'}\n            </Button>\n            <div className=\"flex items-center gap-2 bg-zinc-700/50/50 p-1 rounded-xl\">\n              <button onClick={() => { setViewMode('list'); setSelectedAreaProjects(null); }} className={'p-2 rounded-lg transition-colors ' + (viewMode === 'list' ? 'bg-orange-500 text-white' : 'text-zinc-400 hover:text-white')} title=\"Lista\"><List className=\"w-5 h-5\" /></button>\n              <button onClick={() => setViewMode('map')} className={'p-2 rounded-lg transition-colors ' + (viewMode === 'map' ? 'bg-orange-500 text-white' : 'text-zinc-400 hover:text-white')} title=\"Mappa\"><Map className=\"w-5 h-5\" /></button>\n              <button onClick={() => setViewMode('saved')} className={'p-2 rounded-lg transition-colors relative ' + (viewMode === 'saved' ? 'bg-orange-500 text-white' : 'text-zinc-400 hover:text-white')} title=\"Salvati\">\n                <svg className=\"w-5 h-5\" fill={viewMode === 'saved' ? 'currentColor' : 'none'} stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\" /></svg>\n                {savedListings?.length > 0 && <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-orange-500 rounded-full text-[10px] flex items-center justify-center text-white font-bold\">{savedListings.length}</span>}\n              </button>\n            </div>\n          </div>\n        </div>\n        \n        {/* Stats Panel */}\n        {showStats && (\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n            <Card className=\"p-4\">\n              <h3 className=\"text-white font-medium mb-3 flex items-center gap-2\"><MapPin className=\"w-4 h-4 text-orange-400\" />Top Zone</h3>\n              <div className=\"space-y-2\">\n                {stats.byZone.slice(0, 5).map((z, i) => (\n                  <div key={z.name} className=\"flex items-center justify-between\">\n                    <span className=\"text-zinc-400 text-sm truncate flex-1\">{z.name}</span>\n                    <span className=\"text-white text-sm font-medium ml-2\">{z.count}</span>\n                  </div>\n                ))}\n              </div>\n            </Card>\n            <Card className=\"p-4\">\n              <h3 className=\"text-white font-medium mb-3 flex items-center gap-2\"><Building2 className=\"w-4 h-4 text-orange-400\" />Top Developer</h3>\n              <div className=\"space-y-2\">\n                {stats.byDeveloper.slice(0, 5).map((d, i) => (\n                  <div key={d.name} className=\"flex items-center justify-between\">\n                    <span className=\"text-zinc-400 text-sm truncate flex-1\">{d.name}</span>\n                    <span className=\"text-white text-sm font-medium ml-2\">{d.count}</span>\n                  </div>\n                ))}\n              </div>\n            </Card>\n            <Card className=\"p-4\">\n              <h3 className=\"text-white font-medium mb-3 flex items-center gap-2\"><DollarSign className=\"w-4 h-4 text-orange-400\" />Statistiche</h3>\n              <div className=\"space-y-3\">\n                <div>\n                  <p className=\"text-zinc-500 text-xs\">Totale Progetti</p>\n                  <p className=\"text-white text-xl font-bold\">{totalResults.toLocaleString()}</p>\n                </div>\n                <div>\n                  <p className=\"text-zinc-500 text-xs\">Prezzo Medio</p>\n                  <p className=\"text-orange-400 text-xl font-bold\">AED {(stats.avgPrice / 1000000).toFixed(1)}M</p>\n                </div>\n              </div>\n            </Card>\n          </div>\n        )}\n\n        <Card className=\"mb-4\">\n          <div className=\"relative mb-3\"><Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500\" /><input type=\"text\" placeholder=\"Cerca progetto, zona o developer...\" value={filters.search} onChange={(e) => setFilters(f => ({ ...f, search: e.target.value }))} onKeyDown={(e) => e.key === 'Enter' && searchListings(1)} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-3 text-white placeholder:text-zinc-600 focus:border-orange-500 focus:outline-none\" /></div>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-9 gap-3\">\n            <select value={filters.emirate} onChange={(e) => setFilters(f => ({ ...f, emirate: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"><option value=\"\">🇦🇪 Emirato</option>{emirates.map(e => <option key={e} value={e}>{e}</option>)}</select>\n            <select value={filters.location} onChange={(e) => setFilters(f => ({ ...f, location: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"><option value=\"\">Tutte le zone</option>{availableZones.map(a => <option key={a} value={a}>{a}</option>)}</select>\n            <select value={filters.developer} onChange={(e) => setFilters(f => ({ ...f, developer: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"><option value=\"\">Developer</option>{topDevelopers.map(d => <option key={d} value={d}>{d}</option>)}</select>\n            <select value={filters.bedrooms} onChange={(e) => setFilters(f => ({ ...f, bedrooms: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"><option value=\"\">Camere</option>{bedroomOptions.map(b => <option key={b} value={b}>{b === 'Studio' ? 'Studio' : b + ' BR'}</option>)}</select>\n            <select value={filters.status} onChange={(e) => setFilters(f => ({ ...f, status: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\">{statusOptions.map(s => <option key={s.value} value={s.value}>{s.label}</option>)}</select>\n            <select value={filters.deliveryYear} onChange={(e) => setFilters(f => ({ ...f, deliveryYear: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\"><option value=\"\">Consegna</option>{deliveryYears.map(y => <option key={y} value={y}>{y}</option>)}</select>\n            <input type=\"number\" placeholder=\"Min AED\" value={filters.minPrice} onChange={(e) => setFilters(f => ({ ...f, minPrice: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\" />\n            <input type=\"number\" placeholder=\"Max AED\" value={filters.maxPrice} onChange={(e) => setFilters(f => ({ ...f, maxPrice: e.target.value }))} className=\"bg-[#1e293b] border border-[#334155] rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\" />\n            <Button onClick={() => { setSelectedAreaProjects(null); searchListings(1); }} icon={Search} disabled={loading}>{loading ? '...' : 'Cerca'}</Button>\n          </div>\n          {/* Sorting and active filters */}\n          <div className=\"flex items-center justify-between mt-3 pt-3 border-t border-zinc-800\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-zinc-500 text-sm\">Ordina:</span>\n                <select value={filters.sortBy} onChange={(e) => { setFilters(f => ({ ...f, sortBy: e.target.value })); searchListings(1); }} className=\"bg-transparent border-none text-orange-400 text-sm focus:outline-none cursor-pointer\">\n                  {sortOptions.map(s => <option key={s.value} value={s.value}>{s.label}</option>)}\n                </select>\n              </div>\n              {listings.length > 0 && (\n                <Button variant=\"ghost\" size=\"sm\" onClick={exportProjectsCSV}>\n                  <Download className=\"w-4 h-4 mr-1\" />Export CSV\n                </Button>\n              )}\n            </div>\n            {(filters.emirate || filters.location || filters.developer || filters.status || filters.deliveryYear || filters.minPrice || filters.maxPrice || filters.bedrooms) && (\n              <Button variant=\"ghost\" size=\"sm\" onClick={() => { setFilters({ search: '', emirate: '', location: '', minPrice: '', maxPrice: '', bedrooms: '', developer: '', status: '', deliveryYear: '', sortBy: 'hotness' }); searchListings(1); }}>\n                <X className=\"w-4 h-4 mr-1\" />Reset filtri\n              </Button>\n            )}\n          </div>\n        </Card>\n        {selectedAreaProjects && <div className=\"flex items-center gap-2 mb-4\"><span className=\"text-zinc-400 text-sm\">Filtrato: <span className=\"text-orange-400\">{selectedAreaName}</span></span><Button variant=\"ghost\" size=\"sm\" onClick={() => { setSelectedAreaProjects(null); setSelectedAreaName(''); }}><X className=\"w-4 h-4 mr-1\" />Rimuovi</Button></div>}\n      </div>\n\n      {error && <Card className=\"border-red-500/20 bg-red-500/5 mb-4\"><div className=\"flex items-center gap-3 text-red-400\"><AlertCircle className=\"w-5 h-5\" /><span>{error}</span><Button variant=\"ghost\" size=\"sm\" onClick={() => searchListings(1)}>Riprova</Button></div></Card>}\n\n      <div className=\"flex-1 min-h-0\">\n        {viewMode === 'list' && (\n          <div className=\"h-full overflow-y-auto\">\n            {loading && listings.length === 0 ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">{[1,2,3,4,5,6].map(i => <Card key={i} className=\"animate-pulse\"><div className=\"h-40 bg-zinc-700/50 rounded-xl mb-3\" /><div className=\"h-4 bg-zinc-700/50 rounded w-3/4 mb-2\" /><div className=\"h-3 bg-zinc-700/50 rounded w-1/2\" /></Card>)}</div>\n            ) : displayProjects.length > 0 ? (\n              <>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {displayProjects.map(project => (\n                    <Card key={project.project_id} hover className=\"overflow-hidden group cursor-pointer\" onClick={() => setSelectedListing(project)}>\n                      <div className=\"relative h-40 -mx-4 -mt-4 mb-3 overflow-hidden\">\n                        {project.images?.[0]?.medium_image_url ? <img src={project.images[0].medium_image_url} alt={project.title} className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\" /> : <div className=\"w-full h-full bg-zinc-700/50 flex items-center justify-center\"><Building2 className=\"w-12 h-12 text-zinc-600\" /></div>}\n                        <div className=\"absolute top-2 left-2 flex gap-1\">\n                          <span className={'px-2 py-1 text-white text-xs font-medium rounded-lg ' + (project.construction_phase_key === 'completed' ? 'bg-green-500/90' : project.construction_phase_key === 'under_construction' ? 'bg-orange-500/90' : 'bg-blue-500/90')}>{project.construction_phase_key === 'completed' ? 'Completato' : project.construction_phase_key === 'under_construction' ? 'In Costruzione' : 'Lancio'}</span>\n                          {project.hotness_level >= 80 && <span className=\"px-2 py-1 bg-gradient-to-r from-red-500 to-orange-500 text-white text-xs font-medium rounded-lg\">🔥</span>}\n                        </div>\n                        {formatDelivery(project.delivery_date) && <div className=\"absolute top-2 right-12 px-2 py-1 bg-zinc-800/70 text-white text-xs rounded-lg\">{formatDelivery(project.delivery_date)}</div>}\n                        <button onClick={(e) => { e.stopPropagation(); isListingSaved(project.project_id) ? onRemoveListing(project.project_id) : onSaveListing(project); }} className={'absolute top-2 right-2 p-2 rounded-full transition-colors ' + (isListingSaved(project.project_id) ? 'bg-orange-500 text-white' : 'bg-zinc-800/50 text-white hover:bg-orange-500')}><svg className=\"w-4 h-4\" fill={isListingSaved(project.project_id) ? 'currentColor' : 'none'} stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\" /></svg></button>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <p className=\"text-white font-medium line-clamp-1\">{project.title}</p>\n                        <p className=\"text-zinc-500 text-sm line-clamp-1\">{project.location?.full_name}</p>\n                        <div className=\"flex items-center gap-3 text-xs text-zinc-400\">\n                          {formatBedrooms(project.bedrooms) && <span className=\"flex items-center gap-1\"><Building2 className=\"w-3.5 h-3.5\" />{formatBedrooms(project.bedrooms)}</span>}\n                          {project.payment_plans && <span>{formatPaymentPlan(project.payment_plans)}</span>}\n                        </div>\n                        <div className=\"flex items-center justify-between pt-2\">\n                          <p className=\"text-orange-400 font-semibold\">{project.price_from > 0 ? 'da AED ' + formatPrice(project.price_from) : 'Prezzo TBD'}</p>\n                          {project.developer?.name && <span className=\"text-zinc-500 text-xs truncate max-w-[100px]\">{project.developer.name}</span>}\n                        </div>\n                      </div>\n                      <div className=\"flex gap-2 mt-3 pt-3 border-t border-zinc-800\">\n                        <Button variant=\"ghost\" size=\"sm\" className=\"flex-1\" onClick={(e) => { e.stopPropagation(); setSelectedListing(project); }}><Eye className=\"w-4 h-4 mr-1\" />Dettagli</Button>\n                        <Button variant=\"secondary\" size=\"sm\" className=\"flex-1\" onClick={(e) => { e.stopPropagation(); setShowAssignModal(project); }}><Plus className=\"w-4 h-4 mr-1\" />Lead</Button>\n                      </div>\n                    </Card>\n                  ))}\n                </div>\n                {/* Pagination */}\n                {totalPages > 1 && (\n                  <div className=\"flex items-center justify-center gap-2 pt-6 pb-4\">\n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\" \n                      onClick={() => handlePageChange(page - 1)} \n                      disabled={page === 1}\n                    >\n                      <ChevronLeft className=\"w-4 h-4\" />\n                    </Button>\n                    \n                    {/* Page numbers */}\n                    {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n                      let pageNum;\n                      if (totalPages <= 5) {\n                        pageNum = i + 1;\n                      } else if (page <= 3) {\n                        pageNum = i + 1;\n                      } else if (page >= totalPages - 2) {\n                        pageNum = totalPages - 4 + i;\n                      } else {\n                        pageNum = page - 2 + i;\n                      }\n                      return (\n                        <button\n                          key={pageNum}\n                          onClick={() => handlePageChange(pageNum)}\n                          className={`w-10 h-10 rounded-lg text-sm font-medium transition-colors ${\n                            page === pageNum \n                              ? 'bg-orange-500 text-white' \n                              : 'bg-zinc-700/50 text-zinc-400 hover:bg-zinc-700'\n                          }`}\n                        >\n                          {pageNum}\n                        </button>\n                      );\n                    })}\n                    \n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\" \n                      onClick={() => handlePageChange(page + 1)} \n                      disabled={page === totalPages}\n                    >\n                      <ChevronRight className=\"w-4 h-4\" />\n                    </Button>\n                    \n                    <span className=\"text-zinc-500 text-sm ml-4\">\n                      {totalResults.toLocaleString()} progetti\n                    </span>\n                  </div>\n                )}\n              </>\n            ) : <EmptyState icon={Building2} title=\"Nessun risultato\" description=\"Modifica i filtri\" />}\n          </div>\n        )}\n\n        {viewMode === 'map' && (\n          <div className=\"fixed inset-0 z-50 bg-[#0f172a]\">\n            {/* Header */}\n            <div className=\"absolute top-0 left-0 right-0 z-20 bg-[#0f172a]/95 backdrop-blur border-b border-zinc-800\">\n              <div className=\"px-4 py-3 flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <img src=\"/logo.png\" alt=\"KeyPrime\" className=\"h-8 lg:h-10\" />\n                  <span className=\"text-zinc-500 hidden sm:inline\">|</span>\n                  <span className=\"text-zinc-400 text-sm\">{displayProjects.length} progetti</span>\n                </div>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setViewMode('list')} icon={X}>Chiudi</Button>\n              </div>\n              {/* Filters - Horizontal scroll on mobile */}\n              <div className=\"px-4 pb-3 flex items-center gap-2 overflow-x-auto scrollbar-hide\">\n                <select value={filters.emirate} onChange={(e) => setFilters(f => ({ ...f, emirate: e.target.value }))} className=\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[100px] flex-shrink-0\">\n                  <option value=\"\">🇦🇪 Emirato</option>\n                  {emirates.map(e => <option key={e} value={e}>{e}</option>)}\n                </select>\n                <select value={filters.location} onChange={(e) => setFilters(f => ({ ...f, location: e.target.value }))} className=\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[120px] flex-shrink-0\">\n                  <option value=\"\">Tutte le zone</option>\n                  {availableZones.map(a => <option key={a} value={a}>{a}</option>)}\n                </select>\n                <select value={filters.developer} onChange={(e) => setFilters(f => ({ ...f, developer: e.target.value }))} className=\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[130px] flex-shrink-0\">\n                  <option value=\"\">Tutti i developer</option>\n                  {topDevelopers.map(d => <option key={d} value={d}>{d}</option>)}\n                </select>\n                <select value={filters.bedrooms} onChange={(e) => setFilters(f => ({ ...f, bedrooms: e.target.value }))} className=\"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm min-w-[90px] flex-shrink-0\">\n                  <option value=\"\">Camere</option>\n                  {bedroomOptions.map(b => <option key={b} value={b}>{b === 'Studio' ? 'Studio' : b + ' BR'}</option>)}\n                </select>\n                <Button onClick={() => searchListings(1)} size=\"sm\" className=\"flex-shrink-0\" disabled={loading}>{loading ? '...' : 'Cerca'}</Button>\n              </div>\n            </div>\n            \n            {/* Map Container - Fullscreen */}\n            <div className=\"absolute inset-0 pt-24 lg:pt-28\">\n              {/* Desktop: Sidebar + Map */}\n              <div className=\"hidden lg:flex h-full\">\n                {/* Left Sidebar */}\n                <div className=\"w-96 h-full bg-[#1e293b] border-r border-zinc-800 flex flex-col\">\n                  <div className=\"p-3 border-b border-zinc-800\">\n                    <div className=\"relative\">\n                      <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500\" />\n                      <input type=\"text\" placeholder=\"Cerca progetto...\" value={filters.search} onChange={(e) => setFilters(f => ({ ...f, search: e.target.value }))} onKeyDown={(e) => e.key === 'Enter' && searchListings(1)} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg pl-10 pr-4 py-2 text-white text-sm placeholder:text-zinc-500 focus:border-orange-500 focus:outline-none\" />\n                    </div>\n                  </div>\n                  <div className=\"flex-1 overflow-y-auto\">\n                    {displayProjects.map(project => (\n                      <div key={project.project_id} onClick={() => setSelectedListing(project)} className={'p-3 border-b border-zinc-800/50 cursor-pointer hover:bg-zinc-700/30 transition-colors ' + (selectedListing?.project_id === project.project_id ? 'bg-orange-500/10 border-l-2 border-l-orange-500' : '')}>\n                        <div className=\"flex gap-3\">\n                          <div className=\"w-20 h-16 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700\">\n                            {project.images?.[0]?.medium_image_url ? <img src={project.images[0].medium_image_url} alt=\"\" className=\"w-full h-full object-cover\" /> : <div className=\"w-full h-full flex items-center justify-center\"><Building2 className=\"w-6 h-6 text-zinc-600\" /></div>}\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <h3 className=\"font-medium text-white text-sm truncate\">{project.title}</h3>\n                            <p className=\"text-xs text-zinc-500 truncate\">{project.location?.full_name}</p>\n                            <p className=\"text-orange-400 font-semibold text-sm mt-1\">{project.price_from > 0 ? 'From ' + formatPrice(project.price_from) : 'TBD'}</p>\n                            <div className=\"flex items-center gap-2 text-xs text-zinc-500\">\n                              {formatBedrooms(project.bedrooms) && <span>{formatBedrooms(project.bedrooms)}</span>}\n                              {formatDelivery(project.delivery_date) && <span>• {formatDelivery(project.delivery_date)}</span>}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                    {totalPages > 1 && (\n                      <div className=\"p-3 flex items-center justify-center gap-2 border-t border-zinc-800\">\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => handlePageChange(page - 1)} disabled={page === 1}><ChevronLeft className=\"w-4 h-4\" /></Button>\n                        <span className=\"text-zinc-400 text-sm\">Pag. {page}/{totalPages}</span>\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => handlePageChange(page + 1)} disabled={page === totalPages}><ChevronRight className=\"w-4 h-4\" /></Button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                {/* Map */}\n                <div className=\"flex-1 relative\">\n                  <MapboxMap projects={listings} onSelectProject={setSelectedListing} selectedProject={selectedListing} onAreaClick={handleAreaClick} />\n                </div>\n              </div>\n\n              {/* Mobile: Fullscreen Map + Bottom Carousel */}\n              <div className=\"lg:hidden h-full flex flex-col\">\n                {/* Map takes most space */}\n                <div className=\"flex-1 relative\">\n                  <MapboxMap projects={listings} onSelectProject={setSelectedListing} selectedProject={selectedListing} onAreaClick={handleAreaClick} />\n                </div>\n                \n                {/* Bottom Carousel */}\n                <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-[#0f172a] via-[#0f172a]/95 to-transparent pt-8 pb-4\">\n                  <div className=\"flex gap-3 overflow-x-auto px-4 pb-2 snap-x snap-mandatory scrollbar-hide\">\n                    {displayProjects.map(project => (\n                      <div \n                        key={project.project_id} \n                        onClick={() => setSelectedListing(project)}\n                        className={'flex-shrink-0 w-72 bg-[#1e293b] rounded-xl p-3 border transition-all snap-start ' + (selectedListing?.project_id === project.project_id ? 'border-orange-500 scale-[1.02]' : 'border-zinc-800')}\n                      >\n                        <div className=\"flex gap-3\">\n                          <div className=\"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 bg-zinc-700\">\n                            {project.images?.[0]?.medium_image_url ? (\n                              <img src={project.images[0].medium_image_url} alt=\"\" className=\"w-full h-full object-cover\" />\n                            ) : (\n                              <div className=\"w-full h-full flex items-center justify-center\"><Building2 className=\"w-8 h-8 text-zinc-600\" /></div>\n                            )}\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <h3 className=\"font-medium text-white text-sm line-clamp-1\">{project.title}</h3>\n                            <p className=\"text-xs text-zinc-500 line-clamp-1\">{project.location?.full_name}</p>\n                            <p className=\"text-orange-400 font-bold mt-1\">{project.price_from > 0 ? 'From ' + formatPrice(project.price_from) : 'TBD'}</p>\n                            <div className=\"flex items-center gap-2 text-xs text-zinc-500 mt-0.5\">\n                              {formatBedrooms(project.bedrooms) && <span>{formatBedrooms(project.bedrooms)}</span>}\n                              {formatDelivery(project.delivery_date) && <span>• {formatDelivery(project.delivery_date)}</span>}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                  {/* Page indicator */}\n                  <div className=\"flex items-center justify-center gap-2 mt-2\">\n                    <span className=\"text-zinc-500 text-xs\">{displayProjects.length} progetti • Scorri →</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Saved Projects View */}\n        {viewMode === 'saved' && (\n          <div className=\"h-full overflow-y-auto\">\n            {savedListings?.length > 0 ? (\n              <>\n                <div className=\"mb-4\">\n                  <p className=\"text-zinc-400 text-sm\">{savedListings.length} progetti salvati</p>\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {savedListings.map(saved => {\n                    // Try to get full project data, fallback to saved fields\n                    const project = saved.property_data || {\n                      project_id: saved.property_id,\n                      title: saved.title,\n                      price_from: saved.price,\n                      location: { full_name: saved.location_full, name: saved.location_path },\n                      developer: { name: saved.agent_name },\n                      images: saved.image_url ? [{ medium_image_url: saved.image_url }] : [],\n                      construction_phase_key: saved.completion_status,\n                      url: saved.pf_url\n                    };\n                    const imageUrl = project.images?.[0]?.medium_image_url || saved.image_url;\n                    \n                    return (\n                      <Card key={saved.id} hover className=\"overflow-hidden group cursor-pointer\" onClick={() => setSelectedListing(project)}>\n                        <div className=\"relative h-40 -mx-4 -mt-4 mb-3 overflow-hidden\">\n                          {imageUrl ? (\n                            <img src={imageUrl} alt={project.title} className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\" />\n                          ) : (\n                            <div className=\"w-full h-full bg-zinc-700/50 flex items-center justify-center\"><Building2 className=\"w-12 h-12 text-zinc-600\" /></div>\n                          )}\n                          <button \n                            onClick={(e) => { e.stopPropagation(); onRemoveListing(saved.property_id); }} \n                            className=\"absolute top-2 right-2 p-2 rounded-full bg-orange-500 text-white hover:bg-red-500 transition-colors\"\n                            title=\"Rimuovi dai salvati\"\n                          >\n                            <X className=\"w-4 h-4\" />\n                          </button>\n                          {saved.completion_status && (\n                            <span className={'absolute top-2 left-2 px-2 py-1 text-white text-xs font-medium rounded-lg ' + \n                              (saved.completion_status === 'completed' ? 'bg-green-500/90' : \n                               saved.completion_status === 'under_construction' ? 'bg-orange-500/90' : 'bg-blue-500/90')}>\n                              {saved.completion_status === 'completed' ? 'Completato' : \n                               saved.completion_status === 'under_construction' ? 'In Costruzione' : 'Lancio'}\n                            </span>\n                          )}\n                        </div>\n                        <div className=\"space-y-2\">\n                          <p className=\"text-white font-medium line-clamp-1\">{project.title || saved.title}</p>\n                          <p className=\"text-zinc-500 text-sm line-clamp-1\">{project.location?.full_name || saved.location_full}</p>\n                          <div className=\"flex items-center justify-between pt-2\">\n                            <p className=\"text-orange-400 font-semibold\">\n                              {(project.price_from || saved.price) > 0 ? 'da AED ' + parseFloat(project.price_from || saved.price).toLocaleString() : 'Prezzo TBD'}\n                            </p>\n                            {(project.developer?.name || saved.agent_name) && (\n                              <span className=\"text-zinc-500 text-xs truncate max-w-[100px]\">{project.developer?.name || saved.agent_name}</span>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"flex gap-2 mt-3 pt-3 border-t border-zinc-800\">\n                          <Button variant=\"ghost\" size=\"sm\" className=\"flex-1\" onClick={(e) => { e.stopPropagation(); setSelectedListing(project); }}>\n                            <Eye className=\"w-4 h-4 mr-1\" />Dettagli\n                          </Button>\n                          <Button variant=\"secondary\" size=\"sm\" className=\"flex-1\" onClick={(e) => { e.stopPropagation(); setShowAssignModal(project); }}>\n                            <Plus className=\"w-4 h-4 mr-1\" />Lead\n                          </Button>\n                        </div>\n                      </Card>\n                    );\n                  })}\n                </div>\n              </>\n            ) : (\n              <EmptyState \n                icon={Building2} \n                title=\"Nessun progetto salvato\" \n                description=\"Salva i progetti che ti interessano cliccando sull'icona segnalibro\"\n                actionLabel=\"Cerca Progetti\"\n                onAction={() => setViewMode('list')}\n              />\n            )}\n          </div>\n        )}\n      </div>\n\n      {selectedListing && <ListingDetailModal listing={selectedListing} onClose={() => setSelectedListing(null)} onCreateLead={() => { setShowAssignModal(selectedListing); setSelectedListing(null); }} isSaved={isListingSaved(selectedListing.project_id)} onToggleSave={() => isListingSaved(selectedListing.project_id) ? onRemoveListing(selectedListing.project_id) : onSaveListing(selectedListing)} />}\n      {showAssignModal && <AssignListingModal listing={showAssignModal} clienti={clienti} onClose={() => setShowAssignModal(null)} onCreateLead={onCreateLead} user={user} />}\n    </div>\n  );\n}\n// Listing Detail Modal (for Off-Plan Projects) - Enhanced with Gallery, Map, Location Insights\nfunction ListingDetailModal({ listing, onClose, onCreateLead, isSaved, onToggleSave }) {\n  const [activeImageIndex, setActiveImageIndex] = useState(0);\n  const [showFullGallery, setShowFullGallery] = useState(false);\n  const [generatingPdf, setGeneratingPdf] = useState(false);\n  const [brochureUrl, setBrochureUrl] = useState(null);\n  const [videoUrl, setVideoUrl] = useState(null);\n  const [videoType, setVideoType] = useState(null);\n  const [mediaLoading, setMediaLoading] = useState(false);\n  const [showBrochureViewer, setShowBrochureViewer] = useState(false);\n  const [showVideoPlayer, setShowVideoPlayer] = useState(false);\n\n  // Fetch brochure and video URLs on mount\n  useEffect(() => {\n    if (listing?.url) {\n      setMediaLoading(true);\n      fetch(`/api/get-brochure?url=${encodeURIComponent(listing.url)}`)\n        .then(res => res.json())\n        .then(data => {\n          if (data.success) {\n            if (data.brochure_url) setBrochureUrl(data.brochure_url);\n            if (data.video_url) {\n              setVideoUrl(data.video_url);\n              setVideoType(data.video_type);\n            }\n          }\n        })\n        .catch(() => {})\n        .finally(() => setMediaLoading(false));\n    }\n  }, [listing?.url]);\n\n  const formatPrice = (price) => {\n    if (!price || price === 0) return 'Su richiesta';\n    return parseFloat(price).toLocaleString();\n  };\n  \n  const formatBedrooms = (bedrooms) => {\n    if (!bedrooms?.available?.length) return null;\n    const beds = bedrooms.available;\n    if (beds.length === 1) return beds[0] === 0 ? 'Studio' : `${beds[0]} Camere`;\n    const min = Math.min(...beds);\n    const max = Math.max(...beds);\n    return min === 0 ? `Studio - ${max} Camere` : `${min} - ${max} Camere`;\n  };\n\n  const formatDelivery = (dateStr) => {\n    if (!dateStr) return null;\n    const date = new Date(dateStr);\n    const quarter = Math.ceil((date.getMonth() + 1) / 3);\n    return `Q${quarter} ${date.getFullYear()}`;\n  };\n\n  const getStatusLabel = (status) => {\n    switch(status) {\n      case 'completed': return { text: 'Completato', color: 'bg-green-500', icon: '✓' };\n      case 'under_construction': return { text: 'In Costruzione', color: 'bg-orange-500', icon: '🏗️' };\n      case 'not_started': return { text: 'Nuovo Lancio', color: 'bg-blue-500', icon: '🚀' };\n      default: return { text: 'Off-Plan', color: 'bg-orange-500', icon: '📋' };\n    }\n  };\n\n  // Generate PDF for WhatsApp sharing\n  const downloadProjectPDF = async () => {\n    setGeneratingPdf(true);\n    try {\n      const status = getStatusLabel(listing.construction_phase_key);\n      const paymentPlan = listing.payment_plans?.plans?.[0]?.summary;\n      const imageUrl = listing.images?.[0]?.medium_image_url || '';\n      \n      const htmlContent = `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: 'Helvetica Neue', Arial, sans-serif; background: #111; color: #fff; padding: 40px; }\n    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #f97316; padding-bottom: 20px; }\n    .logo { font-size: 28px; font-weight: bold; color: #f97316; }\n    .date { color: #888; font-size: 12px; }\n    .hero { position: relative; margin-bottom: 30px; border-radius: 16px; overflow: hidden; }\n    .hero img { width: 100%; height: 300px; object-fit: cover; }\n    .badge { position: absolute; top: 16px; left: 16px; background: #f97316; color: white; padding: 8px 16px; border-radius: 8px; font-weight: bold; font-size: 14px; }\n    .title { font-size: 32px; font-weight: bold; margin-bottom: 8px; }\n    .location { color: #888; font-size: 16px; margin-bottom: 24px; }\n    .price { font-size: 36px; font-weight: bold; color: #f97316; margin-bottom: 30px; }\n    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px; }\n    .card { background: #1a1a1a; border-radius: 12px; padding: 20px; }\n    .card-title { color: #888; font-size: 12px; text-transform: uppercase; margin-bottom: 8px; }\n    .card-value { font-size: 20px; font-weight: bold; }\n    .section { margin-bottom: 30px; }\n    .section-title { font-size: 18px; font-weight: bold; margin-bottom: 16px; color: #f97316; }\n    .payment-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }\n    .payment-item { background: #1a1a1a; border-radius: 12px; padding: 16px; text-align: center; }\n    .payment-percent { font-size: 28px; font-weight: bold; color: #f97316; }\n    .payment-label { font-size: 12px; color: #888; margin-top: 4px; }\n    .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #333; text-align: center; color: #666; font-size: 12px; }\n    .cta { background: #f97316; color: white; padding: 16px 32px; border-radius: 12px; font-weight: bold; font-size: 16px; display: inline-block; margin-top: 20px; text-decoration: none; }\n    .developer { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }\n    .developer-name { font-size: 16px; color: #ccc; }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <div class=\"logo\">🔑 KeyPrime</div>\n    <div class=\"date\">${new Date().toLocaleDateString('it-IT', { day: 'numeric', month: 'long', year: 'numeric' })}</div>\n  </div>\n  \n  ${imageUrl ? `<div class=\"hero\"><img src=\"${imageUrl}\" /><div class=\"badge\">${status.icon} ${status.text}</div></div>` : ''}\n  \n  <div class=\"developer\">\n    <span class=\"developer-name\">by ${listing.developer?.name || 'Developer'}</span>\n  </div>\n  \n  <h1 class=\"title\">${listing.title}</h1>\n  <p class=\"location\">📍 ${listing.location?.full_name || ''}</p>\n  <p class=\"price\">A partire da AED ${formatPrice(listing.price_from)}</p>\n  \n  <div class=\"grid\">\n    <div class=\"card\">\n      <div class=\"card-title\">Tipologie</div>\n      <div class=\"card-value\">${formatBedrooms(listing.bedrooms) || 'Varie'}</div>\n    </div>\n    <div class=\"card\">\n      <div class=\"card-title\">Consegna</div>\n      <div class=\"card-value\">${formatDelivery(listing.delivery_date) || 'TBA'}</div>\n    </div>\n    <div class=\"card\">\n      <div class=\"card-title\">Stato</div>\n      <div class=\"card-value\">${status.text}</div>\n    </div>\n    <div class=\"card\">\n      <div class=\"card-title\">Popolarità</div>\n      <div class=\"card-value\">${listing.hotness_level || 0}/100 🔥</div>\n    </div>\n  </div>\n  \n  ${paymentPlan ? `\n  <div class=\"section\">\n    <div class=\"section-title\">Piano di Pagamento</div>\n    <div class=\"payment-grid\">\n      <div class=\"payment-item\">\n        <div class=\"payment-percent\">${paymentPlan.down_payment || 0}%</div>\n        <div class=\"payment-label\">Anticipo</div>\n      </div>\n      <div class=\"payment-item\">\n        <div class=\"payment-percent\">${paymentPlan.during_construction || 0}%</div>\n        <div class=\"payment-label\">In Costruzione</div>\n      </div>\n      <div class=\"payment-item\">\n        <div class=\"payment-percent\">${paymentPlan.handover || 0}%</div>\n        <div class=\"payment-label\">Alla Consegna</div>\n      </div>\n    </div>\n  </div>\n  ` : ''}\n  \n  <div style=\"text-align: center;\">\n    <a href=\"${listing.url || '#'}\" class=\"cta\">Scopri di più →</a>\n  </div>\n  \n  <div class=\"footer\">\n    <p>Documento generato da KeyPrime CRM</p>\n    <p>Per info: pellegrino@indubai.it | +971 XXX XXX XXXX</p>\n  </div>\n</body>\n</html>`;\n\n      // Create blob and download\n      const blob = new Blob([htmlContent], { type: 'text/html' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${listing.title.replace(/[^a-zA-Z0-9]/g, '_')}_KeyPrime.html`;\n      a.click();\n      URL.revokeObjectURL(url);\n    } catch (err) {\n      console.error('PDF error:', err);\n    }\n    setGeneratingPdf(false);\n  };\n\n  // Location insights based on area name\n  const getLocationInsights = (locationName) => {\n    const insights = {\n      'Dubai Marina': { rating: '⭐⭐⭐⭐⭐', type: 'Premium Waterfront', highlights: ['Vista mare', 'Ristoranti di lusso', 'Beach access', 'Metro vicina'], roi: '6-8%' },\n      'Palm Jumeirah': { rating: '⭐⭐⭐⭐⭐', type: 'Ultra Luxury', highlights: ['Isola iconica', 'Spiagge private', 'Hotel 5 stelle', 'Alta domanda'], roi: '5-7%' },\n      'Downtown Dubai': { rating: '⭐⭐⭐⭐⭐', type: 'Iconic Location', highlights: ['Burj Khalifa', 'Dubai Mall', 'Fountain view', 'Business hub'], roi: '5-7%' },\n      'Business Bay': { rating: '⭐⭐⭐⭐', type: 'Business District', highlights: ['Canal view', 'Corporate hub', 'In crescita', 'Buon ROI'], roi: '7-9%' },\n      'JBR': { rating: '⭐⭐⭐⭐⭐', type: 'Beachfront Living', highlights: ['The Walk', 'Beach access', 'Family friendly', 'Turisti'], roi: '6-8%' },\n      'Dubai Creek Harbour': { rating: '⭐⭐⭐⭐', type: 'Future Icon', highlights: ['Creek Tower', 'Waterfront', 'Nuova area', 'Alto potenziale'], roi: '8-10%' },\n      'MBR City': { rating: '⭐⭐⭐⭐', type: 'Master Community', highlights: ['Meydan', 'Crystal Lagoon', 'Golf course', 'Family area'], roi: '7-9%' },\n      'Dubai Hills': { rating: '⭐⭐⭐⭐', type: 'Green Community', highlights: ['Golf club', 'Dubai Hills Mall', 'Parchi', 'Scuole'], roi: '6-8%' },\n      'JVC': { rating: '⭐⭐⭐', type: 'Affordable Living', highlights: ['Entry level', 'Community feel', 'ROI alto', 'In sviluppo'], roi: '8-10%' },\n      'Jumeirah Village': { rating: '⭐⭐⭐', type: 'Value Investment', highlights: ['Prezzi competitivi', 'Comunità', 'Buon rental'], roi: '8-10%' },\n      'DIFC': { rating: '⭐⭐⭐⭐⭐', type: 'Financial Hub', highlights: ['Centro finanziario', 'Art galleries', 'Fine dining', 'Lusso'], roi: '5-6%' },\n      'Yas Island': { rating: '⭐⭐⭐⭐', type: 'Entertainment Hub', highlights: ['Ferrari World', 'Yas Marina', 'Beach', 'Abu Dhabi'], roi: '6-8%' },\n      'Saadiyat Island': { rating: '⭐⭐⭐⭐⭐', type: 'Cultural District', highlights: ['Louvre Abu Dhabi', 'Beaches', 'Golf', 'Exclusive'], roi: '5-7%' }\n    };\n    \n    const locationLower = (locationName || '').toLowerCase();\n    for (const [key, value] of Object.entries(insights)) {\n      if (locationLower.includes(key.toLowerCase())) return { name: key, ...value };\n    }\n    return { name: locationName, rating: '⭐⭐⭐', type: 'Emerging Area', highlights: ['In sviluppo', 'Potenziale crescita'], roi: '7-10%' };\n  };\n\n  const status = getStatusLabel(listing.construction_phase_key);\n  const locationInsights = getLocationInsights(listing.location?.full_name || listing.location?.name);\n  const images = listing.images || [];\n  const hasCoords = listing.location?.lat && listing.location?.lng;\n  \n  // Estimate coordinates from location name for map (rough Dubai coordinates)\n  const getMapUrl = () => {\n    const locationName = encodeURIComponent(listing.location?.full_name || listing.title + ' Dubai');\n    return `https://www.google.com/maps/search/?api=1&query=${locationName}`;\n  };\n\n  // Fullscreen Gallery\n  if (showFullGallery) {\n    return (\n      <div className=\"fixed inset-0 z-[60] bg-zinc-800\">\n        <button onClick={() => setShowFullGallery(false)} className=\"absolute top-4 right-4 z-10 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20\">\n          <X className=\"w-6 h-6\" />\n        </button>\n        <div className=\"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur rounded-full text-white text-sm\">\n          {activeImageIndex + 1} / {images.length}\n        </div>\n        \n        {/* Main Image */}\n        <div className=\"h-full flex items-center justify-center p-4\">\n          {images[activeImageIndex] && (\n            <img src={images[activeImageIndex].medium_image_url || images[activeImageIndex].small_image_url} alt=\"\" className=\"max-h-full max-w-full object-contain\" />\n          )}\n        </div>\n        \n        {/* Navigation */}\n        {images.length > 1 && (\n          <>\n            <button onClick={() => setActiveImageIndex(i => i > 0 ? i - 1 : images.length - 1)} className=\"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20\">\n              <ChevronLeft className=\"w-6 h-6\" />\n            </button>\n            <button onClick={() => setActiveImageIndex(i => i < images.length - 1 ? i + 1 : 0)} className=\"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 backdrop-blur rounded-full text-white hover:bg-white/20\">\n              <ChevronRight className=\"w-6 h-6\" />\n            </button>\n          </>\n        )}\n        \n        {/* Thumbnails */}\n        <div className=\"absolute bottom-4 left-0 right-0 flex justify-center gap-2 px-4 overflow-x-auto\">\n          {images.slice(0, 10).map((img, idx) => (\n            <button key={idx} onClick={() => setActiveImageIndex(idx)} className={`flex-shrink-0 w-16 h-12 rounded-lg overflow-hidden border-2 transition-all ${idx === activeImageIndex ? 'border-orange-500 scale-110' : 'border-transparent opacity-60 hover:opacity-100'}`}>\n              <img src={img.small_image_url || img.medium_image_url} alt=\"\" className=\"w-full h-full object-cover\" />\n            </button>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-2 md:p-4\">\n      <div className=\"absolute inset-0 bg-zinc-800/80 backdrop-blur-sm\" onClick={onClose} />\n      <div className=\"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden animate-scaleIn\">\n        \n        {/* Hero Image Section with Gallery */}\n        <div className=\"relative h-72 md:h-80\">\n          {images[activeImageIndex]?.medium_image_url ? (\n            <img src={images[activeImageIndex].medium_image_url} alt={listing.title} className=\"w-full h-full object-cover cursor-pointer\" onClick={() => setShowFullGallery(true)} />\n          ) : (\n            <div className=\"w-full h-full bg-zinc-700/50 flex items-center justify-center\">\n              <Building2 className=\"w-20 h-20 text-zinc-600\" />\n            </div>\n          )}\n          \n          {/* Gradient overlay */}\n          <div className=\"absolute inset-0 bg-gradient-to-t from-[#1e293b] via-transparent to-black/30\" />\n          \n          {/* Top controls */}\n          <div className=\"absolute top-4 left-4 right-4 flex justify-between items-start\">\n            <div className=\"flex gap-2 flex-wrap\">\n              <span className={`px-3 py-1.5 ${status.color} text-white text-sm font-medium rounded-full flex items-center gap-1.5 shadow-lg`}>\n                <span>{status.icon}</span> {status.text}\n              </span>\n              {listing.hotness_level >= 80 && (\n                <span className=\"px-3 py-1.5 bg-gradient-to-r from-red-500 to-orange-500 text-white text-sm font-medium rounded-full flex items-center gap-1.5 shadow-lg\">\n                  🔥 Popolare\n                </span>\n              )}\n              {formatDelivery(listing.delivery_date) && (\n                <span className=\"px-3 py-1.5 bg-zinc-800/60 backdrop-blur text-white text-sm rounded-full\">\n                  📅 {formatDelivery(listing.delivery_date)}\n                </span>\n              )}\n            </div>\n            <div className=\"flex gap-2\">\n              <button onClick={onToggleSave} className={`p-2.5 rounded-full shadow-lg transition-all ${isSaved ? 'bg-orange-500 text-white' : 'bg-zinc-800/60 backdrop-blur text-white hover:bg-orange-500'}`}>\n                <svg className=\"w-5 h-5\" fill={isSaved ? 'currentColor' : 'none'} stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\" /></svg>\n              </button>\n              <button onClick={onClose} className=\"p-2.5 bg-zinc-800/60 backdrop-blur rounded-full text-white hover:bg-zinc-800/80 shadow-lg\">\n                <X className=\"w-5 h-5\" />\n              </button>\n            </div>\n          </div>\n          \n          {/* Image navigation dots */}\n          {images.length > 1 && (\n            <div className=\"absolute bottom-20 left-0 right-0 flex justify-center gap-1.5\">\n              {images.slice(0, 8).map((_, idx) => (\n                <button key={idx} onClick={() => setActiveImageIndex(idx)} className={`w-2 h-2 rounded-full transition-all ${idx === activeImageIndex ? 'bg-orange-500 w-6' : 'bg-white/50 hover:bg-white/80'}`} />\n              ))}\n              {images.length > 8 && <span className=\"text-white/50 text-xs ml-1\">+{images.length - 8}</span>}\n            </div>\n          )}\n          \n          {/* Title section */}\n          <div className=\"absolute bottom-4 left-4 right-4\">\n            <h2 className=\"text-2xl md:text-3xl font-bold text-white drop-shadow-lg\">{listing.title}</h2>\n            <div className=\"flex items-center gap-2 mt-2 text-white/80\">\n              <MapPin className=\"w-4 h-4\" />\n              <span>{listing.location?.full_name}</span>\n            </div>\n          </div>\n          \n          {/* Expand gallery button */}\n          {images.length > 1 && (\n            <button onClick={() => setShowFullGallery(true)} className=\"absolute bottom-4 right-4 px-3 py-1.5 bg-zinc-800/60 backdrop-blur text-white text-sm rounded-full hover:bg-zinc-800/80 flex items-center gap-1.5\">\n              <Eye className=\"w-4 h-4\" /> {images.length} foto\n            </button>\n          )}\n        </div>\n        \n        {/* Content */}\n        <div className=\"p-4 md:p-6 overflow-y-auto max-h-[calc(95vh-20rem)]\">\n          \n          {/* Price & Quick Info */}\n          <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6 pb-6 border-b border-zinc-800\">\n            <div>\n              <p className=\"text-3xl font-bold text-orange-400\">\n                {listing.price_from > 0 ? `AED ${formatPrice(listing.price_from)}` : 'Prezzo su richiesta'}\n              </p>\n              {listing.price_from > 0 && <p className=\"text-zinc-500 text-sm mt-1\">Prezzo iniziale</p>}\n            </div>\n            {formatBedrooms(listing.bedrooms) && (\n              <div className=\"flex items-center gap-4 text-zinc-300\">\n                <div className=\"flex items-center gap-2 px-4 py-2 bg-zinc-700/50/50 rounded-xl\">\n                  <svg className=\"w-5 h-5 text-orange-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\" /></svg>\n                  <span className=\"font-medium\">{formatBedrooms(listing.bedrooms)}</span>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Price Breakdown by Bedroom Type */}\n          {listing.bedrooms?.available?.length > 0 && listing.price_from > 0 && (\n            <div className=\"mb-6 p-4 bg-zinc-700/50/30 border border-zinc-700/50 rounded-xl\">\n              <h4 className=\"text-white font-medium mb-3 flex items-center gap-2\">\n                <DollarSign className=\"w-4 h-4 text-orange-400\" />\n                Prezzi per Tipologia\n              </h4>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                {listing.bedrooms.available.sort((a, b) => a - b).map((bed, idx) => {\n                  const basePrice = listing.price_from;\n                  const multiplier = bed === 0 ? 1 : 1 + (bed * 0.35);\n                  const estimatedPrice = Math.round(basePrice * multiplier);\n                  return (\n                    <div key={idx} className=\"bg-zinc-800/50 border border-zinc-700/30 rounded-lg p-3 text-center\">\n                      <p className=\"text-zinc-400 text-xs mb-1\">{bed === 0 ? 'Studio' : bed + ' BR'}</p>\n                      <p className=\"text-orange-400 font-semibold\">da {formatPrice(estimatedPrice)}</p>\n                    </div>\n                  );\n                })}\n              </div>\n              <p className=\"text-zinc-500 text-xs mt-2 text-center\">* Prezzi indicativi, contattare per quotazione esatta</p>\n            </div>\n          )}\n          \n          {/* Info Grid - 2 columns on mobile, 4 on desktop */}\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6\">\n            <div className=\"bg-gradient-to-br from-orange-500/10 to-orange-600/5 border border-orange-500/20 rounded-xl p-4 text-center\">\n              <p className=\"text-orange-400 text-2xl font-bold\">{status.icon}</p>\n              <p className=\"text-white font-medium mt-1\">{status.text}</p>\n              <p className=\"text-zinc-500 text-xs mt-1\">Stato progetto</p>\n            </div>\n            {formatDelivery(listing.delivery_date) && (\n              <div className=\"bg-zinc-700/50/50 rounded-xl p-4 text-center\">\n                <p className=\"text-blue-400 text-2xl font-bold\">📅</p>\n                <p className=\"text-white font-medium mt-1\">{formatDelivery(listing.delivery_date)}</p>\n                <p className=\"text-zinc-500 text-xs mt-1\">Consegna prevista</p>\n              </div>\n            )}\n            {listing.payment_plans?.plans?.[0]?.summary?.down_payment && (\n              <div className=\"bg-zinc-700/50/50 rounded-xl p-4 text-center\">\n                <p className=\"text-green-400 text-2xl font-bold\">{listing.payment_plans.plans[0].summary.down_payment}%</p>\n                <p className=\"text-white font-medium mt-1\">Anticipo</p>\n                <p className=\"text-zinc-500 text-xs mt-1\">Down payment</p>\n              </div>\n            )}\n            <div className=\"bg-zinc-700/50/50 rounded-xl p-4 text-center\">\n              <p className=\"text-purple-400 text-2xl font-bold\">{locationInsights.roi}</p>\n              <p className=\"text-white font-medium mt-1\">ROI Stimato</p>\n              <p className=\"text-zinc-500 text-xs mt-1\">Rendimento annuo</p>\n            </div>\n          </div>\n          \n          {/* Developer Info - Prominent Card */}\n          {listing.developer && (\n            <div className=\"flex items-center gap-4 p-4 bg-gradient-to-r from-zinc-800/80 to-zinc-800/40 border border-zinc-700/50 rounded-xl mb-6\">\n              {listing.developer.logo ? (\n                <img src={listing.developer.logo} alt={listing.developer.name} className=\"w-16 h-16 rounded-xl object-contain bg-white p-2\" />\n              ) : (\n                <div className=\"w-16 h-16 rounded-xl bg-orange-500/20 flex items-center justify-center\">\n                  <Building2 className=\"w-8 h-8 text-orange-400\" />\n                </div>\n              )}\n              <div className=\"flex-1\">\n                <p className=\"text-zinc-400 text-xs uppercase tracking-wider\">Developer</p>\n                <p className=\"text-xl font-semibold text-white\">{listing.developer.name}</p>\n                {listing.developer.projects_count && (\n                  <p className=\"text-zinc-500 text-sm\">{listing.developer.projects_count} progetti</p>\n                )}\n              </div>\n              <div className=\"text-right\">\n                <span className=\"px-3 py-1 bg-orange-500/20 text-orange-400 text-xs font-medium rounded-full\">Verificato ✓</span>\n              </div>\n            </div>\n          )}\n          \n          {/* Construction Progress - Only for under construction projects */}\n          {listing.construction_phase_key === 'under_construction' && (\n            <div className=\"bg-gradient-to-r from-orange-500/10 to-amber-500/5 border border-orange-500/20 rounded-xl p-4 mb-6\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <h3 className=\"text-white font-semibold flex items-center gap-2\">\n                  <Building2 className=\"w-4 h-4 text-orange-400\" /> Stato Avanzamento Lavori\n                </h3>\n                <span className=\"px-2 py-1 bg-orange-500/20 text-orange-400 text-xs font-medium rounded-full\">In Costruzione</span>\n              </div>\n              {(() => {\n                // Use real completion percentage if available, otherwise estimate\n                let progress = listing.completion_percentage || listing.construction_progress;\n                if (!progress) {\n                  const deliveryDate = listing.delivery_date ? new Date(listing.delivery_date) : null;\n                  const now = new Date();\n                  const startDate = new Date(now.getFullYear() - 1, now.getMonth(), 1);\n                  if (deliveryDate) {\n                    const totalDuration = deliveryDate - startDate;\n                    const elapsed = now - startDate;\n                    progress = Math.min(Math.max(Math.round((elapsed / totalDuration) * 100), 5), 95);\n                  } else {\n                    progress = 50;\n                  }\n                }\n                return (\n                  <>\n                    <div className=\"relative h-4 bg-zinc-700/50 rounded-full overflow-hidden mb-2\">\n                      <div \n                        className=\"absolute left-0 top-0 h-full bg-gradient-to-r from-orange-500 to-amber-400 rounded-full transition-all duration-500\"\n                        style={{ width: `${progress}%` }}\n                      />\n                      <div className=\"absolute inset-0 flex items-center justify-center\">\n                        <span className=\"text-xs font-bold text-white drop-shadow\">{progress}%</span>\n                      </div>\n                    </div>\n                    <div className=\"flex justify-between text-xs text-zinc-500\">\n                      <span>Inizio lavori</span>\n                      <span>Consegna: {formatDelivery(listing.delivery_date) || 'TBD'}</span>\n                    </div>\n                    <div className=\"mt-3 grid grid-cols-4 gap-2\">\n                      <div className={'p-2 rounded-lg text-center text-xs ' + (progress >= 25 ? 'bg-orange-500/20 text-orange-400' : 'bg-zinc-700/50 text-zinc-500')}>\n                        <p className=\"font-medium\">Fondazioni</p>\n                        <p>{progress >= 25 ? '✓' : '...'}</p>\n                      </div>\n                      <div className={'p-2 rounded-lg text-center text-xs ' + (progress >= 50 ? 'bg-orange-500/20 text-orange-400' : 'bg-zinc-700/50 text-zinc-500')}>\n                        <p className=\"font-medium\">Struttura</p>\n                        <p>{progress >= 50 ? '✓' : '...'}</p>\n                      </div>\n                      <div className={'p-2 rounded-lg text-center text-xs ' + (progress >= 75 ? 'bg-orange-500/20 text-orange-400' : 'bg-zinc-700/50 text-zinc-500')}>\n                        <p className=\"font-medium\">Finiture</p>\n                        <p>{progress >= 75 ? '✓' : '...'}</p>\n                      </div>\n                      <div className={'p-2 rounded-lg text-center text-xs ' + (progress >= 95 ? 'bg-green-500/20 text-green-400' : 'bg-zinc-700/50 text-zinc-500')}>\n                        <p className=\"font-medium\">Consegna</p>\n                        <p>{progress >= 95 ? '✓' : '...'}</p>\n                      </div>\n                    </div>\n                  </>\n                );\n              })()}\n            </div>\n          )}\n          \n          {/* Location Insights Card */}\n          <div className=\"bg-gradient-to-br from-blue-500/10 to-purple-500/5 border border-blue-500/20 rounded-xl p-4 mb-6\">\n            <div className=\"flex items-start justify-between mb-3\">\n              <div>\n                <h3 className=\"text-white font-semibold flex items-center gap-2\">\n                  <MapPin className=\"w-4 h-4 text-blue-400\" /> Analisi Location\n                </h3>\n                <p className=\"text-zinc-400 text-sm\">{locationInsights.name}</p>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"text-lg\">{locationInsights.rating}</p>\n                <span className=\"text-blue-400 text-xs font-medium\">{locationInsights.type}</span>\n              </div>\n            </div>\n            <div className=\"flex flex-wrap gap-2\">\n              {locationInsights.highlights.map((h, i) => (\n                <span key={i} className=\"px-2.5 py-1 bg-white/5 text-zinc-300 text-xs rounded-full\">✓ {h}</span>\n              ))}\n            </div>\n            {/* Mini Map Link */}\n            <a href={getMapUrl()} target=\"_blank\" rel=\"noopener noreferrer\" className=\"mt-4 flex items-center justify-center gap-2 p-3 bg-zinc-700/50/50 hover:bg-zinc-700/50 rounded-xl text-zinc-300 transition-colors\">\n              <MapPin className=\"w-4 h-4\" />\n              <span className=\"text-sm\">Apri in Google Maps</span>\n              <ArrowUpRight className=\"w-4 h-4\" />\n            </a>\n          </div>\n\n          {/* Payment Plans */}\n          {listing.payment_plans?.plans?.length > 0 && (\n            <div className=\"mb-6\">\n              <h3 className=\"text-white font-semibold mb-3 flex items-center gap-2\">\n                <DollarSign className=\"w-4 h-4 text-green-400\" /> Piano di Pagamento\n              </h3>\n              <div className=\"space-y-3\">\n                {listing.payment_plans.plans.map((plan, idx) => (\n                  <div key={idx} className=\"p-4 bg-zinc-700/50/50 rounded-xl\">\n                    {plan.title && <p className=\"text-zinc-300 font-medium mb-3\">{plan.title}</p>}\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                      <div className=\"text-center p-3 bg-green-500/10 rounded-lg\">\n                        <p className=\"text-2xl font-bold text-green-400\">{plan.summary.down_payment}%</p>\n                        <p className=\"text-zinc-500 text-xs mt-1\">Anticipo</p>\n                      </div>\n                      <div className=\"text-center p-3 bg-orange-500/10 rounded-lg\">\n                        <p className=\"text-2xl font-bold text-orange-400\">{plan.summary.during_construction}%</p>\n                        <p className=\"text-zinc-500 text-xs mt-1\">Costruzione</p>\n                      </div>\n                      <div className=\"text-center p-3 bg-blue-500/10 rounded-lg\">\n                        <p className=\"text-2xl font-bold text-blue-400\">{plan.summary.handover}%</p>\n                        <p className=\"text-zinc-500 text-xs mt-1\">Consegna</p>\n                      </div>\n                      {plan.summary.after_handover > 0 && (\n                        <div className=\"text-center p-3 bg-purple-500/10 rounded-lg\">\n                          <p className=\"text-2xl font-bold text-purple-400\">{plan.summary.after_handover}%</p>\n                          <p className=\"text-zinc-500 text-xs mt-1\">Post-consegna</p>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Image Gallery Thumbnails */}\n          {images.length > 1 && (\n            <div className=\"mb-6\">\n              <h3 className=\"text-white font-semibold mb-3 flex items-center gap-2\">\n                <Eye className=\"w-4 h-4 text-orange-400\" /> Galleria\n                <span className=\"text-zinc-500 text-sm font-normal\">({images.length} immagini)</span>\n              </h3>\n              <div className=\"grid grid-cols-4 md:grid-cols-6 gap-2\">\n                {images.slice(0, 12).map((img, idx) => (\n                  <button key={idx} onClick={() => { setActiveImageIndex(idx); setShowFullGallery(true); }} className=\"relative h-20 rounded-lg overflow-hidden group\">\n                    <img src={img.small_image_url || img.medium_image_url} alt=\"\" className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300\" />\n                    <div className=\"absolute inset-0 bg-zinc-800/0 group-hover:bg-zinc-800/30 transition-colors flex items-center justify-center\">\n                      <Eye className=\"w-5 h-5 text-white opacity-0 group-hover:opacity-100 transition-opacity\" />\n                    </div>\n                  </button>\n                ))}\n                {images.length > 12 && (\n                  <button onClick={() => setShowFullGallery(true)} className=\"h-20 rounded-lg bg-zinc-700/50 flex items-center justify-center text-zinc-400 hover:bg-zinc-700 transition-colors\">\n                    <span className=\"text-sm font-medium\">+{images.length - 12}</span>\n                  </button>\n                )}\n              </div>\n            </div>\n          )}\n\n          \n          {/* Actions */}\n          <div className=\"flex flex-wrap gap-3 pt-4 border-t border-zinc-800\">\n            <Button className=\"flex-1 py-3 bg-orange-500 hover:bg-orange-600\" onClick={onCreateLead}>\n              <Plus className=\"w-5 h-5 mr-2\" /> Crea Lead\n            </Button>\n            <Button variant=\"secondary\" className=\"flex-1 py-3\" onClick={() => {\n              const bedsText = formatBedrooms(listing.bedrooms) || 'Varie tipologie';\n              const deliveryText = formatDelivery(listing.delivery_date) || 'TBD';\n              const paymentText = listing.payment_plans?.plans?.[0]?.summary ? \n                `💳 ${listing.payment_plans.plans[0].summary.down_payment}% anticipo` : '';\n              const text = `🏗️ *${listing.title}*\\n\\n📍 ${listing.location?.full_name}\\n💰 ${listing.price_from > 0 ? `da AED ${formatPrice(listing.price_from)}` : 'Prezzo su richiesta'}\\n🏠 ${bedsText}\\n📅 Consegna: ${deliveryText}\\n🏢 Developer: ${listing.developer?.name || 'TBD'}\\n${paymentText}\\n\\n_Progetto Off-Plan Dubai_\\n\\n🔗 Per info: contattami!`;\n              window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');\n            }}>\n              <MessageCircle className=\"w-5 h-5 mr-2\" /> WhatsApp\n            </Button>\n            {/* Video button */}\n            {mediaLoading ? (\n              <div className=\"flex items-center justify-center gap-2 py-3 px-4 bg-purple-500/10 text-purple-400/50 rounded-xl\">\n                <RefreshCw className=\"w-5 h-5 animate-spin\" />\n              </div>\n            ) : videoUrl ? (\n              <button \n                onClick={() => setShowVideoPlayer(true)} \n                className=\"flex items-center justify-center gap-2 py-3 px-4 bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 rounded-xl transition-colors\" \n                title=\"Guarda Video\"\n              >\n                <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M8 5v14l11-7z\"/></svg> Video\n              </button>\n            ) : null}\n            {/* Brochure button */}\n            {mediaLoading ? null : brochureUrl ? (\n              <button \n                onClick={() => setShowBrochureViewer(true)} \n                className=\"flex items-center justify-center gap-2 py-3 px-4 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-xl transition-colors\" \n                title=\"Visualizza Brochure PDF\"\n              >\n                <FileText className=\"w-5 h-5\" /> Brochure\n              </button>\n            ) : null}\n            {listing.url && (\n              <a href={listing.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"flex items-center justify-center gap-2 py-3 px-4 bg-zinc-700/50 hover:bg-zinc-700 text-zinc-300 rounded-xl transition-colors\" title=\"Vedi su PropertyFinder\">\n                <ExternalLink className=\"w-5 h-5\" />\n              </a>\n            )}\n            <Button variant=\"ghost\" className=\"py-3\" onClick={downloadProjectPDF} disabled={generatingPdf} title=\"Scarica scheda PDF\">\n              {generatingPdf ? <RefreshCw className=\"w-5 h-5 animate-spin\" /> : <Download className=\"w-5 h-5\" />}\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* Brochure Viewer Modal */}\n      {showBrochureViewer && brochureUrl && (\n        <div className=\"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/90\">\n          <div className=\"relative w-full h-full max-w-5xl max-h-[90vh] bg-zinc-900 rounded-2xl overflow-hidden flex flex-col\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between p-4 border-b border-zinc-800\">\n              <div className=\"flex items-center gap-3\">\n                <FileText className=\"w-5 h-5 text-blue-400\" />\n                <span className=\"text-white font-medium\">Brochure - {listing.title}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <a \n                  href={brochureUrl} \n                  download \n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors\"\n                >\n                  <Download className=\"w-4 h-4\" /> Scarica PDF\n                </a>\n                <button \n                  onClick={() => setShowBrochureViewer(false)} \n                  className=\"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white transition-colors\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n              </div>\n            </div>\n            {/* PDF Viewer */}\n            <div className=\"flex-1 bg-zinc-800\">\n              <iframe \n                src={brochureUrl + '#toolbar=1&navpanes=0'}\n                className=\"w-full h-full\"\n                title=\"Brochure PDF\"\n              />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Video Player Modal */}\n      {showVideoPlayer && videoUrl && (\n        <div className=\"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/95\">\n          <div className=\"relative w-full h-full max-w-5xl max-h-[90vh] bg-zinc-900 rounded-2xl overflow-hidden flex flex-col\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between p-4 border-b border-zinc-800\">\n              <div className=\"flex items-center gap-3\">\n                <svg className=\"w-5 h-5 text-purple-400\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M8 5v14l11-7z\"/></svg>\n                <span className=\"text-white font-medium\">Video - {listing.title}</span>\n              </div>\n              <button \n                onClick={() => setShowVideoPlayer(false)} \n                className=\"p-2 hover:bg-zinc-800 rounded-lg text-zinc-400 hover:text-white transition-colors\"\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n            </div>\n            {/* Video Player */}\n            <div className=\"flex-1 bg-black flex items-center justify-center\">\n              {videoType === 'youtube' || videoType === 'vimeo' ? (\n                <iframe \n                  src={videoUrl + (videoUrl.includes('?') ? '&' : '?') + 'autoplay=1'}\n                  className=\"w-full h-full\"\n                  title=\"Project Video\"\n                  allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                  allowFullScreen\n                />\n              ) : (\n                <video \n                  src={videoUrl} \n                  controls \n                  autoPlay \n                  className=\"w-full h-full object-contain\"\n                >\n                  Il tuo browser non supporta il video.\n                </video>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction AssignListingModal({ listing, clienti, onClose, onCreateLead, user }) {\n  const [selectedCliente, setSelectedCliente] = useState(null);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [createNew, setCreateNew] = useState(false);\n  const [newCliente, setNewCliente] = useState({ nome: '', cognome: '', telefono: '', email: '' });\n  \n  const filteredClienti = clienti.filter(c => \n    `${c.nome} ${c.cognome} ${c.telefono}`.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n  \n  // Check if we can create lead\n  const canCreate = selectedCliente || (createNew && newCliente.nome.trim());\n  \n  const handleCreate = () => {\n    if (!canCreate) return;\n    \n    const leadData = {\n      progetto: listing.title?.substring(0, 50) || listing.location?.name,\n      developer: listing.location?.name || 'TBD',\n      zona: listing.location?.path_name?.split(',')[1]?.trim() || 'Dubai',\n      valore: parseFloat(listing.price) || 0,\n      stato: 'lead',\n      agente: user?.nome || '',\n      pf_property_id: listing.property_id,\n      pf_url: listing.url,\n      note: `Off-Plan: ${listing.property_type} - ${listing.bedrooms || 'N/A'} BR - ${listing.size || 'N/A'} sqft`\n    };\n    \n    if (selectedCliente) {\n      leadData.cliente_id = selectedCliente.id;\n      leadData.cliente_nome = `${selectedCliente.nome} ${selectedCliente.cognome}`;\n    } else if (createNew && newCliente.nome) {\n      leadData.newCliente = newCliente;\n    }\n    \n    onCreateLead(leadData);\n    onClose();\n  };\n  \n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n      <div className=\"absolute inset-0 bg-zinc-800/70 backdrop-blur-sm\" onClick={onClose} />\n      <div className=\"relative bg-[#1e293b] border border-[#334155] rounded-2xl w-full max-w-md animate-scaleIn\">\n        <div className=\"flex items-center justify-between p-4 border-b border-zinc-800\">\n          <h3 className=\"text-lg font-semibold text-white\">Crea Lead da Annuncio</h3>\n          <button onClick={onClose} className=\"text-zinc-400 hover:text-white\"><X className=\"w-5 h-5\" /></button>\n        </div>\n        \n        <div className=\"p-4 space-y-4\">\n          {/* Listing Summary */}\n          <div className=\"flex gap-3 p-3 bg-zinc-700/50/50 rounded-xl\">\n            {listing.images?.[0]?.small_image_url && <img src={listing.images[0].small_image_url} alt=\"\" className=\"w-16 h-16 rounded-lg object-cover\" />}\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-white text-sm font-medium line-clamp-1\">{listing.title}</p>\n              <p className=\"text-zinc-500 text-xs line-clamp-1\">{listing.location?.path_name}</p>\n              <p className=\"text-orange-400 text-sm font-medium mt-1\">AED {parseFloat(listing.price).toLocaleString()}</p>\n            </div>\n          </div>\n          \n          {/* Client Selection */}\n          <div>\n            <label className=\"text-sm text-zinc-400 mb-2 block\">Associa a Cliente <span className=\"text-red-400\">*</span></label>\n            <input type=\"text\" placeholder=\"Cerca cliente o digita nome per crearne uno nuovo...\" value={searchQuery} onChange={(e) => { setSearchQuery(e.target.value); setSelectedCliente(null); setCreateNew(false); }} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-xl px-3 py-2 text-white text-sm focus:border-orange-500 focus:outline-none\" />\n            \n            {searchQuery && !createNew && !selectedCliente && (\n              <div className=\"mt-2 max-h-40 overflow-y-auto space-y-1\">\n                {filteredClienti.slice(0, 5).map(c => (\n                  <button key={c.id} onClick={() => { setSelectedCliente(c); setSearchQuery(`${c.nome} ${c.cognome}`); }} className={`w-full text-left p-2 rounded-lg flex items-center gap-2 ${selectedCliente?.id === c.id ? 'bg-orange-500/20 text-orange-400' : 'hover:bg-zinc-700/50 text-zinc-300'}`}>\n                    <Avatar nome={c.nome} cognome={c.cognome} size=\"xs\" />\n                    <span className=\"text-sm\">{c.nome} {c.cognome}</span>\n                  </button>\n                ))}\n                <button onClick={() => { setCreateNew(true); setNewCliente(n => ({ ...n, nome: searchQuery.split(' ')[0], cognome: searchQuery.split(' ')[1] || '' })); }} className=\"w-full text-left p-2 rounded-lg text-orange-400 hover:bg-zinc-700/50 text-sm\">\n                  + Crea nuovo cliente \"{searchQuery}\"\n                </button>\n              </div>\n            )}\n            \n            {selectedCliente && (\n              <div className=\"mt-2 flex items-center gap-2 p-2 bg-emerald-500/20 rounded-lg\">\n                <Avatar nome={selectedCliente.nome} cognome={selectedCliente.cognome} size=\"xs\" />\n                <span className=\"text-sm text-emerald-400\">{selectedCliente.nome} {selectedCliente.cognome}</span>\n                <button onClick={() => { setSelectedCliente(null); setSearchQuery(''); }} className=\"ml-auto text-zinc-400 hover:text-white\"><X className=\"w-4 h-4\" /></button>\n              </div>\n            )}\n          </div>\n          \n          {/* New Client Form */}\n          {createNew && (\n            <div className=\"space-y-3 p-3 bg-zinc-700/30 rounded-xl border border-orange-500/30\">\n              <p className=\"text-sm text-orange-400 font-medium\">Nuovo Cliente</p>\n              <div className=\"grid grid-cols-2 gap-2\">\n                <input type=\"text\" placeholder=\"Nome *\" value={newCliente.nome} onChange={(e) => setNewCliente(n => ({ ...n, nome: e.target.value }))} className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\" />\n                <input type=\"text\" placeholder=\"Cognome\" value={newCliente.cognome} onChange={(e) => setNewCliente(n => ({ ...n, cognome: e.target.value }))} className=\"bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\" />\n              </div>\n              <input type=\"tel\" placeholder=\"Telefono\" value={newCliente.telefono} onChange={(e) => setNewCliente(n => ({ ...n, telefono: e.target.value }))} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\" />\n              <input type=\"email\" placeholder=\"Email\" value={newCliente.email} onChange={(e) => setNewCliente(n => ({ ...n, email: e.target.value }))} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm\" />\n            </div>\n          )}\n          \n          {!canCreate && (\n            <p className=\"text-xs text-zinc-500 text-center\">Seleziona un cliente esistente o creane uno nuovo per continuare</p>\n          )}\n        </div>\n        \n        <div className=\"flex gap-3 p-4 border-t border-zinc-800\">\n          <Button variant=\"secondary\" className=\"flex-1\" onClick={onClose}>Annulla</Button>\n          <Button className=\"flex-1\" onClick={handleCreate} disabled={!canCreate} style={{ opacity: canCreate ? 1 : 0.5 }}>Crea Lead</Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Login Form\nfunction LoginForm({ onLogin, loading }) {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [showPwd, setShowPwd] = useState(false);\n\n  return (\n    <form onSubmit={(e) => { e.preventDefault(); onLogin(username, password); }} className=\"space-y-4\">\n      <Input label=\"Username\" type=\"text\" value={username} onChange={(e) => setUsername(e.target.value)} placeholder=\"Inserisci username\" />\n      <div>\n        <label className=\"block text-sm text-zinc-400 mb-2\">Password</label>\n        <div className=\"relative\">\n          <input type={showPwd ? 'text' : 'password'} value={password} onChange={(e) => setPassword(e.target.value)} placeholder=\"••••••••\" className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 pr-12 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] transition-all\" />\n          <button type=\"button\" onClick={() => setShowPwd(!showPwd)} className=\"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-500 hover:text-white transition-colors\">\n            {showPwd ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\n          </button>\n        </div>\n      </div>\n      <Button type=\"submit\" disabled={loading || !username || !password} className=\"w-full py-3\">\n        {loading ? 'Accesso...' : 'Accedi'}\n      </Button>\n    </form>\n  );\n}\n\n// Lead Detail Sheet\nfunction LeadDetailSheet({ sale, cliente, rate, onClose, onUpdateSale, onConvert, isAdmin, activities = [], followUps = [], onAddActivity, onCreateFollowUp, onCompleteFollowUp, onDeleteActivity, onDeleteFollowUp, userName }) {\n  const mc = (sale?.stato === 'venduto' || sale?.stato === 'incassato') ? Number(sale.valore) * (sale.commission_pct || 5) / 100 * rate : 0;\n  const [editing, setEditing] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [activeDetailTab, setActiveDetailTab] = useState('info'); // 'info', 'activities', 'followups'\n  const [showActivityForm, setShowActivityForm] = useState(false);\n  const [showFollowUpForm, setShowFollowUpForm] = useState(false);\n  const [activityForm, setActivityForm] = useState({ tipo: 'call', contenuto: '' });\n  const [followUpForm, setFollowUpForm] = useState({ tipo: 'call', data_reminder: '', ora_reminder: '', nota: '' });\n  const [editForm, setEditForm] = useState({\n    progetto: sale?.progetto || '',\n    developer: sale?.developer || '',\n    zona: sale?.zona || '',\n    valore: sale?.valore || ''\n  });\n  \n  const activityTypes = [\n    { id: 'call', label: 'Chiamata', icon: '📞', color: 'blue' },\n    { id: 'email', label: 'Email', icon: '📧', color: 'purple' },\n    { id: 'whatsapp', label: 'WhatsApp', icon: '💬', color: 'green' },\n    { id: 'meeting', label: 'Incontro', icon: '🤝', color: 'orange' },\n    { id: 'viewing', label: 'Visita', icon: '🏠', color: 'pink' },\n    { id: 'note', label: 'Nota', icon: '📝', color: 'zinc' }\n  ];\n  \n  const handleAddActivity = async () => {\n    if (!activityForm.contenuto.trim()) return;\n    await onAddActivity(sale.id, activityForm.tipo, activityForm.contenuto);\n    setActivityForm({ tipo: 'call', contenuto: '' });\n    setShowActivityForm(false);\n  };\n  \n  const handleAddFollowUp = async () => {\n    if (!followUpForm.data_reminder) return;\n    await onCreateFollowUp({\n      sale_id: sale.id,\n      cliente_id: cliente?.id,\n      ...followUpForm\n    });\n    setFollowUpForm({ tipo: 'call', data_reminder: '', ora_reminder: '', nota: '' });\n    setShowFollowUpForm(false);\n  };\n  \n  useEffect(() => {\n    if (sale) {\n      setEditForm({\n        progetto: sale.progetto || '',\n        developer: sale.developer || '',\n        zona: sale.zona || '',\n        valore: sale.valore || ''\n      });\n    }\n  }, [sale]);\n  \n  const handleSave = async () => {\n    console.log('handleSave called, sale:', sale);\n    console.log('sale.id:', sale?.id);\n    if (!sale?.id) {\n      console.error('No sale.id!');\n      return;\n    }\n    setSaving(true);\n    await onUpdateSale(sale.id, {\n      progetto: editForm.progetto,\n      developer: editForm.developer,\n      zona: editForm.zona,\n      valore: editForm.valore ? parseFloat(editForm.valore) : 0\n    });\n    setSaving(false);\n    setEditing(false);\n    onClose(); // Chiudi il modal per mostrare i dati aggiornati\n  };\n  \n  return (\n    <BottomSheet isOpen={!!sale} onClose={onClose} title={sale?.progetto || 'Lead'}>\n      <div className=\"space-y-4\">\n        {/* Status */}\n        <div className=\"flex items-center justify-between\">\n          <StatusBadge status={sale?.stato || 'lead'} />\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-zinc-500 text-sm\">{fmtDate(sale?.data)}</span>\n            <button onClick={() => setEditing(!editing)} className=\"p-1.5 rounded-lg bg-zinc-700/50 text-zinc-400 hover:text-white\">\n              <Edit2 className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </div>\n\n        {editing ? (\n          /* Edit Mode */\n          <div className=\"space-y-3\">\n            <Card className=\"border-blue-500/20 bg-blue-500/5\">\n              <p className=\"text-blue-400 text-xs font-medium mb-3\">Modifica Lead</p>\n              <div className=\"space-y-3\">\n                <div>\n                  <label className=\"text-zinc-500 text-xs\">Progetto/Immobile</label>\n                  <input type=\"text\" value={editForm.progetto} onChange={(e) => setEditForm({...editForm, progetto: e.target.value})} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\" />\n                </div>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"text-zinc-500 text-xs\">Developer</label>\n                    <input type=\"text\" value={editForm.developer} onChange={(e) => setEditForm({...editForm, developer: e.target.value})} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\" />\n                  </div>\n                  <div>\n                    <label className=\"text-zinc-500 text-xs\">Zona</label>\n                    <input type=\"text\" value={editForm.zona} onChange={(e) => setEditForm({...editForm, zona: e.target.value})} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\" />\n                  </div>\n                </div>\n                <div>\n                  <label className=\"text-zinc-500 text-xs\">Valore (AED)</label>\n                  <input type=\"number\" value={editForm.valore} onChange={(e) => setEditForm({...editForm, valore: e.target.value})} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\" />\n                </div>\n              </div>\n              <div className=\"flex gap-2 mt-4\">\n                <Button variant=\"secondary\" onClick={() => setEditing(false)} className=\"flex-1\" disabled={saving}>Annulla</Button>\n                <Button onClick={handleSave} className=\"flex-1\" disabled={saving}>\n                  {saving ? <><RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />Salvataggio...</> : 'Salva'}\n                </Button>\n              </div>\n            </Card>\n          </div>\n        ) : (\n          /* View Mode */\n          <>\n            {/* Value */}\n            <Card className=\"border-amber-500/20 bg-amber-500/5\">\n              <p className=\"text-zinc-400 text-sm\">Valore</p>\n              <p className=\"text-2xl font-semibold text-white mt-1\">{sale?.valore > 0 ? `${fmt(sale.valore)} AED` : 'TBD'}</p>\n              {mc > 0 && <p className=\"text-emerald-400 text-sm mt-1\">Commissione: {fmt(mc)} AED {sale?.pagato ? '✓' : ''}</p>}\n            </Card>\n\n            {/* Property/Immobile Details */}\n            <Card>\n              <p className=\"text-zinc-500 text-xs mb-2\">Immobile</p>\n              <p className=\"text-white font-medium text-lg\">{sale?.progetto || 'N/A'}</p>\n              <div className=\"grid grid-cols-2 gap-3 mt-3\">\n                <div><p className=\"text-zinc-500 text-xs\">Developer</p><p className=\"text-white text-sm\">{sale?.developer || 'N/A'}</p></div>\n                <div><p className=\"text-zinc-500 text-xs\">Zona</p><p className=\"text-white text-sm\">{sale?.zona || 'N/A'}</p></div>\n              </div>\n              {sale?.pf_url && (\n                <a href={sale.pf_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"inline-flex items-center gap-1 mt-3 text-blue-400 text-sm hover:underline\">\n                  <Building2 className=\"w-3 h-3\" /> Vedi su PropertyFinder\n                </a>\n              )}\n            </Card>\n          </>\n        )}\n\n        {/* Cliente */}\n        {cliente && !editing && (\n          <Card>\n            <p className=\"text-zinc-500 text-xs mb-2\">Cliente</p>\n            <div className=\"flex items-center gap-3 mb-3\">\n              <Avatar nome={cliente.nome} cognome={cliente.cognome} />\n              <div>\n                <p className=\"text-white font-medium\">{cliente.nome} {cliente.cognome}</p>\n                <p className=\"text-zinc-500 text-sm\">{cliente.telefono}</p>\n              </div>\n            </div>\n            <QuickActions phone={cliente.telefono} whatsapp={cliente.whatsapp || cliente.telefono} email={cliente.email} clienteName={cliente.nome} />\n          </Card>\n        )}\n\n        {/* Activities & Follow-ups Tabs */}\n        {!editing && (\n          <div className=\"border-t border-zinc-800 pt-4\">\n            <div className=\"flex gap-2 mb-4\">\n              <button onClick={() => setActiveDetailTab('activities')} className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ${activeDetailTab === 'activities' ? 'bg-blue-500/20 text-blue-400' : 'bg-zinc-700/50 text-zinc-400 hover:text-white'}`}>\n                📝 Attività ({activities.length})\n              </button>\n              <button onClick={() => setActiveDetailTab('followups')} className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 ${activeDetailTab === 'followups' ? 'bg-purple-500/20 text-purple-400' : 'bg-zinc-700/50 text-zinc-400 hover:text-white'}`}>\n                ⏰ Follow-up ({followUps.filter(f => !f.completato).length})\n              </button>\n            </div>\n\n            {/* Activities Tab */}\n            {activeDetailTab === 'activities' && (\n              <div className=\"space-y-3\">\n                {/* Add Activity Button */}\n                {!showActivityForm ? (\n                  <button onClick={() => setShowActivityForm(true)} className=\"w-full py-2 border-2 border-dashed border-zinc-700 rounded-xl text-zinc-400 hover:text-white hover:border-zinc-600 transition-colors flex items-center justify-center gap-2\">\n                    <Plus className=\"w-4 h-4\" /> Registra attività\n                  </button>\n                ) : (\n                  <Card className=\"border-blue-500/20 bg-blue-500/5\">\n                    <div className=\"flex gap-2 mb-3 overflow-x-auto pb-1\">\n                      {activityTypes.map(t => (\n                        <button key={t.id} onClick={() => setActivityForm({...activityForm, tipo: t.id})} className={`px-3 py-1.5 rounded-lg text-xs whitespace-nowrap transition-all ${activityForm.tipo === t.id ? 'bg-blue-500 text-white' : 'bg-zinc-700/50 text-zinc-400 hover:text-white'}`}>\n                          {t.icon} {t.label}\n                        </button>\n                      ))}\n                    </div>\n                    <textarea value={activityForm.contenuto} onChange={(e) => setActivityForm({...activityForm, contenuto: e.target.value})} placeholder=\"Descrivi l'attività...\" className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm resize-none\" rows={3} />\n                    <div className=\"flex gap-2 mt-3\">\n                      <Button variant=\"secondary\" onClick={() => setShowActivityForm(false)} className=\"flex-1\">Annulla</Button>\n                      <Button onClick={handleAddActivity} className=\"flex-1\" disabled={!activityForm.contenuto.trim()}>Salva</Button>\n                    </div>\n                  </Card>\n                )}\n\n                {/* Activities List */}\n                {activities.length > 0 ? (\n                  <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n                    {activities.map(a => {\n                      const aType = activityTypes.find(t => t.id === a.tipo) || activityTypes[5];\n                      return (\n                        <div key={a.id} className=\"p-3 bg-zinc-800/50 rounded-xl group\">\n                          <div className=\"flex items-start justify-between\">\n                            <div className=\"flex items-start gap-2\">\n                              <span className=\"text-lg\">{aType.icon}</span>\n                              <div>\n                                <p className=\"text-white text-sm\">{a.contenuto}</p>\n                                <p className=\"text-zinc-500 text-xs mt-1\">{a.created_by} • {new Date(a.created_at).toLocaleDateString('it-IT', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' })}</p>\n                              </div>\n                            </div>\n                            <button onClick={() => onDeleteActivity(a.id)} className=\"opacity-0 group-hover:opacity-100 p-1 text-zinc-500 hover:text-red-400 transition-all\">\n                              <X className=\"w-3 h-3\" />\n                            </button>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                ) : (\n                  <p className=\"text-zinc-500 text-sm text-center py-4\">Nessuna attività registrata</p>\n                )}\n              </div>\n            )}\n\n            {/* Follow-ups Tab */}\n            {activeDetailTab === 'followups' && (\n              <div className=\"space-y-3\">\n                {/* Add Follow-up Button */}\n                {!showFollowUpForm ? (\n                  <button onClick={() => setShowFollowUpForm(true)} className=\"w-full py-2 border-2 border-dashed border-zinc-700 rounded-xl text-zinc-400 hover:text-white hover:border-zinc-600 transition-colors flex items-center justify-center gap-2\">\n                    <Plus className=\"w-4 h-4\" /> Programma follow-up\n                  </button>\n                ) : (\n                  <Card className=\"border-purple-500/20 bg-purple-500/5\">\n                    <div className=\"flex gap-2 mb-3 overflow-x-auto pb-1\">\n                      {activityTypes.slice(0, 5).map(t => (\n                        <button key={t.id} onClick={() => setFollowUpForm({...followUpForm, tipo: t.id})} className={`px-3 py-1.5 rounded-lg text-xs whitespace-nowrap transition-all ${followUpForm.tipo === t.id ? 'bg-purple-500 text-white' : 'bg-zinc-700/50 text-zinc-400 hover:text-white'}`}>\n                          {t.icon} {t.label}\n                        </button>\n                      ))}\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-3 mb-3\">\n                      <div>\n                        <label className=\"text-zinc-500 text-xs\">Data</label>\n                        <input type=\"date\" value={followUpForm.data_reminder} onChange={(e) => setFollowUpForm({...followUpForm, data_reminder: e.target.value})} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\" />\n                      </div>\n                      <div>\n                        <label className=\"text-zinc-500 text-xs\">Ora (opz.)</label>\n                        <input type=\"time\" value={followUpForm.ora_reminder} onChange={(e) => setFollowUpForm({...followUpForm, ora_reminder: e.target.value})} className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm mt-1\" />\n                      </div>\n                    </div>\n                    <textarea value={followUpForm.nota} onChange={(e) => setFollowUpForm({...followUpForm, nota: e.target.value})} placeholder=\"Note (opzionale)...\" className=\"w-full bg-zinc-700/50 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm resize-none\" rows={2} />\n                    <div className=\"flex gap-2 mt-3\">\n                      <Button variant=\"secondary\" onClick={() => setShowFollowUpForm(false)} className=\"flex-1\">Annulla</Button>\n                      <Button onClick={handleAddFollowUp} className=\"flex-1 bg-purple-500 hover:bg-purple-600\" disabled={!followUpForm.data_reminder}>Salva</Button>\n                    </div>\n                  </Card>\n                )}\n\n                {/* Follow-ups List */}\n                {followUps.length > 0 ? (\n                  <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n                    {followUps.map(f => {\n                      const fType = activityTypes.find(t => t.id === f.tipo) || activityTypes[0];\n                      const isOverdue = new Date(f.data_reminder) < new Date() && !f.completato;\n                      const isToday = new Date(f.data_reminder).toDateString() === new Date().toDateString();\n                      return (\n                        <div key={f.id} className={`p-3 rounded-xl border transition-all ${f.completato ? 'bg-zinc-800/30 border-zinc-800 opacity-60' : isOverdue ? 'bg-red-500/10 border-red-500/30' : isToday ? 'bg-purple-500/10 border-purple-500/30' : 'bg-zinc-800/50 border-zinc-800'}`}>\n                          <div className=\"flex items-start justify-between\">\n                            <div className=\"flex items-start gap-2\">\n                              <span className=\"text-lg\">{fType.icon}</span>\n                              <div>\n                                <div className=\"flex items-center gap-2\">\n                                  <p className={`text-sm font-medium ${f.completato ? 'text-zinc-500 line-through' : isOverdue ? 'text-red-400' : 'text-white'}`}>\n                                    {new Date(f.data_reminder).toLocaleDateString('it-IT', { day: 'numeric', month: 'short' })}\n                                    {f.ora_reminder && ` alle ${f.ora_reminder.slice(0,5)}`}\n                                  </p>\n                                  {isToday && !f.completato && <span className=\"px-1.5 py-0.5 bg-purple-500 text-white text-[10px] font-bold rounded\">OGGI</span>}\n                                  {isOverdue && !f.completato && <span className=\"px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded\">SCADUTO</span>}\n                                </div>\n                                {f.nota && <p className=\"text-zinc-400 text-xs mt-1\">{f.nota}</p>}\n                              </div>\n                            </div>\n                            <div className=\"flex items-center gap-1\">\n                              {!f.completato && (\n                                <button onClick={() => onCompleteFollowUp(f.id)} className=\"p-1.5 text-zinc-500 hover:text-green-400 transition-colors\" title=\"Completato\">\n                                  <Check className=\"w-4 h-4\" />\n                                </button>\n                              )}\n                              <button onClick={() => onDeleteFollowUp(f.id)} className=\"p-1.5 text-zinc-500 hover:text-red-400 transition-colors\" title=\"Elimina\">\n                                <X className=\"w-4 h-4\" />\n                              </button>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                ) : (\n                  <p className=\"text-zinc-500 text-sm text-center py-4\">Nessun follow-up programmato</p>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Status Change */}\n        {!editing && (\n          <div>\n            <p className=\"text-zinc-500 text-xs mb-2\">Cambia stato</p>\n            <div className=\"flex gap-2 overflow-x-auto pb-2\">\n              {pipelineStati.slice(0, -1).map(st => (\n                <button key={st} onClick={() => { onUpdateSale(sale.id, { stato: st }); if (st !== sale.stato) onClose(); }} className={`px-4 py-2 rounded-xl text-sm whitespace-nowrap transition-all ${sale?.stato === st ? 'text-white' : 'text-zinc-500 hover:text-white'}`} style={sale?.stato === st ? { background: theme.status[st]?.bg, color: theme.status[st]?.color } : { background: '#334155' }}>\n                  {pipelineLabels[st] || st}\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Actions */}\n        {!editing && ['prenotato', 'trattativa'].includes(sale?.stato) && (\n          <Button onClick={onConvert} icon={DollarSign} className=\"w-full py-3 bg-emerald-500 hover:bg-emerald-600 text-white\">\n            Registra Vendita\n          </Button>\n        )}\n\n        {isAdmin && !editing && (\n          <Button variant=\"danger\" icon={Trash2} className=\"w-full\">Elimina Lead</Button>\n        )}\n      </div>\n    </BottomSheet>\n  );\n}\n\n// Convert Modal\nfunction ConvertModal({ sale, onConvert, onCancel }) {\n  const [value, setValue] = useState(sale?.valore || '');\n  \n  return (\n    <Modal isOpen={!!sale} onClose={onCancel} title=\"🎉 Registra Vendita\" size=\"sm\">\n      <div className=\"space-y-4\">\n        <Card padding=\"p-3\" className=\"bg-zinc-700/50/50\">\n          <p className=\"text-white font-medium\">{sale?.progetto}</p>\n          <p className=\"text-zinc-500 text-sm\">{sale?.developer} • {sale?.zona}</p>\n        </Card>\n        <Input label=\"Valore finale (AED)\" type=\"number\" value={value} onChange={(e) => setValue(e.target.value)} placeholder=\"es. 1500000\" autoFocus />\n        <div className=\"flex gap-3\">\n          <Button variant=\"secondary\" onClick={onCancel} className=\"flex-1\">Annulla</Button>\n          <Button onClick={() => value && onConvert(sale.id, parseFloat(value))} disabled={!value} className=\"flex-1 bg-emerald-500 hover:bg-emerald-600\">Conferma</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Notifications Panel\nfunction NotificationsPanel({ tasks, unreadIds, onClose, onGoToTask, recentSales = [], onMarkAsRead, userId }) {\n  const allNotifications = [\n    ...recentSales.map(s => ({ type: 'sale', id: 'sale_' + s.id, data: s })),\n    ...tasks.map(t => ({ type: 'task', id: `task_${t.id}_${userId}`, data: t }))\n  ];\n  \n  return (\n    <BottomSheet isOpen={true} onClose={onClose} title=\"Notifiche\">\n      {allNotifications.length === 0 ? (\n        <EmptyState icon={Bell} title=\"Nessuna notifica\" description=\"Sei in pari con tutto!\" />\n      ) : (\n        <div className=\"space-y-2\">\n          {recentSales.map(s => (\n            <Card key={'sale_' + s.id} padding=\"p-3\" className={unreadIds.includes('sale_' + s.id) ? 'border-l-2 border-l-emerald-500' : ''}>\n              <div className=\"flex items-start gap-3\">\n                <div className=\"w-8 h-8 rounded-full bg-emerald-500/20 flex items-center justify-center\">\n                  <DollarSign className=\"w-4 h-4 text-emerald-400\" />\n                </div>\n                <div className=\"flex-1\">\n                  <p className=\"text-white text-sm font-medium\">Nuova {s.stato === 'venduto' ? 'Vendita' : 'Lead'}</p>\n                  <p className=\"text-zinc-400 text-xs\">{s.progetto} • {s.agente || s.segnalatore}</p>\n                  <p className=\"text-emerald-400 text-xs font-medium mt-1\">{fmt(s.valore)} AED</p>\n                </div>\n                <div className=\"flex flex-col items-end gap-1\">\n                  <span className=\"text-zinc-500 text-xs\">{fmtShort(s.created_at)}</span>\n                  {unreadIds.includes('sale_' + s.id) && (\n                    <button onClick={(e) => { e.stopPropagation(); onMarkAsRead('sale_' + s.id); }} className=\"text-xs text-zinc-500 hover:text-white\">\n                      <Check className=\"w-4 h-4\" />\n                    </button>\n                  )}\n                </div>\n              </div>\n            </Card>\n          ))}\n          {tasks.map(t => {\n            const taskNotifId = `task_${t.id}_${userId}`;\n            const isUnread = unreadIds.includes(taskNotifId);\n            return (\n              <Card key={t.id} padding=\"p-3\" className={isUnread ? 'border-l-2 border-l-pink-500' : ''}>\n                <div className=\"flex items-start gap-3\">\n                  <div className={`w-2 h-2 rounded-full mt-1.5 ${isOverdue(t.scadenza) ? 'bg-red-500' : 'bg-amber-500'}`} />\n                  <div className=\"flex-1 cursor-pointer\" onClick={onGoToTask}>\n                    <p className=\"text-white text-sm font-medium\">{t.titolo}</p>\n                    <p className={`text-xs ${isOverdue(t.scadenza) ? 'text-red-400' : 'text-zinc-500'}`}>\n                      {t.scadenza ? fmtDateTime(t.scadenza) : 'Senza scadenza'}\n                      {isOverdue(t.scadenza) && ' • Scaduto!'}\n                    </p>\n                    {t.created_by && <p className=\"text-zinc-600 text-xs mt-1\">Da: {t.created_by}</p>}\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <StatusBadge status={t.priorita} type=\"priority\" />\n                    {isUnread && (\n                      <button onClick={(e) => { e.stopPropagation(); onMarkAsRead(taskNotifId); }} className=\"p-1 text-zinc-500 hover:text-white hover:bg-zinc-700 rounded transition-colors\" title=\"Segna come letta\">\n                        <Check className=\"w-4 h-4\" />\n                      </button>\n                    )}\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </BottomSheet>\n  );\n}\n\n// Password Modal\nfunction PasswordModal({ currentPassword, onSave, onClose }) {\n  const [oldPwd, setOldPwd] = useState('');\n  const [newPwd, setNewPwd] = useState('');\n  const [confirmPwd, setConfirmPwd] = useState('');\n  const [error, setError] = useState('');\n\n  const save = () => {\n    if (oldPwd !== currentPassword) { setError('Password attuale errata'); return; }\n    if (newPwd.length < 6) { setError('Minimo 6 caratteri'); return; }\n    if (newPwd !== confirmPwd) { setError('Le password non coincidono'); return; }\n    onSave(newPwd);\n  };\n\n  return (\n    <Modal isOpen onClose={onClose} title=\"Cambia Password\" size=\"sm\">\n      <div className=\"space-y-4\">\n        {error && <div className=\"bg-red-500/10 border border-red-500/20 text-red-400 rounded-xl px-4 py-3 text-sm\">{error}</div>}\n        <Input label=\"Password attuale\" type=\"password\" value={oldPwd} onChange={(e) => setOldPwd(e.target.value)} />\n        <Input label=\"Nuova password\" type=\"password\" value={newPwd} onChange={(e) => setNewPwd(e.target.value)} />\n        <Input label=\"Conferma password\" type=\"password\" value={confirmPwd} onChange={(e) => setConfirmPwd(e.target.value)} />\n        <div className=\"flex gap-3\">\n          <Button variant=\"secondary\" onClick={onClose} className=\"flex-1\">Annulla</Button>\n          <Button onClick={save} className=\"flex-1\">Salva</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Note Modal\nfunction NoteModal({ task, onSave, onClose }) {\n  const [note, setNote] = useState(task?.note || '');\n  \n  return (\n    <Modal isOpen onClose={onClose} title=\"Aggiungi Nota\" size=\"sm\">\n      <div className=\"space-y-4\">\n        <Card padding=\"p-3\" className=\"bg-zinc-700/50/50\">\n          <p className=\"text-white font-medium\">{task?.titolo}</p>\n        </Card>\n        <div>\n          <label className=\"block text-sm text-zinc-400 mb-2\">Nota</label>\n          <textarea value={note} onChange={(e) => setNote(e.target.value)} placeholder=\"Scrivi una nota...\" className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46] h-24 resize-none\" autoFocus />\n        </div>\n        <p className=\"text-zinc-600 text-xs\">L'admin riceverà una notifica email</p>\n        <div className=\"flex gap-3\">\n          <Button variant=\"secondary\" onClick={onClose} className=\"flex-1\">Annulla</Button>\n          <Button onClick={() => onSave(task.id, note)} icon={Send} className=\"flex-1\">Invia</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Cliente Modal\nfunction ClienteModal({ cliente, onSave, onClose }) {\n  const [form, setForm] = useState(cliente || { nome: '', cognome: '', email: '', telefono: '', whatsapp: '', nazionalita: '', budget_min: '', budget_max: '', stato: 'nuovo', fonte: '', note: '' });\n  \n  const save = async () => {\n    if (!form.nome) { alert('Nome obbligatorio'); return; }\n    await onSave(form);\n  };\n\n  return (\n    <Modal isOpen onClose={onClose} title={cliente ? 'Modifica Cliente' : 'Nuovo Cliente'}>\n      <div className=\"space-y-4\">\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Input label=\"Nome *\" value={form.nome} onChange={(e) => setForm({ ...form, nome: e.target.value })} />\n          <Input label=\"Cognome\" value={form.cognome || ''} onChange={(e) => setForm({ ...form, cognome: e.target.value })} />\n        </div>\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Input label=\"Telefono\" type=\"tel\" value={form.telefono || ''} onChange={(e) => setForm({ ...form, telefono: e.target.value })} />\n          <Input label=\"WhatsApp\" type=\"tel\" value={form.whatsapp || ''} onChange={(e) => setForm({ ...form, whatsapp: e.target.value })} />\n        </div>\n        <Input label=\"Email\" type=\"email\" value={form.email || ''} onChange={(e) => setForm({ ...form, email: e.target.value })} />\n        <Input label=\"Nazionalità\" value={form.nazionalita || ''} onChange={(e) => setForm({ ...form, nazionalita: e.target.value })} />\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Input label=\"Budget Min\" type=\"number\" value={form.budget_min || ''} onChange={(e) => setForm({ ...form, budget_min: e.target.value })} />\n          <Input label=\"Budget Max\" type=\"number\" value={form.budget_max || ''} onChange={(e) => setForm({ ...form, budget_max: e.target.value })} />\n        </div>\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Select label=\"Stato\" value={form.stato || 'nuovo'} onChange={(e) => setForm({ ...form, stato: e.target.value })}>\n            {clienteStati.map(s => <option key={s} value={s}>{s}</option>)}\n          </Select>\n          <Input label=\"Fonte\" value={form.fonte || ''} onChange={(e) => setForm({ ...form, fonte: e.target.value })} />\n        </div>\n        <div>\n          <label className=\"block text-sm text-zinc-400 mb-2\">Note</label>\n          <textarea value={form.note || ''} onChange={(e) => setForm({ ...form, note: e.target.value })} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm h-20 resize-none focus:outline-none focus:border-[#3F3F46]\" />\n        </div>\n        <div className=\"flex gap-3 pt-2\">\n          <Button variant=\"secondary\" onClick={onClose} className=\"flex-1\">Annulla</Button>\n          <Button onClick={save} className=\"flex-1\">Salva</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Task Modal\nfunction TaskModal({ task, clienti, users, onSave, onClose }) {\n  const [form, setForm] = useState(task || { titolo: '', descrizione: '', scadenza: '', priorita: 'normale', cliente_id: '', assegnato_a: '' });\n\n  const save = async () => {\n    if (!form.titolo) { alert('Titolo obbligatorio'); return; }\n    await onSave({ ...form, cliente_id: form.cliente_id || null, scadenza: form.scadenza || null });\n  };\n\n  return (\n    <Modal isOpen onClose={onClose} title={task?.id ? 'Modifica Task' : 'Nuovo Task'}>\n      <div className=\"space-y-4\">\n        <Input label=\"Titolo *\" value={form.titolo} onChange={(e) => setForm({ ...form, titolo: e.target.value })} autoFocus />\n        <div>\n          <label className=\"block text-sm text-zinc-400 mb-2\">Descrizione</label>\n          <textarea value={form.descrizione || ''} onChange={(e) => setForm({ ...form, descrizione: e.target.value })} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm h-20 resize-none focus:outline-none focus:border-[#3F3F46]\" />\n        </div>\n        <Input label=\"Scadenza\" type=\"datetime-local\" value={form.scadenza ? form.scadenza.slice(0, 16) : ''} onChange={(e) => setForm({ ...form, scadenza: e.target.value ? new Date(e.target.value).toISOString() : '' })} />\n        <div>\n          <label className=\"block text-sm text-zinc-400 mb-2\">Priorità</label>\n          <div className=\"flex gap-2\">\n            {taskPriorita.map(p => (\n              <button key={p} onClick={() => setForm({ ...form, priorita: p })} className={`flex-1 px-3 py-2 rounded-xl text-sm transition-all ${form.priorita === p ? 'text-white' : 'text-zinc-500'}`} style={form.priorita === p ? { background: theme.priority[p]?.bg, color: theme.priority[p]?.color } : { background: '#334155' }}>\n                {p}\n              </button>\n            ))}\n          </div>\n        </div>\n        <Select label=\"Cliente\" value={form.cliente_id || ''} onChange={(e) => setForm({ ...form, cliente_id: e.target.value })}>\n          <option value=\"\">Nessun cliente</option>\n          {clienti.map(c => <option key={c.id} value={c.id}>{c.nome} {c.cognome}</option>)}\n        </Select>\n        <Select label=\"Assegna a\" value={form.assegnato_a || ''} onChange={(e) => setForm({ ...form, assegnato_a: e.target.value })}>\n          <option value=\"\">Non assegnato</option>\n          {users.filter(u => u.ruolo !== 'admin').map(u => <option key={u.id} value={u.nome}>{u.nome} ({u.ruolo})</option>)}\n        </Select>\n        <div className=\"flex gap-3 pt-2\">\n          <Button variant=\"secondary\" onClick={onClose} className=\"flex-1\">Annulla</Button>\n          <Button onClick={save} className=\"flex-1\">Salva</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// User Modal\nfunction UserModal({ user, onSave, onClose }) {\n  const [form, setForm] = useState(user || { nome: '', username: '', password: '', email: '', ruolo: 'agente', referente: 'Pellegrino', attivo: true });\n  const [saving, setSaving] = useState(false);\n\n  const save = async () => {\n    if (!form.nome || !form.username || !form.password) { alert('Compila i campi obbligatori'); return; }\n    setSaving(true);\n    await onSave(form);\n    setSaving(false);\n  };\n\n  return (\n    <Modal isOpen onClose={onClose} title={user ? 'Modifica Utente' : 'Nuovo Utente'}>\n      <div className=\"space-y-4\">\n        <Input label=\"Nome *\" value={form.nome} onChange={(e) => setForm({ ...form, nome: e.target.value })} />\n        <Input label=\"Email\" type=\"email\" value={form.email || ''} onChange={(e) => setForm({ ...form, email: e.target.value })} placeholder=\"Per notifiche\" />\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Input label=\"Username *\" value={form.username} onChange={(e) => setForm({ ...form, username: e.target.value })} />\n          <Input label=\"Password *\" value={form.password} onChange={(e) => setForm({ ...form, password: e.target.value })} />\n        </div>\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Select label=\"Ruolo\" value={form.ruolo} onChange={(e) => setForm({ ...form, ruolo: e.target.value })}>\n            <option value=\"admin\">Admin</option>\n            <option value=\"agente\">Agente</option>\n            <option value=\"agente_admin\">Agente Admin (70/30)</option>\n            <option value=\"segnalatore\">Segnalatore</option>\n          </Select>\n          <Select label=\"Referente\" value={form.referente} onChange={(e) => setForm({ ...form, referente: e.target.value })} disabled={form.ruolo === 'agente_admin'}>\n            <option value=\"Pellegrino\">Pellegrino</option>\n            <option value=\"Giovanni\">Giovanni</option>\n          </Select>\n        </div>\n        {form.ruolo === 'agente_admin' && (\n          <Card padding=\"p-3\" className=\"bg-violet-500/10 border-violet-500/20\">\n            <p className=\"text-violet-400 text-sm\">💡 <strong>Agente Admin:</strong> 70% commissione all'agente, 30% a Pellegrino</p>\n          </Card>\n        )}\n        {user && (\n          <Card padding=\"p-3\" className=\"flex items-center gap-3\">\n            <input type=\"checkbox\" id=\"attivo\" checked={form.attivo} onChange={(e) => setForm({ ...form, attivo: e.target.checked })} className=\"w-4 h-4 rounded\" />\n            <label htmlFor=\"attivo\" className=\"text-zinc-300 text-sm\">Utente attivo</label>\n          </Card>\n        )}\n        <div className=\"flex gap-3 pt-2\">\n          <Button variant=\"secondary\" onClick={onClose} className=\"flex-1\">Annulla</Button>\n          <Button onClick={save} className=\"flex-1\" disabled={saving}>{saving ? 'Salvataggio...' : 'Salva'}</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// ==================== LEAD & SALE FORMS ====================\n\n// Client Search Component\nfunction ClientSearch({ clienti, onSelect, onCreateNew, selectedClient }) {\n  const [search, setSearch] = useState('');\n  const [show, setShow] = useState(false);\n  const filtered = search.length >= 2 ? clienti.filter(c => `${c.nome} ${c.cognome} ${c.telefono}`.toLowerCase().includes(search.toLowerCase())).slice(0, 5) : [];\n\n  if (selectedClient) {\n    return (\n      <Card padding=\"p-3\" className=\"border-emerald-500/20 bg-emerald-500/5\">\n        <div className=\"flex items-center gap-3\">\n          <Avatar nome={selectedClient.nome} cognome={selectedClient.cognome} size=\"sm\" />\n          <div className=\"flex-1\">\n            <p className=\"text-white font-medium\">{selectedClient.nome} {selectedClient.cognome}</p>\n            <p className=\"text-emerald-400 text-sm\">{selectedClient.telefono}</p>\n          </div>\n          <button onClick={() => onSelect(null)} className=\"text-zinc-500 hover:text-white\"><X className=\"w-5 h-5\" /></button>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"relative\">\n      <div className=\"relative\">\n        <Search className=\"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500\" />\n        <input type=\"text\" placeholder=\"Cerca cliente...\" value={search} onChange={(e) => { setSearch(e.target.value); setShow(true); }} onFocus={() => setShow(true)} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl pl-10 pr-4 py-3 text-white text-sm placeholder:text-zinc-600 focus:outline-none focus:border-[#3F3F46]\" />\n      </div>\n      \n      {show && search.length >= 2 && (\n        <div className=\"absolute z-10 w-full mt-2 bg-[#1e293b] border border-[#334155] rounded-xl overflow-hidden shadow-xl\">\n          {filtered.map(c => (\n            <button key={c.id} onClick={() => { onSelect(c); setSearch(''); setShow(false); }} className=\"w-full text-left px-4 py-3 hover:bg-white/5 border-b border-[#334155] last:border-0 flex items-center gap-3 transition-colors\">\n              <Avatar nome={c.nome} cognome={c.cognome} size=\"sm\" />\n              <div>\n                <p className=\"text-white text-sm\">{c.nome} {c.cognome}</p>\n                <p className=\"text-zinc-500 text-xs\">{c.telefono}</p>\n              </div>\n            </button>\n          ))}\n          {filtered.length === 0 && <div className=\"px-4 py-3 text-zinc-500 text-sm\">Nessun risultato</div>}\n          <button onClick={() => { onCreateNew(); setShow(false); }} className=\"w-full text-left px-4 py-3 bg-blue-500/10 text-blue-400 flex items-center gap-2 hover:bg-blue-500/20 transition-colors\">\n            <UserPlus className=\"w-4 h-4\" /> Nuovo cliente\n          </button>\n        </div>\n      )}\n      \n      {!search && (\n        <button onClick={onCreateNew} className=\"w-full mt-3 border border-dashed border-[#3F3F46] rounded-xl py-3 text-zinc-500 text-sm flex items-center justify-center gap-2 hover:border-amber-500 hover:text-amber-400 transition-colors\">\n          <UserPlus className=\"w-4 h-4\" /> Crea nuovo cliente\n        </button>\n      )}\n    </div>\n  );\n}\n\n// Select with Other Option\nfunction SelectWithOther({ value, onChange, options, placeholder, label }) {\n  const [showCustom, setShowCustom] = useState(false);\n  const [customValue, setCustomValue] = useState('');\n\n  useEffect(() => {\n    if (value && !options.includes(value) && value !== 'Altro') {\n      setShowCustom(true);\n      setCustomValue(value);\n    }\n  }, [value, options]);\n\n  return (\n    <div>\n      {label && <label className=\"block text-sm text-zinc-400 mb-2\">{label}</label>}\n      <select value={showCustom ? 'Altro' : value} onChange={(e) => {\n        if (e.target.value === 'Altro') { setShowCustom(true); setCustomValue(''); onChange(''); }\n        else { setShowCustom(false); onChange(e.target.value); }\n      }} className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm focus:outline-none focus:border-[#3F3F46] appearance-none\">\n        <option value=\"\">{placeholder}</option>\n        {options.map(o => <option key={o} value={o}>{o}</option>)}\n      </select>\n      {showCustom && (\n        <input type=\"text\" value={customValue} onChange={(e) => { setCustomValue(e.target.value); onChange(e.target.value); }} placeholder=\"Specifica...\" className=\"w-full bg-[#1e293b] border border-[#334155] rounded-xl px-4 py-3 text-white text-sm mt-2 focus:outline-none focus:border-[#3F3F46]\" autoFocus />\n      )}\n    </div>\n  );\n}\n\n// Lead Form\nfunction LeadForm({ type, userName, clienti, onSubmit }) {\n  const [selectedClient, setSelectedClient] = useState(null);\n  const [showNewClient, setShowNewClient] = useState(false);\n  const [form, setForm] = useState({\n    data: new Date().toISOString().split('T')[0],\n    developer: '', progetto: '', zona: '', valore: '', stato: 'lead',\n    cliente_nome: '', cliente_cognome: '', cliente_email: '', cliente_telefono: '',\n    cliente_whatsapp: '', cliente_nazionalita: '', cliente_budget_min: '', cliente_budget_max: '', cliente_note: ''\n  });\n\n  const submit = (e) => {\n    e?.preventDefault();\n    if (!selectedClient && !form.cliente_nome) { alert('Seleziona o crea un cliente'); return; }\n    onSubmit({\n      ...form,\n      cliente_id: selectedClient?.id,\n      cliente_nome: selectedClient?.nome || form.cliente_nome,\n      developer: form.developer || 'TBD',\n      progetto: form.progetto || 'TBD',\n      zona: form.zona || 'TBD',\n      valore: form.valore ? parseFloat(form.valore) : 0,\n      agente: type === 'agente' ? userName : null,\n      segnalatore: type === 'segnalatore' ? userName : null\n    });\n  };\n\n  return (\n    <form onSubmit={submit} className=\"space-y-6\">\n      {/* Cliente */}\n      <Card>\n        <h4 className=\"text-white font-medium mb-4 flex items-center gap-2\">\n          <User className=\"w-4 h-4 text-amber-400\" /> Cliente\n        </h4>\n        <ClientSearch clienti={clienti} selectedClient={selectedClient} onSelect={(c) => { setSelectedClient(c); setShowNewClient(false); }} onCreateNew={() => { setSelectedClient(null); setShowNewClient(true); }} />\n        \n        {showNewClient && !selectedClient && (\n          <div className=\"mt-4 pt-4 border-t border-[#334155] space-y-3\">\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input placeholder=\"Nome *\" value={form.cliente_nome} onChange={(e) => setForm({ ...form, cliente_nome: e.target.value })} />\n              <Input placeholder=\"Cognome\" value={form.cliente_cognome} onChange={(e) => setForm({ ...form, cliente_cognome: e.target.value })} />\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input type=\"tel\" placeholder=\"Telefono\" value={form.cliente_telefono} onChange={(e) => setForm({ ...form, cliente_telefono: e.target.value })} />\n              <Input type=\"email\" placeholder=\"Email\" value={form.cliente_email} onChange={(e) => setForm({ ...form, cliente_email: e.target.value })} />\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input type=\"number\" placeholder=\"Budget Min\" value={form.cliente_budget_min} onChange={(e) => setForm({ ...form, cliente_budget_min: e.target.value })} />\n              <Input type=\"number\" placeholder=\"Budget Max\" value={form.cliente_budget_max} onChange={(e) => setForm({ ...form, cliente_budget_max: e.target.value })} />\n            </div>\n          </div>\n        )}\n      </Card>\n\n      {/* Immobile */}\n      <Card>\n        <h4 className=\"text-white font-medium mb-4 flex items-center gap-2\">\n          <Building2 className=\"w-4 h-4 text-blue-400\" /> Immobile\n        </h4>\n        <div className=\"space-y-3\">\n          <div className=\"grid grid-cols-2 gap-3\">\n            <SelectWithOther value={form.developer} onChange={(v) => setForm({ ...form, developer: v })} options={developers} placeholder=\"Developer\" />\n            <SelectWithOther value={form.zona} onChange={(v) => setForm({ ...form, zona: v })} options={zones} placeholder=\"Zona\" />\n          </div>\n          <Input placeholder=\"Progetto\" value={form.progetto} onChange={(e) => setForm({ ...form, progetto: e.target.value })} />\n          <Input type=\"number\" placeholder=\"Valore (AED)\" value={form.valore} onChange={(e) => setForm({ ...form, valore: e.target.value })} />\n        </div>\n      </Card>\n\n      {/* Stato */}\n      <Card>\n        <h4 className=\"text-white font-medium mb-4\">Stato iniziale</h4>\n        <div className=\"flex flex-wrap gap-2\">\n          {pipelineStati.slice(0, 4).map(st => (\n            <button key={st} type=\"button\" onClick={() => setForm({ ...form, stato: st })} className={`px-4 py-2 rounded-xl text-sm transition-all ${form.stato === st ? 'text-white' : 'text-zinc-500'}`} style={form.stato === st ? { background: theme.status[st]?.bg, color: theme.status[st]?.color } : { background: '#334155' }}>\n              {pipelineLabels[st] || st}\n            </button>\n          ))}\n        </div>\n      </Card>\n\n      <button type=\"submit\" id=\"submitBtn\" className=\"hidden\">Submit</button>\n    </form>\n  );\n}\n\n// Sale Form\nfunction SaleForm({ type, userName, clienti, onSubmit }) {\n  const [selectedClient, setSelectedClient] = useState(null);\n  const [showNewClient, setShowNewClient] = useState(false);\n  const [form, setForm] = useState({\n    data: new Date().toISOString().split('T')[0],\n    developer: '', progetto: '', zona: '', valore: '',\n    nuovo_cliente_nome: '', nuovo_cliente_cognome: '', nuovo_cliente_telefono: '', nuovo_cliente_email: ''\n  });\n\n  const submit = (e) => {\n    e?.preventDefault();\n    if (!selectedClient && !form.nuovo_cliente_nome) { alert('Seleziona o inserisci il cliente'); return; }\n    if (!form.developer || !form.progetto || !form.zona || !form.valore) { alert('Compila tutti i campi dell\\'immobile'); return; }\n    onSubmit({\n      data: form.data,\n      developer: form.developer,\n      progetto: form.progetto,\n      zona: form.zona,\n      valore: parseFloat(form.valore),\n      agente: type === 'agente' ? userName : null,\n      segnalatore: type === 'segnalatore' ? userName : null,\n      cliente_id: selectedClient?.id,\n      cliente_nome: selectedClient?.nome || form.nuovo_cliente_nome,\n      nuovo_cliente_nome: form.nuovo_cliente_nome,\n      nuovo_cliente_cognome: form.nuovo_cliente_cognome,\n      nuovo_cliente_telefono: form.nuovo_cliente_telefono,\n      nuovo_cliente_email: form.nuovo_cliente_email\n    });\n  };\n\n  return (\n    <form onSubmit={submit} className=\"space-y-6\">\n      {/* Cliente */}\n      <Card>\n        <h4 className=\"text-white font-medium mb-4 flex items-center gap-2\">\n          <User className=\"w-4 h-4 text-amber-400\" /> Cliente Acquirente\n        </h4>\n        <ClientSearch clienti={clienti} selectedClient={selectedClient} onSelect={(c) => { setSelectedClient(c); setShowNewClient(false); }} onCreateNew={() => { setSelectedClient(null); setShowNewClient(true); }} />\n        \n        {showNewClient && !selectedClient && (\n          <div className=\"mt-4 pt-4 border-t border-[#334155] space-y-3\">\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input placeholder=\"Nome *\" value={form.nuovo_cliente_nome} onChange={(e) => setForm({ ...form, nuovo_cliente_nome: e.target.value })} />\n              <Input placeholder=\"Cognome\" value={form.nuovo_cliente_cognome} onChange={(e) => setForm({ ...form, nuovo_cliente_cognome: e.target.value })} />\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input type=\"tel\" placeholder=\"Telefono\" value={form.nuovo_cliente_telefono} onChange={(e) => setForm({ ...form, nuovo_cliente_telefono: e.target.value })} />\n              <Input type=\"email\" placeholder=\"Email\" value={form.nuovo_cliente_email} onChange={(e) => setForm({ ...form, nuovo_cliente_email: e.target.value })} />\n            </div>\n          </div>\n        )}\n      </Card>\n\n      {/* Vendita */}\n      <Card>\n        <h4 className=\"text-white font-medium mb-4 flex items-center gap-2\">\n          <DollarSign className=\"w-4 h-4 text-emerald-400\" /> Dettagli Vendita\n        </h4>\n        <div className=\"space-y-3\">\n          <Input label=\"Data\" type=\"date\" value={form.data} onChange={(e) => setForm({ ...form, data: e.target.value })} />\n          <SelectWithOther label=\"Developer *\" value={form.developer} onChange={(v) => setForm({ ...form, developer: v })} options={developers} placeholder=\"Seleziona developer\" />\n          <Input label=\"Progetto *\" value={form.progetto} onChange={(e) => setForm({ ...form, progetto: e.target.value })} placeholder=\"Nome progetto\" />\n          <SelectWithOther label=\"Zona *\" value={form.zona} onChange={(v) => setForm({ ...form, zona: v })} options={zones} placeholder=\"Seleziona zona\" />\n          <Input label=\"Valore (AED) *\" type=\"number\" value={form.valore} onChange={(e) => setForm({ ...form, valore: e.target.value })} placeholder=\"es. 1500000\" />\n        </div>\n      </Card>\n\n      <button type=\"submit\" id=\"submitBtn\" className=\"hidden\">Submit</button>\n    </form>\n  );\n}\n\n// ==================== ROI CALCULATOR ====================\nconst roiZones = {\n  // DUBAI\n  'Palm Jumeirah': { emirate: 'Dubai', cat: 'Ultra Premium', e: '🌴', lt: 5.5, rent: 180000, sqft: 2800, occ: 78, night: 1200, opAppr: 15, opDisc: 10, opHand: 30, secAppr: 8, scNew: 22, scOld: 30, dewa: 8000, ageNew: '2020+', ageMid: '2010-19', ageOld: '2005-09' },\n  'Emirates Hills': { emirate: 'Dubai', cat: 'Ultra Premium', e: '⛳', lt: 4.0, rent: 250000, sqft: 3500, occ: 50, night: 2500, opAppr: 8, opDisc: 5, opHand: 36, secAppr: 5, scNew: 5, scOld: 7, dewa: 15000, ageNew: '2020+', ageMid: '2008-19', ageOld: '2003-07' },\n  'Bluewaters Island': { emirate: 'Dubai', cat: 'Ultra Premium', e: '🎡', lt: 5.2, rent: 160000, sqft: 3000, occ: 75, night: 1100, opAppr: 12, opDisc: 8, opHand: 24, secAppr: 7, scNew: 25, scOld: 32, dewa: 7500, ageNew: '2020+', ageMid: '2018-19', ageOld: null },\n  'Downtown Dubai': { emirate: 'Dubai', cat: 'Premium', e: '🏙️', lt: 5.8, rent: 130000, sqft: 2400, occ: 82, night: 900, opAppr: 18, opDisc: 12, opHand: 30, secAppr: 8, scNew: 18, scOld: 28, dewa: 7500, ageNew: '2020+', ageMid: '2010-19', ageOld: '2006-09' },\n  'Dubai Marina': { emirate: 'Dubai', cat: 'Premium', e: '⛵', lt: 6.2, rent: 105000, sqft: 1700, occ: 82, night: 700, opAppr: 12, opDisc: 10, opHand: 24, secAppr: 6, scNew: 15, scOld: 22, dewa: 6500, ageNew: '2018+', ageMid: '2008-17', ageOld: '2003-07' },\n  'DIFC': { emirate: 'Dubai', cat: 'Premium', e: '🏦', lt: 5.0, rent: 150000, sqft: 3200, occ: 65, night: 950, opAppr: 10, opDisc: 8, opHand: 30, secAppr: 6, scNew: 28, scOld: 38, dewa: 8000, ageNew: '2020+', ageMid: '2010-19', ageOld: '2005-09' },\n  'Jumeirah': { emirate: 'Dubai', cat: 'Premium', e: '🏖️', lt: 4.8, rent: 140000, sqft: 2600, occ: 60, night: 1000, opAppr: 8, opDisc: 5, opHand: 30, secAppr: 5, scNew: 8, scOld: 12, dewa: 9000, ageNew: '2015+', ageMid: '2000-14', ageOld: '1990-99' },\n  'Al Wasl': { emirate: 'Dubai', cat: 'Premium', e: '🌇', lt: 5.0, rent: 135000, sqft: 2500, occ: 55, night: 900, opAppr: 7, opDisc: 5, opHand: 28, secAppr: 5, scNew: 8, scOld: 12, dewa: 8500, ageNew: '2018+', ageMid: '2005-17', ageOld: '1995-04' },\n  'JBR': { emirate: 'Dubai', cat: 'High-End', e: '🏖️', lt: 6.0, rent: 110000, sqft: 1900, occ: 85, night: 800, opAppr: 10, opDisc: 8, opHand: 24, secAppr: 5, scNew: 14, scOld: 18, dewa: 6000, ageNew: '2018+', ageMid: '2008-17', ageOld: '2005-07' },\n  'Dubai Creek Harbour': { emirate: 'Dubai', cat: 'High-End', e: '🌊', lt: 6.5, rent: 95000, sqft: 1600, occ: 70, night: 600, opAppr: 25, opDisc: 15, opHand: 30, secAppr: 12, scNew: 14, scOld: 18, dewa: 6000, ageNew: '2020+', ageMid: '2018-19', ageOld: null },\n  'Dubai Hills Estate': { emirate: 'Dubai', cat: 'High-End', e: '🌳', lt: 6.5, rent: 100000, sqft: 1700, occ: 60, night: 650, opAppr: 20, opDisc: 12, opHand: 28, secAppr: 10, scNew: 12, scOld: 16, dewa: 6500, ageNew: '2020+', ageMid: '2017-19', ageOld: null },\n  'MBR City': { emirate: 'Dubai', cat: 'High-End', e: '👑', lt: 6.8, rent: 90000, sqft: 1500, occ: 65, night: 550, opAppr: 22, opDisc: 15, opHand: 30, secAppr: 12, scNew: 11, scOld: 15, dewa: 6000, ageNew: '2020+', ageMid: '2016-19', ageOld: null },\n  'City Walk': { emirate: 'Dubai', cat: 'High-End', e: '🛍️', lt: 5.5, rent: 120000, sqft: 2200, occ: 72, night: 750, opAppr: 12, opDisc: 8, opHand: 24, secAppr: 7, scNew: 18, scOld: 24, dewa: 7000, ageNew: '2020+', ageMid: '2015-19', ageOld: null },\n  'Sobha Hartland': { emirate: 'Dubai', cat: 'High-End', e: '🌿', lt: 6.2, rent: 95000, sqft: 1650, occ: 62, night: 580, opAppr: 18, opDisc: 12, opHand: 28, secAppr: 10, scNew: 13, scOld: 17, dewa: 6200, ageNew: '2020+', ageMid: '2018-19', ageOld: null },\n  'Arabian Ranches': { emirate: 'Dubai', cat: 'High-End', e: '🐎', lt: 5.5, rent: 120000, sqft: 1800, occ: 50, night: 700, opAppr: 10, opDisc: 8, opHand: 28, secAppr: 6, scNew: 4, scOld: 6, dewa: 8000, ageNew: '2020+', ageMid: '2008-19', ageOld: '2004-07' },\n  'Wasl Gate': { emirate: 'Dubai', cat: 'High-End', e: '🚪', lt: 6.5, rent: 85000, sqft: 1400, occ: 68, night: 520, opAppr: 15, opDisc: 10, opHand: 26, secAppr: 8, scNew: 12, scOld: 16, dewa: 5800, ageNew: '2020+', ageMid: '2016-19', ageOld: null },\n  'Business Bay': { emirate: 'Dubai', cat: 'Mid-Market', e: '💼', lt: 7.2, rent: 78000, sqft: 1350, occ: 75, night: 500, opAppr: 15, opDisc: 12, opHand: 24, secAppr: 8, scNew: 14, scOld: 20, dewa: 5500, ageNew: '2020+', ageMid: '2012-19', ageOld: '2008-11' },\n  'JLT': { emirate: 'Dubai', cat: 'Mid-Market', e: '🏢', lt: 7.5, rent: 68000, sqft: 1050, occ: 70, night: 420, opAppr: 8, opDisc: 8, opHand: 24, secAppr: 5, scNew: 11, scOld: 16, dewa: 5000, ageNew: '2018+', ageMid: '2008-17', ageOld: '2006-07' },\n  'JVC': { emirate: 'Dubai', cat: 'Mid-Market', e: '🏘️', lt: 8.0, rent: 55000, sqft: 850, occ: 78, night: 350, opAppr: 18, opDisc: 15, opHand: 22, secAppr: 10, scNew: 9, scOld: 14, dewa: 4500, ageNew: '2020+', ageMid: '2015-19', ageOld: '2010-14' },\n  'JVT': { emirate: 'Dubai', cat: 'Mid-Market', e: '📐', lt: 7.8, rent: 52000, sqft: 820, occ: 72, night: 330, opAppr: 16, opDisc: 14, opHand: 22, secAppr: 9, scNew: 9, scOld: 13, dewa: 4400, ageNew: '2020+', ageMid: '2015-19', ageOld: '2010-14' },\n  'Al Barsha': { emirate: 'Dubai', cat: 'Mid-Market', e: '🏬', lt: 7.0, rent: 65000, sqft: 1100, occ: 68, night: 400, opAppr: 8, opDisc: 6, opHand: 24, secAppr: 4, scNew: 10, scOld: 15, dewa: 5000, ageNew: '2018+', ageMid: '2008-17', ageOld: '2000-07' },\n  'Tecom': { emirate: 'Dubai', cat: 'Mid-Market', e: '💻', lt: 7.3, rent: 62000, sqft: 1000, occ: 68, night: 400, opAppr: 8, opDisc: 8, opHand: 24, secAppr: 5, scNew: 10, scOld: 15, dewa: 4800, ageNew: '2018+', ageMid: '2005-17', ageOld: '2002-04' },\n  'Sports City': { emirate: 'Dubai', cat: 'Value', e: '⚽', lt: 8.5, rent: 48000, sqft: 700, occ: 72, night: 320, opAppr: 12, opDisc: 12, opHand: 20, secAppr: 7, scNew: 8, scOld: 12, dewa: 4200, ageNew: '2020+', ageMid: '2012-19', ageOld: '2008-11' },\n  'Arjan': { emirate: 'Dubai', cat: 'Value', e: '🦋', lt: 7.8, rent: 50000, sqft: 800, occ: 65, night: 300, opAppr: 18, opDisc: 15, opHand: 20, secAppr: 10, scNew: 8, scOld: 12, dewa: 4300, ageNew: '2020+', ageMid: '2016-19', ageOld: null },\n  'Al Furjan': { emirate: 'Dubai', cat: 'Value', e: '🏡', lt: 7.3, rent: 58000, sqft: 950, occ: 62, night: 350, opAppr: 14, opDisc: 12, opHand: 22, secAppr: 8, scNew: 8, scOld: 11, dewa: 4800, ageNew: '2020+', ageMid: '2015-19', ageOld: '2012-14' },\n  'Motor City': { emirate: 'Dubai', cat: 'Value', e: '🏎️', lt: 7.5, rent: 52000, sqft: 850, occ: 58, night: 320, opAppr: 10, opDisc: 10, opHand: 22, secAppr: 6, scNew: 9, scOld: 13, dewa: 4600, ageNew: '2018+', ageMid: '2008-17', ageOld: '2005-07' },\n  'Mudon': { emirate: 'Dubai', cat: 'Value', e: '🏠', lt: 7.2, rent: 60000, sqft: 1000, occ: 55, night: 380, opAppr: 12, opDisc: 10, opHand: 24, secAppr: 7, scNew: 5, scOld: 7, dewa: 5000, ageNew: '2020+', ageMid: '2015-19', ageOld: null },\n  'Mirdif': { emirate: 'Dubai', cat: 'Value', e: '🌺', lt: 6.8, rent: 55000, sqft: 950, occ: 55, night: 350, opAppr: 8, opDisc: 8, opHand: 24, secAppr: 5, scNew: 7, scOld: 10, dewa: 5000, ageNew: '2018+', ageMid: '2008-17', ageOld: '2000-07' },\n  'Silicon Oasis': { emirate: 'Dubai', cat: 'Affordable', e: '💻', lt: 9.0, rent: 45000, sqft: 650, occ: 68, night: 280, opAppr: 15, opDisc: 12, opHand: 22, secAppr: 8, scNew: 7, scOld: 11, dewa: 4000, ageNew: '2020+', ageMid: '2012-19', ageOld: '2008-11' },\n  'International City': { emirate: 'Dubai', cat: 'Affordable', e: '🌍', lt: 9.5, rent: 35000, sqft: 480, occ: 65, night: 220, opAppr: 8, opDisc: 8, opHand: 20, secAppr: 5, scNew: 5, scOld: 8, dewa: 3500, ageNew: '2018+', ageMid: '2008-17', ageOld: '2005-07' },\n  'Discovery Gardens': { emirate: 'Dubai', cat: 'Affordable', e: '🌻', lt: 9.2, rent: 38000, sqft: 520, occ: 60, night: 240, opAppr: 5, opDisc: 5, opHand: 20, secAppr: 3, scNew: 6, scOld: 10, dewa: 3800, ageNew: '2015+', ageMid: '2008-14', ageOld: '2005-07' },\n  'DIP': { emirate: 'Dubai', cat: 'Affordable', e: '🏭', lt: 9.8, rent: 32000, sqft: 420, occ: 55, night: 200, opAppr: 8, opDisc: 8, opHand: 22, secAppr: 4, scNew: 5, scOld: 8, dewa: 3200, ageNew: '2018+', ageMid: '2008-17', ageOld: '2005-07' },\n  'Al Nahda Dubai': { emirate: 'Dubai', cat: 'Affordable', e: '🏠', lt: 8.5, rent: 40000, sqft: 580, occ: 62, night: 250, opAppr: 6, opDisc: 6, opHand: 22, secAppr: 4, scNew: 6, scOld: 10, dewa: 3600, ageNew: '2015+', ageMid: '2005-14', ageOld: '1998-04' },\n  'Deira': { emirate: 'Dubai', cat: 'Affordable', e: '🕌', lt: 8.2, rent: 42000, sqft: 620, occ: 65, night: 280, opAppr: 6, opDisc: 5, opHand: 24, secAppr: 3, scNew: 7, scOld: 12, dewa: 3800, ageNew: '2015+', ageMid: '2000-14', ageOld: '1990-99' },\n  'Bur Dubai': { emirate: 'Dubai', cat: 'Affordable', e: '🛶', lt: 7.8, rent: 45000, sqft: 700, occ: 70, night: 320, opAppr: 5, opDisc: 5, opHand: 24, secAppr: 3, scNew: 8, scOld: 14, dewa: 4000, ageNew: '2015+', ageMid: '2000-14', ageOld: '1985-99' },\n  'Jebel Ali': { emirate: 'Dubai', cat: 'Affordable', e: '🚢', lt: 8.8, rent: 38000, sqft: 550, occ: 58, night: 240, opAppr: 10, opDisc: 10, opHand: 24, secAppr: 6, scNew: 6, scOld: 10, dewa: 3600, ageNew: '2018+', ageMid: '2008-17', ageOld: '2000-07' },\n  'Dubai South': { emirate: 'Dubai', cat: 'Emerging', e: '✈️', lt: 8.5, rent: 40000, sqft: 600, occ: 55, night: 250, opAppr: 25, opDisc: 20, opHand: 28, secAppr: 15, scNew: 7, scOld: 10, dewa: 3800, ageNew: '2022+', ageMid: '2018-21', ageOld: null },\n  'Expo City': { emirate: 'Dubai', cat: 'Emerging', e: '🎪', lt: 7.5, rent: 55000, sqft: 900, occ: 60, night: 350, opAppr: 30, opDisc: 18, opHand: 30, secAppr: 18, scNew: 10, scOld: 14, dewa: 4500, ageNew: '2022+', ageMid: null, ageOld: null },\n  'Damac Hills': { emirate: 'Dubai', cat: 'Emerging', e: '🏌️', lt: 7.8, rent: 52000, sqft: 820, occ: 62, night: 320, opAppr: 18, opDisc: 15, opHand: 24, secAppr: 10, scNew: 8, scOld: 12, dewa: 4300, ageNew: '2020+', ageMid: '2017-19', ageOld: null },\n  'Damac Hills 2': { emirate: 'Dubai', cat: 'Emerging', e: '🏡', lt: 8.5, rent: 42000, sqft: 620, occ: 55, night: 280, opAppr: 20, opDisc: 18, opHand: 22, secAppr: 12, scNew: 6, scOld: 9, dewa: 4000, ageNew: '2021+', ageMid: '2019-20', ageOld: null },\n  'Town Square': { emirate: 'Dubai', cat: 'Emerging', e: '🏪', lt: 8.2, rent: 48000, sqft: 720, occ: 58, night: 290, opAppr: 15, opDisc: 12, opHand: 22, secAppr: 9, scNew: 7, scOld: 10, dewa: 4100, ageNew: '2020+', ageMid: '2017-19', ageOld: null },\n  'Tilal Al Ghaf': { emirate: 'Dubai', cat: 'Emerging', e: '🌴', lt: 6.5, rent: 85000, sqft: 1400, occ: 50, night: 500, opAppr: 25, opDisc: 15, opHand: 30, secAppr: 15, scNew: 5, scOld: 7, dewa: 6000, ageNew: '2022+', ageMid: null, ageOld: null },\n  'The Valley': { emirate: 'Dubai', cat: 'Emerging', e: '🏞️', lt: 7.0, rent: 55000, sqft: 900, occ: 48, night: 350, opAppr: 28, opDisc: 20, opHand: 32, secAppr: 15, scNew: 6, scOld: 8, dewa: 4500, ageNew: '2024+', ageMid: null, ageOld: null },\n  // RAK\n  'Al Marjan Island': { emirate: 'RAK', cat: 'Premium', e: '🏝️', lt: 7.5, rent: 70000, sqft: 1200, occ: 72, night: 550, opAppr: 25, opDisc: 15, opHand: 28, secAppr: 15, scNew: 14, scOld: 18, dewa: 4500, ageNew: '2022+', ageMid: '2018-21', ageOld: null },\n  'Mina Al Arab': { emirate: 'RAK', cat: 'High-End', e: '🌊', lt: 7.0, rent: 65000, sqft: 1000, occ: 68, night: 480, opAppr: 20, opDisc: 12, opHand: 26, secAppr: 12, scNew: 12, scOld: 16, dewa: 4200, ageNew: '2020+', ageMid: '2016-19', ageOld: null },\n  'Al Hamra Village': { emirate: 'RAK', cat: 'Mid-Market', e: '⛳', lt: 7.8, rent: 55000, sqft: 850, occ: 65, night: 380, opAppr: 15, opDisc: 10, opHand: 24, secAppr: 10, scNew: 10, scOld: 14, dewa: 3800, ageNew: '2018+', ageMid: '2008-17', ageOld: '2005-07' },\n  'Yasmin Village RAK': { emirate: 'RAK', cat: 'Affordable', e: '🌸', lt: 11.0, rent: 35000, sqft: 450, occ: 70, night: 250, opAppr: 10, opDisc: 8, opHand: 20, secAppr: 6, scNew: 6, scOld: 9, dewa: 3000, ageNew: '2015+', ageMid: '2008-14', ageOld: '2005-07' },\n  'Hayat Island': { emirate: 'RAK', cat: 'Emerging', e: '🏖️', lt: 7.2, rent: 60000, sqft: 950, occ: 62, night: 420, opAppr: 22, opDisc: 15, opHand: 28, secAppr: 14, scNew: 11, scOld: 15, dewa: 4000, ageNew: '2023+', ageMid: null, ageOld: null },\n  // ABU DHABI\n  'Saadiyat Island': { emirate: 'Abu Dhabi', cat: 'Ultra Premium', e: '🏛️', lt: 5.0, rent: 180000, sqft: 2800, occ: 60, night: 1100, opAppr: 12, opDisc: 8, opHand: 30, secAppr: 7, scNew: 20, scOld: 28, dewa: 8000, ageNew: '2020+', ageMid: '2015-19', ageOld: null },\n  'Yas Island': { emirate: 'Abu Dhabi', cat: 'Premium', e: '🎢', lt: 6.0, rent: 95000, sqft: 1500, occ: 70, night: 650, opAppr: 15, opDisc: 10, opHand: 28, secAppr: 8, scNew: 14, scOld: 18, dewa: 5500, ageNew: '2020+', ageMid: '2012-19', ageOld: null },\n  'Al Reem Island': { emirate: 'Abu Dhabi', cat: 'High-End', e: '🌆', lt: 7.0, rent: 75000, sqft: 1200, occ: 72, night: 500, opAppr: 12, opDisc: 10, opHand: 26, secAppr: 7, scNew: 12, scOld: 16, dewa: 5000, ageNew: '2018+', ageMid: '2010-17', ageOld: '2008-09' },\n  'Al Raha Beach': { emirate: 'Abu Dhabi', cat: 'High-End', e: '🏖️', lt: 6.5, rent: 85000, sqft: 1350, occ: 65, night: 550, opAppr: 10, opDisc: 8, opHand: 26, secAppr: 6, scNew: 13, scOld: 17, dewa: 5200, ageNew: '2018+', ageMid: '2008-17', ageOld: null },\n  'Khalifa City': { emirate: 'Abu Dhabi', cat: 'Mid-Market', e: '🏘️', lt: 7.5, rent: 55000, sqft: 850, occ: 68, night: 380, opAppr: 8, opDisc: 8, opHand: 24, secAppr: 5, scNew: 8, scOld: 12, dewa: 4200, ageNew: '2018+', ageMid: '2008-17', ageOld: '2000-07' },\n  'Masdar City': { emirate: 'Abu Dhabi', cat: 'Emerging', e: '🌱', lt: 7.8, rent: 58000, sqft: 900, occ: 65, night: 400, opAppr: 18, opDisc: 15, opHand: 28, secAppr: 10, scNew: 10, scOld: 14, dewa: 4500, ageNew: '2020+', ageMid: '2015-19', ageOld: null },\n  // SHARJAH\n  'Al Mamzar SHJ': { emirate: 'Sharjah', cat: 'Mid-Market', e: '🏖️', lt: 8.0, rent: 42000, sqft: 650, occ: 65, night: 300, opAppr: 8, opDisc: 6, opHand: 24, secAppr: 5, scNew: 6, scOld: 10, dewa: 3500, ageNew: '2015+', ageMid: '2005-14', ageOld: '1995-04' },\n  'Al Nahda SHJ': { emirate: 'Sharjah', cat: 'Affordable', e: '🏢', lt: 9.0, rent: 35000, sqft: 500, occ: 75, night: 250, opAppr: 5, opDisc: 5, opHand: 22, secAppr: 3, scNew: 5, scOld: 8, dewa: 3000, ageNew: '2015+', ageMid: '2000-14', ageOld: '1990-99' },\n  'Aljada': { emirate: 'Sharjah', cat: 'Emerging', e: '🏗️', lt: 7.8, rent: 52000, sqft: 800, occ: 60, night: 350, opAppr: 18, opDisc: 15, opHand: 26, secAppr: 10, scNew: 9, scOld: 12, dewa: 4000, ageNew: '2022+', ageMid: null, ageOld: null },\n  // AJMAN\n  'Ajman Downtown': { emirate: 'Ajman', cat: 'Affordable', e: '🏙️', lt: 10.5, rent: 28000, sqft: 380, occ: 70, night: 200, opAppr: 8, opDisc: 8, opHand: 20, secAppr: 5, scNew: 4, scOld: 7, dewa: 2500, ageNew: '2018+', ageMid: '2008-17', ageOld: '2000-07' },\n  'Ajman Corniche': { emirate: 'Ajman', cat: 'Mid-Market', e: '🌅', lt: 9.0, rent: 35000, sqft: 500, occ: 65, night: 250, opAppr: 10, opDisc: 8, opHand: 22, secAppr: 6, scNew: 5, scOld: 9, dewa: 3000, ageNew: '2018+', ageMid: '2008-17', ageOld: '2000-07' },\n  // UAQ\n  'UAQ Marina': { emirate: 'UAQ', cat: 'Affordable', e: '⛵', lt: 9.5, rent: 30000, sqft: 420, occ: 55, night: 220, opAppr: 12, opDisc: 10, opHand: 24, secAppr: 7, scNew: 5, scOld: 8, dewa: 2800, ageNew: '2020+', ageMid: '2015-19', ageOld: null },\n};\n\nconst roiBrMult = { rent: [0.55,1,1.55,2.1,2.8], night: [0.65,1,1.45,1.9,2.5], dewa: [0.6,1,1.4,1.8,2.3] };\nconst roiAgeMult = { new: {sc:1,maint:0,rent:1.05,appr:1.2}, mid: {sc:1.2,maint:5000,rent:1,appr:1}, old: {sc:1.5,maint:12000,rent:0.92,appr:0.7} };\n\nfunction ROICalculator() {\n  const [emirate, setEmirate] = useState('all');\n  const [z, setZ] = useState('Business Bay');\n  const [price, setPrice] = useState(1200000);\n  const [sqft, setSqft] = useState(850);\n  const [br, setBr] = useState(1);\n  const [mkt, setMkt] = useState('offplan');\n  const [age, setAge] = useState('new');\n  const [tab, setTab] = useState('overview');\n\n  const d = roiZones[z];\n  const a = roiAgeMult[age];\n  const sc = mkt === 'offplan' ? d.scNew : (age === 'old' ? d.scOld : d.scNew);\n  const costs = sc * sqft * a.sc + d.dewa * roiBrMult.dewa[br] + 1000 + a.maint;\n  \n  const rent = d.rent * roiBrMult.rent[br] * a.rent;\n  const ltNet = rent - costs;\n  const ltYield = (ltNet / price * 100).toFixed(1);\n  \n  const stGross = d.night * roiBrMult.night[br] * 365 * d.occ / 100;\n  const stNet = stGross - costs - 2500 - stGross * 0.28;\n  const stYield = (stNet / price * 100).toFixed(1);\n  \n  const appr = (mkt === 'offplan' ? d.opAppr : d.secAppr) * a.appr;\n  const disc = mkt === 'offplan' ? d.opDisc : 0;\n  const effPrice = price * (1 - disc/100);\n  const futVal = effPrice * (1 + appr/100);\n  const profit = futVal - effPrice;\n  \n  const fmt = n => new Intl.NumberFormat('it-IT').format(Math.round(n));\n\n  // Group zones by emirate\n  const grouped = {};\n  Object.entries(roiZones).forEach(([name, data]) => {\n    const em = data.emirate;\n    if (!grouped[em]) grouped[em] = {};\n    if (!grouped[em][data.cat]) grouped[em][data.cat] = [];\n    grouped[em][data.cat].push({name, ...data});\n  });\n\n  const filteredZones = emirate === 'all' ? grouped : { [emirate]: grouped[emirate] };\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Emirate Filter */}\n      <div className=\"flex gap-2 overflow-x-auto pb-2\">\n        <button onClick={()=>setEmirate('all')} className={`py-1.5 px-4 rounded-full text-sm font-medium whitespace-nowrap transition-all ${emirate==='all'?'bg-emerald-500 text-white':'bg-[#334155] text-zinc-400 hover:bg-[#475569]'}`}>🇦🇪 Tutti</button>\n        {['Dubai','Abu Dhabi','RAK','Sharjah','Ajman','UAQ'].map(em=>(\n          <button key={em} onClick={()=>setEmirate(em)} className={`py-1.5 px-4 rounded-full text-sm font-medium whitespace-nowrap transition-all ${emirate===em?'bg-emerald-500 text-white':'bg-[#334155] text-zinc-400 hover:bg-[#475569]'}`}>\n            {em==='RAK'?'🏝️':em==='Dubai'?'🌆':em==='Abu Dhabi'?'🏛️':em==='Sharjah'?'📚':em==='Ajman'?'🏠':'⛵'} {em}\n          </button>\n        ))}\n      </div>\n\n      {/* Inputs */}\n      <div className=\"bg-[#1e293b] rounded-xl p-4 border border-[#334155]\">\n        <div className=\"grid grid-cols-2 md:grid-cols-6 gap-3\">\n          <div className=\"col-span-2\">\n            <label className=\"text-zinc-500 text-xs block mb-1\">Zona</label>\n            <select value={z} onChange={e=>setZ(e.target.value)} className=\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\">\n              {Object.entries(filteredZones).map(([em, cats])=>(\n                <optgroup key={em} label={`━━ ${em} ━━`}>\n                  {Object.entries(cats || {}).map(([cat, list])=>(\n                    <React.Fragment key={cat}>\n                      <option disabled className=\"text-zinc-500\">── {cat} ──</option>\n                      {(list || []).map(item=><option key={item.name} value={item.name}>{item.e} {item.name}</option>)}\n                    </React.Fragment>\n                  ))}\n                </optgroup>\n              ))}\n            </select>\n          </div>\n          <div>\n            <label className=\"text-zinc-500 text-xs block mb-1\">Prezzo (AED)</label>\n            <input type=\"number\" value={price} onChange={e=>setPrice(+e.target.value)} className=\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\"/>\n          </div>\n          <div>\n            <label className=\"text-zinc-500 text-xs block mb-1\">Sqft</label>\n            <input type=\"number\" value={sqft} onChange={e=>setSqft(+e.target.value)} className=\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\"/>\n          </div>\n          <div>\n            <label className=\"text-zinc-500 text-xs block mb-1\">Camere</label>\n            <select value={br} onChange={e=>setBr(+e.target.value)} className=\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\">\n              {['Studio','1BR','2BR','3BR','4+BR'].map((l,i)=><option key={i} value={i}>{l}</option>)}\n            </select>\n          </div>\n          <div>\n            <label className=\"text-zinc-500 text-xs block mb-1\">Mercato</label>\n            <select value={mkt} onChange={e=>setMkt(e.target.value)} className=\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\">\n              <option value=\"offplan\">🏗️ Off-Plan</option>\n              <option value=\"secondary\">🏢 Secondary</option>\n            </select>\n          </div>\n        </div>\n        \n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-3 mt-3\">\n          {mkt === 'secondary' && (\n            <div>\n              <label className=\"text-zinc-500 text-xs block mb-1\">Età Edificio</label>\n              <select value={age} onChange={e=>setAge(e.target.value)} className=\"w-full bg-[#334155] border-none rounded-lg px-3 py-2 text-sm text-white\">\n                <option value=\"new\">🆕 {d.ageNew}</option>\n                {d.ageMid && <option value=\"mid\">📅 {d.ageMid}</option>}\n                {d.ageOld && <option value=\"old\">🏚️ {d.ageOld}</option>}\n              </select>\n            </div>\n          )}\n          <div className=\"bg-[#334155]/50 rounded-lg p-2\">\n            <p className=\"text-zinc-500 text-xs\">{d.emirate} • {d.cat}</p>\n            <p className=\"text-white font-medium text-sm\">{d.e} {z}</p>\n          </div>\n          <div className=\"bg-amber-500/10 rounded-lg p-2 text-center border border-amber-500/20\">\n            <p className=\"text-amber-400 text-xs\">SC/sqft</p>\n            <p className=\"text-white font-bold\">{sc} AED</p>\n          </div>\n          {mkt === 'offplan' ? (\n            <>\n              <div className=\"bg-emerald-500/10 rounded-lg p-2 text-center border border-emerald-500/20\">\n                <p className=\"text-emerald-400 text-xs\">Discount</p>\n                <p className=\"text-white font-bold\">-{disc}%</p>\n              </div>\n              <div className=\"bg-purple-500/10 rounded-lg p-2 text-center border border-purple-500/20\">\n                <p className=\"text-purple-400 text-xs\">Apprezzamento</p>\n                <p className=\"text-white font-bold\">+{d.opAppr}%</p>\n              </div>\n            </>\n          ) : (\n            <div className=\"bg-red-500/10 rounded-lg p-2 text-center border border-red-500/20\">\n              <p className=\"text-red-400 text-xs\">Manutenzione</p>\n              <p className=\"text-white font-bold\">{fmt(a.maint)}/y</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-2 overflow-x-auto\">\n        {['overview','rental','capital','costs'].map(t=>(\n          <button key={t} onClick={()=>setTab(t)} className={`py-2 px-4 rounded-lg text-sm font-medium transition-all ${tab===t?'bg-emerald-500 text-white':'bg-[#334155] text-zinc-400 hover:bg-[#475569]'}`}>\n            {t==='overview'?'📊 Overview':t==='rental'?'🏠 Rental':t==='capital'?'📈 Capital':'💰 Costi'}\n          </button>\n        ))}\n      </div>\n\n      {/* Overview Tab */}\n      {tab === 'overview' && (\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n          <div className=\"bg-blue-500/10 rounded-xl p-4 text-center border border-blue-500/20\">\n            <p className=\"text-3xl font-bold text-blue-400\">{ltYield}%</p>\n            <p className=\"text-xs text-zinc-500 mt-1\">Yield LT Netto</p>\n          </div>\n          <div className=\"bg-purple-500/10 rounded-xl p-4 text-center border border-purple-500/20\">\n            <p className=\"text-3xl font-bold text-purple-400\">{stYield}%</p>\n            <p className=\"text-xs text-zinc-500 mt-1\">Yield ST Netto</p>\n          </div>\n          <div className=\"bg-emerald-500/10 rounded-xl p-4 text-center border border-emerald-500/20\">\n            <p className=\"text-3xl font-bold text-emerald-400\">+{appr.toFixed(0)}%</p>\n            <p className=\"text-xs text-zinc-500 mt-1\">Apprezzamento</p>\n          </div>\n          <div className=\"bg-amber-500/10 rounded-xl p-4 text-center border border-amber-500/20\">\n            <p className=\"text-3xl font-bold text-amber-400\">{fmt(costs)}</p>\n            <p className=\"text-xs text-zinc-500 mt-1\">Costi/Anno</p>\n          </div>\n          \n          <div className=\"col-span-2 bg-[#1e293b] rounded-xl p-4 border border-[#334155]\">\n            <p className=\"text-zinc-400 text-xs mb-3\">Revenue Annuo Netto</p>\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between items-center\"><span className=\"text-zinc-400\">🏠 Long Term</span><span className=\"text-blue-400 font-bold text-lg\">{fmt(ltNet)} AED</span></div>\n              <div className=\"flex justify-between items-center\"><span className=\"text-zinc-400\">🏖️ Short Term</span><span className=\"text-purple-400 font-bold text-lg\">{fmt(stNet)} AED</span></div>\n            </div>\n          </div>\n          <div className=\"col-span-2 bg-[#1e293b] rounded-xl p-4 border border-[#334155]\">\n            <p className=\"text-zinc-400 text-xs mb-3\">Capital Gain</p>\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between items-center\"><span className=\"text-zinc-400\">Valore Futuro</span><span className=\"text-emerald-400 font-bold text-lg\">{fmt(futVal)} AED</span></div>\n              <div className=\"flex justify-between items-center\"><span className=\"text-zinc-400\">Profitto</span><span className=\"text-emerald-400 font-bold text-lg\">+{fmt(profit)} AED</span></div>\n            </div>\n          </div>\n          \n          <div className=\"col-span-full bg-[#1e293b] rounded-xl p-4 border border-[#334155]\">\n            <p className=\"text-zinc-400 text-xs mb-3\">ROI Totale 3 anni (rent + appreciation)</p>\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex-1 bg-[#334155] rounded-full h-4 overflow-hidden\">\n                <div className=\"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-emerald-500 transition-all\" style={{width:`${Math.min(((ltNet*3+profit)/price)*100, 100)}%`}}/>\n              </div>\n              <span className=\"text-white font-bold text-xl\">{(((ltNet*3+profit)/price)*100).toFixed(0)}%</span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Rental Tab */}\n      {tab === 'rental' && (\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          <div className=\"bg-[#1e293b] rounded-xl p-4 border border-blue-500/30\">\n            <h3 className=\"font-semibold text-white mb-4\">🏠 Long Term Rental</h3>\n            <div className=\"grid grid-cols-2 gap-3 mb-4\">\n              <div className=\"bg-blue-500/10 rounded-lg p-3 text-center\">\n                <p className=\"text-2xl font-bold text-blue-400\">{(rent/price*100).toFixed(1)}%</p>\n                <p className=\"text-xs text-zinc-500\">Yield Lordo</p>\n              </div>\n              <div className=\"bg-emerald-500/10 rounded-lg p-3 text-center\">\n                <p className=\"text-2xl font-bold text-emerald-400\">{ltYield}%</p>\n                <p className=\"text-xs text-zinc-500\">Yield Netto</p>\n              </div>\n            </div>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">Affitto Annuo</span><span className=\"text-white\">{fmt(rent)} AED</span></div>\n              <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">Mensile</span><span className=\"text-white\">{fmt(rent/12)} AED</span></div>\n              <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">(-) Costi Annui</span><span className=\"text-red-400\">-{fmt(costs)} AED</span></div>\n              <div className=\"flex justify-between py-2 font-medium\"><span className=\"text-white\">= Netto Annuo</span><span className=\"text-emerald-400\">{fmt(ltNet)} AED</span></div>\n            </div>\n          </div>\n          \n          <div className=\"bg-[#1e293b] rounded-xl p-4 border border-purple-500/30\">\n            <h3 className=\"font-semibold text-white mb-4\">🏖️ Short Term / Airbnb</h3>\n            <div className=\"grid grid-cols-2 gap-3 mb-4\">\n              <div className=\"bg-purple-500/10 rounded-lg p-3 text-center\">\n                <p className=\"text-2xl font-bold text-purple-400\">{(stGross/price*100).toFixed(1)}%</p>\n                <p className=\"text-xs text-zinc-500\">Yield Lordo</p>\n              </div>\n              <div className=\"bg-emerald-500/10 rounded-lg p-3 text-center\">\n                <p className=\"text-2xl font-bold text-emerald-400\">{stYield}%</p>\n                <p className=\"text-xs text-zinc-500\">Yield Netto</p>\n              </div>\n            </div>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">Tariffa/Notte</span><span className=\"text-white\">{fmt(d.night*roiBrMult.night[br])} AED</span></div>\n              <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">Occupancy Media</span><span className=\"text-white\">{d.occ}%</span></div>\n              <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">Revenue Lordo</span><span className=\"text-white\">{fmt(stGross)} AED</span></div>\n              <div className=\"flex justify-between py-2 font-medium\"><span className=\"text-white\">= Netto Annuo</span><span className=\"text-emerald-400\">{fmt(stNet)} AED</span></div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Capital Tab */}\n      {tab === 'capital' && (\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-emerald-500/30\">\n          <h3 className=\"font-semibold text-white mb-4\">📈 Capital Appreciation - {mkt === 'offplan' ? 'Off-Plan' : 'Secondary'}</h3>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4\">\n            <div className=\"bg-emerald-500/10 rounded-lg p-3 text-center\">\n              <p className=\"text-2xl font-bold text-emerald-400\">+{appr.toFixed(0)}%</p>\n              <p className=\"text-xs text-zinc-500\">Apprezzamento</p>\n            </div>\n            <div className=\"bg-[#334155] rounded-lg p-3 text-center\">\n              <p className=\"text-xl font-bold text-white\">{fmt(profit)}</p>\n              <p className=\"text-xs text-zinc-500\">Profitto (AED)</p>\n            </div>\n            <div className=\"bg-[#334155] rounded-lg p-3 text-center\">\n              <p className=\"text-xl font-bold text-white\">{fmt(futVal)}</p>\n              <p className=\"text-xs text-zinc-500\">Valore Futuro</p>\n            </div>\n            {mkt === 'offplan' && (\n              <div className=\"bg-orange-500/10 rounded-lg p-3 text-center\">\n                <p className=\"text-xl font-bold text-orange-400\">{d.opHand}m</p>\n                <p className=\"text-xs text-zinc-500\">Handover</p>\n              </div>\n            )}\n          </div>\n          <div className=\"space-y-2 text-sm\">\n            <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">Prezzo Acquisto</span><span className=\"text-white\">{fmt(price)} AED</span></div>\n            {mkt === 'offplan' && <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">(-) Launch Discount {disc}%</span><span className=\"text-emerald-400\">-{fmt(price-effPrice)} AED</span></div>}\n            <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">Prezzo Effettivo</span><span className=\"text-white\">{fmt(effPrice)} AED</span></div>\n            <div className=\"flex justify-between py-2 border-b border-[#334155]\"><span className=\"text-zinc-400\">(+) Apprezzamento {appr.toFixed(0)}%</span><span className=\"text-emerald-400\">+{fmt(profit)} AED</span></div>\n            <div className=\"flex justify-between py-2 font-medium text-lg\"><span className=\"text-white\">= Valore Futuro</span><span className=\"text-emerald-400\">{fmt(futVal)} AED</span></div>\n          </div>\n        </div>\n      )}\n\n      {/* Costs Tab */}\n      {tab === 'costs' && (\n        <div className=\"bg-[#1e293b] rounded-xl p-4 border border-red-500/30\">\n          <h3 className=\"font-semibold text-white mb-4\">💰 Breakdown Costi Annuali</h3>\n          <div className=\"space-y-2 text-sm\">\n            <div className=\"flex justify-between py-3 border-b border-[#334155]\">\n              <span className=\"text-zinc-400\">Service Charge ({sc} × {sqft} sqft)</span>\n              <span className=\"text-amber-400 font-bold\">{fmt(sc*sqft*a.sc)} AED</span>\n            </div>\n            <div className=\"flex justify-between py-3 border-b border-[#334155]\">\n              <span className=\"text-zinc-400\">DEWA (Utilities)</span>\n              <span className=\"text-blue-400 font-bold\">{fmt(d.dewa*roiBrMult.dewa[br])} AED</span>\n            </div>\n            <div className=\"flex justify-between py-3 border-b border-[#334155]\">\n              <span className=\"text-zinc-400\">Assicurazione</span>\n              <span className=\"text-green-400 font-bold\">~1,000 AED</span>\n            </div>\n            {a.maint > 0 && (\n              <div className=\"flex justify-between py-3 border-b border-[#334155]\">\n                <span className=\"text-zinc-400\">Manutenzione (edificio {age})</span>\n                <span className=\"text-red-400 font-bold\">{fmt(a.maint)} AED</span>\n              </div>\n            )}\n            <div className=\"flex justify-between py-3 font-bold text-lg\">\n              <span className=\"text-white\">TOTALE ANNUO</span>\n              <span className=\"text-red-400\">{fmt(costs)} AED</span>\n            </div>\n            <div className=\"flex justify-between py-2 text-zinc-500\">\n              <span>Mensile</span>\n              <span>{fmt(costs/12)} AED/mese</span>\n            </div>\n          </div>\n          <div className=\"mt-4 p-3 bg-amber-500/10 rounded-lg border border-amber-500/20\">\n            <p className=\"text-amber-400 text-xs\">📌 Service Charge {z}: {sc} AED/sqft • {sc > 20 ? 'Premium (alto)' : sc > 12 ? 'Nella media' : 'Budget (basso)'}</p>\n          </div>\n        </div>\n      )}\n\n      <p className=\"text-zinc-600 text-xs text-center\">⚠️ Stime basate su dati 2024-2025 (RERA, Bayut, DLD). Consulta un professionista prima di investire.</p>\n    </div>\n  );\n}\n\n// ==================== CSS ANIMATIONS ====================\nconst style = document.createElement('style');\nstyle.textContent = `\n  @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }\n  @keyframes slideRight { from { transform: translateX(-100%); } to { transform: translateX(0); } }\n  @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }\n  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\n  .animate-slideUp { animation: slideUp 0.3s ease-out; }\n  .animate-slideRight { animation: slideRight 0.3s ease-out; }\n  .animate-scaleIn { animation: scaleIn 0.2s ease-out; }\n  .animate-fadeIn { animation: fadeIn 0.2s ease-out; }\n  * { -webkit-tap-highlight-color: transparent; }\n  input, select, textarea { font-size: 16px !important; }\n  .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }\n  .scrollbar-hide::-webkit-scrollbar { display: none; }\n`;\nif (typeof document !== 'undefined') document.head.appendChild(style);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}